<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Linux---DHCP和FTP（原理&#43;实操） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/b153f939cf53080ba045218234779c77/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Linux---DHCP和FTP（原理&#43;实操）">
  <meta property="og:description" content="文章目录 DHCP和FTP（原理&#43;实操）DHCP使用DHCP（自动分配IP）的好处分配方式租约过程第一次重新登录更新租约DHCP服务可分配的地址信息主要包括 DHCP安装和配置实验目的实验环境:网络环境:系统环境:具体操作实操注意一、将三台虚拟机网络连为vmnat2二、配置ens33三、重启网络四、查看网络信息五、配置yum源六、关闭防火墙、核心防护七、安装dhcp有关软件包八、编辑 dchp全局配置文件，设置好对应的网络池九、重启网卡，启用dhcp服务十、centos客户端配置ens33十一、关闭防火墙、核心防护十二、刷新网卡，通过DHCP获取IP十三、win 10 客户端关闭防火墙十四、ipv4改为自动获得IP地址和DNS服务器十五、禁用网络再启动十六、进入cmd，查询网络十七、完成 FTPftp的数据连接模式vsftpd的安装和配置实验环境:实操注意一、vsftpd安装二、备份vsftpd的配置文件三、vsftpd初始化全局配置四、让匿名用户拥有访问本机和各种权限五、重启vsftpd服务，关闭安全防护六、给匿名用户的默认根目录权限，做测试文件七、在Windows系统打开开始菜单，输入cmd 命令打开命令提示符，连接ftp 192.168.52.2八、测试九、创建用户，免交互设置密码十、配置本地用户验证访问ftp限制十一、在Windows系统打开开始菜单，输入cmd 命令打开命令提示符十二、添加、切换目录的限制配置 ：十三、重启ftp服务十四、在Windows系统打开开始菜单，输入cmd 命令打开命令提示符十五、配置黑名单/白名单黑名单测试白名单测试 十六、windows输入文件同步：十七、完成 DHCP和FTP（原理&#43;实操） DHCP 使用DHCP（自动分配IP）的好处 减少管理员的工作量避免输入错误的可能避免IP地址冲突当更改IP地址段时，不需要重新配置每个用户的IP地址提高了IP地址的利用率方便客户端的配置 分配方式 自动分配:分配到一个IP地址后永久使用（打印机）手动分配:由DHCP服务器管理员专门指定IP地址动态分配:使用完后释放该IP，供其它客户机使用（地址池） 租约过程 客户机从DHCP服务器获得IP地址的过程
第一次 客户端在网络中搜索服务器—discover服务器向客户端响应服务—offer客户端向目标服务器发出服务请求—request服务器向客户端提供服务—ack 重新登录 客户端向目标服务器发出服务请求—request
服务器向客户端提供服务—ack
更新租约 当DHCP服务器向客户机出租的IP地址租期达到50%时就需要更新租约客户机直接向提供租约的服务器发送DHCP Request包要求更新现有的地址租约 DHCP服务 为大量客户机自动分配地址，提供集中管理减轻管理和维护成本、提高网络配置效率 可分配的地址信息主要包括 网卡的IP地址、子网掩码对应的网络地址、广播地址默认网关地址DNS服务器地址 DHCP安装和配置 实验目的 在单位时，运用DHCP协议设置地址池，让公司员工的主机都能自动识别，并且分发范围内的IP地址
实验环境: 3台机器
centos 7-1 DHCP 服务端 192.168.65.2(为了实验方便，将此IP定义为该网段的网关)
centos 7-2 DHCP 客户端 自动分配
windows 10 DHCP 客户端 自动分配
网络环境: ① Vmnet2(仅主机模式)
② vmware workstation 的虚拟网络编辑器中的DHCP功能必须关闭
③ 确定好Vmnet2 仅主机模式的IP地址段是多少4 注意 DHCP服务端的网卡信息的配置(GATEWAY 不要写)
系统环境: ① 先安装好DHCP服务，再行修改网络配置(nat-》Vmnet2)">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-15T17:20:26+08:00">
    <meta property="article:modified_time" content="2024-08-15T17:20:26+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Linux---DHCP和FTP（原理&#43;实操）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#DHCPFTP_1" rel="nofollow">DHCP和FTP（原理+实操）</a></li><li><ul><li><a href="#DHCP_3" rel="nofollow">DHCP</a></li><li><ul><li><a href="#DHCPIP_5" rel="nofollow">使用DHCP（自动分配IP）的好处</a></li><li><a href="#_14" rel="nofollow">分配方式</a></li><li><a href="#_20" rel="nofollow">租约过程</a></li><li><ul><li><a href="#_24" rel="nofollow">第一次</a></li><li><a href="#_31" rel="nofollow">重新登录</a></li><li><a href="#_37" rel="nofollow">更新租约</a></li><li><a href="#DHCP_43" rel="nofollow">DHCP服务</a></li><li><a href="#_48" rel="nofollow">可分配的地址信息主要包括</a></li></ul> 
    </li><li><a href="#DHCP_55" rel="nofollow">DHCP安装和配置</a></li><li><ul><li><a href="#_57" rel="nofollow">实验目的</a></li><li><a href="#_61" rel="nofollow">实验环境:</a></li><li><a href="#_68" rel="nofollow">网络环境:</a></li><li><a href="#_76" rel="nofollow">系统环境:</a></li><li><a href="#_84" rel="nofollow">具体操作</a></li><li><a href="#_162" rel="nofollow">实操</a></li><li><ul><li><a href="#_164" rel="nofollow">注意</a></li><li><a href="#vmnat2_171" rel="nofollow">一、将三台虚拟机网络连为vmnat2</a></li><li><a href="#ens33_175" rel="nofollow">二、配置ens33</a></li><li><a href="#_181" rel="nofollow">三、重启网络</a></li><li><a href="#_185" rel="nofollow">四、查看网络信息</a></li><li><a href="#yum_191" rel="nofollow">五、配置yum源</a></li><li><a href="#_195" rel="nofollow">六、关闭防火墙、核心防护</a></li><li><a href="#dhcp_199" rel="nofollow">七、安装dhcp有关软件包</a></li><li><a href="#_dchp_205" rel="nofollow">八、编辑 dchp全局配置文件，设置好对应的网络池</a></li><li><a href="#dhcp_211" rel="nofollow">九、重启网卡，启用dhcp服务</a></li><li><a href="#centosens33_219" rel="nofollow">十、centos客户端配置ens33</a></li><li><a href="#_225" rel="nofollow">十一、关闭防火墙、核心防护</a></li><li><a href="#DHCPIP_229" rel="nofollow">十二、刷新网卡，通过DHCP获取IP</a></li><li><a href="#win_10__236" rel="nofollow">十三、win 10 客户端关闭防火墙</a></li><li><a href="#ipv4IPDNS_240" rel="nofollow">十四、ipv4改为自动获得IP地址和DNS服务器</a></li><li><a href="#_244" rel="nofollow">十五、禁用网络再启动</a></li><li><a href="#cmd_249" rel="nofollow">十六、进入cmd，查询网络</a></li><li><a href="#_255" rel="nofollow">十七、完成</a></li></ul> 
    </li></ul> 
   </li></ul> 
   </li><li><a href="#FTP_257" rel="nofollow">FTP</a></li><li><ul><li><a href="#ftp_264" rel="nofollow">ftp的数据连接模式</a></li><li><a href="#vsftpd_278" rel="nofollow">vsftpd的安装和配置</a></li><li><ul><li><a href="#_280" rel="nofollow">实验环境:</a></li><li><a href="#_431" rel="nofollow">实操</a></li><li><ul><li><a href="#_432" rel="nofollow">注意</a></li><li><a href="#vsftpd_436" rel="nofollow">一、vsftpd安装</a></li><li><a href="#vsftpd_442" rel="nofollow">二、备份vsftpd的配置文件</a></li><li><a href="#vsftpd_452" rel="nofollow">三、vsftpd初始化全局配置</a></li><li><a href="#_463" rel="nofollow">四、让匿名用户拥有访问本机和各种权限</a></li><li><a href="#vsftpd_473" rel="nofollow">五、重启vsftpd服务，关闭安全防护</a></li><li><a href="#_480" rel="nofollow">六、给匿名用户的默认根目录权限，做测试文件</a></li><li><a href="#Windowscmd_ftp_192168522_487" rel="nofollow">七、在Windows系统打开开始菜单，输入cmd 命令打开命令提示符，连接ftp 192.168.52.2</a></li><li><a href="#_495" rel="nofollow">八、测试</a></li><li><a href="#_507" rel="nofollow">九、创建用户，免交互设置密码</a></li><li><a href="#ftp_516" rel="nofollow">十、配置本地用户验证访问ftp限制</a></li><li><a href="#Windowscmd__527" rel="nofollow">十一、在Windows系统打开开始菜单，输入cmd 命令打开命令提示符</a></li><li><a href="#__536" rel="nofollow">十二、添加、切换目录的限制配置 ：</a></li><li><a href="#ftp_546" rel="nofollow">十三、重启ftp服务</a></li><li><a href="#Windowscmd__552" rel="nofollow">十四、在Windows系统打开开始菜单，输入cmd 命令打开命令提示符</a></li><li><a href="#_564" rel="nofollow">十五、配置黑名单/白名单</a></li><li><ul><li><a href="#_566" rel="nofollow">黑名单</a></li><li><a href="#_590" rel="nofollow">测试</a></li><li><a href="#_599" rel="nofollow">白名单</a></li><li><a href="#_612" rel="nofollow">测试</a></li></ul> 
      </li><li><a href="#windows_620" rel="nofollow">十六、windows输入文件同步：</a></li><li><a href="#_628" rel="nofollow">十七、完成</a></li></ul> 
    </li></ul> 
   </li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="DHCPFTP_1"></a>DHCP和FTP（原理+实操）</h2> 
<h3><a id="DHCP_3"></a>DHCP</h3> 
<h4><a id="DHCPIP_5"></a>使用DHCP（自动分配IP）的好处</h4> 
<ol><li>减少管理员的工作量</li><li>避免输入错误的可能</li><li>避免IP地址冲突</li><li>当更改IP地址段时，不需要重新配置每个用户的IP地址</li><li>提高了IP地址的利用率</li><li>方便客户端的配置</li></ol> 
<h4><a id="_14"></a>分配方式</h4> 
<ol><li>自动分配:分配到一个IP地址后永久使用（打印机）</li><li>手动分配:由DHCP服务器管理员专门指定IP地址</li><li>动态分配:使用完后释放该IP，供其它客户机使用（地址池）</li></ol> 
<h4><a id="_20"></a>租约过程</h4> 
<p>客户机从DHCP服务器获得IP地址的过程</p> 
<h5><a id="_24"></a>第一次</h5> 
<ol><li>客户端在网络中搜索服务器—discover</li><li>服务器向客户端响应服务—offer</li><li>客户端向目标服务器发出服务请求—request</li><li>服务器向客户端提供服务—ack</li></ol> 
<h5><a id="_31"></a>重新登录</h5> 
<p>客户端向目标服务器发出服务请求—request</p> 
<p>服务器向客户端提供服务—ack</p> 
<h5><a id="_37"></a>更新租约</h5> 
<ol><li>当DHCP服务器向客户机出租的IP地址租期达到50%时就需要更新租约</li><li>客户机直接向提供租约的服务器发送DHCP Request包要求更新现有的地址租约</li></ol> 
<h5><a id="DHCP_43"></a>DHCP服务</h5> 
<ol><li>为大量客户机自动分配地址，提供集中管理</li><li>减轻管理和维护成本、提高网络配置效率</li></ol> 
<h5><a id="_48"></a>可分配的地址信息主要包括</h5> 
<ol><li>网卡的IP地址、子网掩码</li><li>对应的网络地址、广播地址</li><li>默认网关地址</li><li>DNS服务器地址</li></ol> 
<h4><a id="DHCP_55"></a>DHCP安装和配置</h4> 
<h5><a id="_57"></a>实验目的</h5> 
<p>在单位时，运用DHCP协议设置地址池，让公司员工的主机都能自动识别，并且分发范围内的IP地址</p> 
<h5><a id="_61"></a>实验环境:</h5> 
<p>3台机器<br> centos 7-1 DHCP 服务端 192.168.65.2(为了实验方便，将此IP定义为该网段的网关)<br> centos 7-2 DHCP 客户端 自动分配<br> windows 10 DHCP 客户端 自动分配</p> 
<h5><a id="_68"></a>网络环境:</h5> 
<p>① Vmnet2(仅主机模式)</p> 
<p>② vmware workstation 的虚拟网络编辑器中的DHCP功能必须关闭</p> 
<p>③ 确定好Vmnet2 仅主机模式的IP地址段是多少4 注意 DHCP服务端的网卡信息的配置(GATEWAY 不要写)</p> 
<h5><a id="_76"></a>系统环境:</h5> 
<p>① 先安装好DHCP服务，再行修改网络配置(nat-》Vmnet2)</p> 
<p>② 或者，修改完网络配置后，配置本地YUM仓库，再行安装DHCP</p> 
<p>③ 每台机器，关闭防火墙、核心防护</p> 
<h5><a id="_84"></a>具体操作</h5> 
<pre><code>1.将三台虚拟机网络连为vmnat2

centos 7服务端配置
2.centos服务端配置ens33

vim /etc/sysconfig/network-scripts/ifcfg-ens33
dhcp改为static
onboot改为yes
添加ipaddr=192.168.65.2和netmask

重启网络
systemctl restart network

查看网络信息
ifconfig ens33

3.配置yum源

此处略

4.关闭防火墙、核心保护

systemctl stop firewalld
setenforce 0

5.编辑 dchp全局配置文件，设置好对应的网络池
检查并且安装dhcp有关软件包
rpm -qc dhcp
yum install -y dhcp

cd /usr/share/doc/dhcp-4.2.5/
less dhcpd.conf.example
cp /usr/share/doc/dhcp-4.2.5/dhcpd.conf.example /etc/dhcp/dhcpd.conf
vim /etc/dhcp/dhcpd.conf
 
subnet 192.168.233.0 netmask 255.255.255.0{
 range 192.168.233.30  192.168.233.50；
  option routers 192.168.233.2；
}

6.重启网卡，启用dhcp服务
systemctl restart network
systemctl restart dhcpd
systemctl status dhcpd

centos 7客户端配置
7.centos客户端配置ens33

vim /etc/sysconfig/network-scripts/ifcfg-ens33
默认为dhcp
onboot改为yes

8.关闭防火墙、核心保护

systemctl stop firewalld
setenforce 0

9.刷新网卡，通过DHCP获取IP
systemctl restart network
ifconfig ens33

10.查看租约
less /var/lib/dhcpd/dhcpd.lease 

11.windows 10 客户端（win10已激活）
关闭防火墙

12.ipv4改为自动获得IP地址和DNS服务器

13.禁用网络再启动

14.进入cmd，查询网络
ipconfig
</code></pre> 
<h5><a id="_162"></a>实操</h5> 
<h6><a id="_164"></a>注意</h6> 
<p><img src="https://images2.imgbox.com/1c/9f/aUVnl5EK_o.png" alt="在这里插入图片描述"></p> 
<ol><li>取消勾选使用dhcp</li><li>记住子网IP</li></ol> 
<h6><a id="vmnat2_171"></a>一、将三台虚拟机网络连为vmnat2</h6> 
<p><img src="https://images2.imgbox.com/5a/8e/ieKkNuBN_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="ens33_175"></a>二、配置ens33</h6> 
<p>vim /etc/sysconfig/network-scripts/ifcfg-ens33</p> 
<p><img src="https://images2.imgbox.com/96/ef/QxtalPIk_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="_181"></a>三、重启网络</h6> 
<p><img src="https://images2.imgbox.com/ae/cf/btTQM4Y6_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="_185"></a>四、查看网络信息</h6> 
<p>ifconfig ens33</p> 
<p><img src="https://images2.imgbox.com/eb/47/F2JsjWr7_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="yum_191"></a>五、配置yum源</h6> 
<p>之前已做好-略</p> 
<h6><a id="_195"></a>六、关闭防火墙、核心防护</h6> 
<p>之前已做好-略</p> 
<h6><a id="dhcp_199"></a>七、安装dhcp有关软件包</h6> 
<p>yum install -y dhcp</p> 
<p><img src="https://images2.imgbox.com/9b/aa/xwa4naCv_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="_dchp_205"></a>八、编辑 dchp全局配置文件，设置好对应的网络池</h6> 
<p><img src="https://images2.imgbox.com/57/01/JunzWMsO_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/79/f0/caSKxgv9_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="dhcp_211"></a>九、重启网卡，启用dhcp服务</h6> 
<p>systemctl restart network<br> systemctl restart dhcpd<br> systemctl status dhcpd</p> 
<p><img src="https://images2.imgbox.com/86/cf/PceK8Z8x_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="centosens33_219"></a>十、centos客户端配置ens33</h6> 
<p>vim /etc/sysconfig/network-scripts/ifcfg-ens33</p> 
<p><img src="https://images2.imgbox.com/19/86/589yofg0_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="_225"></a>十一、关闭防火墙、核心防护</h6> 
<p>之前已做好-略</p> 
<h6><a id="DHCPIP_229"></a>十二、刷新网卡，通过DHCP获取IP</h6> 
<p>systemctl restart network<br> ifconfig ens33</p> 
<p><img src="https://images2.imgbox.com/8b/42/zihPnwhE_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="win_10__236"></a>十三、win 10 客户端关闭防火墙</h6> 
<p><img src="https://images2.imgbox.com/02/fb/DrF1IyT3_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="ipv4IPDNS_240"></a>十四、ipv4改为自动获得IP地址和DNS服务器</h6> 
<p><img src="https://images2.imgbox.com/e0/f9/Lh0TVPhy_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="_244"></a>十五、禁用网络再启动</h6> 
<p><img src="https://images2.imgbox.com/d4/27/GIoxSpav_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="cmd_249"></a>十六、进入cmd，查询网络</h6> 
<p>ipconfig</p> 
<p><img src="https://images2.imgbox.com/db/7b/QZNdCRk5_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="_255"></a>十七、完成</h6> 
<h3><a id="FTP_257"></a>FTP</h3> 
<p>FTP服务器默认使用TCP协议的20、21端口与客户端进行通信</p> 
<ul><li>20端口用于建立数据连接，并传输文件数据</li><li>21端口用于建立控制连接，并传输FTP控制命令</li></ul> 
<h4><a id="ftp_264"></a>ftp的数据连接模式</h4> 
<ol><li>主动模式:服务器主动发起数据连接</li><li>被动模式:服务器被动等待数据连接</li></ol> 
<ul><li>主动模式(Active Mode):在主动模式下，FTP客户端首先与FTP服务器的默认端口(通常是端口21)建立控制连接当需要进行数据传输时，客户端会随机选择一个未使用的端口(通常是大于1024的端口)作为源端口，然后告知服务器使用该端口进行数据连接。服务器通过控制连接将数据连接请求发送到客户端的指定端口建立数据连接并进行数据传输。</li><li>被动模式(Passive Mode):在被动模式下，FTP客户端首先与FTP服务器的默认端口(通常是端口21)建立控制连接当需要进行数据传输时，服务器会随机选择一个未使用的端口(通常是大于1024的端口)作为源端口，并将该端口告知客户端。客户端通过控制连接向服务器指定的端口发起数据连接，建立数据连接并进行数据传输</li></ul> 
<p>主动模式和被动模式在数据连接的建立方式上有所区别，主要涉及客户端和服务器之间数据连接的建立和传输。在网络环境复杂或存在防火墙的情况下，被动模式通常更容易穿越防火墙，因此在实际应用中被广泛使用。</p> 
<p>passive 开启被动模式</p> 
<p>prompt 开启主动模式</p> 
<h4><a id="vsftpd_278"></a>vsftpd的安装和配置</h4> 
<h5><a id="_280"></a>实验环境:</h5> 
<p>2台机器<br> centos 7-1 上面做的DHCP 服务端可以继续使用<br> windows 10 上面做的DHCP 客户端 取消自动分配，自定义IP地址 禁用网络再启动</p> 
<pre><code>1.vsftpd安装
rpm -qc vsftpd    //检查vsftpd安装包是否存在，存在即不需要安装
yum install -y vsftpd   //yum 安装vsftpd

2.备份vsftpd的配置文件
cd /etc/vsftpd
ls                //切换到安装好vsftpd目录下查看文件
cp vsftpd.conf vsftpd.conf.bak   //将vsftpd的配置文件进行备份

3.vsftpd初始化全局配置
vim /etc/vsftpd/vsftpd.conf

# 默认
anonymous_enable=YES            #开启匿名用户访问。默认已开启
local_enable=YES                #允许系统用户进行访问(useradd zhangsan)
write_enable=YES                #开放服务器的写权限（若要上传，必须开启）。默认已开启
anon_umask=022                  #设置匿名用户所上传数据的权限掩码（反掩码）。

4.让匿名用户拥有访问本机和各种权限 
anon_umask=022                  #设置匿名用户所上传数据的权限掩码（反掩码）。
anon_upload_enable=YES          #允许匿名用户上传文件。默认已注释，需取消注释
anon_mkdir_write_enable=YES     #允许匿名用户创建（上传）目录。默认已注释，需取消注释
anon_other_write_enable=YES     #允许删除、重命名、覆盖等操作。需添加

5.重启vsftpd服务，关闭安全防护
systemctl restart vsftpd
systemctl stop firewalld
setenforce 0

6.给匿名用户的默认根目录权限，做测试文件
chmod 777 /var/ftp/pub/  这是匿名用户的默认根目录
echo 'hello world!' &gt; test.txt

匿名访问测试
7.在Windows系统打开开始菜单，输入cmd 命令打开命令提示符

8.建立ftp连接
ftp 192.168.52.2
#匿名访问，用户名为ftp，密码为空，直接回车即可完成登录

9.测试
ftp&gt; pwd          #匿名访问ftp的根目录为Linux系统的/var/ftp/目录
ftp&gt; ls           #查看当前目录
ftp&gt; cd pub       #切换到pub目录ftp&gt; get文件名    #下载文件到当前Windows本地目录
ftp&gt; ls
ftp&gt; get test.txt #获取目录中的文件下载到电脑
ftp&gt; ls
ftp&gt; put test4.txt
存在的缺点：匿名用户权限过高，存在安全隐患

设置本地用户验证访问ftp
设置本地用户可以访问ftp，禁止匿名用户登录
10.创建用户，免交互设置密码
useradd zhangsan
echo '123' | passwd --stdin zhangsan
useradd lisi
echo '123' | passwd --stdin lisi

11.配置本地用户验证访问ftp限制
vim /etc/vsftpd/vsftpd.conf

local_enable=Yes        		 #启用本地用户
anonymous_enable=NO     		 #关闭匿名用户访问
write_enable=YES        		 #开放服务器的写权限（若要上传，必须开启）
local_umask=077          		 #可设置仅宿主用户拥有被上传的文件的权限（反掩码）

12.在Windows系统打开开始菜单，输入cmd 命令打开命令提示符
ftp 192.168.52.2
zhangsan
123
OK

对本地用户访问切换目录进行限制
13.添加、切换目录的限制配置 ：
vim /etc/vsftpd/vsftpd.conf

chroot_local_user=YES   		        #将访问禁锢在用户的宿主目录中 取消注释即可
allow_writeable_chroot=YES		 #允许被限制的用户主目录具有写权限

14.重启ftp服务
systemctl restart vsftpd

15.在Windows系统打开开始菜单，输入cmd 命令打开命令提示符
ftp 192.168.52.2
zhangsan
123
OK

16.测试
ftp&gt; cd /etc
550 Failed to change directory.

17.修改匿名用户、本地用户登录的默认根目录
vim /etc/vsftpd/vsftpd.conf

anon_root=/var/www/html			#anon_root 针对匿名用户
local_root=/var/www/html		#local_root 针对本地用户

18.重启ftp服务
systemctl restart vsftpd

黑名单和白名单的使用 
在安装vsftpd服务后，官方贴心的为我们在服务目录中提供了user_list   
(其中就是为了我们更好利用黑名单和白名单的手册)。

黑名单：在黑名单上标记的用户，是我们禁止访问的对象。
白名单：在白名单上标记的用户是我们允许访问的对象，白名单比黑名单的制定更为严格和安全。

17.配置黑名单/白名单
vim /etc/vsftpd/vsftpd.conf

黑名单
userlist_enable=YES				#启用user_list用户列表文件
userlist_deny=YES				#默认为YES，为黑名单，禁止user_list名单上的用户进行访问

白名单
userlist_enable=YES				#启用user_list用户列表文件
userlist_deny=NO				#设置白名单，仅允许user_list用户列表文件的用户访问。

#要想使用root用户，需要把ftpusers里面的root用户注销掉即可

18.测试
ftp 192.168.52.2
zhangsan
530 Permission denied.
登录失败。
ftp&gt; quit
221 Goodbye.

ftp 192.168.52.2
lisi
331 Please specify the password.
密码:
230 Login successful.
ftp&gt;

张三不能输入密码

19.可以在windows输入文件同步
ftp://lisi@192.168.52.2	 #在资源管理器输入
lisi
123
</code></pre> 
<h5><a id="_431"></a>实操</h5> 
<h6><a id="_432"></a>注意</h6> 
<p>windows 10 取消自动分配，自定义IP地址，禁用网络再启动</p> 
<h6><a id="vsftpd_436"></a>一、vsftpd安装</h6> 
<p>yum install -y vsftpd</p> 
<p><img src="https://images2.imgbox.com/8e/45/GSx23PCt_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="vsftpd_442"></a>二、备份vsftpd的配置文件</h6> 
<p>cd /etc/vsftpd</p> 
<p>ls</p> 
<p>cp vsftpd.conf vsftpd.conf.bak</p> 
<p><img src="https://images2.imgbox.com/6b/1b/w4525zyz_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="vsftpd_452"></a>三、vsftpd初始化全局配置</h6> 
<p>vim /etc/vsftpd/vsftpd.conf</p> 
<p>anonymous_enable=YES<br> local_enable=YES<br> write_enable=YES<br> anon_umask=022</p> 
<p><img src="https://images2.imgbox.com/75/4b/wPevQWCY_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="_463"></a>四、让匿名用户拥有访问本机和各种权限</h6> 
<p>anon_umask=022<br> anon_upload_enable=YES<br> anon_mkdir_write_enable=YES<br> anon_other_write_enable=YES</p> 
<p><img src="https://images2.imgbox.com/24/99/xxqHp3yI_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="vsftpd_473"></a>五、重启vsftpd服务，关闭安全防护</h6> 
<p>systemctl restart vsftpd<br> 防火墙/核心防护已关-略</p> 
<p><img src="https://images2.imgbox.com/e4/09/wochFP19_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="_480"></a>六、给匿名用户的默认根目录权限，做测试文件</h6> 
<p>chmod 777 /var/ftp/pub/<br> echo ‘hello world!’ &gt; test.txt</p> 
<p><img src="https://images2.imgbox.com/04/5b/uU8Sv1dJ_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="Windowscmd_ftp_192168522_487"></a>七、在Windows系统打开开始菜单，输入cmd 命令打开命令提示符，连接ftp 192.168.52.2</h6> 
<p>ftp 192.168.52.2</p> 
<p>匿名访问，用户名为ftp，密码为空，直接回车</p> 
<p><img src="https://images2.imgbox.com/93/28/IPk6V6mz_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="_495"></a>八、测试</h6> 
<p>ftp&gt; pwd<br> ftp&gt; ls<br> ftp&gt; cd pub<br> ftp&gt; ls<br> ftp&gt; get test.txt<br> ftp&gt; ls<br> ftp&gt; put test4.txt</p> 
<p><img src="https://images2.imgbox.com/96/66/X8qQE36r_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="_507"></a>九、创建用户，免交互设置密码</h6> 
<p>useradd zhangsan<br> echo ‘123’ | passwd --stdin zhangsan<br> useradd lisi<br> echo ‘123’ | passwd --stdin lisi</p> 
<p><img src="https://images2.imgbox.com/c7/ea/8BaXRE5l_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="ftp_516"></a>十、配置本地用户验证访问ftp限制</h6> 
<p>vim /etc/vsftpd/vsftpd.conf</p> 
<p>local_enable=Yes<br> anonymous_enable=NO<br> write_enable=YES<br> local_umask=077</p> 
<p><img src="https://images2.imgbox.com/37/a7/EvTIDN4P_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="Windowscmd__527"></a>十一、在Windows系统打开开始菜单，输入cmd 命令打开命令提示符</h6> 
<p>ftp 192.168.52.2<br> zhangsan<br> 123<br> OK</p> 
<p><img src="https://images2.imgbox.com/01/1c/0XfO701X_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="__536"></a>十二、添加、切换目录的限制配置 ：</h6> 
<p>vim /etc/vsftpd/vsftpd.conf</p> 
<p>chroot_local_user=YES<br> allow_writeable_chroot=YES</p> 
<p><img src="https://images2.imgbox.com/1b/8f/Jm82aprl_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="ftp_546"></a>十三、重启ftp服务</h6> 
<p>systemctl restart vsftpd</p> 
<p><img src="https://images2.imgbox.com/1a/8d/dc8QTnfF_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="Windowscmd__552"></a>十四、在Windows系统打开开始菜单，输入cmd 命令打开命令提示符</h6> 
<p>ftp 192.168.52.2<br> zhangsan<br> 123<br> OK</p> 
<p>ftp&gt; cd /etc</p> 
<p>550 Failed to change directory.<br> <img src="https://images2.imgbox.com/ad/91/VJDe9YHb_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="_564"></a>十五、配置黑名单/白名单</h6> 
<h6><a id="_566"></a>黑名单</h6> 
<p>vim /etc/vsftpd/vsftpd.conf</p> 
<p>userlist_enable=YES<br> userlist_deny=YES</p> 
<p>ls</p> 
<p>vim user_list</p> 
<p>zhangsan</p> 
<p>systemctl restart vsftpd</p> 
<p><img src="https://images2.imgbox.com/98/2d/1WjYhQNC_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="_590"></a>测试</h6> 
<p>win10</p> 
<p>ftp 192.168.52.2<br> zhangsan</p> 
<p><img src="https://images2.imgbox.com/59/28/2Yhgv95C_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="_599"></a>白名单</h6> 
<p>vim /etc/vsftpd/vsftpd.conf</p> 
<p>userlist_enable=YES<br> userlist_deny=NO</p> 
<p>systemctl restart vsftpd</p> 
<p><img src="https://images2.imgbox.com/c9/3b/S0IFZ20d_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="_612"></a>测试</h6> 
<p>win10</p> 
<p>ftp 192.168.52.2<br> zhangsan</p> 
<p><img src="https://images2.imgbox.com/4c/72/wocOpwma_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="windows_620"></a>十六、windows输入文件同步：</h6> 
<p>ftp://lisi@192.168.52.2<br> lisi<br> 123</p> 
<p><img src="https://images2.imgbox.com/79/4c/j7W0w6Nq_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="_628"></a>十七、完成</h6>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8158817cfe273a1b9c120c01843c5cc9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【数据结构】二叉树（二）遍历</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7e185ee92af06df1c4cc0aad285cb1c8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">每日一题-贪心算法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>