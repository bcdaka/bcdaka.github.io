<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>LeetCode题练习与总结：第N高的薪水--177 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/f1dfd559b9f13960ed21689d7185af52/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="LeetCode题练习与总结：第N高的薪水--177">
  <meta property="og:description" content="一、题目描述 SQL Schema &gt; Pandas Schema &gt; 表: Employee
&#43;-------------&#43;------&#43; | Column Name | Type | &#43;-------------&#43;------&#43; | id | int | | salary | int | &#43;-------------&#43;------&#43; 在 SQL 中，id 是该表的主键。 该表的每一行都包含有关员工工资的信息。 查询 Employee 表中第 n 高的工资。如果没有第 n 个最高工资，查询结果应该为 null 。
查询结果格式如下所示。
示例 1:
输入: Employee table: &#43;----&#43;--------&#43; | id | salary | &#43;----&#43;--------&#43; | 1 | 100 | | 2 | 200 | | 3 | 300 | &#43;----&#43;--------&#43; n = 2 输出: &#43;------------------------&#43; | getNthHighestSalary(2) | &#43;------------------------&#43; | 200 | &#43;------------------------&#43; 示例 2:">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-31T23:16:52+08:00">
    <meta property="article:modified_time" content="2024-07-31T23:16:52+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">LeetCode题练习与总结：第N高的薪水--177</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4>一、题目描述</h4> 
<p>SQL Schema &gt; Pandas Schema &gt; </p> 
<p>表: <code>Employee</code></p> 
<pre>+-------------+------+
| Column Name | Type |
+-------------+------+
| id          | int  |
| salary      | int  |
+-------------+------+
在 SQL 中，id 是该表的主键。
该表的每一行都包含有关员工工资的信息。
</pre> 
<p></p> 
<p>查询 <code>Employee</code> 表中第 <code>n</code> 高的工资。如果没有第 <code>n</code> 个最高工资，查询结果应该为 <code>null</code> 。</p> 
<p>查询结果格式如下所示。</p> 
<p></p> 
<p><strong>示例 1:</strong></p> 
<pre><strong>输入:</strong> 
Employee table:
+----+--------+
| id | salary |
+----+--------+
| 1  | 100    |
| 2  | 200    |
| 3  | 300    |
+----+--------+
n = 2
<strong>输出:</strong> 
+------------------------+
| getNthHighestSalary(2) |
+------------------------+
| 200                    |
+------------------------+
</pre> 
<p><strong>示例 2:</strong></p> 
<pre><strong>输入:</strong> 
Employee 表:
+----+--------+
| id | salary |
+----+--------+
| 1  | 100    |
+----+--------+
n = 2
<strong>输出:</strong> 
+------------------------+
| getNthHighestSalary(2) |
+------------------------+
| null                   |
+------------------------+</pre> 
<h4>二、解题思路</h4> 
<p><strong>1. 声明变量</strong>：首先，我们声明一个名为 <code>nth_salary</code> 的变量，用于存储最终要返回的第 N 高工资的值。</p> 
<p><strong>2. 主查询</strong>：然后，我们执行一个主查询，从 <code>Employee</code> 表中选择 <code>salary</code> 列。这个查询的目标是找到第 N 高的工资。</p> 
<p><strong>3. 子查询</strong>：在主查询的 <code>WHERE</code> 子句中，我们嵌入了一个子查询。这个子查询的作用是计算每个工资值在 <code>Employee</code> 表中出现的排名。</p> 
<ul><li><strong>子查询内部逻辑</strong>： 
  <ul><li>从 <code>Employee</code> 表中选择 <code>salary</code> 列（别名为 <code>e2</code>）。</li><li>使用 <code>COUNT(DISTINCT e2.salary)</code> 计算有多少个不同的工资大于或等于当前考虑的工资（<code>e1.salary</code>）。</li><li>通过比较 <code>COUNT(DISTINCT e2.salary)</code> 的结果与 N，我们可以确定当前工资的排名。</li></ul></li></ul> 
<p><strong>4. 比较排名</strong>：在 <code>WHERE</code> 子句中，我们将子查询返回的排名数与 N 进行比较。如果排名数等于 N，则意味着我们找到了第 N 高的工资。</p> 
<p><strong>5. 赋值</strong>：当找到第 N 高的工资时，使用 <code>SELECT ... INTO nth_salary</code> 将其赋值给 <code>nth_salary</code> 变量。</p> 
<p><strong>6. 返回结果</strong>：最后，使用 <code>RETURN IFNULL(nth_salary, NULL)</code> 返回结果。<code>IFNULL</code> 函数确保如果 <code>nth_salary</code> 没有被赋值（即没有找到第 N 高的工资），则返回 <code>NULL</code>。</p> 
<p>这个函数的目的是返回 <code>Employee</code> 表中第 N 高的工资。如果没有第 N 高的工资，则返回 <code>NULL</code>。通过子查询计算每个工资的排名，并与 N 进行比较，我们能够确定第 N 高的工资。</p> 
<h4>三、具体代码</h4> 
<pre><code>CREATE FUNCTION getNthHighestSalary(N INT) RETURNS INT
BEGIN
  DECLARE nth_salary INT;
  
  SELECT salary INTO nth_salary
  FROM Employee e1
  WHERE (SELECT COUNT(DISTINCT e2.salary) FROM Employee e2 WHERE e2.salary &gt;= e1.salary) = N;
  
  RETURN IFNULL(nth_salary, NULL);
END
</code></pre> 
<h4>四、时间复杂度和空间复杂度</h4> 
<h5>1. 时间复杂度</h5> 
<p>时间复杂度通常取决于查询执行过程中数据库需要处理的数据量。以下是针对给定函数的时间复杂度分析：</p> 
<p><strong>(1)子查询</strong>：</p> 
<ul><li>子查询 <code>(SELECT COUNT(DISTINCT e2.salary) FROM Employee e2 WHERE e2.salary &gt;= e1.salary)</code> 对于每个 <code>e1.salary</code> 都会执行一次。</li><li>在最坏的情况下，子查询需要扫描整个 <code>Employee</code> 表来计算有多少个不同的工资大于或等于 <code>e1.salary</code>。</li><li>假设 <code>Employee</code> 表中有 <code>M</code> 行数据，那么子查询的时间复杂度是 <code>O(M)</code>。</li></ul> 
<p><strong>(2)主查询</strong>：</p> 
<ul><li>主查询需要遍历 <code>Employee</code> 表中的所有工资。</li><li>对于每个工资值，它都会执行一次子查询。</li><li>因此，如果 <code>Employee</code> 表中有 <code>M</code> 行数据，主查询的时间复杂度是 <code>O(M^2)</code>，因为它需要为每个工资执行一次 <code>O(M)</code> 的子查询。</li></ul> 
<p>综上所述，整个函数的时间复杂度是 <code>O(M^2)</code>。</p> 
<h5>2. 空间复杂度</h5> 
<p>空间复杂度主要取决于查询执行时使用的额外空间。以下是针对给定函数的空间复杂度分析：</p> 
<p><strong>(1)临时存储</strong>：</p> 
<ul><li>子查询在执行时可能会创建一个临时的内部表来存储不同工资的计数。</li><li>这个内部表的大小取决于不同工资值的数量，假设有 <code>D</code> 个不同的工资值，那么空间复杂度是 <code>O(D)</code>。</li></ul> 
<p><strong>(2)结果存储</strong>：</p> 
<ul><li><code>nth_salary</code> 变量只需要存储一个整数值，因此它的空间复杂度是 <code>O(1)</code>。</li></ul> 
<p>综合考虑，整个函数的空间复杂度是 <code>O(D)</code>，其中 <code>D</code> 是不同工资值的数量。</p> 
<p>需要注意的是，实际执行时，数据库优化器可能会应用一些优化策略来减少实际的查询时间，例如使用索引、物化视图或其他查询优化技术。因此，实际的时间复杂度可能会有所不同。</p> 
<h4>五、总结知识点</h4> 
<p><strong>1. SQL 函数定义</strong>：</p> 
<ul><li>使用 <code>CREATE FUNCTION</code> 语句来创建一个新的 SQL 函数。</li><li><code>RETURNS INT</code> 指定了函数返回的数据类型是整数。</li></ul> 
<p><strong>2. 变量声明</strong>：</p> 
<ul><li>使用 <code>DECLARE</code> 关键字声明一个局部变量 <code>nth_salary</code>。</li><li>声明的变量用于在函数内部存储和传递数据。</li></ul> 
<p><strong>3. 子查询</strong>：</p> 
<ul><li>在 <code>WHERE</code> 子句中使用子查询来计算满足特定条件的记录数。</li><li>子查询 <code>(SELECT COUNT(DISTINCT e2.salary) FROM Employee e2 WHERE e2.salary &gt;= e1.salary)</code> 计算有多少个不同的工资大于或等于当前工资。</li></ul> 
<p><strong>4. 表别名</strong>：使用别名 <code>e1</code> 和 <code>e2</code> 来引用同一个表 <code>Employee</code> 的不同实例，允许在同一个查询中对同一个表进行多次引用。</p> 
<p><strong>5. DISTINCT 关键字</strong>：<code>DISTINCT</code> 用于子查询中，确保计数时只考虑唯一的工资值。</p> 
<p><strong>6. NULL 处理</strong>：使用 <code>IFNULL</code> 函数来处理可能出现的 <code>NULL</code> 值，确保如果没有找到第 N 高的工资时，函数返回 <code>NULL</code>。</p> 
<p>以上就是解决这个问题的详细步骤，希望能够为各位提供启发和帮助。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/21eadf99ff106b104b8bdd9fdd969033/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">postman接口测试工具介绍与使用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a619ff796418ede1392a80f19ebabfc6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【C&#43;&#43;标准库】介绍及使用string类</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>