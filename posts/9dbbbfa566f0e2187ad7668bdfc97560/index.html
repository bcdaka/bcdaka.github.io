<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>前端使用插件预览pdf、docx、xlsx、pptx格式文件 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/9dbbbfa566f0e2187ad7668bdfc97560/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="前端使用插件预览pdf、docx、xlsx、pptx格式文件">
  <meta property="og:description" content="PDF预览 H5页面pdf预览 插件：pdfh5
版本：“pdfh5”: “^1.4.7”
npm install pdfh5
import PdfH5 from &#34;pdfh5&#34;; import &#34;pdfh5/css/pdfh5.css&#34;; // methods this.$nextTick(() =&gt; { this.pdfH5 = new PdfH5(&#34;#pdf&#34;, { pdfurl: this.pdfData.url, pageNum: false, backTop: false, }); this.pdfH5.on(&#34;ready&#34;, () =&gt; { this.pdfData.totalNum = this.pdfH5.totalNum - 0 this.pdfData.currentNum = this.pdfH5.currentNum - 0 }) this.pdfH5.on(&#34;scroll&#34;, (scrollTop, currentNum) =&gt; { this.pdfData.currentNum = currentNum - 1 === 0 ? 1 : currentNum - 1 }) this.pdfH5.on(&#39;success&#39;, () =&gt; { this.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-18T14:57:34+08:00">
    <meta property="article:modified_time" content="2024-01-18T14:57:34+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">前端使用插件预览pdf、docx、xlsx、pptx格式文件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4><a id="PDF_0"></a>PDF预览</h4> 
<h5><a id="H5pdf_2"></a>H5页面pdf预览</h5> 
<p>插件：<a href="https://www.npmjs.com/package/pdfh5" rel="nofollow">pdfh5</a><br> 版本：“pdfh5”: “^1.4.7”</p> 
<blockquote> 
 <p>npm install pdfh5</p> 
</blockquote> 
<pre><code class="prism language-js"><span class="token keyword">import</span> PdfH5 <span class="token keyword">from</span> <span class="token string">"pdfh5"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">"pdfh5/css/pdfh5.css"</span><span class="token punctuation">;</span>

<span class="token comment">// methods</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>pdfH5 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PdfH5</span><span class="token punctuation">(</span><span class="token string">"#pdf"</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">pdfurl</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pdfData<span class="token punctuation">.</span>url<span class="token punctuation">,</span>
    <span class="token literal-property property">pageNum</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token literal-property property">backTop</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span>pdfH5<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"ready"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>pdfData<span class="token punctuation">.</span>totalNum <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pdfH5<span class="token punctuation">.</span>totalNum <span class="token operator">-</span> <span class="token number">0</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>pdfData<span class="token punctuation">.</span>currentNum <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pdfH5<span class="token punctuation">.</span>currentNum <span class="token operator">-</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>pdfH5<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"scroll"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">scrollTop<span class="token punctuation">,</span> currentNum</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>pdfData<span class="token punctuation">.</span>currentNum <span class="token operator">=</span> currentNum <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> currentNum <span class="token operator">-</span> <span class="token number">1</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>pdfH5<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'success'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>inpDisabled <span class="token operator">=</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// html</span>
<span class="token operator">&lt;</span>view id<span class="token operator">=</span><span class="token string">"pdf"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
 <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"operation-box"</span><span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"operation"</span><span class="token operator">&gt;</span>
     <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"page-num-info"</span><span class="token operator">&gt;</span>
       <span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> pdfData<span class="token punctuation">.</span>currentNum <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
       <span class="token operator">/</span>
       <span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> pdfData<span class="token punctuation">.</span>totalNum <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
     <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
     <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"jump-box"</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"!tips"</span> @click<span class="token operator">=</span><span class="token string">"clickInp"</span><span class="token operator">&gt;</span>
       <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"inp-box"</span><span class="token operator">&gt;</span>
         跳转 <span class="token operator">&lt;</span>input style<span class="token operator">=</span><span class="token string">"width: 60px;text-align: center;color: black"</span> type<span class="token operator">=</span><span class="token string">"number"</span> @input<span class="token operator">=</span><span class="token string">"printfVal"</span> v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">"jumpNum"</span> <span class="token operator">/</span><span class="token operator">&gt;</span> 页
       <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
       <span class="token operator">&lt;</span>view @click<span class="token punctuation">.</span>stop<span class="token operator">=</span><span class="token string">"goToPage"</span><span class="token operator">&gt;</span>确定<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
     <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
     <span class="token operator">&lt;</span>view v<span class="token operator">-</span><span class="token keyword">else</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"tips"</span><span class="token operator">&gt;</span>尚未加载完成请等待<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
     <span class="token operator">&lt;</span>uni<span class="token operator">-</span>icons @click<span class="token operator">=</span><span class="token string">"goToTop"</span> type<span class="token operator">=</span><span class="token string">"home"</span> size<span class="token operator">=</span><span class="token string">"30"</span> color<span class="token operator">=</span><span class="token string">"#b0b2b2"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>uni<span class="token operator">-</span>icons<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
 <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
</code></pre> 
<h4><a id="docxdoc_53"></a>docx预览（不能预览doc格式文件）</h4> 
<p>插件：<a href="https://www.npmjs.com/package/docx-preview" rel="nofollow">docx-preview</a><br> 版本：“docx-preview”: “^0.1.20”</p> 
<blockquote> 
 <p>npm i docx-preview</p> 
</blockquote> 
<pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> DocxJs <span class="token keyword">from</span> <span class="token string">'docx-preview'</span>


<span class="token comment">// methods</span>
<span class="token keyword">const</span> f <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>fileUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> ab <span class="token operator">=</span> <span class="token keyword">await</span> f<span class="token punctuation">.</span><span class="token function">arrayBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">await</span> DocxJs<span class="token punctuation">.</span><span class="token function">renderAsync</span><span class="token punctuation">(</span>ab<span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'docxDom'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'docxDom'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">inWrapper</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 适配移动端</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// html</span>
<span class="token operator">&lt;</span>view id<span class="token operator">=</span><span class="token string">"docxDom"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
</code></pre> 
<h4><a id="xlsx_73"></a>xlsx预览</h4> 
<blockquote> 
 <p>npm i xlsx</p> 
</blockquote> 
<pre><code class="prism language-js"><span class="token keyword">const</span> f <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>fileUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> ab <span class="token operator">=</span> <span class="token keyword">await</span> f<span class="token punctuation">.</span><span class="token function">arrayBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> wb <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>ab<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> ws <span class="token operator">=</span> wb<span class="token punctuation">.</span>Sheets<span class="token punctuation">[</span>wb<span class="token punctuation">.</span>SheetNames<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>xlsxFileData<span class="token punctuation">.</span>tableData <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">sheet_to_json</span><span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">raw</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token literal-property property">rawNumbers</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>xlsxFileData<span class="token punctuation">.</span>labelList<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
      Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>xlsxFileData<span class="token punctuation">.</span>tableData<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>xlsxFileData<span class="token punctuation">.</span>labelList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// html</span>
<span class="token operator">&lt;</span>uni<span class="token operator">-</span>table border stripe emptyText<span class="token operator">=</span><span class="token string">"暂无更多数据"</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 表头行 <span class="token operator">--</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>uni<span class="token operator">-</span>tr<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>uni<span class="token operator">-</span>th align<span class="token operator">=</span><span class="token string">"center"</span> v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"item in xlsxFileData.labelList"</span><span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> item <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>uni<span class="token operator">-</span>th<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>uni<span class="token operator">-</span>tr<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 表格数据行 <span class="token operator">--</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>uni<span class="token operator">-</span>tr v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"item in xlsxFileData.tableData"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>uni<span class="token operator">-</span>td  v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"key in xlsxFileData.labelList"</span><span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> item<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>uni<span class="token operator">-</span>td<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>uni<span class="token operator">-</span>tr<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>uni<span class="token operator">-</span>table<span class="token operator">&gt;</span>

</code></pre> 
<h4><a id="pptx_101"></a>pptx预览</h4> 
<p>github: <a href="https://github.com/meshesha/PPTXjs">PPTXjs</a><br> gitee: <a href="https://gitee.com/huzouzou/PPTXjs" rel="nofollow">PPTXjs</a></p> 
<blockquote> 
 <p>拷贝文件到本地项目中在index.html引入</p> 
</blockquote> 
<p><strong>如果在index.html中引入没有加载，则动态引入</strong></p> 
<pre><code class="prism language-js"><span class="token comment">// app.vue</span>

<span class="token comment">// created || onLaunch</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addLink</span><span class="token punctuation">(</span><span class="token string">'/static/PPTXjs/css/pptxjs.css'</span><span class="token punctuation">)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addLink</span><span class="token punctuation">(</span><span class="token string">'/static/PPTXjs/css/nv.d3.min.css'</span><span class="token punctuation">)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addScript</span><span class="token punctuation">(</span><span class="token string">'/static/PPTXjs/js/jquery-1.11.3.min.js'</span><span class="token punctuation">)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addScript</span><span class="token punctuation">(</span><span class="token string">'/static/PPTXjs/js/jszip.min.js'</span><span class="token punctuation">)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addScript</span><span class="token punctuation">(</span><span class="token string">'/static/PPTXjs/js/filereader.js'</span><span class="token punctuation">)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addScript</span><span class="token punctuation">(</span><span class="token string">'/static/PPTXjs/js/d3.min.js'</span><span class="token punctuation">)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addScript</span><span class="token punctuation">(</span><span class="token string">'/static/PPTXjs/js/nv.d3.min.js'</span><span class="token punctuation">)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addScript</span><span class="token punctuation">(</span><span class="token string">'/static/PPTXjs/js/dingbat.js'</span><span class="token punctuation">)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addScript</span><span class="token punctuation">(</span><span class="token string">'/static/PPTXjs/js/pptxjs.js'</span><span class="token punctuation">)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addScript</span><span class="token punctuation">(</span><span class="token string">'/static/PPTXjs/js/divs2slides.js'</span><span class="token punctuation">)</span>

<span class="token comment">//methods</span>
<span class="token function">addScript</span> <span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">let</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  script<span class="token punctuation">.</span>src <span class="token operator">=</span> src<span class="token punctuation">;</span>
  script<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'text/javascript'</span><span class="token punctuation">;</span>
  <span class="token comment">// script.setAttribute('async', true);</span>
  <span class="token comment">// script.setAttribute('defer', true);</span>
  document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">addLink</span> <span class="token punctuation">(</span><span class="token parameter">href</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">let</span> link <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'link'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  link<span class="token punctuation">.</span>rel <span class="token operator">=</span> <span class="token string">"stylesheet"</span>
  link<span class="token punctuation">.</span>href <span class="token operator">=</span> href
  document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

</code></pre> 
<p><strong>引入拷贝的js文件以后</strong></p> 
<pre><code class="prism language-js"><span class="token comment">// methods</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
   <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#pptxDom"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pptxToHtml</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
     <span class="token literal-property property">pptxFileUrl</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>fileUrl<span class="token punctuation">,</span>
     <span class="token literal-property property">slidesScale</span><span class="token operator">:</span> <span class="token string">"100%"</span><span class="token punctuation">,</span>
     <span class="token literal-property property">slideMode</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
     <span class="token literal-property property">keyBoardShortCut</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
   <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 适配移动端！！</span>
   <span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
     <span class="token keyword">const</span> $slides <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".slides"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>$slides<span class="token punctuation">.</span><span class="token function">children</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
       <span class="token keyword">const</span> slidesWidth <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>
           <span class="token operator">...</span>Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>$slides<span class="token punctuation">.</span><span class="token function">children</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> s<span class="token punctuation">.</span>offsetWidth<span class="token punctuation">)</span>
       <span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">const</span> $wrapper <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#pptxDom"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">const</span> wrapperWidth <span class="token operator">=</span> window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">;</span>
       <span class="token keyword">const</span> wrapperHeight <span class="token operator">=</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">;</span>
       $wrapper<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
         <span class="token literal-property property">transform</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">scale(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>wrapperWidth <span class="token operator">/</span> slidesWidth<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
         <span class="token string-property property">"transform-origin"</span><span class="token operator">:</span> <span class="token string">"top left"</span><span class="token punctuation">,</span>
         <span class="token literal-property property">height</span><span class="token operator">:</span> wrapperHeight <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span>wrapperWidth <span class="token operator">/</span> slidesWidth<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"px"</span><span class="token punctuation">,</span>
       <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token function">clearInterval</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h2><a id="iframe_173"></a>使用iframe预览（缺点：在微信内置浏览器不显示或者跨域，需要使用插件。）</h2> 
<h3><a id="_174"></a>文档预览服务</h3> 
<p><a href="https://view.xdocin.com/" rel="nofollow">xdocin</a>需要付费，前几天免费体验<br> 日常格式都可以预览，比如xls、xlsx、doc、docx、pptx、pdf</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>`https://view.xdocin.com/view?src=${encodeURIComponent(fileUrl)}`<span class="token punctuation">"</span></span>  <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">min-width</span><span class="token punctuation">:</span> 100vw<span class="token punctuation">;</span><span class="token property">min-height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>微软免费预览<br> 日常格式除了不能预览pdf，其他类型都可以（文件大小不超过10M）</p> 
<pre><code class="prism language-html"><span class="token comment">&lt;!-- pdf格式文件可以直接赋值iframe的src预览，其余交给微软服务 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">allow</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>payment<span class="token punctuation">"</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fileUrl.includes('.pdf')<span class="token punctuation">"</span></span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fileUrl<span class="token punctuation">"</span></span>  <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">min-width</span><span class="token punctuation">:</span> 100vw<span class="token punctuation">;</span><span class="token property">min-height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">v-else</span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>`https://view.officeapps.live.com/op/view.aspx?src=${encodeURIComponent(fileUrl)}`<span class="token punctuation">"</span></span>  <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">min-width</span><span class="token punctuation">:</span> 100vw<span class="token punctuation">;</span><span class="token property">min-height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">&gt;</span></span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/dd63923beee1c75a664ef2cf392e7ba5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">SQL两表/多表关联查询--JOIN语句</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3c3bfd6db0259a72db334d1bff71dd33/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SQLyog 社区版安装，完全免费的</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>