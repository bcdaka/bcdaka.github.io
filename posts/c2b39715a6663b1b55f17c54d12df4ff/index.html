<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>机器学习课程设计，人工智能课程设计，深度学习课程设计--基于Transformer的家庭暴力情绪检测系统（欢迎私） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/c2b39715a6663b1b55f17c54d12df4ff/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="机器学习课程设计，人工智能课程设计，深度学习课程设计--基于Transformer的家庭暴力情绪检测系统（欢迎私）">
  <meta property="og:description" content="文章目录 摘要第一章 背景与意义1.1 背景1.1.1 家庭暴力发展现状1.1.2 家庭暴力的危害 1.2 意义与目的 第二章 关键技术与方法2.1 文本模态特征提取法2.2 视频模态特征提取法2.3 音频模态特征提取法2.4 注意力机制（Attention）2.5 多头注意力机制（Multi-Attention）2.6 Transformer 第三章 系统的设计与实现3.1 文本特征提取3.2 音频特征提取3.3 视频特征提取3.4 深度学习算法实现3.4.1 特征编码3.4.2 特征融合3.4.3 结果预测 3.5 深度学习算法训练3.6 深度学习算法性能测试3.7 系统测试 第四章 总结 以下链接包含本文相关资源： 。需要文件可发邮件到3307320866@qq.com
完整报告链接：https://download.csdn.net/download/m0_48932261/89432061
数据集下载链接：https://download.csdn.net/download/m0_48932261/89421590?spm=1001.2014.3001.5501
摘要 家庭暴力在现今社会屡见不鲜，成为威胁社会和谐与稳定的重要问题之一。家庭暴力不仅包括身体上的虐待，还涉及情感、心理和经济上的虐待，给受害者尤其是女性和儿童带来深远的负面影响。有效预防和处理家庭暴力事件，及时感知和理解伴侣的情感显得尤为重要。为了帮助社会稳定，提高居民生活幸福指数，本系统选取了CMU-MOSI、IEMOCAP数据集，利用Transformer、Adam优化器等多种深度学习算法，构建起情感检测系统。用户可以将信息输入到情感检测系统中，系统能够帮助识别检测对象的情感状态，提供预警，保护受害者的权益，并避免矛盾的进一步激化。本系统选取了MOSi、IEMOCAP数据集，并利用transformer技术构建了一个情绪检测系统。MOSi、IEMOCAP数据集是一个多模态情感分析数据集，包含视频、音频和文本三种模式的数据，非常适合用于情感分析和情绪检测研究。其多样性和丰富性，使其成为情感检测系统开发的理想选择。通过构建和应用情感检测系统，可以在家庭暴力问题发生前提供预警，减少暴力事件的发生频率和严重程度。该系统不仅有助于保护受害者的权益，改善家庭关系，还有助于构建一个更加和谐和安全的社会环境。利用MOSi、IEMOCAP数据集和transformer技术构建情感检测系统，是应对家庭暴力问题的一项重要创新和实践，能够在保护家庭暴力受害者、预防暴力事件方面发挥重要作用，推动社会和谐和进步。
第一章 背景与意义 1.1 背景 家庭暴力是一个普遍存在的社会问题，它不仅侵蚀着个体的尊严和权利，也对社会的道德和法律秩序构成挑战。深入了解家庭暴力的发展现状、认识其严重危害，并明确预防和干预项目的意义与目的，对于构建和谐社会至关重要。
1.1.1 家庭暴力发展现状 家庭暴力作为一种严重的社会问题，其发生率在全球范围内一直居高不下。尽管各国政府、国际组织和民间社会已经采取了包括立法、教育、公共宣传和支持服务在内的多种措施来应对和减少家庭暴力事件，但这一问题仍然普遍存在。家庭暴力的隐蔽性和复杂性，加之受文化、宗教和社会观念的影响，使得许多案例难以被及时发现和处理，从而成为一个难以根除的社会顽疾。
1.1.2 家庭暴力的危害 家庭暴力的危害性是广泛而深远的，它的影响不仅限于受害者个体，还会波及整个家庭系统，乃至更广泛的社会层面。受害者遭受的身体伤害往往是显而易见的，但家庭暴力所带来的心理创伤却可能是隐蔽而持久的。受害者可能会经历深刻的心理痛苦，包括羞耻、内疚、无助感和持续的恐惧，这些感受可能会长期影响他们的心理健康和社会功能。
1.2 意义与目的 本项目通过构建和应用情感检测系统，旨在成为预防家庭暴力的第一道防线。该系统利用MOSi、IEMOCAP数据集和前沿的Transformer技术，能够深入分析家庭成员的情感状态，及时捕捉到潜在的冲突信号。通过提前预警，我们不仅可以减少家庭暴力的发生频率，还能降低其严重程度，从而避免对受害者造成不可逆转的伤害。本项目的意义不仅在于技术层面的创新，更在于它对促进社会正义、保护人权、维护社会秩序的深远影响。通过这一系统，我们期望能够为每一个家庭带来和平与安宁，为社会带来和谐与进步。
第二章 关键技术与方法 2.1 文本模态特征提取法 BERT（Bidirectional Encoder Representations from Transformers）是由Google在2018年提出的一种预训练语言模型，它在自然语言处理（NLP）任务中取得了显著的成果。BERT的核心优势在于其双向训练机制，这使得模型在处理每个词汇时都能考虑到整个句子的上下文信息，从而更精准地理解语言的细微差别。
2.2 视频模态特征提取法 OpenFace 2.0 由卡内基梅隆大学开发的先进开源工具包，专门用于面部行为分析。OpenFace 2.0集成了一系列尖端功能，包括高精度面部标记点检测、实时头部姿态估计、面部动作单元识别，以及眼动估计。这些功能使得工具包在情感分析、用户身份验证和社交媒体行为分析等多个领域具有广泛的应用潜力。
2.3 音频模态特征提取法 Librosa是一个专为音乐和音频分析设计的Python库，它为音乐信息检索（MIR）领域提供了一套全面而强大的工具集。该库特别适合于音乐探索性数据分析，并且已经变得在音乐学、音频信号处理和机器学习等学科领域中不可或缺。Librosa的核心能力在于其对音频信号的处理和音乐特征的提取。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-30T09:29:56+08:00">
    <meta property="article:modified_time" content="2024-06-30T09:29:56+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">机器学习课程设计，人工智能课程设计，深度学习课程设计--基于Transformer的家庭暴力情绪检测系统（欢迎私）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_7" rel="nofollow">摘要</a></li><li><a href="#__9" rel="nofollow">第一章 背景与意义</a></li><li><ul><li><a href="#11__11" rel="nofollow">1.1 背景</a></li><li><ul><li><a href="#111__13" rel="nofollow">1.1.1 家庭暴力发展现状</a></li><li><a href="#112__15" rel="nofollow">1.1.2 家庭暴力的危害</a></li></ul> 
   </li><li><a href="#12__18" rel="nofollow">1.2 意义与目的</a></li></ul> 
  </li><li><a href="#__21" rel="nofollow">第二章 关键技术与方法</a></li><li><ul><li><a href="#21__22" rel="nofollow">2.1 文本模态特征提取法</a></li><li><a href="#22__24" rel="nofollow">2.2 视频模态特征提取法</a></li><li><a href="#23__26" rel="nofollow">2.3 音频模态特征提取法</a></li><li><a href="#24_Attention_28" rel="nofollow">2.4 注意力机制（Attention）</a></li><li><a href="#25_MultiAttention_38" rel="nofollow">2.5 多头注意力机制（Multi-Attention）</a></li><li><a href="#26_Transformer_46" rel="nofollow">2.6 Transformer</a></li></ul> 
  </li><li><a href="#__50" rel="nofollow">第三章 系统的设计与实现</a></li><li><ul><li><a href="#31__54" rel="nofollow">3.1 文本特征提取</a></li><li><a href="#32__75" rel="nofollow">3.2 音频特征提取</a></li><li><a href="#33__91" rel="nofollow">3.3 视频特征提取</a></li><li><a href="#34__114" rel="nofollow">3.4 深度学习算法实现</a></li><li><ul><li><a href="#341__116" rel="nofollow">3.4.1 特征编码</a></li><li><a href="#342__151" rel="nofollow">3.4.2 特征融合</a></li><li><a href="#343__180" rel="nofollow">3.4.3 结果预测</a></li></ul> 
   </li><li><a href="#35__221" rel="nofollow">3.5 深度学习算法训练</a></li><li><a href="#36__257" rel="nofollow">3.6 深度学习算法性能测试</a></li><li><a href="#37__288" rel="nofollow">3.7 系统测试</a></li></ul> 
  </li><li><a href="#__311" rel="nofollow">第四章 总结</a></li></ul> 
</div> 
<br> 
<code> 以下链接包含本文相关资源：</code> 
<p></p> 
<blockquote> 
 <p>。需要文件可发邮件到3307320866@qq.com</p> 
</blockquote> 
<p><strong>完整报告链接：<a href="https://download.csdn.net/download/m0_48932261/89432061">https://download.csdn.net/download/m0_48932261/89432061</a><br> 数据集下载链接：<a href="https://download.csdn.net/download/m0_48932261/89421590?spm=1001.2014.3001.5501">https://download.csdn.net/download/m0_48932261/89421590?spm=1001.2014.3001.5501</a></strong></p> 
<h2><a id="_7"></a>摘要</h2> 
<p>家庭暴力在现今社会屡见不鲜，成为威胁社会和谐与稳定的重要问题之一。家庭暴力不仅包括身体上的虐待，还涉及情感、心理和经济上的虐待，给受害者尤其是女性和儿童带来深远的负面影响。有效预防和处理家庭暴力事件，及时感知和理解伴侣的情感显得尤为重要。为了帮助社会稳定，提高居民生活幸福指数，本系统选取了CMU-MOSI、IEMOCAP数据集，利用Transformer、Adam优化器等多种深度学习算法，构建起情感检测系统。用户可以将信息输入到情感检测系统中，系统能够帮助识别检测对象的情感状态，提供预警，保护受害者的权益，并避免矛盾的进一步激化。本系统选取了MOSi、IEMOCAP数据集，并利用transformer技术构建了一个情绪检测系统。MOSi、IEMOCAP数据集是一个多模态情感分析数据集，包含视频、音频和文本三种模式的数据，非常适合用于情感分析和情绪检测研究。其多样性和丰富性，使其成为情感检测系统开发的理想选择。通过构建和应用情感检测系统，可以在家庭暴力问题发生前提供预警，减少暴力事件的发生频率和严重程度。该系统不仅有助于保护受害者的权益，改善家庭关系，还有助于构建一个更加和谐和安全的社会环境。利用MOSi、IEMOCAP数据集和transformer技术构建情感检测系统，是应对家庭暴力问题的一项重要创新和实践，能够在保护家庭暴力受害者、预防暴力事件方面发挥重要作用，推动社会和谐和进步。</p> 
<h2><a id="__9"></a>第一章 背景与意义</h2> 
<h3><a id="11__11"></a>1.1 背景</h3> 
<p>家庭暴力是一个普遍存在的社会问题，它不仅侵蚀着个体的尊严和权利，也对社会的道德和法律秩序构成挑战。深入了解家庭暴力的发展现状、认识其严重危害，并明确预防和干预项目的意义与目的，对于构建和谐社会至关重要。</p> 
<h4><a id="111__13"></a>1.1.1 家庭暴力发展现状</h4> 
<p>家庭暴力作为一种严重的社会问题，其发生率在全球范围内一直居高不下。尽管各国政府、国际组织和民间社会已经采取了包括立法、教育、公共宣传和支持服务在内的多种措施来应对和减少家庭暴力事件，但这一问题仍然普遍存在。家庭暴力的隐蔽性和复杂性，加之受文化、宗教和社会观念的影响，使得许多案例难以被及时发现和处理，从而成为一个难以根除的社会顽疾。</p> 
<h4><a id="112__15"></a>1.1.2 家庭暴力的危害</h4> 
<p>家庭暴力的危害性是广泛而深远的，它的影响不仅限于受害者个体，还会波及整个家庭系统，乃至更广泛的社会层面。受害者遭受的身体伤害往往是显而易见的，但家庭暴力所带来的心理创伤却可能是隐蔽而持久的。受害者可能会经历深刻的心理痛苦，包括羞耻、内疚、无助感和持续的恐惧，这些感受可能会长期影响他们的心理健康和社会功能。</p> 
<h3><a id="12__18"></a>1.2 意义与目的</h3> 
<p>本项目通过构建和应用情感检测系统，旨在成为预防家庭暴力的第一道防线。该系统利用MOSi、IEMOCAP数据集和前沿的Transformer技术，能够深入分析家庭成员的情感状态，及时捕捉到潜在的冲突信号。通过提前预警，我们不仅可以减少家庭暴力的发生频率，还能降低其严重程度，从而避免对受害者造成不可逆转的伤害。本项目的意义不仅在于技术层面的创新，更在于它对促进社会正义、保护人权、维护社会秩序的深远影响。通过这一系统，我们期望能够为每一个家庭带来和平与安宁，为社会带来和谐与进步。</p> 
<h2><a id="__21"></a>第二章 关键技术与方法</h2> 
<h3><a id="21__22"></a>2.1 文本模态特征提取法</h3> 
<p>BERT（Bidirectional Encoder Representations from Transformers）是由Google在2018年提出的一种预训练语言模型，它在自然语言处理（NLP）任务中取得了显著的成果。BERT的核心优势在于其双向训练机制，这使得模型在处理每个词汇时都能考虑到整个句子的上下文信息，从而更精准地理解语言的细微差别。</p> 
<h3><a id="22__24"></a>2.2 视频模态特征提取法</h3> 
<p>OpenFace 2.0 由卡内基梅隆大学开发的先进开源工具包，专门用于面部行为分析。OpenFace 2.0集成了一系列尖端功能，包括高精度面部标记点检测、实时头部姿态估计、面部动作单元识别，以及眼动估计。这些功能使得工具包在情感分析、用户身份验证和社交媒体行为分析等多个领域具有广泛的应用潜力。</p> 
<h3><a id="23__26"></a>2.3 音频模态特征提取法</h3> 
<p>Librosa是一个专为音乐和音频分析设计的Python库，它为音乐信息检索（MIR）领域提供了一套全面而强大的工具集。该库特别适合于音乐探索性数据分析，并且已经变得在音乐学、音频信号处理和机器学习等学科领域中不可或缺。Librosa的核心能力在于其对音频信号的处理和音乐特征的提取。</p> 
<h3><a id="24_Attention_28"></a>2.4 注意力机制（Attention）</h3> 
<p>注意力机制是深度学习中模拟人类选择性关注的一种技术，它允许模型在处理序列数据时，动态地聚焦于输入中最为相关的部分。这种机制首次在神经机器翻译中得到应用，并迅速成为自然语言处理及其他领域的核心技术。注意力机制的核心优势在于其选择性聚焦能力，它通过计算输入序列中每个元素与当前任务的相关性，生成一组权重，指导模型集中处理最重要的信息。<img src="https://images2.imgbox.com/34/7c/KFfBIQ7I_o.png" alt="在这里插得分描述"></p> 
<p>其中，Q、K、V代表模态输入，dk代表问题规模。具体的点积操作如下图结构图所示：<br> <img src="https://images2.imgbox.com/18/19/PPBFiwqA_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="25_MultiAttention_38"></a>2.5 多头注意力机制（Multi-Attention）</h3> 
<p>多头注意力机制是深度学习领域中一种创新且强大的技术，尤其在变换器（Transformer）模型架构中发挥着核心作用。这种机制的先进之处在于其能够并行地处理信息的多个子空间表示，从而在不同层面上捕捉输入数据的丰富特征。在自然语言处理（NLP）任务中，如机器翻译、文本摘要、情感分析等，多头注意力机制使模型能够同时集中于文本序列中的多个位置，关注不同词语的多个上下文维度。公式如下所示：<br> <img src="https://images2.imgbox.com/67/02/uCEVLiz9_o.png" alt="在这里插入图片描述"></p> 
<p>其中Concat代表拼接操作，W是可学习的权重，i表示第i个头（多层注意力机制中的第i层）。网络结构图如下图所示。<br> <img src="https://images2.imgbox.com/33/1a/4B9sVt8P_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="26_Transformer_46"></a>2.6 Transformer</h3> 
<p>Transformer是一种革命性的神经网络架构，它在自然语言处理（NLP）领域引发了一场变革。这种模型完全基于注意力机制，摒弃了传统的循环神经网络（RNN）结构，使得模型能够并行处理序列数据，极大地提高了训练效率。Transformer的网络结构如下图所示：<br> <img src="https://images2.imgbox.com/f2/1b/APZvXF7v_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="__50"></a>第三章 系统的设计与实现</h2> 
<p>在本次系统开发过程中，首先的关键步骤是获取源数据集。本文对数据集进行深入分析，并执行特征提取，以确保数据的完整性和一致性。数据处理阶段完成后，本文转向PyCharm集成开发环境，开始设计机器学习算法模型。通过利用处理后的数据集对模型进行系统训练，本文进一步通过一系列测试来评估不同模型的性能。经过细致的比较和验证，本文最终选定了表现最佳的模型，并将其应用于实际使用场景，以确保系统能够提供高效、准确的解决方案。</p> 
<h3><a id="31__54"></a>3.1 文本特征提取</h3> 
<p>采用预训练的bert模型对输入的文本进行特征提取，将特征变成向量表示。首先导入一些必要的三方库，BertTokenizer 和 BertModel 是使用 Hugging Face 的 transformers 库中的类，它们分别用于BERT模型的文本分词和模型加载。具体代码如下：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> csv
<span class="token keyword">import</span> torch
<span class="token keyword">from</span> transformers <span class="token keyword">import</span> BertTokenizer<span class="token punctuation">,</span> BertModel
<span class="token keyword">import</span> pickle
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

tokenizer <span class="token operator">=</span> BertTokenizer<span class="token punctuation">.</span>from_pretrained<span class="token punctuation">(</span><span class="token string">'../bert-base-uncased'</span><span class="token punctuation">)</span>
model <span class="token operator">=</span> BertModel<span class="token punctuation">.</span>from_pretrained<span class="token punctuation">(</span><span class="token string">'../bert-base-uncased'</span><span class="token punctuation">)</span>
</code></pre> 
<p>随后， 设计一个文本编码函数<code>TextEmbedding(tokenizer, model, text)</code>，它负责将输入文本转换为BERT模型的嵌入表示，这一过程对于后续的自然语言处理任务至关重要。代码实现如下：</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">TextEmbedding</span><span class="token punctuation">(</span>tokenizer<span class="token punctuation">,</span> model<span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">:</span>
    input_ids <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span>tokenizer<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>text<span class="token punctuation">,</span> add_special_tokens<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        last_hidden_states <span class="token operator">=</span> model<span class="token punctuation">(</span>input_ids<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  
    <span class="token keyword">return</span> last_hidden_states<span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="32__75"></a>3.2 音频特征提取</h3> 
<p>本文使用Librosa进行音频特征的提取，方法流程是遍历指定文件夹内的所有音频文件，从中提取有用的音频特征，并最终将这些特征保存到一个字典中，以便于后续的分析和处理。代码如下：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> librosa
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> os
<span class="token keyword">import</span> pickle

filepath <span class="token operator">=</span> <span class="token string">"./your/path"</span>
files <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>filepath<span class="token punctuation">)</span>
audio_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
a<span class="token operator">=</span> <span class="token number">0</span>
</code></pre> 
<p>之后，在循环中，对于每个文件，本文使用 librosa.load 函数加载音频数据并提取了以下音频特征：过零率（zero_crossing_rate），反映了信号在单位时间内过零的次数，是音频信号的一种基本特征。</p> 
<h3><a id="33__91"></a>3.3 视频特征提取</h3> 
<p>为了从视频文件中提取图像和音频特征，本文引入了<code>CatchPIC_Audio_FromVideo_camera(filepath,savepath)</code> 函数。具体代码实现如下：</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">CatchPIC_Audio_FromVideo_camera</span><span class="token punctuation">(</span>filepath<span class="token punctuation">,</span>savepath<span class="token punctuation">)</span><span class="token punctuation">:</span>
    files <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>filepath<span class="token punctuation">)</span>
    delete_files_in_folder<span class="token punctuation">(</span><span class="token string">'path\to\OpenFace_2.0.0_win_x64\processed'</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> files<span class="token punctuation">:</span>
        file_name<span class="token punctuation">,</span> file_extension <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>splitext<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>basename<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        os<span class="token punctuation">.</span>chdir<span class="token punctuation">(</span><span class="token string">'path\to\OpenFace_2.0.0_win_x64'</span><span class="token punctuation">)</span>
        cmd <span class="token operator">=</span> <span class="token string">'FeatureExtraction.exe -f "'</span> <span class="token operator">+</span> filepath <span class="token operator">+</span> <span class="token string">'\\'</span> <span class="token operator">+</span> <span class="token builtin">file</span>
        run_cmd<span class="token punctuation">(</span>cmd<span class="token punctuation">)</span>
        current_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>getcwd<span class="token punctuation">(</span><span class="token punctuation">)</span>
        parent_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>current_dir<span class="token punctuation">)</span>
        os<span class="token punctuation">.</span>chdir<span class="token punctuation">(</span>parent_dir<span class="token punctuation">)</span>
        current_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>getcwd<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>current_dir<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"视频获取成功"</span><span class="token punctuation">)</span>
        df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'path\to\OpenFace_2.0.0_win_x64\processed\\'</span> <span class="token operator">+</span> file_name <span class="token operator">+</span> <span class="token string">'.csv'</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>skiprows<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>nrows<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
</code></pre> 
<p>通过<code>CatchPIC_Audio_FromVideo_camera(filepath,savepath)</code> 函数，能够自动化地从视频文件中提取图像和音频特征，为进一步的分析和处理提供了便利。这一过程不仅提高了特征提取的效率，也保证了数据处理的一致性和准确性。</p> 
<h3><a id="34__114"></a>3.4 深度学习算法实现</h3> 
<p>深度学习算法的主要流程为特征编码、特征融合与结果预测。</p> 
<h4><a id="341__116"></a>3.4.1 特征编码</h4> 
<p>特征编码部分采用了深度学习中的多头注意力机制（Multihead Attention），以及随后的前馈网络（Feed-Forward Network），用于有效地处理视觉（visual）、音频（audio）和文本（text）三种不同类型的输入数据。代码如下所示：</p> 
<pre><code class="prism language-python"><span class="token keyword">with</span> tf<span class="token punctuation">.</span>variable_scope<span class="token punctuation">(</span><span class="token string">'vv'</span><span class="token punctuation">,</span> reuse<span class="token operator">=</span>tf<span class="token punctuation">.</span>AUTO_REUSE<span class="token punctuation">)</span><span class="token punctuation">:</span>
    enc_vv <span class="token operator">=</span> multihead_attention<span class="token punctuation">(</span>queries<span class="token operator">=</span>visual<span class="token punctuation">,</span>
                                 keys<span class="token operator">=</span>visual<span class="token punctuation">,</span>
                                 values<span class="token operator">=</span>visual<span class="token punctuation">,</span>
                                 num_heads<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>
                                 dropout_rate<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>
                                 training<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                                 causality<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    enc_vv <span class="token operator">=</span> ff<span class="token punctuation">(</span>enc_vv<span class="token punctuation">,</span> num_units<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>config<span class="token punctuation">.</span>att_dim<span class="token punctuation">,</span> self<span class="token punctuation">.</span>config<span class="token punctuation">.</span>att_dim<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">with</span> tf<span class="token punctuation">.</span>variable_scope<span class="token punctuation">(</span><span class="token string">'aa'</span><span class="token punctuation">,</span> reuse<span class="token operator">=</span>tf<span class="token punctuation">.</span>AUTO_REUSE<span class="token punctuation">)</span><span class="token punctuation">:</span>
    enc_aa <span class="token operator">=</span> multihead_attention<span class="token punctuation">(</span>queries<span class="token operator">=</span>audio<span class="token punctuation">,</span>
                                 keys<span class="token operator">=</span>audio<span class="token punctuation">,</span>
                                 values<span class="token operator">=</span>audio<span class="token punctuation">,</span>
                                 num_heads<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>
                                 dropout_rate<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>
                                 training<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                                 causality<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    enc_aa <span class="token operator">=</span> ff<span class="token punctuation">(</span>enc_aa<span class="token punctuation">,</span> num_units<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>config<span class="token punctuation">.</span>att_dim<span class="token punctuation">,</span> self<span class="token punctuation">.</span>config<span class="token punctuation">.</span>att_dim<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">with</span> tf<span class="token punctuation">.</span>variable_scope<span class="token punctuation">(</span><span class="token string">'tt'</span><span class="token punctuation">,</span> reuse<span class="token operator">=</span>tf<span class="token punctuation">.</span>AUTO_REUSE<span class="token punctuation">)</span><span class="token punctuation">:</span>
    enc_tt <span class="token operator">=</span> multihead_attention<span class="token punctuation">(</span>queries<span class="token operator">=</span>text<span class="token punctuation">,</span>
                                 keys<span class="token operator">=</span>text<span class="token punctuation">,</span>
                                 values<span class="token operator">=</span>text<span class="token punctuation">,</span>
                                 num_heads<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>
                                 dropout_rate<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>
                                 training<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                                 causality<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    enc_tt <span class="token operator">=</span> ff<span class="token punctuation">(</span>enc_tt<span class="token punctuation">,</span> num_units<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>config<span class="token punctuation">.</span>att_dim<span class="token punctuation">,</span> self<span class="token punctuation">.</span>config<span class="token punctuation">.</span>att_dim<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>通过这种特征编码方法，我们能够为不同类型的输入数据生成丰富且具有区分性的特征表示，这对于后续的模型训练和预测任务至关重要。这种编码方式不仅提高了模型对数据的理解能力，也为处理多模态数据提供了一种有效的技术手段。</p> 
<h4><a id="342__151"></a>3.4.2 特征融合</h4> 
<p>在本项目的深度学习模型中，特征融合和模态间交互影响是通过精心设计的多头注意力机制和前馈网络来实现的。代码实现如下：</p> 
<pre><code class="prism language-python"><span class="token keyword">with</span> tf<span class="token punctuation">.</span>variable_scope<span class="token punctuation">(</span><span class="token string">'enc_TinfuluenceV'</span><span class="token punctuation">,</span> reuse<span class="token operator">=</span>tf<span class="token punctuation">.</span>AUTO_REUSE<span class="token punctuation">)</span><span class="token punctuation">:</span>
    enc_TinfuluenceV <span class="token operator">=</span> multihead_attention<span class="token punctuation">(</span>queries<span class="token operator">=</span>enc_vv<span class="token punctuation">,</span>  <span class="token comment"># 32 * 300 * 300</span>
                                               keys<span class="token operator">=</span>enc_tt<span class="token punctuation">,</span>
                                               values<span class="token operator">=</span>enc_tt<span class="token punctuation">,</span>
                                               num_heads<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>
                                               dropout_rate<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>
                                               training<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                                               causality<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    enc_TinfuluenceV <span class="token operator">=</span> ff<span class="token punctuation">(</span>enc_TinfuluenceV<span class="token punctuation">,</span> num_units<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>att_dim<span class="token punctuation">,</span> self<span class="token punctuation">.</span>att_dim<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 32 * 300 * 300</span>
<span class="token keyword">with</span> tf<span class="token punctuation">.</span>variable_scope<span class="token punctuation">(</span><span class="token string">'enc_TinfuluenceA'</span><span class="token punctuation">,</span> reuse<span class="token operator">=</span>tf<span class="token punctuation">.</span>AUTO_REUSE<span class="token punctuation">)</span><span class="token punctuation">:</span>
    enc_TinfuluenceA <span class="token operator">=</span> multihead_attention<span class="token punctuation">(</span>queries<span class="token operator">=</span>enc_aa<span class="token punctuation">,</span>  <span class="token comment"># 32 * 300 * 300</span>
                                               keys<span class="token operator">=</span>enc_tt<span class="token punctuation">,</span>
                                               values<span class="token operator">=</span>enc_tt<span class="token punctuation">,</span>
                                               num_heads<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>
                                               dropout_rate<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>
                                               training<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                                               causality<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    enc_TinfuluenceA <span class="token operator">=</span> ff<span class="token punctuation">(</span>enc_TinfuluenceA<span class="token punctuation">,</span> num_units<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>att_dim<span class="token punctuation">,</span> self<span class="token punctuation">.</span>att_dim<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 32 * 300 * 300</span>

enc_vv_new <span class="token operator">=</span> tf<span class="token punctuation">.</span>convert_to_tensor<span class="token punctuation">(</span>enc_TinfuluenceV<span class="token punctuation">)</span>
enc_aa_new <span class="token operator">=</span> tf<span class="token punctuation">.</span>convert_to_tensor<span class="token punctuation">(</span>enc_TinfuluenceA<span class="token punctuation">)</span>
enc_vv_new <span class="token operator">=</span> tf<span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span>enc_vv_new<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
enc_aa_new <span class="token operator">=</span> tf<span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span>enc_aa_new<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
enc_tt_new <span class="token operator">=</span> enc_tt
</code></pre> 
<p>这种设计允许模型在不同模态之间进行信息的整合和融合，通过多头注意力机制和前馈网络的结合，提高了模型对多模态数据的表达能力。</p> 
<h4><a id="343__180"></a>3.4.3 结果预测</h4> 
<p>为了指导模型训练，本文引入了决策融合方式。在多模态特征的解码阶段，我们使用<code>SigmoidAtt</code>函数对不同模态的特征编码进行解码，生成对应的输出。这些输出随后通过密集连接层和线性变换，生成最终的预测结果<code>output_res_vv、output_res_aa和 output_res_tt</code>。<br> 代码实现如下：</p> 
<pre><code class="prism language-python">outputs_en_vv <span class="token operator">=</span> SigmoidAtt<span class="token punctuation">(</span>enc_vv_new<span class="token punctuation">,</span> Wr_wqv<span class="token punctuation">,</span> Wm_wqv<span class="token punctuation">,</span> Wu_wqv<span class="token punctuation">)</span>
outputs_en_aa <span class="token operator">=</span> SigmoidAtt<span class="token punctuation">(</span>enc_aa_new<span class="token punctuation">,</span> Wr_wqa<span class="token punctuation">,</span> Wm_wqa<span class="token punctuation">,</span> Wu_wqa<span class="token punctuation">)</span>
outputs_en_tt <span class="token operator">=</span> SigmoidAtt<span class="token punctuation">(</span>enc_tt<span class="token punctuation">,</span> Wr_wqt<span class="token punctuation">,</span> Wm_wqt<span class="token punctuation">,</span> Wu_wqt<span class="token punctuation">)</span>

ouput_label <span class="token operator">=</span> tf<span class="token punctuation">.</span>one_hot<span class="token punctuation">(</span>self<span class="token punctuation">.</span>label<span class="token punctuation">,</span> self<span class="token punctuation">.</span>config<span class="token punctuation">.</span>class_num<span class="token punctuation">)</span>

temp_new_vv <span class="token operator">=</span> outputs_en_vv
temp_new_vv <span class="token operator">=</span> tf<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>dense<span class="token punctuation">(</span>temp_new_vv<span class="token punctuation">,</span> self<span class="token punctuation">.</span>config<span class="token punctuation">.</span>att_dim<span class="token punctuation">,</span> use_bias<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
output_res_vv <span class="token operator">=</span> tf<span class="token punctuation">.</span>add<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>temp_new_vv<span class="token punctuation">,</span> W_l<span class="token punctuation">)</span><span class="token punctuation">,</span> b_l<span class="token punctuation">)</span>
temp_new_aa <span class="token operator">=</span> outputs_en_aa
temp_new_aa <span class="token operator">=</span> tf<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>dense<span class="token punctuation">(</span>temp_new_aa<span class="token punctuation">,</span> self<span class="token punctuation">.</span>config<span class="token punctuation">.</span>att_dim<span class="token punctuation">,</span> use_bias<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
output_res_aa <span class="token operator">=</span> tf<span class="token punctuation">.</span>add<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>temp_new_aa<span class="token punctuation">,</span> W_l<span class="token punctuation">)</span><span class="token punctuation">,</span> b_l<span class="token punctuation">)</span>

temp_new_tt <span class="token operator">=</span> outputs_en_tt
temp_new_tt <span class="token operator">=</span> tf<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>dense<span class="token punctuation">(</span>temp_new_tt<span class="token punctuation">,</span> self<span class="token punctuation">.</span>config<span class="token punctuation">.</span>att_dim<span class="token punctuation">,</span> use_bias<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
output_res_tt <span class="token operator">=</span> tf<span class="token punctuation">.</span>add<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>temp_new_tt<span class="token punctuation">,</span> W_l<span class="token punctuation">)</span><span class="token punctuation">,</span> b_l<span class="token punctuation">)</span>

<span class="token keyword">with</span> tf<span class="token punctuation">.</span>variable_scope<span class="token punctuation">(</span><span class="token string">'vatWei'</span><span class="token punctuation">,</span> reuse<span class="token operator">=</span>tf<span class="token punctuation">.</span>AUTO_REUSE<span class="token punctuation">)</span><span class="token punctuation">:</span>
    Wv <span class="token operator">=</span> tf<span class="token punctuation">.</span>get_variable<span class="token punctuation">(</span><span class="token string">'Wv'</span><span class="token punctuation">,</span> shape<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    Wa <span class="token operator">=</span> tf<span class="token punctuation">.</span>get_variable<span class="token punctuation">(</span><span class="token string">'Wa'</span><span class="token punctuation">,</span> shape<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    Wt <span class="token operator">=</span> tf<span class="token punctuation">.</span>get_variable<span class="token punctuation">(</span><span class="token string">'Wt'</span><span class="token punctuation">,</span> shape<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
output_res_vv <span class="token operator">=</span> tf<span class="token punctuation">.</span>multiply<span class="token punctuation">(</span>output_res_vv<span class="token punctuation">,</span> Wv<span class="token punctuation">)</span>
output_res_aa <span class="token operator">=</span> tf<span class="token punctuation">.</span>multiply<span class="token punctuation">(</span>output_res_aa<span class="token punctuation">,</span> Wa<span class="token punctuation">)</span>
output_res_tt <span class="token operator">=</span> tf<span class="token punctuation">.</span>multiply<span class="token punctuation">(</span>output_res_tt<span class="token punctuation">,</span> Wt<span class="token punctuation">)</span>
output_res <span class="token operator">=</span> tf<span class="token punctuation">.</span>add<span class="token punctuation">(</span>output_res_vv<span class="token punctuation">,</span> tf<span class="token punctuation">.</span>add<span class="token punctuation">(</span>output_res_aa<span class="token punctuation">,</span> output_res_tt<span class="token punctuation">)</span><span class="token punctuation">)</span>

self<span class="token punctuation">.</span>prob <span class="token operator">=</span> tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>softmax<span class="token punctuation">(</span>output_res<span class="token punctuation">)</span>

<span class="token keyword">with</span> tf<span class="token punctuation">.</span>name_scope<span class="token punctuation">(</span><span class="token string">'loss'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    loss <span class="token operator">=</span> tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>softmax_cross_entropy_with_logits<span class="token punctuation">(</span>logits<span class="token operator">=</span>output_res<span class="token punctuation">,</span> labels<span class="token operator">=</span>ouput_label<span class="token punctuation">)</span><span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>loss <span class="token operator">=</span> loss
    self<span class="token punctuation">.</span>l2_loss <span class="token operator">=</span> tf<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>apply_regularization<span class="token punctuation">(</span>regularizer<span class="token operator">=</span>tf<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>l2_regularizer<span class="token punctuation">(</span><span class="token number">0.0001</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                                          weights_list<span class="token operator">=</span><span class="token punctuation">[</span>W_l<span class="token punctuation">,</span> b_l<span class="token punctuation">]</span><span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>total_loss <span class="token operator">=</span> self<span class="token punctuation">.</span>loss <span class="token operator">+</span> self<span class="token punctuation">.</span>l2_loss
</code></pre> 
<p>通过这种设计，我们不仅能够训练模型以最小化预测误差，还能够通过正则化技术提高模型的泛化能力。这种综合的方法为多模态学习任务提供了一种有效的技术手段，有助于提高模型在复杂数据集上的性能。</p> 
<h3><a id="35__221"></a>3.5 深度学习算法训练</h3> 
<p>本文在训练深度学习模型的过程中，采用了一些核心的机器学习技术。首先，模型参数是通过Xavier初始化来设定的，这有助于在训练初期避免梯度消失或爆炸的问题。训练中使用的优化算法是Adam，它是一种非常流行的自适应学习率优化算法，能够根据参数的梯度自适应调整学习率。</p> 
<p>损失函数的设计也很关键，自定义了一个损失函数来指导模型的训练。在每个训练周期，模型通过前向传播计算输出和损失，然后反向传播算法根据损失来更新模型的权重。</p> 
<p>为了防止模型过拟合，本文还引入了L2正则化，这是一种常见的正则化技术，通过惩罚大的权重值来促使模型学习到更加简单的表示。此外，定期保存模型的检查点惯不仅有助于监控训练过程，还可以在模型出现意外时恢复到之前的状态。代码实现如下：</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">train</span><span class="token punctuation">(</span>sess<span class="token punctuation">,</span> setting<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> sess<span class="token punctuation">.</span>as_default<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        dataset <span class="token operator">=</span> Dataset<span class="token punctuation">(</span><span class="token punctuation">)</span>
        initializer <span class="token operator">=</span> tf<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>xavier_initializer<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">with</span> tf<span class="token punctuation">.</span>variable_scope<span class="token punctuation">(</span><span class="token string">'model'</span><span class="token punctuation">,</span> reuse<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> initializer<span class="token operator">=</span>initializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
            m <span class="token operator">=</span> MM<span class="token punctuation">(</span>is_training<span class="token operator">=</span>FLAGS<span class="token punctuation">.</span>train<span class="token punctuation">)</span>

        optimizer <span class="token operator">=</span> tf<span class="token punctuation">.</span>train<span class="token punctuation">.</span>AdamOptimizer<span class="token punctuation">(</span>setting<span class="token punctuation">.</span>learning_rate<span class="token punctuation">)</span>
        global_step <span class="token operator">=</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'global_step'</span><span class="token punctuation">,</span> trainable<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        train_op <span class="token operator">=</span> optimizer<span class="token punctuation">.</span>minimize<span class="token punctuation">(</span>m<span class="token punctuation">.</span>total_loss<span class="token punctuation">,</span> global_step<span class="token operator">=</span>global_step<span class="token punctuation">)</span>
        sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>initialize_all_variables<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        saver <span class="token operator">=</span> tf<span class="token punctuation">.</span>train<span class="token punctuation">.</span>Saver<span class="token punctuation">(</span>max_to_keep<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>

        <span class="token keyword">for</span> epoch <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>setting<span class="token punctuation">.</span>epoch_num<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>traindata<span class="token punctuation">[</span><span class="token string">'L'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> setting<span class="token punctuation">.</span>batch_size<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                cur_batch <span class="token operator">=</span> dataset<span class="token punctuation">.</span>nextBatch<span class="token punctuation">(</span>traindata<span class="token punctuation">,</span> testdata<span class="token punctuation">,</span> FLAGS<span class="token punctuation">.</span>train<span class="token punctuation">)</span>
                feed_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
                feed_dict<span class="token punctuation">[</span>m<span class="token punctuation">.</span>visual<span class="token punctuation">]</span> <span class="token operator">=</span> cur_batch<span class="token punctuation">[</span><span class="token string">'V'</span><span class="token punctuation">]</span>
                feed_dict<span class="token punctuation">[</span>m<span class="token punctuation">.</span>audio<span class="token punctuation">]</span> <span class="token operator">=</span> cur_batch<span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">]</span>
                feed_dict<span class="token punctuation">[</span>m<span class="token punctuation">.</span>text<span class="token punctuation">]</span> <span class="token operator">=</span> cur_batch<span class="token punctuation">[</span><span class="token string">'T'</span><span class="token punctuation">]</span>
                feed_dict<span class="token punctuation">[</span>m<span class="token punctuation">.</span>label<span class="token punctuation">]</span> <span class="token operator">=</span> cur_batch<span class="token punctuation">[</span><span class="token string">'L'</span><span class="token punctuation">]</span>

                temp<span class="token punctuation">,</span> step<span class="token punctuation">,</span> loss_ <span class="token operator">=</span> sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span>train_op<span class="token punctuation">,</span> global_step<span class="token punctuation">,</span> m<span class="token punctuation">.</span>total_loss<span class="token punctuation">]</span><span class="token punctuation">,</span> feed_dict<span class="token punctuation">)</span>
                <span class="token keyword">if</span> step <span class="token operator">&gt;=</span> <span class="token number">10</span> <span class="token keyword">and</span> step <span class="token operator">%</span> <span class="token number">10</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                    time_str <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span><span class="token punctuation">)</span>
                    tempstr <span class="token operator">=</span> <span class="token string">"{}: step {}, Loss {:g}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>time_str<span class="token punctuation">,</span> step<span class="token punctuation">,</span> loss_<span class="token punctuation">)</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span>tempstr<span class="token punctuation">)</span>
                    path <span class="token operator">=</span> saver<span class="token punctuation">.</span>save<span class="token punctuation">(</span>sess<span class="token punctuation">,</span> <span class="token string">'./model1/MT_ATT_model'</span><span class="token punctuation">,</span> global_step<span class="token operator">=</span>step<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="36__257"></a>3.6 深度学习算法性能测试</h3> 
<p>在本项目中，模型的评估和测试过程是通过一系列函数来实现的。evaluation 函数负责计算预测结果和真实标签的 F1 分数和准确率，这两个指标是衡量模型性能的关键。test 函数是测试过程中的核心，它首先加载数据集，然后定义了模型的 TensorFlow 变量作用域，并初始化了模型实例 mtest。随后加载之前训练过程中保存的最佳模型检查点。测试过程中，我们尝试恢复一系列定期保存的模型状态，并在每个模型状态上执行测试集的预测。<br> 代码实现如下：</p> 
<pre><code class="prism language-python">        <span class="token keyword">for</span> model_iter <span class="token keyword">in</span> testlist<span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>saver<span class="token punctuation">.</span>restore<span class="token punctuation">(</span>sess<span class="token punctuation">,</span> <span class="token string">'./model1/MT_ATT_model-'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>model_iter<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">except</span> Exception<span class="token punctuation">:</span><span class="token keyword">continue</span>
            total_pred <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            total_y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>testdata<span class="token punctuation">[</span><span class="token string">'L'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> setting<span class="token punctuation">.</span>batch_size<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                cur_batch <span class="token operator">=</span> dataset<span class="token punctuation">.</span>nextBatch<span class="token punctuation">(</span>traindata<span class="token punctuation">,</span> testdata<span class="token punctuation">,</span> FLAGS<span class="token punctuation">.</span>train<span class="token punctuation">)</span>
                feed_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
                feed_dict<span class="token punctuation">[</span>mtest<span class="token punctuation">.</span>visual<span class="token punctuation">]</span> <span class="token operator">=</span> cur_batch<span class="token punctuation">[</span><span class="token string">'V'</span><span class="token punctuation">]</span>
                feed_dict<span class="token punctuation">[</span>mtest<span class="token punctuation">.</span>audio<span class="token punctuation">]</span> <span class="token operator">=</span> cur_batch<span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">]</span>
                feed_dict<span class="token punctuation">[</span>mtest<span class="token punctuation">.</span>text<span class="token punctuation">]</span> <span class="token operator">=</span> cur_batch<span class="token punctuation">[</span><span class="token string">'T'</span><span class="token punctuation">]</span>
                feed_dict<span class="token punctuation">[</span>mtest<span class="token punctuation">.</span>label<span class="token punctuation">]</span> <span class="token operator">=</span> cur_batch<span class="token punctuation">[</span><span class="token string">'L'</span><span class="token punctuation">]</span>
                prob <span class="token operator">=</span> sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span>mtest<span class="token punctuation">.</span>prob<span class="token punctuation">]</span><span class="token punctuation">,</span> feed_dict<span class="token punctuation">)</span>
                <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>prob<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    total_pred<span class="token punctuation">.</span>append<span class="token punctuation">(</span>np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>prob<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">for</span> item <span class="token keyword">in</span> cur_batch<span class="token punctuation">[</span><span class="token string">'L'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                    total_y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>item<span class="token punctuation">)</span>
                    
            f1<span class="token punctuation">,</span> accuracy <span class="token operator">=</span> evaluation<span class="token punctuation">(</span>total_pred<span class="token punctuation">,</span> total_y<span class="token punctuation">)</span>
            all_acc<span class="token punctuation">.</span>append<span class="token punctuation">(</span>accuracy<span class="token punctuation">)</span>
            <span class="token keyword">if</span> accuracy <span class="token operator">&gt;</span> best_model_acc<span class="token punctuation">:</span>
                best_model_acc <span class="token operator">=</span> accuracy

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'最好的模型编号'</span><span class="token punctuation">,</span> best_model_iter<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'最好的准确率'</span><span class="token punctuation">,</span> best_model_acc<span class="token punctuation">)</span>
</code></pre> 
<p>通过这种系统化的测试方法，我们能够全面评估模型的泛化能力，并确保所选模型在实际应用中的有效性和可靠性。</p> 
<h3><a id="37__288"></a>3.7 系统测试</h3> 
<p>在本系统开发中，我们实现了一个简洁直观的用户交互流程。用户仅需输入数字 “1” 即可轻松启动检测过程。一旦用户做出选择，系统便立即在后台激活算法模型，开始一系列复杂的训练和运算任务。这包括对数据集的预处理、特征的提取，以及模型的参数优化。<br> <img src="https://images2.imgbox.com/09/5e/noltcybO_o.png" alt="在这里插入图片描述"><br> 随着模型运算的完成，系统将对所有用户进行测试，并生成详细的测试报告。这份报告不仅展示了模型预测的结果，还与实际的真实结果进行了对比，以便进行准确评估。系统将自动计算并展示模型的准确率，这一指标反映了模型预测的准确性和可靠性。</p> 
<p>在系统测试阶段，特别关注源数据集中的第一条数据。本文假设这是当前用户的有效数据，并将其作为模型初步测试和验证的基础。这种做法有助于快速评估模型对新数据的适应性和预测能力。其中数字与情感的对应关系如下：</p> 
<pre><code class="prism language-python">emo_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'0'</span><span class="token punctuation">:</span> <span class="token string">'快乐'</span><span class="token punctuation">,</span>
            <span class="token string">'1'</span><span class="token punctuation">:</span> <span class="token string">'生气'</span><span class="token punctuation">,</span>
            <span class="token string">'2'</span><span class="token punctuation">:</span> <span class="token string">'悲伤'</span><span class="token punctuation">,</span>
            <span class="token string">'3'</span><span class="token punctuation">:</span> <span class="token string">'中性'</span><span class="token punctuation">,</span>
            <span class="token string">'4'</span><span class="token punctuation">:</span> <span class="token string">'挫折'</span><span class="token punctuation">,</span>
            <span class="token string">'5'</span><span class="token punctuation">:</span> <span class="token string">'兴奋'</span><span class="token punctuation">,</span>
            <span class="token string">'6'</span><span class="token punctuation">:</span> <span class="token string">'惊讶'</span>
            <span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a9/37/chalgWYy_o.png" alt="在这里插入图片描述"><br> 整个过程的设计旨在确保用户能够轻松获取检测结果，同时对模型的性能有一个清晰的认识。这种透明度和即时反馈机制不仅增强了用户的信任感，也为系统开发者提供了宝贵的数据，以便进行持续的优化和改进。</p> 
<h2><a id="__311"></a>第四章 总结</h2> 
<p>在本项目中，开发了一个深度学习模型，专注于家庭暴力背景下的情感分析。这个系统通过先进的技术手段，能够提前识别情感变化，帮助预防潜在的家庭冲突。我们利用了BERT等预训练语言模型来提取文本特征，并结合了多头注意力机制和Transformer架构的优势，以提高模型对情感状态的识别能力。项目的核心是一个情感检测系统，它能够分析家庭成员之间的交流信息，识别出潜在的负面情绪和冲突信号。系统通过实时监控和分析家庭内部的沟通模式，能够在家庭暴力问题发生前提供预警，帮助预防和减少暴力事件的发生。在开发过程中，使用了CMU-MOSI等多模态情感分析数据集进行训练和测试，这使得模型能够从文本中提取情感相关的特征，并对可能的情感冲突进行评估。此外，系统的用户界面设计简洁直观，确保了易用性和可访问性。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b4ca26aaea3e13213e4fb808ce19eb0c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">前端 Vite 项目使用 vite-plugin-dts 打包输出.d.ts文件，分析处理踩坑：Cannot find module ‘vue‘. Did you mean to set ...</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/eab88a9e89dfcde5170c41feb5829c46/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Python基础之模块和包</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>