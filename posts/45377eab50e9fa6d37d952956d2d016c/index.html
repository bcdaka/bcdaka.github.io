<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>配置Hive元数据存储到MySQL - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/45377eab50e9fa6d37d952956d2d016c/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="配置Hive元数据存储到MySQL">
  <meta property="og:description" content="文章目录 配置Hive元数据存储到MySQL背景介绍配置步骤1) 在MySQL中新建 Hive 元数据库2) 将MySQL的JDBC驱动拷贝到Hive的lib目录下3) 更新guava包和hadoop一致4) 在$HIVE_HOME/conf目录下新建hive-site.xml文件5) 初始化Hive元数据库（修改为采用MySQL存储元数据）6) 验证是否成功配置 配置Hive元数据存储到MySQL 背景介绍 在安装完Hive之后，需要将Hive的元数据写入到MySQL的metastore数据库。
如果说MySQL中缺乏了关于Hive的相关配置，Hive是无法正常启动和运行的。
如果说MySQL进行重装，则需要对Hive服务进行重新的配置。
配置步骤 1) 在MySQL中新建 Hive 元数据库 #登录MySQL [atguigu@hadoop102 software]$ mysql -uroot -p123456 #创建Hive元数据库 mysql&gt; create database metastore; mysql&gt; quit; 2) 将MySQL的JDBC驱动拷贝到Hive的lib目录下 cp /opt/download/mysql-connector-j-8.0.33.jar lib/ 3) 更新guava包和hadoop一致 ls lib/|grep guava # guava-19.0.jar rm -f lib/guava-19.0.jar find /opt/software/hadoop313/ -name guava* #/opt/software/hadoop313/share/hadoop/common/lib/guava-27.0-jre.jar #/opt/software/hadoop313/share/hadoop/hdfs/lib/guava-27.0-jre.jar cp /opt/software/hadoop313/share/hadoop/hdfs/lib/guava-27.0-jre.jar lib/ 4) 在$HIVE_HOME/conf目录下新建hive-site.xml文件 [atguigu@hadoop102 software]$ vim $HIVE_HOME/conf/hive-site.xml 添加如下内容： &lt;?xml version=&#34;1.0&#34;?&gt; &lt;?xml-stylesheet type=&#34;text/xsl&#34; href=&#34;configuration.xsl&#34;?&gt; &lt;configuration&gt; &lt;!">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-20T14:06:12+08:00">
    <meta property="article:modified_time" content="2024-07-20T14:06:12+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">配置Hive元数据存储到MySQL</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/cf/81/03C4Tgji_o.gif" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/db/61/qOqEIiI2_o.png" alt="在这里插入图片描述"><br> </p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#HiveMySQL_3" rel="nofollow">配置Hive元数据存储到MySQL</a></li><li><ul><li><ul><li><a href="#_4" rel="nofollow">背景介绍</a></li><li><a href="#_9" rel="nofollow">配置步骤</a></li><li><ul><li><ul><li><a href="#1_MySQL_Hive__10" rel="nofollow">1) 在MySQL中新建 Hive 元数据库</a></li><li><a href="#2_MySQLJDBCHivelib_21" rel="nofollow">2) 将MySQL的JDBC驱动拷贝到Hive的lib目录下</a></li><li><a href="#3_guavahadoop_27" rel="nofollow">3) 更新guava包和hadoop一致</a></li><li><a href="#4_HIVE_HOMEconfhivesitexml_38" rel="nofollow">4) 在$HIVE_HOME/conf目录下新建hive-site.xml文件</a></li><li><a href="#5_HiveMySQL_78" rel="nofollow">5) 初始化Hive元数据库（修改为采用MySQL存储元数据）</a></li><li><a href="#6__84" rel="nofollow">6) 验证是否成功配置</a></li></ul> 
     </li></ul> 
    </li></ul> 
   </li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="HiveMySQL_3"></a>配置Hive元数据存储到MySQL</h3> 
<h5><a id="_4"></a>背景介绍</h5> 
<p>在安装完Hive之后，需要将Hive的元数据写入到MySQL的metastore数据库。<br> 如果说MySQL中缺乏了关于Hive的相关配置，Hive是无法正常启动和运行的。<br> 如果说MySQL进行重装，则需要对Hive服务进行重新的配置。</p> 
<h5><a id="_9"></a>配置步骤</h5> 
<h6><a id="1_MySQL_Hive__10"></a>1) 在MySQL中新建 Hive 元数据库</h6> 
<pre><code class="prism language-bash"><span class="token comment">#登录MySQL</span>
<span class="token punctuation">[</span>atguigu@hadoop102 software<span class="token punctuation">]</span>$ mysql <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p123456</span>

<span class="token comment">#创建Hive元数据库</span>
mysql<span class="token operator">&gt;</span> create database metastore<span class="token punctuation">;</span>
mysql<span class="token operator">&gt;</span> quit<span class="token punctuation">;</span>
</code></pre> 
<h6><a id="2_MySQLJDBCHivelib_21"></a>2) 将MySQL的JDBC驱动拷贝到Hive的lib目录下</h6> 
<pre><code class="prism language-bash"><span class="token function">cp</span> /opt/download/mysql-connector-j-8.0.33.jar lib/
</code></pre> 
<h6><a id="3_guavahadoop_27"></a>3) 更新guava包和hadoop一致</h6> 
<pre><code class="prism language-bash"><span class="token function">ls</span> lib/<span class="token operator">|</span><span class="token function">grep</span> guava
<span class="token comment"># guava-19.0.jar</span>
<span class="token function">rm</span> <span class="token parameter variable">-f</span> lib/guava-19.0.jar
<span class="token function">find</span> /opt/software/hadoop313/ <span class="token parameter variable">-name</span> guava*
<span class="token comment">#/opt/software/hadoop313/share/hadoop/common/lib/guava-27.0-jre.jar</span>
<span class="token comment">#/opt/software/hadoop313/share/hadoop/hdfs/lib/guava-27.0-jre.jar</span>
<span class="token function">cp</span> /opt/software/hadoop313/share/hadoop/hdfs/lib/guava-27.0-jre.jar lib/
</code></pre> 
<h6><a id="4_HIVE_HOMEconfhivesitexml_38"></a>4) 在$HIVE_HOME/conf目录下新建hive-site.xml文件</h6> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>atguigu@hadoop102 software<span class="token punctuation">]</span>$ <span class="token function">vim</span> <span class="token variable">$HIVE_HOME</span>/conf/hive-site.xml
添加如下内容：
<span class="token operator">&lt;</span>?xml <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token string">"1.0"</span>?<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>?xml-stylesheet <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">"text/xsl"</span> <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">"configuration.xsl"</span>?<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>configuration<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span>-- jdbc连接的URL --<span class="token operator">&gt;</span>
     <span class="token operator">&lt;</span>property<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>javax.jdo.option.ConnectionURL<span class="token operator">&lt;</span>/name<span class="token operator">&gt;</span>mysql
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>jdbc:mysql://localhost:3306/hive312?createDatabaseIfNotExist<span class="token operator">=</span>true<span class="token operator">&lt;</span>/value<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>/property<span class="token operator">&gt;</span>
    
    <span class="token operator">&lt;</span><span class="token operator">!</span>-- jdbc连接的Driver--<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>property<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>javax.jdo.option.ConnectionDriverName<span class="token operator">&lt;</span>/name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>com.mysql.cj.jdbc.Driver<span class="token operator">&lt;</span>/value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/property<span class="token operator">&gt;</span>
    
	<span class="token operator">&lt;</span><span class="token operator">!</span>-- jdbc连接的username--<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>property<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>javax.jdo.option.ConnectionUserName<span class="token operator">&lt;</span>/name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>root<span class="token operator">&lt;</span>/value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/property<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token operator">!</span>-- jdbc连接的password --<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>property<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>javax.jdo.option.ConnectionPassword<span class="token operator">&lt;</span>/name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token number">12345</span><span class="token operator"><span class="token file-descriptor important">6</span>&lt;</span>/value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/property<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token operator">!</span>-- Hive默认在HDFS的工作目录 --<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>property<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>hive.metastore.warehouse.dir<span class="token operator">&lt;</span>/name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span>/hive312/warehouse<span class="token operator">&lt;</span>/value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/property<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/configuration<span class="token operator">&gt;</span>
</code></pre> 
<h6><a id="5_HiveMySQL_78"></a>5) 初始化Hive元数据库（修改为采用MySQL存储元数据）</h6> 
<p>在初始化之前，需要先到MySQL数据库下查看数据库列表中是否存在<code>hive312</code>数据库，如果存在先删掉，否则会导致元数据库的创建过程失败。</p> 
<pre><code class="prism language-bash">schematool <span class="token parameter variable">-dbType</span> mysql <span class="token parameter variable">-initSchema</span> <span class="token parameter variable">-verbose</span>
</code></pre> 
<h6><a id="6__84"></a>6) 验证是否成功配置</h6> 
<pre><code class="prism language-bash"><span class="token comment">#首先启动元数据服务</span>
<span class="token function">nohup</span> hive <span class="token parameter variable">--service</span> metastore <span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>/dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span>

<span class="token comment">#1、方法一 hive客户端</span>
hive
<span class="token comment">#2、方法二 基于metastore和hiveserver2的beeline</span>
<span class="token comment">#启动hiveserver2服务</span>
<span class="token function">nohup</span> hive <span class="token parameter variable">--service</span> hiveserver2 <span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>/dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span>
beeline <span class="token parameter variable">-u</span> jdbc:hive2://single01:10000
</code></pre> 
<p><img src="https://images2.imgbox.com/ca/8c/KOXzbXI5_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5614fca15155bdb235c435025a6b1e0d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">《样式设计011：模组-瓷片区》</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0afd573a88b7edf00bc641b98d0c420e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">适配器模式</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>