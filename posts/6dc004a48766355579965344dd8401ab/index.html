<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>通过 Java 中 5 种流行的方法提取电子邮件 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/6dc004a48766355579965344dd8401ab/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="通过 Java 中 5 种流行的方法提取电子邮件">
  <meta property="og:description" content="在开发电子邮件处理应用程序时，建立一种从收件箱中提取消息的有效机制对于可靠、及时的传递和可访问性至关重要。处理不断增长的传入消息的组织和企业尤其赞赏它。在本文中，我们将探讨如何利用 Java 库的强大功能，通过 POP3、IMAP、EWS、Graph API 以及以 pst 文件为示例从各种格式的离线邮箱存储中检索电子邮件。这些方法为电子邮件检索提供了全面的解决方案，增强了 Java 应用程序的功能。
Aspose.Email 是用于轻松的开发 email 功能的应用程序的一组控件，基于 ASP.NET 的Web应用、Web服务和Windows 应用。支持 Outlook PST, EML, MSG, and MHT 格式. 允许开发者直接与 SMTP, POP, FTP, 和 MS Exchange 服务器进行工作。支持邮件合并、行事历、定制邮件标题和内容、嵌入文件等，Aspose API支持流行文件格式处理，并允许将各类文档导出或转换为固定布局文件格式和最常用的图像/多媒体格式。
Aspose.Email 最新下载https://www.evget.com/product/3081/download
用于提取消息的 Java API 要从 Java 中的服务器或邮箱存储中提取消息，我们将使用Aspose.Email for Java。Aspose.Email 是一个强大的库，使 Java 开发人员能够轻松地使用电子邮件、文件夹和邮件服务器。它支持多种电子邮件格式，包括 MSG、EML、PST 和 OST，使其成为电子邮件相关任务的多功能选择。如果您使用以下 Maven 配置下载或安装该 API，则可以轻松地将 API 实施到您的项目中。
存储库：
&lt;repository&gt; &lt;id&gt;AsposeJavaAPI&lt;/id&gt; &lt;name&gt;Aspose Java API&lt;/name&gt; &lt;url&gt;http://repository.aspose.com/repo/&lt;/url&gt; &lt;/repository&gt; 依赖关系：
&lt;dependency&gt; &lt;groupId&gt;com.aspose&lt;/groupId&gt; &lt;artifactId&gt;aspose-email&lt;/artifactId&gt; &lt;version&gt;23.11&lt;/version&gt; &lt;classifier&gt;jdk16&lt;/classifier&gt; &lt;/dependency&gt; 通过 POP3 检索电子邮件 POP3（邮局协议 3）是一种广泛使用的电子邮件检索协议。它允许您将电子邮件从邮件服务器下载到本地设备。借助 Aspose.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-02-26T15:48:40+08:00">
    <meta property="article:modified_time" content="2024-02-26T15:48:40+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">通过 Java 中 5 种流行的方法提取电子邮件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>在开发电子邮件处理应用程序时，建立一种从收件箱中提取消息的有效机制对于可靠、及时的传递和可访问性至关重要。处理不断增长的传入消息的组织和企业尤其赞赏它。在本文中，我们将探讨如何利用 Java 库的强大功能，通过 POP3、IMAP、EWS、Graph API 以及以 pst 文件为示例从各种格式的离线邮箱存储中检索电子邮件。这些方法为电子邮件检索提供了全面的解决方案，增强了 Java 应用程序的功能。</p> 
<p><strong><a href="https://www.evget.com/product/564" rel="nofollow" title="Aspose.Email ">Aspose.Email </a></strong>是用于轻松的开发 email 功能的应用程序的一组控件，基于  ASP.NET 的Web应用、Web服务和Windows 应用。支持 Outlook PST, EML, MSG, and MHT 格式. 允许开发者直接与 SMTP, POP, FTP, 和 MS Exchange 服务器进行工作。支持邮件合并、行事历、定制邮件标题和内容、嵌入文件等，<a href="https://www.evget.com/supplier/150" rel="nofollow" title="Aspose API">Aspose API</a>支持流行文件格式处理，并允许将各类文档导出或转换为固定布局文件格式和最常用的图像/多媒体格式。</p> 
<p><a class="has-card" href="https://www.evget.com/product/3081/download" rel="nofollow" title="Aspose.Email 最新下载"><span class="link-card-box"><span class="link-title">Aspose.Email 最新下载</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/dc/fe/WbIQAfmk_o.png" alt="icon-default.png?t=N7T8">https://www.evget.com/product/3081/download</span></span></a></p> 
<h6>用于提取消息的 Java API</h6> 
<p>要从 Java 中的服务器或邮箱存储中提取消息，我们将使用Aspose.Email for Java。Aspose.Email 是一个强大的库，使 Java 开发人员能够轻松地使用电子邮件、文件夹和邮件服务器。它支持多种电子邮件格式，包括 MSG、EML、PST 和 OST，使其成为电子邮件相关任务的多功能选择。如果您使用以下 Maven 配置下载或安装该 API，则可以轻松地将 API 实施到您的项目中。</p> 
<p><strong>存储库：</strong></p> 
<blockquote> 
 <pre>&lt;repository&gt;
&lt;id&gt;AsposeJavaAPI&lt;/id&gt;
&lt;name&gt;Aspose Java API&lt;/name&gt;
&lt;url&gt;http://repository.aspose.com/repo/&lt;/url&gt;
&lt;/repository&gt;</pre> 
</blockquote> 
<p><strong>依赖关系：</strong></p> 
<blockquote> 
 <pre>&lt;dependency&gt;
&lt;groupId&gt;com.aspose&lt;/groupId&gt;
&lt;artifactId&gt;aspose-email&lt;/artifactId&gt;
&lt;version&gt;23.11&lt;/version&gt;
&lt;classifier&gt;jdk16&lt;/classifier&gt;
&lt;/dependency&gt;
</pre> 
</blockquote> 
<h6><strong>通过 POP3 检索电子邮件</strong></h6> 
<p>POP3（邮局协议 3）是一种广泛使用的电子邮件检索协议。它允许您将电子邮件从邮件服务器下载到本地设备。借助 Aspose.Email，您可以使用以下代码片段和步骤轻松地通过 POP3 检索电子邮件：</p> 
<ol><li>使用Pop3Client类创建一个对象，传递必要的属性以建立与 POP3 服务器的连接。</li><li>通过将安全选项设置为SecurityOptions.Auto来启用适当安全协议的自动选择。</li><li>通过调用Pop3Client对象上的listMessages方法来检索邮箱中的邮件集合。</li><li>迭代 messageInfoCol 集合。</li><li>对于每个Pop3MessageInfo对象，调用Pop3Client对象上的fetchMessage方法，传递从messageInfo.getSequenceNumber()检索到的序列号。</li><li>在循环内，您可以使用 eml 变量中获取的消息，例如读取其内容或将其保存到文件中。</li></ol> 
<blockquote> 
 <pre>Pop3Client client = new Pop3Client("pop3.server.com", "username", "password");
client.setSecurityOptions(SecurityOptions.Auto);

try {
Pop3MessageInfoCollection messageInfoCol = pop3Client.listMessages();

for (Pop3MessageInfo messageInfo : messageInfoCol) {
MailMessage eml = client.fetchMessage(messageInfo.getSequenceNumber());
}
} catch (Exception ex) {
System.out.println(ex.getMessage());
} finally {
client.dispose();
}</pre> 
</blockquote> 
<h6><strong>从 MS Exchange Server 检索消息</strong></h6> 
<p>Exchange Web 服务 (EWS) 协议是 Microsoft 开发的强大且多功能的通信协议，用于访问和管理 Microsoft Exchange Server 和 Office 365 中的数据。Aspose.Email 提供了一系列功能来处理交换邮箱和消息，使开发人员能够构建与 Microsoft Exchange Server 和 Office 365 无缝集成并管理数据的应用程序和服务，使其成为现代业务通信和协作的宝贵工具。下面是通过简单的代码片段和步骤演示了我们的 API 与 EWS 协议的有效集成：</p> 
<ol><li>创建IEWSClient对象，调用EWSClient类上的 getEWSClient 方法并传递 Exchange 服务器的 EWS 终结点的 URL 以及用于身份验证的用户名和密码。</li><li>在客户端对象上调用getMailboxInfo()和getInboxUri()方法以获取收件箱文件夹的 URI。</li><li>调用客户端对象上的listMessages()方法，传递收件箱的 URI，以检索表示收件箱中邮件的ExchangeMessageInfo对象的集合。</li><li>迭代 messageInfoCol 集合。</li><li>对于每个ExchangeMessageInfo对象，调用getUniqueUri()方法来获取消息的唯一 URI。</li><li>调用客户端对象上的fetchMessage方法，传递 strMessageURI，以获取特定消息。</li><li>在循环内，您可以使用 eml 变量中获取的消息，例如读取其内容或将其保存到文件中。</li></ol> 
<blockquote> 
 <pre>IEWSClient client = EWSClient.getEWSClient("https://outlook.office365.com/ews/exchange.asmx", "UserName", "Password");
ExchangeMessageInfoCollection messageInfoCol = client.listMessages(client.getMailboxInfo().getInboxUri());

for (ExchangeMessageInfo msgInfo : (Iterable&lt;ExchangeMessageInfo&gt;) messageInfoCol) {
String strMessageURI = msgInfo.getUniqueUri();

MailMessage eml = client.fetchMessage(strMessageURI);
}</pre> 
</blockquote> 
<h6><strong>Microsoft Graph 从服务器提取消息</strong></h6> 
<p>Microsoft Graph API 是 Microsoft 提供的 REST API，用于访问各种 Microsoft 服务，包括 Outlook 和 Office 365。 Aspose.Email for Java 提供的<a href="https://reference.aspose.com/email/java/com.aspose.email/igraphclient/" rel="nofollow" title="IGraphClient">IGraphClient</a>类的实例处理构建请求，将其发送到 Microsoft Graph API，并处理响应。此集成提供了一组用于高效电子邮件处理的功能。下面的代码示例演示了以下步骤支持的消息检索功能：</p> 
<ol><li>创建 IGraphClient 对象，调用GraphClient类上的getClient方法并传递 tokenProvider 对象以使用 Microsoft Graph API 进行身份验证。</li><li>调用IGraphClient 对象上的listMessages方法，传递GraphKnownFolders.Inbox以检索表示收件箱中消息的GraphMessageInfo对象的集合。</li><li>迭代messageInfoColl集合。</li><li>对于每个GraphMessageInfo对象，调用IGraphClient 对象上的fetchMessage方法，并将getItemId方法作为参数传递以获取特定消息。</li><li>在循环内，您可以使用消息变量中获取的消息，例如读取其内容或使用MapiMessage类将其保存到文件中。</li></ol> 
<blockquote> 
 <pre>IGraphClient client = GraphClient.getClient(tokenProvider);
GraphMessageInfoCollection messageInfoColl = client.listMessages(GraphKnownFolders.Inbox);

for (GraphMessageInfo messageInfo : messageInfoColl) {
MapiMessage message = client.fetchMessage(messageInfo.getItemId());
}
</pre> 
</blockquote> 
<p><strong>从离线邮箱存储中提取邮件</strong></p> 
<p>离线邮箱存储是指在本地设备或计算机上存储电子邮件和相关数据，允许用户在没有有效互联网连接的情况下访问其电子邮件。我们的渐进式库允许您开发电子邮件客户端和应用程序，使用户即使在未连接到电子邮件服务器或互联网的情况下也能够处理电子邮件。以下代码片段及其步骤将向您展示如何利用该库的强大功能来打开 Outlook 个人存储 (PST) 文件、访问“收件箱”文件夹以及从中提取每封邮件。</p> 
<ol><li>创建一个 PersonalStorage 对象，调用PersonalStorage类的fromFile方法并传递 PST 文件的文件路径（“storage.pst”）。</li><li>通过 PersonalStorage 对象上的 getRootFolder 方法访问 PST 文件的根文件夹。</li><li>使用 getSubFolder 方法从根文件夹获取“Inbox”文件夹，并传递“Inbox”作为文件夹名称。</li><li>迭代收件箱文件夹中的邮件。</li><li>对于folder.enumerateMessages() 集合中的每个MessageInfo 对象，调用PersonalStorage 对象上的extractMessage 方法，传递messageInfo 参数以提取特定消息。</li><li>在循环内，您可以使用 msg 变量中提取的消息，例如使用 MapiMessage 类读取其内容或处理其元数据。</li></ol> 
<blockquote> 
 <pre>PersonalStorage pst = PersonalStorage.fromFile("storage.pst");
FolderInfo folder = pst.getRootFolder().getSubFolder("Inbox");

for (MessageInfo messageInfo : folder.enumerateMessages()) {

MapiMessage msg = pst.extractMessage(messageInfo);
}</pre> 
</blockquote> 
<h6><strong>结论</strong></h6> 
<p>在本文中，我们学习了如何利用Aspose.Email for Java的强大功能进行电子邮件检索。通过支持 POP3、IMAP、EWS、Graph API 和离线邮箱存储，该库使您能够自定义应用程序的功能以满足特定需求。无论您是开发客户端应用程序、集成工具还是自定义解决方案，我们的 Java API 都能为您提供创建无缝且高效的消息处理体验的工具。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a5886224687bdaeef51cdeefdee618ab/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">电子科技大学-数据库系统-期末汇总-完全体（概念&#43;图片&#43;习题&#43;代码）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a57d370247c223c3634c75f4d607e40b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">tongweb生成hprof文件并结合Memory Analyzer Mat分析内存溢出（by lqw）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>