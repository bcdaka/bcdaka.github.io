<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>消息队列之RabbitMQ的安装配置 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/1546de1162c954374a90bfaa48298506/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="消息队列之RabbitMQ的安装配置">
  <meta property="og:description" content="一，前言 RabbitMQ是由erlang语言开发，基于AMQP（Advanced Message Queue 高级消息队列协议）协议实现的消息队列，它是一种应用程序之间的通信方法，消息队列在分布式系统开发中应用非常广泛。点击跳转RabbitMQ官方地址
RabbitMQ提供了6种模式： 简单模式，work模式 ，Publish/Subscribe发布与订阅模式，Routing路由模式，Topics主题模式，RPC远程调用模式（远程调用，不太算MQ；暂不作介绍）
点击跳转官网对应模式介绍
2007年，Rabbit 技术公司基于 AMQP 标准开发的 RabbitMQ 1.0 发布。RabbitMQ 采用 Erlang 语言开发。Erlang 语言由 Ericson 设计，专门为开发高并发和分布式系统的一种语言，在电信领域使用广泛。
RabbitMQ 基础架构如下图： RabbitMQ 中的相关概念 Broker：接收和分发消息的应用，RabbitMQ Server就是 Message Broker
Virtual host:出于多租户和安全因素设计的，把 AMQP 的基本组件划分到一个虚拟的分组中，类似于网络中的 namespace 概念。当多个不同的用户使用同一个 RabbitMQ server 提供的服务时，可以划分出多个vhost，每个用户在自己的 vhost 创建exchange／queue 等。
Connection：publisher／consumer 和 broker 之间的 TCP 连接。
Channel：如果每一次访问 RabbitMQ 都建立一个 Connection，在消息量大的时候建立 TCP Connection的开销将是巨大的，效率也较低。Channel 是在 connection 内部建立的逻辑连接，如果应用程序支持多线程，通常每个thread创建单独的 channel 进行通讯，AMQP method 包含了channel id 帮助客户端和message broker 识别 channel，所以 channel 之间是完全隔离的。Channel 作为轻量级的 Connection 极大减少了操作系统建立 TCP connection 的开销。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-07T11:07:41+08:00">
    <meta property="article:modified_time" content="2024-04-07T11:07:41+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">消息队列之RabbitMQ的安装配置</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>一，前言</h2> 
<p>RabbitMQ是由erlang语言开发，基于AMQP（Advanced Message Queue 高级消息队列协议）协议实现的消息队列，它是一种应用程序之间的通信方法，消息队列在分布式系统开发中应用非常广泛。<a href="http://www.rabbitmq.com/" rel="nofollow">点击跳转RabbitMQ官方地址</a></p> 
<h3><a id="RabbitMQ6_3"></a>RabbitMQ提供了6种模式：</h3> 
<p>简单模式，work模式 ，Publish/Subscribe发布与订阅模式，Routing路由模式，Topics主题模式，RPC远程调用模式（远程调用，不太算MQ；暂不作介绍）<br> <a href="https://www.rabbitmq.com/getstarted.html" rel="nofollow">点击跳转官网对应模式介绍</a><br> <img src="https://images2.imgbox.com/d5/a3/HQmY2EZ9_o.png" alt="在这里插入图片描述"><br> 2007年，Rabbit 技术公司基于 AMQP 标准开发的 RabbitMQ 1.0 发布。RabbitMQ 采用 Erlang 语言开发。Erlang 语言由 Ericson 设计，专门为开发高并发和分布式系统的一种语言，在电信领域使用广泛。</p> 
<h3><a id="RabbitMQ__9"></a>RabbitMQ 基础架构如下图：</h3> 
<p><img src="https://images2.imgbox.com/91/bc/xiBzoLuN_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="RabbitMQ__11"></a>RabbitMQ 中的相关概念</h3> 
<p><code>Broker</code>：接收和分发消息的应用，RabbitMQ Server就是 Message Broker<br> <code>Virtual host</code>:出于多租户和安全因素设计的，把 AMQP 的基本组件划分到一个虚拟的分组中，类似于网络中的 namespace 概念。当多个不同的用户使用同一个 RabbitMQ server 提供的服务时，可以划分出多个vhost，每个用户在自己的 vhost 创建exchange／queue 等。<br> <code>Connection</code>：publisher／consumer 和 broker 之间的 TCP 连接。<br> <code>Channel</code>：如果每一次访问 RabbitMQ 都建立一个 Connection，在消息量大的时候建立 TCP Connection的开销将是巨大的，效率也较低。Channel 是在 connection 内部建立的逻辑连接，如果应用程序支持多线程，通常每个thread创建单独的 channel 进行通讯，AMQP method 包含了channel id 帮助客户端和message broker 识别 channel，所以 channel 之间是完全隔离的。Channel 作为轻量级的 Connection 极大减少了操作系统建立 TCP connection 的开销。<br> <code>Exchange</code>：message 到达 broker 的第一站，根据分发规则，匹配查询表中的 routing key，分发消息到queue 中去。常用的类型有：direct (point-to-point)，topic (publish-subscribe) and fanout (multicast)。<br> <code>Queue</code>：存储消息的容器，消息最终被送到这里，等待 consumer 取走。<br> <code>Binding</code>：exchange 和 queue 之间的虚拟连接，binding 中可以包含 routing key。Binding 信息被保存到 exchange 中的查询表中，用于 message 的分发依据。</p> 
<h3><a id="RabbitMQ_20"></a>二，下载安装和配置RabbitMQ</h3> 
<h4><a id="_21"></a>下载</h4> 
<ol><li><strong>下载Erlang的rpm包</strong><br> RabbitMQ是Erlang语言编写，所以Erlang环境必须要有，<code>注：Erlang环境一定要与RabbitMQ版本匹配</code>：<a href="https://www.rabbitmq.com/which-erlang.html" rel="nofollow">点击查看版本匹配关系</a></li><li><strong>下载socat的rpm包</strong><br> rabbitmq安装依赖于socat，所以需要下载socat。<br> 点击下载：<a href="http://repo.iotti.biz/CentOS/7/x86_64/socat-1.7.3.2-5.el7.lux.x86_64.rpm" rel="nofollow">socat下载地址</a></li><li><strong>下载RabbitMQ的rpm包</strong><br> RabbitMQ下载地址：<a href="https://www.rabbitmq.com/download.html" rel="nofollow">下载</a>（根据自身需求及匹配关系，下载对应rpm包）例如：rabbitmq-server-3.8.1-1.el7.noarch.rpm<br> 也可从github等网站下载。</li></ol> 
<h4><a id="_30"></a>安装配置</h4> 
<ol><li> <p><strong>安装Erlang、Socat、RabbitMQ</strong><br> ①<code>rpm -ivh erlang-21.3.8.9-1.el7.x86_64.rpm </code><br> ②<code>rpm -ivh socat-1.7.3.2-1.el6.lux.x86_64.rpm</code><br> 在安装rabbitmq之前需要先安装socat，否则，报错。<br> 可以采用yum安装方式：<code>yum install socat</code>，我们这里采用rpm安装方式<br> ③<code>rpm -ivh rabbitmq-server-3.8.1-1.el7.noarch.rpm </code></p> </li><li> <p><strong>启用管理插件</strong><br> /usr/lib/rabbitmq/bin/<br> <code>rabbitmq-plugins enable rabbitmq_management</code></p> </li><li> <p><strong>修改主机名</strong><br> （1）<code>vim /etc/hostname</code><br> <img src="https://images2.imgbox.com/81/6e/miqGObmh_o.png" alt="在这里插入图片描述"><br> （2）<code>vim /etc/hosts</code><br> <img src="https://images2.imgbox.com/95/7b/vaXoYMW3_o.png" alt="在这里插入图片描述"></p> </li><li> <p><strong>启动RabbitMQ</strong><br> 启动：<code>systemctl start rabbitmq-server.service</code><br> 查看状态<code>systemctl status rabbitmq-server.service</code><br> 重启：<code>systemctl restart rabbitmq-server.service</code><br> 关闭：<code>systemctl stop rabbitmq-server.service</code></p> </li><li> <p><strong>查看进程</strong><br> <code>ps -ef | grep rabbitmq</code></p> </li></ol> 
<h5><a id="_56"></a>测试</h5> 
<ul><li>关闭防火墙：<code>systemctl stop firewalld.service</code></li><li>在web浏览器中输入地址：<code>http://虚拟机ip:15672/</code></li><li>输入默认账号密码： <code>guest</code> ： <code>guest</code>，guest用户默认不允许远程连接。</li></ul> 
<p><strong>增加自定义账号</strong><br> l 添加管理员账号密码：<code>rabbitmqctl add_user admin admin</code><br> l 分配账号角色：<code>rabbitmqctl set_user_tags admin administrator</code><br> l 修改密码：<code>rabbitmqctl change_password admin 123456</code><br> l 查看用户列表：<code>rabbitmqctl list_users</code><br> 使用新账号登录，成功界面<br> <img src="https://images2.imgbox.com/d9/f6/kgA6UGhB_o.png" alt="在这里插入图片描述"></p> 
<p><strong>管理界面标签页介绍</strong><br> l overview：概览<br> l connections：无论生产者还是消费者，都需要与RabbitMQ建立连接后才可以完成消息的生产和消费，在这里可以查看连接情况<br> l channels：通道，建立连接后，会形成通道，消息的投递获取依赖通道。<br> l Exchanges：交换机，用来实现消息的路由<br> l Queues：队列，即消息队列，消息存放在队列中，等待消费，消费后被移除队列。<br> <strong>端口：</strong><br> l 5672：rabbitMq的编程语言客户端连接端口<br> l 15672：rabbitMq管理界面端口<br> l 25672：rabbitMq集群的端口</p> 
<h4><a id="_79"></a>卸载</h4> 
<p>l rpm -qa | grep rabbitmq<br> l rpm -e rabbitmq-server</p> 
<h3><a id="_82"></a>三，管理界面</h3> 
<ol><li><strong>添加用户</strong><br> 如果不使用guest，我们也可以自己创建一个用户：<br> <img src="https://images2.imgbox.com/2a/6c/uDI5eFXq_o.png" alt="在这里插入图片描述"></li></ol> 
<ul><li>超级管理员(administrator)<br> 可登录管理控制台，可查看所有的信息，并且可以对用户，策略(policy)进行操作。</li><li>监控者(monitoring)<br> 可登录管理控制台，同时可以查看rabbitmq节点的相关信息(进程数，内存使用情况，磁盘使用情况等)</li><li>策略制定者(policymaker)<br> 可登录管理控制台，同时可以对policy进行管理。但无法查看节点的相关信息。</li><li>普通管理者(management)<br> 仅可登录管理控制台，无法看到节点信息，也无法对策略进行管理。</li><li>其他<br> 无法登录管理控制台，通常就是普通的生产者和消费者。</li></ul> 
<ol start="2"><li> <p><strong>创建Virtual Hosts</strong><br> 虚拟主机：类似于mysql中的database。他们都是以“/”开头<br> <img src="https://images2.imgbox.com/a0/de/JNYVsaGl_o.png" alt="在这里插入图片描述"></p> </li><li> <p><strong>设置权限</strong></p> </li></ol> 
<p><img src="https://images2.imgbox.com/09/d1/tz3Yg4dM_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/33/0c/25sb8fbw_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d45cc6a9e6dc08442b36be1101ebe1b6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">从MySQL5.7平滑升级到MySQL8.0的最佳实践分享</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ce3f931b9d203a4d383d8931d6d25fb2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">iOS 审核 5月1日开始 Privacy manifest files 【隐私清单】</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>