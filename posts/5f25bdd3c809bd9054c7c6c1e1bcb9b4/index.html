<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>东方通TongWeb（外置容器）部署spring boot项目（jar包改war包） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/5f25bdd3c809bd9054c7c6c1e1bcb9b4/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="东方通TongWeb（外置容器）部署spring boot项目（jar包改war包）">
  <meta property="og:description" content="Tomcat信创平替之TongWEB(东方通)、springboot项目东方通TongWeb改造以及部署、东方通TongWeb7.0.4.9部署包安装下载 本文提供了两个示例：kotlin跟java
东方通TongWeb（外置容器）部署spring boot项目（war包）
东方通TongWeb（外置容器）部署kotlin项目（war包）
spring boot项目打包方式由jar包改成war包
kotlin项目打包方式由jar包改成war包
一：准备好应用war包：
1、carrier工程（后端，kotlin语法）打包方式由jar包改成war包（修改pom文件）
2、排查内置Tomcat
&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;!-- 去除内嵌tomcat --&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt; &lt;/dependency&gt; ①注释掉其它Tomcat相关依赖
①启动类继承 SpringBootServletInitializer 类，并重写 configure 方法
fun configure(application: SpringApplicationBuilder) { application.sources(CarrierApp::class.java) } ②然后 maven clean install 得到war包
3、前端打成war包
①首先 在项目目录下面npm run build:prod 打成dist包（这里前端打包的命令就是参考项目package.json的script命令）
②进入dist路径下面，在这里新建一个WEB-INF文件夹，然后在文件夹里面放入一个web.xml文件，用来解决tongweb部署404问题。如下
&lt;web-app&gt; &lt;error-page&gt; &lt;error-code&gt;404&lt;/error-code&gt; &lt;location&gt;/index.html&lt;/location&gt; &lt;/error-page&gt; &lt;/web-app&gt; ③进入dist包，然后在这个dist目录层级下输入cmd ，打开命令窗口后输入以下命令把前端dist包也打成一个war包，项目名称随便取。（这个war包打完会在dist文件夹里面）
jar -cvf 项目名称.war * 4、sunimp工程（三个应用中sunimp-app为例，java语法）：工程目录如下图
①修改pom文件:将打包方式更改为 war
②排查内置Tomcat
&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;!-- 去除内嵌tomcat --&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;org.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-25T15:21:19+08:00">
    <meta property="article:modified_time" content="2024-04-25T15:21:19+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">东方通TongWeb（外置容器）部署spring boot项目（jar包改war包）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 id="articleContentId">Tomcat信创平替之TongWEB(东方通)、springboot项目东方通TongWeb改造以及部署、东方通TongWeb7.0.4.9部署包安装下载</h2> 
<p>本文提供了两个示例：kotlin跟java</p> 
<p>东方通TongWeb（外置容器）部署spring boot项目（war包）</p> 
<p>东方通TongWeb（外置容器）部署kotlin项目（war包）</p> 
<p>spring boot项目打包方式由jar包改成war包</p> 
<p>kotlin项目打包方式由jar包改成war包</p> 
<p></p> 
<p>一：准备好应用war包：</p> 
<p>1、carrier工程（后端，kotlin语法）打包方式由jar包改成war包（修改pom文件）</p> 
<p><img alt="" height="952" src="https://images2.imgbox.com/dd/2c/aUTSLCop_o.png" width="1200"></p> 
<p>2、排查内置Tomcat</p> 
<pre><code class="language-XML">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;!-- 去除内嵌tomcat --&gt;
    &lt;exclusions&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;</code></pre> 
<p><img alt="" height="655" src="https://images2.imgbox.com/5c/94/ECa3j0XN_o.png" width="1200"></p> 
<p>①注释掉其它Tomcat相关依赖</p> 
<p><img alt="" height="738" src="https://images2.imgbox.com/57/e2/MjF2CGPM_o.png" width="1200"></p> 
<p>①启动类继承 SpringBootServletInitializer 类，并重写 configure 方法</p> 
<pre><code class="language-Kotlin">fun configure(application: SpringApplicationBuilder) {
    application.sources(CarrierApp::class.java)
}</code></pre> 
<p><img alt="" height="792" src="https://images2.imgbox.com/95/8f/TrPK0NzT_o.png" width="646"></p> 
<p><img alt="" height="186" src="https://images2.imgbox.com/e4/be/JOyQVEgY_o.png" width="608"></p> 
<p>②然后 maven clean install 得到war包</p> 
<p><img alt="" height="519" src="https://images2.imgbox.com/a3/b3/ExFrms3r_o.png" width="1023"></p> 
<p>3、前端打成war包</p> 
<p>①首先 在项目目录下面npm run build:prod 打成dist包（这里前端打包的命令就是参考项目package.json的script命令）</p> 
<p>②进入dist路径下面，在这里新建一个WEB-INF文件夹，然后在文件夹里面放入一个web.xml文件，用来解决tongweb部署404问题。如下</p> 
<pre><code class="language-html">&lt;web-app&gt;
    &lt;error-page&gt;
        &lt;error-code&gt;404&lt;/error-code&gt;
        &lt;location&gt;/index.html&lt;/location&gt;
    &lt;/error-page&gt;
&lt;/web-app&gt;</code></pre> 
<p>③进入dist包，然后在这个dist目录层级下输入cmd ，打开命令窗口后输入以下命令把前端dist包也打成一个war包，项目名称随便取。（这个war包打完会在dist文件夹里面）</p> 
<pre><code class="language-bash">jar -cvf 项目名称.war *</code></pre> 
<p>4、sunimp工程（三个应用中sunimp-app为例，java语法）：工程目录如下图</p> 
<p><img alt="" height="946" src="https://images2.imgbox.com/9f/5a/zU3edVMr_o.png" width="643"></p> 
<p>①修改pom文件:将打包方式更改为 war</p> 
<p><img alt="" height="1162" src="https://images2.imgbox.com/ea/d7/cDb3FGbj_o.png" width="1200"></p> 
<p>②排查内置Tomcat</p> 
<pre><code class="language-XML">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;!-- 去除内嵌tomcat --&gt;
    &lt;exclusions&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;</code></pre> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/ae/b8/5gOfSXPs_o.png" width="1200"></p> 
<p>③修改启动类：启动类继承 SpringBootServletInitializer 类，并重写 configure 方法</p> 
<pre><code class="language-java">@Override
    protected SpringApplicationBuilder configure(SpringApplicationBuilder builder) {
        return builder.sources(App.class);
    }
    public static void main(String[] args) {
        SpringApplication.run(App.class, args);
    }</code></pre> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/42/9f/6Uf60eTA_o.png" width="1200"></p> 
<p>maven install 得到war包</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/81/0e/957w7Dw8_o.png" width="1200"></p> 
<p><img alt="" height="659" src="https://images2.imgbox.com/59/bc/xRqj4RJg_o.png" width="1177"></p> 
<p>二、东方通TongWeb7.0.4.9部署包下载安装</p> 
<p>实际项目tongweb安装是需要收费的，需要证书，一般企业会提供。如果没有，可以根据证书修改linux系统的时间</p> 
<p>东方通的安装包及证书（根据证书修改linux系统的时间）</p> 
<p></p> 
<p>东方通的安装包链接：<a href="https://pan.baidu.com/s/1V6hB0t2GF6_eZlPQf-y5yQ?pwd=0ihg" rel="nofollow" title="百度网盘 请输入提取码">百度网盘 请输入提取码</a></p> 
<p>提取码：0ihg</p> 
<p>1、解压到相对目录,拷贝授权文件license.dat到目录</p> 
<p>sudo tar -zxvf TongWeb7.0.4.9_Enterprise_Linux.tar.gz</p> 
<p><img alt="" height="546" src="https://images2.imgbox.com/99/00/jTicJ9yM_o.png" width="549"></p> 
<p>2、配置TongWeb自启动</p> 
<pre><code class="language-bash">cd bin sh installservice.sh</code></pre> 
<p>3、启动Tongweb</p> 
<pre><code class="language-bash">sh startservernohup.sh</code></pre> 
<p><img alt="" height="166" src="https://images2.imgbox.com/87/9e/nHq8g4Bm_o.png" width="559"></p> 
<p>启动成功：</p> 
<p><img alt="" height="170" src="https://images2.imgbox.com/ee/06/qxfCVK4S_o.png" width="959"></p> 
<p>4、停止tongweb</p> 
<pre><code class="language-bash">cd bin
sh stopserver.sh quick 
或
sh forcestopserver.sh</code></pre> 
<p>5、访问TongWEB控制台</p> 
<p>链接：<a href="http://localhost:9060/console" rel="nofollow" title="http://localhost:9060/console">http://localhost:9060/console</a></p> 
<p>账号：thanos</p> 
<p>默认密码: thanos123.com</p> 
<p>三、tongweb配置虚拟主机及http通道</p> 
<p>3.1配置一台虚拟主机</p> 
<p>打开web容器配置里的虚拟主机管理，新增虚拟主机，主机名称没有限制可以用项目名称，主机别名可以设置成前后端所在的服务器ip，方便后面访问，通道列表可以先随便选一个，点击保存按钮添加主机完成。记得添加property属性，防止后面多次部署后会出现内存溢出的问题。</p> 
<p><img alt="" height="762" src="https://images2.imgbox.com/b7/84/jvTHqRVf_o.png" width="1200"></p> 
<pre><code class="language-bash">cacheMaxSize 5120000 
cachingAllowed true</code></pre> 
<p><img alt="" height="934" src="https://images2.imgbox.com/22/ec/AniWKEVo_o.png" width="1081"></p> 
<p>3.2 配置http通道</p> 
<p>配置一个http通道，这个通道就类似于nginx的代理配置 ，通道名字自己取，监听端口就是前后端公用的监听端口，虚拟主机就是刚才创建的，其他的一直下一步再点完成就可以了。</p> 
<p><img alt="" height="733" src="https://images2.imgbox.com/bc/e9/dsml3yXd_o.png" width="1200"></p> 
<p>要注意http禁用的请求方法：</p> 
<p><img alt="" height="612" src="https://images2.imgbox.com/23/39/82vszoWR_o.png" width="1200"></p> 
<p>四、部署前后端应用（war包）</p> 
<p>4.1单独部署前端</p> 
<p><img alt="" height="1133" src="https://images2.imgbox.com/8b/d3/wMnMdvbY_o.png" width="1200"></p> 
<p>4.2部署后端应用</p> 
<p>应用后缀与配置文件server.servlet.context-path=/sunimp 一致</p> 
<p><img alt="" height="472" src="https://images2.imgbox.com/1b/a4/LeE7lmQD_o.png" width="816"></p> 
<p><img alt="" height="1154" src="https://images2.imgbox.com/d0/9f/d2kDlADV_o.png" width="1200"></p> 
<p>一直下一步，或者直接完成。</p> 
<p>到这里就部署完成了！！</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/51971059887783b7e4daee57a0135cbd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">获取安卓apk证书SHA1等签名信息的方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1aff76424614a601387d2de0fb5a156c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">如何看待AIGC技术</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>