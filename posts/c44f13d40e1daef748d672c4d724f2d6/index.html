<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Java Excel转PDF，支持xlsx和xls两种格式， itextpdf【即取即用】 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/c44f13d40e1daef748d672c4d724f2d6/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Java Excel转PDF，支持xlsx和xls两种格式， itextpdf【即取即用】">
  <meta property="og:description" content="Java Excel转PDF itextpdf，即取即用 工具方法一、使用方式1、本地转换2、网络下载 二、pom依赖引入三、工具方法三、引文 本篇主要为工具方法整理，参考学习其他博主文章做了整理，方便使用。
工具方法 一、使用方式 1、本地转换 导入依赖创建工具方法传入输入输出流或文档地址即可。 2、网络下载 通过POI或者easyExcel生成或填充，再由后端转换PDF响应前端
思路：将网络下载拆分为本地转换，再响应前端即可。
现在服务器创建临时文件目录（临时目录可在每次下载请求开始先进行清空）；将生成的Excel写入本地临时文件；获取Excel文件输入流，获取响应的输出流（response.getOutputStream();）;调取公共方法传入输入输出流即可。 二、pom依赖引入 &lt;!-- pom相关依赖 --&gt; &lt;poi.version&gt;4.1.1&lt;/poi.version&gt; &lt;itextpdf.version&gt;5.5.13.2&lt;/itextpdf.version&gt; &lt;!-- POI Excel--&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.poi&lt;/groupId&gt; &lt;artifactId&gt;poi&lt;/artifactId&gt; &lt;version&gt;${poi.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- iText PDF --&gt; &lt;dependency&gt; &lt;groupId&gt;com.itextpdf&lt;/groupId&gt; &lt;artifactId&gt;itextpdf&lt;/artifactId&gt; &lt;version&gt;${itextpdf.version}&lt;/version&gt; &lt;/dependency&gt; 三、工具方法 package com.xxx.tool.util; import cn.hutool.core.collection.CollUtil; import com.itextpdf.text.*; import com.itextpdf.text.pdf.BaseFont; import com.itextpdf.text.pdf.PdfPCell; import com.itextpdf.text.pdf.PdfPTable; import com.itextpdf.text.pdf.PdfWriter; import lombok.experimental.UtilityClass; import org.apache.poi.hssf.usermodel.*; import org.apache.poi.ooxml.POIXMLDocumentPart; import org.apache.poi.ss.usermodel.Font; import org.apache.poi.ss.usermodel.*; import org.apache.poi.ss.util.CellRangeAddress; import org.apache.poi.xssf.usermodel.*; import java.io.IOException; import java.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-10-13T10:02:42+08:00">
    <meta property="article:modified_time" content="2023-10-13T10:02:42+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Java Excel转PDF，支持xlsx和xls两种格式， itextpdf【即取即用】</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>Java Excel转PDF itextpdf，即取即用</h4> 
 <ul><li><a href="#_4" rel="nofollow">工具方法</a></li><li><ul><li><a href="#_5" rel="nofollow">一、使用方式</a></li><li><ul><li><a href="#1_6" rel="nofollow">1、本地转换</a></li><li><a href="#2_10" rel="nofollow">2、网络下载</a></li></ul> 
   </li><li><a href="#pom_17" rel="nofollow">二、pom依赖引入</a></li><li><a href="#_36" rel="nofollow">三、工具方法</a></li><li><a href="#_586" rel="nofollow">三、引文</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<blockquote> 
 <p><strong>本篇主要为工具方法整理，参考学习其他博主文章做了整理，方便使用。</strong></p> 
</blockquote> 
<h2><a id="_4"></a>工具方法</h2> 
<h3><a id="_5"></a>一、使用方式</h3> 
<h4><a id="1_6"></a>1、本地转换</h4> 
<ul><li>导入依赖</li><li>创建工具方法</li><li>传入输入输出流或文档地址即可。</li></ul> 
<h4><a id="2_10"></a>2、网络下载</h4> 
<blockquote> 
 <p>通过POI或者easyExcel生成或填充，再由后端转换PDF响应前端<br> <strong>思路</strong>：将网络下载拆分为本地转换，再响应前端即可。</p> 
</blockquote> 
<ul><li>现在服务器创建临时文件目录（临时目录可在每次下载请求开始先进行清空）；</li><li>将生成的Excel写入本地临时文件；</li><li>获取Excel文件输入流，获取响应的输出流（response.getOutputStream();）;</li><li>调取公共方法传入输入输出流即可。</li></ul> 
<h3><a id="pom_17"></a>二、pom依赖引入</h3> 
<pre><code class="prism language-java">	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> pom相关依赖 <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>poi<span class="token punctuation">.</span>version<span class="token punctuation">&gt;</span></span><span class="token number">4.1</span><span class="token number">.1</span><span class="token operator">&lt;</span><span class="token operator">/</span>poi<span class="token punctuation">.</span>version<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>itextpdf<span class="token punctuation">.</span>version<span class="token punctuation">&gt;</span></span><span class="token number">5.5</span><span class="token number">.13</span><span class="token number">.2</span><span class="token operator">&lt;</span><span class="token operator">/</span>itextpdf<span class="token punctuation">.</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token constant">POI</span> <span class="token class-name">Excel</span><span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
        <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>poi<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span>$<span class="token punctuation">{<!-- --></span>poi<span class="token punctuation">.</span>version<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> iText <span class="token constant">PDF</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
        <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>com<span class="token punctuation">.</span>itextpdf<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>itextpdf<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span>$<span class="token punctuation">{<!-- --></span>itextpdf<span class="token punctuation">.</span>version<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="_36"></a>三、工具方法</h3> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>xxx<span class="token punctuation">.</span>tool<span class="token punctuation">.</span>util</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>core<span class="token punctuation">.</span>collection<span class="token punctuation">.</span></span><span class="token class-name">CollUtil</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>itextpdf<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>itextpdf<span class="token punctuation">.</span>text<span class="token punctuation">.</span>pdf<span class="token punctuation">.</span></span><span class="token class-name">BaseFont</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>itextpdf<span class="token punctuation">.</span>text<span class="token punctuation">.</span>pdf<span class="token punctuation">.</span></span><span class="token class-name">PdfPCell</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>itextpdf<span class="token punctuation">.</span>text<span class="token punctuation">.</span>pdf<span class="token punctuation">.</span></span><span class="token class-name">PdfPTable</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>itextpdf<span class="token punctuation">.</span>text<span class="token punctuation">.</span>pdf<span class="token punctuation">.</span></span><span class="token class-name">PdfWriter</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>experimental<span class="token punctuation">.</span></span><span class="token class-name">UtilityClass</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>hssf<span class="token punctuation">.</span>usermodel<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>ooxml<span class="token punctuation">.</span></span><span class="token class-name">POIXMLDocumentPart</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>ss<span class="token punctuation">.</span>usermodel<span class="token punctuation">.</span></span><span class="token class-name">Font</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>ss<span class="token punctuation">.</span>usermodel<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>ss<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">CellRangeAddress</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>xssf<span class="token punctuation">.</span>usermodel<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">OutputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>file<span class="token punctuation">.</span></span><span class="token class-name">Files</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>file<span class="token punctuation">.</span></span><span class="token class-name">Paths</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span><span class="token class-name">SimpleDateFormat</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Objects</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@UtilityClass</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExcelToPdfUtil</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">excelToPdf</span><span class="token punctuation">(</span><span class="token class-name">String</span> excelPath<span class="token punctuation">,</span> <span class="token class-name">String</span> pdfPath<span class="token punctuation">,</span> <span class="token class-name">String</span> excelSuffix<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">InputStream</span> in <span class="token operator">=</span> <span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">newInputStream</span><span class="token punctuation">(</span><span class="token class-name">Paths</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>excelPath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token class-name">OutputStream</span> out <span class="token operator">=</span> <span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">newOutputStream</span><span class="token punctuation">(</span><span class="token class-name">Paths</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>pdfPath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">ExcelToPdfUtil</span><span class="token punctuation">.</span><span class="token function">excelToPdf</span><span class="token punctuation">(</span>in<span class="token punctuation">,</span> out<span class="token punctuation">,</span> excelSuffix<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Excel转PDF并写入输出流
     *
     * @param inStream    Excel输入流
     * @param outStream   PDF输出流
     * @param excelSuffix Excel类型 .xls 和 .xlsx
     * @throws Exception 异常信息
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">excelToPdf</span><span class="token punctuation">(</span><span class="token class-name">InputStream</span> inStream<span class="token punctuation">,</span> <span class="token class-name">OutputStream</span> outStream<span class="token punctuation">,</span> <span class="token class-name">String</span> excelSuffix<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 输入流转workbook，获取sheet</span>
        <span class="token class-name">Sheet</span> sheet <span class="token operator">=</span> <span class="token function">getPoiSheetByFileStream</span><span class="token punctuation">(</span>inStream<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> excelSuffix<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 获取列宽度占比</span>
        <span class="token keyword">float</span><span class="token punctuation">[</span><span class="token punctuation">]</span> widths <span class="token operator">=</span> <span class="token function">getColWidth</span><span class="token punctuation">(</span>sheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PdfPTable</span> table <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PdfPTable</span><span class="token punctuation">(</span>widths<span class="token punctuation">)</span><span class="token punctuation">;</span>
        table<span class="token punctuation">.</span><span class="token function">setWidthPercentage</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> colCount <span class="token operator">=</span> widths<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token comment">//设置基本字体</span>
        <span class="token class-name">BaseFont</span> baseFont <span class="token operator">=</span> <span class="token class-name">BaseFont</span><span class="token punctuation">.</span><span class="token function">createFont</span><span class="token punctuation">(</span><span class="token string">"C:\\Windows\\Fonts\\simsun.ttc,0"</span><span class="token punctuation">,</span> <span class="token class-name">BaseFont</span><span class="token punctuation">.</span><span class="token constant">IDENTITY_H</span><span class="token punctuation">,</span> <span class="token class-name">BaseFont</span><span class="token punctuation">.</span><span class="token constant">EMBEDDED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 遍历行</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> rowIndex <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getFirstRowNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> rowIndex <span class="token operator">&lt;=</span> sheet<span class="token punctuation">.</span><span class="token function">getLastRowNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> rowIndex<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Row</span> row <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span>rowIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">isNull</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 插入空对象</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> colCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    table<span class="token punctuation">.</span><span class="token function">addCell</span><span class="token punctuation">(</span><span class="token function">createPdfPCell</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">13f</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 遍历单元格</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> columnIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">(</span>columnIndex <span class="token operator">&lt;</span> row<span class="token punctuation">.</span><span class="token function">getLastCellNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> columnIndex <span class="token operator">&lt;</span> colCount<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> columnIndex <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> columnIndex<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token class-name">PdfPCell</span> pCell <span class="token operator">=</span> <span class="token function">excelCellToPdfCell</span><span class="token punctuation">(</span>sheet<span class="token punctuation">,</span> row<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span>columnIndex<span class="token punctuation">)</span><span class="token punctuation">,</span> baseFont<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 是否合并单元格</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isMergedRegion</span><span class="token punctuation">(</span>sheet<span class="token punctuation">,</span> rowIndex<span class="token punctuation">,</span> columnIndex<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> span <span class="token operator">=</span> <span class="token function">getMergedSpan</span><span class="token punctuation">(</span>sheet<span class="token punctuation">,</span> rowIndex<span class="token punctuation">,</span> columnIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token comment">//忽略合并过的单元格</span>
                        <span class="token keyword">boolean</span> mergedCell <span class="token operator">=</span> span<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> span<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>mergedCell<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token keyword">continue</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        pCell<span class="token punctuation">.</span><span class="token function">setRowspan</span><span class="token punctuation">(</span>span<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        pCell<span class="token punctuation">.</span><span class="token function">setColspan</span><span class="token punctuation">(</span>span<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    table<span class="token punctuation">.</span><span class="token function">addCell</span><span class="token punctuation">(</span>pCell<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 初始化PDF文档对象</span>
        <span class="token function">createPdfTableAndWriteDocument</span><span class="token punctuation">(</span>outStream<span class="token punctuation">,</span> table<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 单元格转换，poi cell 转换为 itext cell
     *
     * @param sheet     poi sheet页
     * @param excelCell poi 单元格
     * @param baseFont  基础字体
     * @return com.itextpdf.text.pdf.PdfPCell
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">PdfPCell</span> <span class="token function">excelCellToPdfCell</span><span class="token punctuation">(</span><span class="token class-name">Sheet</span> sheet<span class="token punctuation">,</span> <span class="token class-name">Cell</span> excelCell<span class="token punctuation">,</span> <span class="token class-name">BaseFont</span> baseFont<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">isNull</span><span class="token punctuation">(</span>excelCell<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token function">createPdfPCell</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">13f</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">int</span> rowIndex <span class="token operator">=</span> excelCell<span class="token punctuation">.</span><span class="token function">getRowIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> columnIndex <span class="token operator">=</span> excelCell<span class="token punctuation">.</span><span class="token function">getColumnIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 图片信息</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PicturesInfo</span><span class="token punctuation">&gt;</span></span> infos <span class="token operator">=</span> <span class="token function">getAllPictureInfos</span><span class="token punctuation">(</span>sheet<span class="token punctuation">,</span> rowIndex<span class="token punctuation">,</span> rowIndex<span class="token punctuation">,</span> columnIndex<span class="token punctuation">,</span> columnIndex<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PdfPCell</span> pCell<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollUtil</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>infos<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            pCell <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PdfPCell</span><span class="token punctuation">(</span><span class="token class-name">Image</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>infos<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPictureData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Font</span> excelFont <span class="token operator">=</span> <span class="token function">getExcelFont</span><span class="token punctuation">(</span>sheet<span class="token punctuation">,</span> excelCell<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//设置单元格字体</span>
            <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>itextpdf<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span>Font</span> pdFont <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>itextpdf<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span>Font</span><span class="token punctuation">(</span>baseFont<span class="token punctuation">,</span> excelFont<span class="token punctuation">.</span><span class="token function">getFontHeightInPoints</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> excelFont<span class="token punctuation">.</span><span class="token function">getBold</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token class-name">BaseColor</span><span class="token punctuation">.</span><span class="token constant">BLACK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Integer</span> border <span class="token operator">=</span> <span class="token function">hasBorder</span><span class="token punctuation">(</span>excelCell<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> excelCellValue <span class="token operator">=</span> <span class="token function">getExcelCellValue</span><span class="token punctuation">(</span>excelCell<span class="token punctuation">)</span><span class="token punctuation">;</span>
            pCell <span class="token operator">=</span> <span class="token function">createPdfPCell</span><span class="token punctuation">(</span>excelCellValue<span class="token punctuation">,</span> border<span class="token punctuation">,</span> excelCell<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHeightInPoints</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pdFont<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 水平居中</span>
        pCell<span class="token punctuation">.</span><span class="token function">setHorizontalAlignment</span><span class="token punctuation">(</span><span class="token function">getHorAlign</span><span class="token punctuation">(</span>excelCell<span class="token punctuation">.</span><span class="token function">getCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAlignment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 垂直对齐</span>
        pCell<span class="token punctuation">.</span><span class="token function">setVerticalAlignment</span><span class="token punctuation">(</span><span class="token function">getVerAlign</span><span class="token punctuation">(</span>excelCell<span class="token punctuation">.</span><span class="token function">getCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getVerticalAlignment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> pCell<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 创建pdf文档，并添加表格
     *
     * @param outStream 输出流，目标文档
     * @param table     表格
     * @throws DocumentException 异常信息
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">createPdfTableAndWriteDocument</span><span class="token punctuation">(</span><span class="token class-name">OutputStream</span> outStream<span class="token punctuation">,</span> <span class="token class-name">PdfPTable</span> table<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">DocumentException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//设置pdf纸张大小 PageSize.A4 A4横向</span>
        <span class="token class-name">Document</span> document <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Document</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RectangleReadOnly</span><span class="token punctuation">(</span><span class="token number">842.0F</span><span class="token punctuation">,</span> <span class="token number">595.0F</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PdfWriter</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>document<span class="token punctuation">,</span> outStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//设置页边距 宽</span>
        document<span class="token punctuation">.</span><span class="token function">setMargins</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        document<span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>table<span class="token punctuation">)</span><span class="token punctuation">;</span>
        document<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Excel文档输入流转换为对应的workbook及获取对应的sheet
     *
     * @param inputStream Excel文档输入流
     * @param sheetNo     sheet编号，默认0 第一个sheet
     * @param excelSuffix 文件类型 .xls和.xlsx
     * @return poi sheet
     * @throws IOException 异常
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Sheet</span> <span class="token function">getPoiSheetByFileStream</span><span class="token punctuation">(</span><span class="token class-name">InputStream</span> inputStream<span class="token punctuation">,</span> <span class="token keyword">int</span> sheetNo<span class="token punctuation">,</span> <span class="token class-name">String</span> excelSuffix<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Workbook</span> workbook<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>excelSuffix<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">".xlsx"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XSSFWorkbook</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HSSFWorkbook</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> workbook<span class="token punctuation">.</span><span class="token function">getSheetAt</span><span class="token punctuation">(</span>sheetNo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 创建itext pdf 单元格
     *
     * @param content       单元格内容
     * @param border        边框
     * @param minimumHeight 高度
     * @param pdFont        字体
     * @return pdf cell
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">PdfPCell</span> <span class="token function">createPdfPCell</span><span class="token punctuation">(</span><span class="token class-name">String</span> content<span class="token punctuation">,</span> <span class="token class-name">Integer</span> border<span class="token punctuation">,</span> <span class="token class-name">Float</span> minimumHeight<span class="token punctuation">,</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>itextpdf<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span>Font</span> pdFont<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span> contentValue <span class="token operator">=</span> content <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token string">""</span> <span class="token operator">:</span> content<span class="token punctuation">;</span>
        <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>itextpdf<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span>Font</span> pdFontNew <span class="token operator">=</span> pdFont <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>itextpdf<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span>Font</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> pdFont<span class="token punctuation">;</span>
        <span class="token class-name">PdfPCell</span> pCell <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PdfPCell</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Phrase</span><span class="token punctuation">(</span>contentValue<span class="token punctuation">,</span> pdFontNew<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">nonNull</span><span class="token punctuation">(</span>border<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            pCell<span class="token punctuation">.</span><span class="token function">setBorder</span><span class="token punctuation">(</span>border<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">nonNull</span><span class="token punctuation">(</span>minimumHeight<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            pCell<span class="token punctuation">.</span><span class="token function">setMinimumHeight</span><span class="token punctuation">(</span>minimumHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> pCell<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * excel垂直对齐方式映射到pdf对齐方式
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getVerAlign</span><span class="token punctuation">(</span><span class="token keyword">int</span> align<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>align<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
                <span class="token keyword">return</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>itextpdf<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span>Element</span><span class="token punctuation">.</span><span class="token constant">ALIGN_BOTTOM</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>
                <span class="token keyword">return</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>itextpdf<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span>Element</span><span class="token punctuation">.</span><span class="token constant">ALIGN_TOP</span><span class="token punctuation">;</span>
            <span class="token keyword">default</span><span class="token operator">:</span>
                <span class="token keyword">return</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>itextpdf<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span>Element</span><span class="token punctuation">.</span><span class="token constant">ALIGN_MIDDLE</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * excel水平对齐方式映射到pdf水平对齐方式
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getHorAlign</span><span class="token punctuation">(</span><span class="token keyword">int</span> align<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>align<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
                <span class="token keyword">return</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>itextpdf<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span>Element</span><span class="token punctuation">.</span><span class="token constant">ALIGN_LEFT</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>
                <span class="token keyword">return</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>itextpdf<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span>Element</span><span class="token punctuation">.</span><span class="token constant">ALIGN_RIGHT</span><span class="token punctuation">;</span>
            <span class="token keyword">default</span><span class="token operator">:</span>
                <span class="token keyword">return</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>itextpdf<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span>Element</span><span class="token punctuation">.</span><span class="token constant">ALIGN_CENTER</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/*============================================== POI获取图片及文本内容工具方法 ==============================================*/</span>

    <span class="token comment">/**
     * 获取字体
     *
     * @param sheet excel 转换的sheet页
     * @param cell  单元格
     * @return 字体
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Font</span> <span class="token function">getExcelFont</span><span class="token punctuation">(</span><span class="token class-name">Sheet</span> sheet<span class="token punctuation">,</span> <span class="token class-name">Cell</span> cell<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// xls</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>sheet <span class="token keyword">instanceof</span> <span class="token class-name">HSSFSheet</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Workbook</span> workbook <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getWorkbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">HSSFCell</span><span class="token punctuation">)</span> cell<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFont</span><span class="token punctuation">(</span>workbook<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// xlsx</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">XSSFCell</span><span class="token punctuation">)</span> cell<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFont</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 判断excel单元格是否有边框
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">hasBorder</span><span class="token punctuation">(</span><span class="token class-name">Cell</span> excelCell<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">short</span> top <span class="token operator">=</span> excelCell<span class="token punctuation">.</span><span class="token function">getCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBorderTop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">short</span> bottom <span class="token operator">=</span> excelCell<span class="token punctuation">.</span><span class="token function">getCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBorderBottom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">short</span> left <span class="token operator">=</span> excelCell<span class="token punctuation">.</span><span class="token function">getCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBorderLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">short</span> right <span class="token operator">=</span> excelCell<span class="token punctuation">.</span><span class="token function">getCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBorderRight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> top <span class="token operator">+</span> bottom <span class="token operator">+</span> left <span class="token operator">+</span> right <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 判断单元格是否是合并单元格
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">isMergedRegion</span><span class="token punctuation">(</span><span class="token class-name">Sheet</span> sheet<span class="token punctuation">,</span> <span class="token keyword">int</span> row<span class="token punctuation">,</span> <span class="token keyword">int</span> column<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> sheetMergeCount <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getNumMergedRegions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> sheetMergeCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">CellRangeAddress</span> range <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getMergedRegion</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> firstColumn <span class="token operator">=</span> range<span class="token punctuation">.</span><span class="token function">getFirstColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> lastColumn <span class="token operator">=</span> range<span class="token punctuation">.</span><span class="token function">getLastColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> firstRow <span class="token operator">=</span> range<span class="token punctuation">.</span><span class="token function">getFirstRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> lastRow <span class="token operator">=</span> range<span class="token punctuation">.</span><span class="token function">getLastRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>row <span class="token operator">&gt;=</span> firstRow <span class="token operator">&amp;&amp;</span> row <span class="token operator">&lt;=</span> lastRow<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>column <span class="token operator">&gt;=</span> firstColumn <span class="token operator">&amp;&amp;</span> column <span class="token operator">&lt;=</span> lastColumn<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 计算合并单元格合并的跨行跨列数
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getMergedSpan</span><span class="token punctuation">(</span><span class="token class-name">Sheet</span> sheet<span class="token punctuation">,</span> <span class="token keyword">int</span> row<span class="token punctuation">,</span> <span class="token keyword">int</span> column<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> sheetMergeCount <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getNumMergedRegions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> span <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> sheetMergeCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">CellRangeAddress</span> range <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getMergedRegion</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> firstColumn <span class="token operator">=</span> range<span class="token punctuation">.</span><span class="token function">getFirstColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> lastColumn <span class="token operator">=</span> range<span class="token punctuation">.</span><span class="token function">getLastColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> firstRow <span class="token operator">=</span> range<span class="token punctuation">.</span><span class="token function">getFirstRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> lastRow <span class="token operator">=</span> range<span class="token punctuation">.</span><span class="token function">getLastRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>firstColumn <span class="token operator">==</span> column <span class="token operator">&amp;&amp;</span> firstRow <span class="token operator">==</span> row<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                span<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> lastRow <span class="token operator">-</span> firstRow <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
                span<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> lastColumn <span class="token operator">-</span> firstColumn <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> span<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 获取excel中每列宽度的占比
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">float</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getColWidth</span><span class="token punctuation">(</span><span class="token class-name">Sheet</span> sheet<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> rowNum <span class="token operator">=</span> <span class="token function">getMaxColRowNum</span><span class="token punctuation">(</span>sheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Row</span> row <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span>rowNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> cellCount <span class="token operator">=</span> row<span class="token punctuation">.</span><span class="token function">getPhysicalNumberOfCells</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> colWidths <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>cellCount<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> row<span class="token punctuation">.</span><span class="token function">getFirstCellNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> cellCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Cell</span> cell <span class="token operator">=</span> row<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>cell <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                colWidths<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getColumnWidth</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                sum <span class="token operator">+=</span> sheet<span class="token punctuation">.</span><span class="token function">getColumnWidth</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">float</span><span class="token punctuation">[</span><span class="token punctuation">]</span> colWidthPer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">float</span><span class="token punctuation">[</span>cellCount<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> row<span class="token punctuation">.</span><span class="token function">getFirstCellNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> cellCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            colWidthPer<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span> colWidths<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> sum <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> colWidthPer<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 获取excel中列数最多的行号
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getMaxColRowNum</span><span class="token punctuation">(</span><span class="token class-name">Sheet</span> sheet<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> rowNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> maxCol <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> r <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getFirstRowNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> r <span class="token operator">&lt;</span> sheet<span class="token punctuation">.</span><span class="token function">getPhysicalNumberOfRows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> r<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Row</span> row <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>row <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> maxCol <span class="token operator">&lt;</span> row<span class="token punctuation">.</span><span class="token function">getPhysicalNumberOfCells</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                maxCol <span class="token operator">=</span> row<span class="token punctuation">.</span><span class="token function">getPhysicalNumberOfCells</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                rowNum <span class="token operator">=</span> r<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> rowNum<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * poi 根据单元格类型获取单元格内容
     *
     * @param excelCell poi单元格
     * @return 单元格内容文本
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">getExcelCellValue</span><span class="token punctuation">(</span><span class="token class-name">Cell</span> excelCell<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>excelCell <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 判断数据的类型</span>
        <span class="token class-name">CellType</span> cellType <span class="token operator">=</span> excelCell<span class="token punctuation">.</span><span class="token function">getCellType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>cellType <span class="token operator">==</span> <span class="token class-name">CellType</span><span class="token punctuation">.</span><span class="token constant">STRING</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> excelCell<span class="token punctuation">.</span><span class="token function">getStringCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>cellType <span class="token operator">==</span> <span class="token class-name">CellType</span><span class="token punctuation">.</span><span class="token constant">BOOLEAN</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>excelCell<span class="token punctuation">.</span><span class="token function">getBooleanCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>cellType <span class="token operator">==</span> <span class="token class-name">CellType</span><span class="token punctuation">.</span><span class="token constant">FORMULA</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> excelCell<span class="token punctuation">.</span><span class="token function">getCellFormula</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>cellType <span class="token operator">==</span> <span class="token class-name">CellType</span><span class="token punctuation">.</span><span class="token constant">NUMERIC</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//short s = excelCell.getCellStyle().getDataFormat();</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">DateUtil</span><span class="token punctuation">.</span><span class="token function">isCellDateFormatted</span><span class="token punctuation">(</span>excelCell<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token comment">// 处理日期格式、时间格式</span>
                <span class="token class-name">SimpleDateFormat</span> sdf<span class="token punctuation">;</span>
                <span class="token comment">// 验证short值</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>excelCell<span class="token punctuation">.</span><span class="token function">getCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDataFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">14</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    sdf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">"yyyy/MM/dd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>excelCell<span class="token punctuation">.</span><span class="token function">getCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDataFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">21</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    sdf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">"HH:mm:ss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>excelCell<span class="token punctuation">.</span><span class="token function">getCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDataFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">22</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    sdf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">"yyyy/MM/dd HH:mm:ss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"日期格式错误!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token class-name">Date</span> date <span class="token operator">=</span> excelCell<span class="token punctuation">.</span><span class="token function">getDateCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> sdf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>excelCell<span class="token punctuation">.</span><span class="token function">getCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDataFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">//处理数值格式</span>
                <span class="token class-name">DataFormatter</span> formatter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataFormatter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> formatter<span class="token punctuation">.</span><span class="token function">formatCellValue</span><span class="token punctuation">(</span>excelCell<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>cellType <span class="token operator">==</span> <span class="token class-name">CellType</span><span class="token punctuation">.</span><span class="token constant">ERROR</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token string">"非法字符"</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 获取sheet内的所有图片信息
     *
     * @param sheet        sheet表
     * @param onlyInternal 单元格内部
     * @return 照片集合
     * @throws Exception 异常
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PicturesInfo</span><span class="token punctuation">&gt;</span></span> <span class="token function">getAllPictureInfos</span><span class="token punctuation">(</span><span class="token class-name">Sheet</span> sheet<span class="token punctuation">,</span> <span class="token keyword">boolean</span> onlyInternal<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token function">getAllPictureInfos</span><span class="token punctuation">(</span>sheet<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> onlyInternal<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 根据sheet和单元格信息获取图片
     *
     * @param sheet        sheet表
     * @param minRow       最小行
     * @param maxRow       最大行
     * @param minCol       最小列
     * @param maxCol       最大列
     * @param onlyInternal 是否内部
     * @return 图片集合
     * @throws Exception 异常
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PicturesInfo</span><span class="token punctuation">&gt;</span></span> <span class="token function">getAllPictureInfos</span><span class="token punctuation">(</span><span class="token class-name">Sheet</span> sheet<span class="token punctuation">,</span> <span class="token class-name">Integer</span> minRow<span class="token punctuation">,</span> <span class="token class-name">Integer</span> maxRow<span class="token punctuation">,</span> <span class="token class-name">Integer</span> minCol<span class="token punctuation">,</span>
                                                        <span class="token class-name">Integer</span> maxCol<span class="token punctuation">,</span> <span class="token keyword">boolean</span> onlyInternal<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>sheet <span class="token keyword">instanceof</span> <span class="token class-name">HSSFSheet</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token function">getXLSAllPictureInfos</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">HSSFSheet</span><span class="token punctuation">)</span> sheet<span class="token punctuation">,</span> minRow<span class="token punctuation">,</span> maxRow<span class="token punctuation">,</span> minCol<span class="token punctuation">,</span> maxCol<span class="token punctuation">,</span> onlyInternal<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>sheet <span class="token keyword">instanceof</span> <span class="token class-name">XSSFSheet</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token function">getXLSXAllPictureInfos</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">XSSFSheet</span><span class="token punctuation">)</span> sheet<span class="token punctuation">,</span> minRow<span class="token punctuation">,</span> maxRow<span class="token punctuation">,</span> minCol<span class="token punctuation">,</span> maxCol<span class="token punctuation">,</span> onlyInternal<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"未处理类型，没有为该类型添加：GetAllPicturesInfos()扩展方法！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PicturesInfo</span><span class="token punctuation">&gt;</span></span> <span class="token function">getXLSAllPictureInfos</span><span class="token punctuation">(</span><span class="token class-name">HSSFSheet</span> sheet<span class="token punctuation">,</span> <span class="token class-name">Integer</span> minRow<span class="token punctuation">,</span> <span class="token class-name">Integer</span> maxRow<span class="token punctuation">,</span>
                                                            <span class="token class-name">Integer</span> minCol<span class="token punctuation">,</span> <span class="token class-name">Integer</span> maxCol<span class="token punctuation">,</span> <span class="token class-name">Boolean</span> onlyInternal<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PicturesInfo</span><span class="token punctuation">&gt;</span></span> picturesInfoList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HSSFShapeContainer</span> shapeContainer <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getDrawingPatriarch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>shapeContainer <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> picturesInfoList<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">HSSFShape</span><span class="token punctuation">&gt;</span></span> shapeList <span class="token operator">=</span> shapeContainer<span class="token punctuation">.</span><span class="token function">getChildren</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">HSSFShape</span> shape <span class="token operator">:</span> shapeList<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>shape <span class="token keyword">instanceof</span> <span class="token class-name">HSSFPicture</span> <span class="token operator">&amp;&amp;</span> shape<span class="token punctuation">.</span><span class="token function">getAnchor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">instanceof</span> <span class="token class-name">HSSFClientAnchor</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">HSSFPicture</span> picture <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HSSFPicture</span><span class="token punctuation">)</span> shape<span class="token punctuation">;</span>
                <span class="token class-name">HSSFClientAnchor</span> anchor <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HSSFClientAnchor</span><span class="token punctuation">)</span> shape<span class="token punctuation">.</span><span class="token function">getAnchor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isInternalOrIntersect</span><span class="token punctuation">(</span>minRow<span class="token punctuation">,</span> maxRow<span class="token punctuation">,</span> minCol<span class="token punctuation">,</span> maxCol<span class="token punctuation">,</span> anchor<span class="token punctuation">.</span><span class="token function">getRow1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> anchor<span class="token punctuation">.</span><span class="token function">getRow2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        anchor<span class="token punctuation">.</span><span class="token function">getCol1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> anchor<span class="token punctuation">.</span><span class="token function">getCol2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> onlyInternal<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token class-name">HSSFPictureData</span> pictureData <span class="token operator">=</span> picture<span class="token punctuation">.</span><span class="token function">getPictureData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    picturesInfoList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PicturesInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">setMinRow</span><span class="token punctuation">(</span>anchor<span class="token punctuation">.</span><span class="token function">getRow1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">setMaxRow</span><span class="token punctuation">(</span>anchor<span class="token punctuation">.</span><span class="token function">getRow2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">setMinCol</span><span class="token punctuation">(</span>anchor<span class="token punctuation">.</span><span class="token function">getCol1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">setMaxCol</span><span class="token punctuation">(</span>anchor<span class="token punctuation">.</span><span class="token function">getCol2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">setPictureData</span><span class="token punctuation">(</span>pictureData<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">setExt</span><span class="token punctuation">(</span>pictureData<span class="token punctuation">.</span><span class="token function">getMimeType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> picturesInfoList<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PicturesInfo</span><span class="token punctuation">&gt;</span></span> <span class="token function">getXLSXAllPictureInfos</span><span class="token punctuation">(</span><span class="token class-name">XSSFSheet</span> sheet<span class="token punctuation">,</span> <span class="token class-name">Integer</span> minRow<span class="token punctuation">,</span> <span class="token class-name">Integer</span> maxRow<span class="token punctuation">,</span>
                                                             <span class="token class-name">Integer</span> minCol<span class="token punctuation">,</span> <span class="token class-name">Integer</span> maxCol<span class="token punctuation">,</span> <span class="token class-name">Boolean</span> onlyInternal<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PicturesInfo</span><span class="token punctuation">&gt;</span></span> picturesInfoList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">POIXMLDocumentPart</span><span class="token punctuation">&gt;</span></span> documentPartList <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getRelations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">POIXMLDocumentPart</span> documentPart <span class="token operator">:</span> documentPartList<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>documentPart <span class="token keyword">instanceof</span> <span class="token class-name">XSSFDrawing</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">XSSFDrawing</span> drawing <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">XSSFDrawing</span><span class="token punctuation">)</span> documentPart<span class="token punctuation">;</span>
                <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">XSSFShape</span><span class="token punctuation">&gt;</span></span> shapes <span class="token operator">=</span> drawing<span class="token punctuation">.</span><span class="token function">getShapes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">XSSFShape</span> shape <span class="token operator">:</span> shapes<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>shape <span class="token keyword">instanceof</span> <span class="token class-name">XSSFPicture</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token class-name">XSSFPicture</span> picture <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">XSSFPicture</span><span class="token punctuation">)</span> shape<span class="token punctuation">;</span>
                        <span class="token class-name">XSSFClientAnchor</span> anchor <span class="token operator">=</span> picture<span class="token punctuation">.</span><span class="token function">getPreferredSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isInternalOrIntersect</span><span class="token punctuation">(</span>minRow<span class="token punctuation">,</span> maxRow<span class="token punctuation">,</span> minCol<span class="token punctuation">,</span> maxCol<span class="token punctuation">,</span> anchor<span class="token punctuation">.</span><span class="token function">getRow1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> anchor<span class="token punctuation">.</span><span class="token function">getRow2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                anchor<span class="token punctuation">.</span><span class="token function">getCol1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> anchor<span class="token punctuation">.</span><span class="token function">getCol2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> onlyInternal<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token class-name">XSSFPictureData</span> pictureData <span class="token operator">=</span> picture<span class="token punctuation">.</span><span class="token function">getPictureData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            picturesInfoList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PicturesInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">setMinRow</span><span class="token punctuation">(</span>anchor<span class="token punctuation">.</span><span class="token function">getRow1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">setMaxRow</span><span class="token punctuation">(</span>anchor<span class="token punctuation">.</span><span class="token function">getRow2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">setMinCol</span><span class="token punctuation">(</span>anchor<span class="token punctuation">.</span><span class="token function">getCol1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">setMaxCol</span><span class="token punctuation">(</span>anchor<span class="token punctuation">.</span><span class="token function">getCol2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">setPictureData</span><span class="token punctuation">(</span>pictureData<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">.</span><span class="token function">setExt</span><span class="token punctuation">(</span>pictureData<span class="token punctuation">.</span><span class="token function">getMimeType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> picturesInfoList<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">isInternalOrIntersect</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> rangeMinRow<span class="token punctuation">,</span> <span class="token class-name">Integer</span> rangeMaxRow<span class="token punctuation">,</span> <span class="token class-name">Integer</span> rangeMinCol<span class="token punctuation">,</span>
                                                 <span class="token class-name">Integer</span> rangeMaxCol<span class="token punctuation">,</span> <span class="token keyword">int</span> pictureMinRow<span class="token punctuation">,</span> <span class="token keyword">int</span> pictureMaxRow<span class="token punctuation">,</span> <span class="token keyword">int</span> pictureMinCol<span class="token punctuation">,</span> <span class="token keyword">int</span> pictureMaxCol<span class="token punctuation">,</span>
                                                 <span class="token class-name">Boolean</span> onlyInternal<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> _rangeMinRow <span class="token operator">=</span> rangeMinRow <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> pictureMinRow <span class="token operator">:</span> rangeMinRow<span class="token punctuation">;</span>
        <span class="token keyword">int</span> _rangeMaxRow <span class="token operator">=</span> rangeMaxRow <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> pictureMaxRow <span class="token operator">:</span> rangeMaxRow<span class="token punctuation">;</span>
        <span class="token keyword">int</span> _rangeMinCol <span class="token operator">=</span> rangeMinCol <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> pictureMinCol <span class="token operator">:</span> rangeMinCol<span class="token punctuation">;</span>
        <span class="token keyword">int</span> _rangeMaxCol <span class="token operator">=</span> rangeMaxCol <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> pictureMaxCol <span class="token operator">:</span> rangeMaxCol<span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>onlyInternal<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span>_rangeMinRow <span class="token operator">&lt;=</span> pictureMinRow <span class="token operator">&amp;&amp;</span> _rangeMaxRow <span class="token operator">&gt;=</span> pictureMaxRow <span class="token operator">&amp;&amp;</span> _rangeMinCol <span class="token operator">&lt;=</span> pictureMinCol
                    <span class="token operator">&amp;&amp;</span> _rangeMaxCol <span class="token operator">&gt;=</span> pictureMaxCol<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>_rangeMaxRow <span class="token operator">-</span> _rangeMinRow<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>pictureMaxRow <span class="token operator">-</span> pictureMinRow<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token class-name">Math</span>
                    <span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>_rangeMaxRow <span class="token operator">+</span> _rangeMinRow <span class="token operator">-</span> pictureMaxRow <span class="token operator">-</span> pictureMinRow<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>_rangeMaxCol <span class="token operator">-</span> _rangeMinCol<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>pictureMaxCol <span class="token operator">-</span> pictureMinCol<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token class-name">Math</span>
                    <span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>_rangeMaxCol <span class="token operator">+</span> _rangeMinCol <span class="token operator">-</span> pictureMaxCol <span class="token operator">-</span> pictureMinCol<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 图片基本信息
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">PicturesInfo</span> <span class="token punctuation">{<!-- --></span>

        <span class="token keyword">private</span> <span class="token keyword">int</span> minRow<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> maxRow<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> minCol<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> maxCol<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">String</span> ext<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> pictureData<span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token class-name">PicturesInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getPictureData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> pictureData<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token class-name">PicturesInfo</span> <span class="token function">setPictureData</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> pictureData<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>pictureData <span class="token operator">=</span> pictureData<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getMinRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> minRow<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token class-name">PicturesInfo</span> <span class="token function">setMinRow</span><span class="token punctuation">(</span><span class="token keyword">int</span> minRow<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>minRow <span class="token operator">=</span> minRow<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getMaxRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> maxRow<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token class-name">PicturesInfo</span> <span class="token function">setMaxRow</span><span class="token punctuation">(</span><span class="token keyword">int</span> maxRow<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>maxRow <span class="token operator">=</span> maxRow<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getMinCol</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> minCol<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token class-name">PicturesInfo</span> <span class="token function">setMinCol</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCol<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>minCol <span class="token operator">=</span> minCol<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getMaxCol</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> maxCol<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token class-name">PicturesInfo</span> <span class="token function">setMaxCol</span><span class="token punctuation">(</span><span class="token keyword">int</span> maxCol<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>maxCol <span class="token operator">=</span> maxCol<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getExt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> ext<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token class-name">PicturesInfo</span> <span class="token function">setExt</span><span class="token punctuation">(</span><span class="token class-name">String</span> ext<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>ext <span class="token operator">=</span> ext<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="_586"></a>三、引文</h3> 
<ol><li><a href="https://blog.csdn.net/weixin_43663915/article/details/89319125">java高效实现excel转pdf，支持excel中带有图片的转换（支持.xls和.xlsx两种格式）</a></li><li><a href="https://www.cnblogs.com/22MM/p/10278484.html" rel="nofollow">Java Poi 读取excel 对所有类型进行处理</a></li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c09f82fa4e05b3324cc4ab54ad1e29dd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">C# 超详细的WebService创建、发布与调用（VS2022）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b37d2bc1f27099308e9531337ddaf9ee/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Ubuntu上安装、使用MongoDB详细教程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>