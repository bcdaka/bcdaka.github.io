<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【DB2报错】执行存储过程报 SQLCODE:-420 SQLSTATE:22018,解决方法在这里。 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/7513c7628aa56f3d6b4226efb3e5ffc5/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【DB2报错】执行存储过程报 SQLCODE:-420 SQLSTATE:22018,解决方法在这里。">
  <meta property="og:description" content="执行存储过程的时候碰到这个报错： Invalid character found in a character string argument of the function &#34;DECFLOAT&#34;...SQLSTATE:22018 SQLCODE:-420 不要慌！！遇事不决先翻译：
翻译：在函数 &#34;DECFLOAT&#34; 的字符串自变量中找到无效字符。
报错解释 ：
原因分析：
处理方式：
情况一：
情况二：
报错解释 ： SQLCODE:-420 函数 函数名（这里指的是报错信息里的DECFLOAT） 的字符串自变量包含在数字 SQL 常量中无效的字符。 由于使用 CAST 规范并将 函数名 （DECFLOAT）作为目标数据类型，或者将一个自变量隐式强制类型转换为数字数据类型而调用了此函数。 用于 SQL 语句中的函数或数据类型可能是 函数名 （DECFLOAT）的同义词。
SQLSTATE:22018 CAST 规范 或者 CAST 标量函数的字符值无效。
用户响应：更改 SQL 语句，使每个操作数或 VALUES 子句中的每行有完全相同的列数。
原因分析： 根据提示找到问题语句所在地方，是一个IF条件里的语句
/*-------------------------------------- 情况一：字段类型说明 DEPTNO decimal(2,0) --------------------------------------*/ SELECT COUNT(1) FROM EMP WHERE DEPTNO &lt;&gt; &#39;&#39; /*--------------------------------------------- 情况二：字段类型说明 var_col varchar(8) var_col里的枚举值都是数字，也有&#39;&#39;（空字符串）的情况 -----------------------------------------------*/ SELECT var_col FROM test_table WHERE var_col &gt; 0 处理方式 情况一： SELECT COUNT(1) FROM EMP WHERE DEPTNO &lt;&gt; &#39;&#39;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-24T00:29:17+08:00">
    <meta property="article:modified_time" content="2024-04-24T00:29:17+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【DB2报错】执行存储过程报 SQLCODE:-420 SQLSTATE:22018,解决方法在这里。</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 id="%E4%BB%8A%E5%A4%A9%E6%B5%8B%E8%AF%95%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%9A%84%E6%97%B6%E5%80%99%E7%A2%B0%E5%88%B0%E8%BF%99%E4%B8%AA%E6%8A%A5%E9%94%99%EF%BC%9A">执行存储过程的时候碰到这个报错：</h2> 
<h2 id="SQL0668N%C2%A0%20Operation%20not%20allowed%20for%20reason%20code%20%223%22%20on%20table%20%22CALSS_STUDENT%22.%C2%A0%20SQLSTATE%3D57016.">Invalid character found in a character string argument of the function  "DECFLOAT"...SQLSTATE:22018 SQLCODE:-420</h2> 
<p><em><strong><span style="color:#1c7331;">不要慌！！遇事不决先翻译：</span></strong></em></p> 
<p>翻译：在函数 "DECFLOAT" 的字符串自变量中找到无效字符。</p> 
<p id="%E6%8A%A5%E9%94%99%E8%A7%A3%E9%87%8A%EF%BC%9A-toc"><strong><a href="#%E6%8A%A5%E9%94%99%E8%A7%A3%E9%87%8A%EF%BC%9A" rel="nofollow">报错解释 ：</a></strong></p> 
<p id="%E5%8E%9F%E5%9B%A0%E5%87%BA%E5%A4%84%EF%BC%9A-toc"><strong><a href="#%E5%8E%9F%E5%9B%A0%E5%87%BA%E5%A4%84%EF%BC%9A" rel="nofollow">原因分析：</a></strong></p> 
<p id="%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F%EF%BC%9A-toc"><strong><a href="#%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F%EF%BC%9A" rel="nofollow">处理方式：</a></strong></p> 
<p id="%E6%83%85%E5%86%B5%E4%B8%80%E3%80%81-toc"><strong><a href="#%E6%83%85%E5%86%B5%E4%B8%80%E3%80%81" rel="nofollow">情况一：</a></strong></p> 
<p id="%E6%83%85%E5%86%B5%E4%BA%8C%E3%80%81-toc"><strong><a href="#%E6%83%85%E5%86%B5%E4%BA%8C%E3%80%81" rel="nofollow">情况二：</a></strong></p> 
<p id="%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F%EF%BC%9A-toc"></p> 
<hr id="hr-toc"> 
<h3 id="%E6%8A%A5%E9%94%99%E8%A7%A3%E9%87%8A%EF%BC%9A"><strong><em>报错解释 ：</em></strong></h3> 
<p><strong>SQLCODE:-420  </strong><u>函数 函数名</u>（<em><span style="color:#fe2c24;">这里指的是报错信息里的DECFLOAT</span></em>） <u>的字符串自变量包含在数字 SQL 常量中无效的字符。 由于使用 CAST 规范并将 函数名 </u>（<em><span style="color:#fe2c24;">DECFLOAT</span></em>）<u>作为目标数据类型，或者将一个自变量隐式强制类型转换为数字数据类型而调用了此函数。 用于 SQL 语句中的函数或数据类型可能是 函数名 </u>（<em><span style="color:#fe2c24;">DECFLOAT</span></em>）<u>的同义词。</u></p> 
<p><strong>SQLSTATE:</strong>22018 <u>CAST 规范 或者 CAST 标量函数的字符值无效。</u></p> 
<p>用户响应：<u>更改 SQL 语句，使每个操作数或 VALUES 子句中的每行有完全相同的列数。</u></p> 
<hr> 
<h3 id="%E5%8E%9F%E5%9B%A0%E5%87%BA%E5%A4%84%EF%BC%9A"><em><strong>原因分析：</strong></em></h3> 
<p>根据提示找到问题语句所在地方，是一个IF条件里的语句</p> 
<pre><code class="language-sql">
/*--------------------------------------

情况一：字段类型说明 

DEPTNO decimal(2,0)

--------------------------------------*/


SELECT COUNT(1) FROM EMP WHERE DEPTNO &lt;&gt; ''







/*---------------------------------------------

情况二：字段类型说明 

var_col varchar(8)

var_col里的枚举值都是数字，也有''（空字符串）的情况

-----------------------------------------------*/


SELECT var_col FROM test_table WHERE var_col &gt; 0</code></pre> 
<hr> 
<h3 id="%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F%EF%BC%9A"><em><strong>处理方式</strong></em></h3> 
<h4 id="%E6%83%85%E5%86%B5%E4%B8%80%E3%80%81"><strong><em>情况一：</em></strong></h4> 
<p>SELECT COUNT(1) FROM EMP WHERE DEPTNO &lt;&gt; ''</p> 
<p>这个判断是无效的，可以把条件去掉，但是在mysql那里是可以执行的。</p> 
<blockquote> 
 <p>ps：因为 DEPTNO 字段类型 decimal 它属于数值类型之一，所以字段本来就不允许出现空字符串的情况，所以where 条件那里不能够和 '' 进行比较。</p> 
</blockquote> 
<hr> 
<h4 id="%E6%83%85%E5%86%B5%E4%BA%8C%E3%80%81"><strong><em>情况二：</em></strong></h4> 
<p>SELECT var_col FROM test_table WHERE var_col &gt; 0：</p> 
<p>如果不用 CAST 函数转换 var_col想和0比较改成以下两种语句之一就可以了：</p> 
<pre><code class="language-sql">
# 和'0' 字符串进行比较
SELECT var_col FROM test_table WHERE var_col &gt; '0'


# 用函数把0转成字符串
SELECT var_col FROM test_table WHERE var_col &gt; to_char(0)</code></pre> 
<blockquote> 
 <p>ps：</p> 
 <ol><li>如果字段类型是 varchar 类型你要对它进行数值比较，需要把值转成数字的字符串形式，所以例子中的 var_col varchar(8) 虽然里面的值都是数字，但是和整数 0 比较会报错的。</li><li>另外假如 var_col 里面的数据 存在 ‘’ 两个引号的这种空字符串，这条sql 也会报错但是转成字符串就可以比较。</li></ol> 
</blockquote> 
<hr> 
<p>存储过程一定要用日志作为debug，方便找问题。</p> 
<p>其他<strong>报错 </strong>的原因码以及其他报错的错误状态码可以在下面 IBM 的链接查看。</p> 
<p>👇👇👇👇👇👇👇👇👇👇👇<br><a href="https://www.ibm.com/docs/en/db2/11.1?topic=messages-sql0500-sql0749#sql0668n" rel="nofollow" title="SQL0500 - SQL0749 - IBM Documentationhttps://www.ibm.com/docs/en/db2/11.1?topic=messages-sql0500-sql0749#sql0668n">SQL0500 - SQL0749 - IBM Documentationhttps://www.ibm.com/docs/en/db2/11.1?topic=messages-sql0500-sql0749#sql0668n</a>有需要文档的同学也可以私信我~</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/554ab455185c5d47913685f01065359a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">分布式hbase：status查看hbase shell时抱错：ERROR: KeeperErrorCode = NoNode for /hbase/master 问题。</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a3561d1c2099b056efc63bba6538f24e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Python OpenCV图像处理：从基础到高级的全方位指南</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>