<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Ciallo～(∠・ω・ )⌒☆第二十五篇 Redis - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/9d50abadc8b0512bd14f799a77ca7281/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Ciallo～(∠・ω・ )⌒☆第二十五篇 Redis">
  <meta property="og:description" content="Redis 是一个高性能的键值存储数据库，它能够在内存中快速读写数据，并且支持持久化到磁盘。它被广泛应用于缓存、队列、实时分析等场景。
一、启动redis服务器 要打开redis服务器，需要在终端中输入redis-server命令。确保已经安装了redis，并且路径已经正确配置。打开终端，输入redis-server命令并按下回车键，即可启动redis服务器。
在控制台输入:
redis-cli
来连接redis服务器: 二、redis 数据类型对应的操作 主要使用python来实现redis的相关操作
（一）、使用pip命令安装redis-py库： pip install redis 安装完成后，可以在Python代码中导入redis库：
import redis （二）、接下来，连接到Redis服务器： # 创建Redis连接 client = redis.Redis(host=&#39;localhost&#39;, port=6379, db=0) 这里的host是Redis服务器的主机名，port是Redis服务器的端口号（默认为6379），db是使用的数据库编号（默认为0）。
(三)、键的操作 # 获取键的类型 print(client.type(&#34;key_string&#34;)) # 设置有效期 client.set(&#34;key_string&#34;, 101) client.expire(&#34;key_string&#34;, 100) # 剩余时间 print(client.ttl(&#34;key_string&#34;)) # 移除有效期 client.persist(&#34;key_string&#34;) # 删除键 client.delete(&#34;key_string&#34;) # 打印键 print(client.keys()) (四)、字符串的操作 # 添加字符串 client.set(&#34;id&#34;, 101) # 获取字符串 print(client.get(&#34;id&#34;).decode()) # 连续添加字符串 client.mset({&#34;name&#34;: &#34;kurumi&#34;, &#34;address&#34;: &#34;youkohama&#34;}) # 连续获取字符串 print(client.mget([&#34;name&#34;, &#34;address&#34;, &#34;id&#34;])) # 获取字符串长度 print(client.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-22T20:00:24+08:00">
    <meta property="article:modified_time" content="2024-08-22T20:00:24+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Ciallo～(∠・ω・ )⌒☆第二十五篇 Redis</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><span style="color:#ffd900;">Redis 是一个高性能的键值存储数据库，它能够在内存中快速读写数据，并且支持持久化到磁盘。它被广泛应用于缓存、队列、实时分析等场景。</span></p> 
<p class="img-center"><img alt="" height="312" src="https://images2.imgbox.com/90/12/Ou5txIGM_o.png" width="553"></p> 
<h2><span style="color:#ffd900;">一、启动redis服务器</span></h2> 
<p><span style="color:#ffd900;">要打开redis服务器，需要在终端中输入redis-server命令。确保已经安装了redis，并且路径已经正确配置。打开终端，输入redis-server命令并按下回车键，即可启动redis服务器。</span></p> 
<p><span style="color:#ffd900;"><img alt="" height="30" src="https://images2.imgbox.com/eb/be/wwD4U4Vl_o.png" width="448"></span></p> 
<p><span style="color:#ffd900;"><img alt="" height="358" src="https://images2.imgbox.com/51/63/IiXSni3D_o.png" width="776"></span></p> 
<p><span style="color:#ffd900;"> 在控制台输入:</span></p> 
<blockquote> 
 <p><span style="color:#ffd900;">redis-cli</span></p> 
</blockquote> 
<p><span style="color:#ffd900;">来连接redis服务器: </span></p> 
<p><span style="color:#ffd900;"><img alt="" height="52" src="https://images2.imgbox.com/55/7e/3zHLKkfc_o.png" width="231"></span></p> 
<p></p> 
<h2><span style="color:#ffd900;">二、redis 数据类型对应的操作</span></h2> 
<p><span style="color:#ffd900;">主要使用python来实现redis的相关操作</span></p> 
<h4><span style="color:#ffd900;">（一）、使用pip命令安装redis-py库：</span></h4> 
<pre><code class="language-cmake">pip install redis</code></pre> 
<p><span style="color:#ffd900;">安装完成后，可以在Python代码中导入redis库：</span></p> 
<pre><code class="language-python">import redis</code></pre> 
<h4><span style="color:#ffd900;">（二）、接下来，连接到Redis服务器：</span></h4> 
<pre><code class="language-python"># 创建Redis连接
client = redis.Redis(host='localhost', port=6379, db=0)</code></pre> 
<p><span style="color:#ffd900;">这里的host是Redis服务器的主机名，port是Redis服务器的端口号（默认为6379），db是使用的数据库编号（默认为0）。</span></p> 
<h4><span style="color:#ffd900;">(三)、键的操作</span></h4> 
<pre><code class="language-python"># 获取键的类型
print(client.type("key_string"))
# 设置有效期
client.set("key_string", 101)
client.expire("key_string", 100)
# 剩余时间
print(client.ttl("key_string"))
# 移除有效期
client.persist("key_string")
# 删除键
client.delete("key_string")
# 打印键
print(client.keys())</code></pre> 
<h4><span style="color:#ffd900;">(四)、字符串的操作</span></h4> 
<pre><code class="language-python"># 添加字符串
client.set("id", 101)
# 获取字符串
print(client.get("id").decode())
# 连续添加字符串
client.mset({"name": "kurumi", "address": "youkohama"})
# 连续获取字符串
print(client.mget(["name", "address", "id"]))
# 获取字符串长度
print(client.strlen("name"))
# 设置字符串寿命
client.set("id", 101, ex=100)
# 获取字符串寿命
print(client.ttl("id"))</code></pre> 
<h4><span style="color:#ffd900;"> (五)、列表的操作</span></h4> 
<pre><code class="language-python"># 从列表左边删除
value = client.lpop("key_list")
print(value)
# 从列表右边删除
value = client.rpop("key_list")
print(value)

# 返回索引对应的元素
print(client.lindex("key_list", 1))
# 返回索引范围内的元素
print(client.lrange("key_list", 0, 3))
# 对原始数据使用索引切割
print(client.ltrim("key_list", 2, 3))
</code></pre> 
<h4><span style="color:#ffd900;">  (六)、哈希的操作</span></h4> 
<pre><code class="language-python">client.hset("key_hash", "key1", "value1")
print(client.hget("key_hash", "key1"))
# 键值对的个数
print(client.hlen("key_hash"))
# 删除指定的键
client.hdel("key_hash", "key1")
# 返回所有键
print(client.hkeys("key_hash"))
# 返回所有值
print(client.hvals("key_hash"))
# 返回所有键值对
print(client.hgetall("key_hash"))</code></pre> 
<h4><span style="color:#ffd900;">   (七)、集合的操作</span></h4> 
<pre><code class="language-python"># 添加
client.sadd("key_set", 1, 2, 3, 2, 1)
# 删除指定值，没有不管
client.srem("key_set", 1, 2, 5, 7)
# 是否是成员
print(client.sismember("key_set", "3"))
# 所有成员
print(client.smembers("key_set"))
# 个数
print(client.scard("key_set"))
# 交集
print(client.sinter(["key_set", "key_set2"]))
# 并集
print(client.sunion(["key_set", "key_set2"]))
# 差集
print(client.sdiff(["key_set", "key_set2"]))</code></pre> 
<h4><span style="color:#ffd900;">    (八)、有序集合的操作</span></h4> 
<pre><code class="language-python"># 添加
client.zadd("key_zset", {"aaa": 15, "bbb": 20, "ccc": 30})
# 删除
client.zrem("key_zset", "aaa", "ccc")
# 个数
print(client.zcard("key_zest"))
# 根据值取权重
print(client.zscore("key_zset", "bbb"))
# 根据获取权重范围内个数
print(client.zcount("key_zset", 20, 25))
# 根据权重排序索引返回值
print(client.zrange("key_set", 0, 1))</code></pre> 
<h2><span style="color:#ffd900;">三、 mysql与redis结合使用</span></h2> 
<p><span style="color:#ffd900;">MySQL和Redis是两种功能各异的数据库系统，通常可以结合使用来发挥各自的优势。以下是它们如何结合使用的方法：</span></p> 
<pre><code class="language-python">import pymysql
import redis


class MySqlHelper:
    def __init__(self):
       self.con = None
       self.cur = None
       try:
          self.con = pymysql.connect(user="root", password="123456", database="python2407")
       except Exception as e:
          print(f"连接出异常")
       else:
          self.cur = self.con.cursor()

    def query_one(self, sql, args=None):
       try:
          self.cur.execute(sql, args)
          return self.cur.fetchone()
       except Exception as e:
          print(f"查询出异常")

    def update(self, sql, args=None):
       try:
          row = self.cur.execute(sql, args)
          self.con.commit()
          return row
       except Exception as e:
          print(f"修改出异常")

    def __del__(self):
       if self.cur:
          self.cur.close()
       if self.con:
          self.con.close()


class RedisHelper:
    def __init__(self):
       self.client = None
       try:
          self.client = redis.Redis(host="192.168.13.32", password="123456")
       except Exception as e:
          print(f"连接redis失败")


    def query_one(self, key):
       try:
          return self.client.hgetall(key)
       except Exception as e:
          print(f"执行查询失败")

    def update(self, key, value):
       try:
          self.client.hset(key, mapping=value)
       except Exception as e:
          print(f"执行修改失败", e)

    def __del__(self):
       if self.client:
          self.client.close()


class DataHelper:
    def __init__(self):
       self.sql = MySqlHelper()
       self.redis = RedisHelper()

    def regist_user(self, username, password):
       row = self.sql.update("insert into user (username, password) values (%s, %s)", (username, password))
       if row &gt; 0:
          user = self.sql.query_one("select * from user where username = %s and password = %s", (username, password))
          self.redis.update(f"{user[0]}", {"id": user[0], "username": user[1], "password": user[2]})
          print(f"注册成功")

    def query_user(self, u_id):
       value = self.redis.query_one(u_id)
       if value:
          print(f"redis中直接找到")
          return value
       else:
          user = self.sql.query_one("select * from user where id = %s", u_id)
          if user:
             print(f"redis中没有找到， 从mysql中找到放入redis")
             self.redis.update(f"{u_id}", {"id": user[0], "username": user[1], "password": user[2]})
             return user


def main():
    dh = DataHelper()
    r = dh.query_user("3031")
    print(r)



if __name__ == '__main__':
    main()</code></pre> 
<p><span style="color:#ffd900;"> </span></p> 
<p class="img-center"><img alt="" height="604" src="https://images2.imgbox.com/71/e7/WAsGUAAR_o.png" width="472"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9489cfd128022c998f4945c3a3df4d38/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【数据结构初阶】单链表接口实现超详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4e4565188b6b3714186d76ffd21fd334/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">汉服推广网站</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>