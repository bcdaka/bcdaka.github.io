<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【面试干货】 Java 中的 HashSet 底层实现 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/af3774318e758808f1933584c7016a40/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【面试干货】 Java 中的 HashSet 底层实现">
  <meta property="og:description" content="【面试干货】 Java 中的 HashSet 底层实现 1、HashSet 的底层实现2、 HashSet 的特点3、 总结 💖The Begin💖点点关注，收藏不迷路💖 HashSet 是 Java 集合框架中的一个重要成员，它提供了不存储重复元素的集合。但是，你有没有好奇过 HashSet 是如何实现这一特性的呢？本文将带你深入了解 HashSet 的底层实现机制。
1、HashSet 的底层实现 HashSet 的实现是基于 HashMap 的。当我们创建一个 HashSet 对象时，实际上是在背后初始化了一个 HashMap 对象。
但是，HashSet 和 HashMap 的使用方式并不完全相同，这是因为 HashSet 隐藏了 HashMap 的某些复杂性，只暴露了简单的集合操作接口。
HashSet 不允许值重复，这是如何实现的呢？ 关键在于 HashSet 是如何存储其元素的。在 HashSet 中，元素是作为 HashMap 的 key 存储的，而 HashMap 的 value 则是一个固定的对象（在 Java 8 及以后的版本中，这个固定的对象通常是一个名为 PRESENT 的静态常量对象）。
示例：
package com.mypackage; import java.util.HashMap; import java.util.Map; public class MyHashSet&lt;E&gt; { // 使用 HashMap 存储元素，这里将 key 视为 HashSet 中的元素 private Map&lt;E, Object&gt; map; // 静态常量，模拟 HashSet 中的 PRESENT private static final Object PRESENT = new Object(); // 构造函数，初始化 HashMap public MyHashSet() { map = new HashMap&lt;&gt;(); } // 添加元素到 HashSet 中 public boolean add(E e) { // 如果 put 方法返回 null，表示该 key 尚未在 HashMap 中存在 return map.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-22T00:00:00+08:00">
    <meta property="article:modified_time" content="2024-06-22T00:00:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【面试干货】 Java 中的 HashSet 底层实现</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>【面试干货】 Java 中的 HashSet 底层实现</h4> 
 <ul><li><a href="#1HashSet__18" rel="nofollow">1、HashSet 的底层实现</a></li><li><a href="#2_HashSet__89" rel="nofollow">2、 HashSet 的特点</a></li><li><a href="#3__95" rel="nofollow">3、 总结</a></li></ul> 
</div> 
<p></p> 
<br> 
<table width="100%"><tbody><tr><td width="50%"> 
    <div align="center"> 
     <font color="#E73B3E"><em>💖The Begin💖点点关注，收藏不迷路💖<em></em></em></font> 
    </div> </td></tr></tbody></table> 
<p>HashSet 是 Java 集合框架中的一个重要成员，它提供了不存储重复元素的集合。但是，你有没有好奇过 HashSet 是如何实现这一特性的呢？本文将带你深入了解 HashSet 的底层实现机制。</p> 
<h2><a id="1HashSet__18"></a>1、HashSet 的底层实现</h2> 
<p><strong><code>HashSet 的实现是基于 HashMap 的。当我们创建一个 HashSet 对象时，实际上是在背后初始化了一个 HashMap 对象。</code></strong></p> 
<p>但是，HashSet 和 HashMap 的使用方式并不完全相同，这是因为 HashSet 隐藏了 HashMap 的某些复杂性，只暴露了简单的集合操作接口。</p> 
<p><mark><strong>HashSet 不允许值重复，这是如何实现的呢？</strong></mark> 关键在于 HashSet 是如何存储其元素的。在 HashSet 中，元素是作为 HashMap 的 key 存储的，而 HashMap 的 value 则是一个固定的对象（在 Java 8 及以后的版本中，这个固定的对象通常是一个名为 PRESENT 的静态常量对象）。</p> 
<p><strong>示例：</strong></p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>mypackage</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashMap</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyHashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 使用 HashMap 存储元素，这里将 key 视为 HashSet 中的元素</span>
    <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map<span class="token punctuation">;</span>

    <span class="token comment">// 静态常量，模拟 HashSet 中的 PRESENT</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Object</span> <span class="token constant">PRESENT</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 构造函数，初始化 HashMap</span>
    <span class="token keyword">public</span> <span class="token class-name">MyHashSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 添加元素到 HashSet 中</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">E</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 如果 put 方法返回 null，表示该 key 尚未在 HashMap 中存在</span>
        <span class="token keyword">return</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token constant">PRESENT</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 从 HashSet 中移除元素</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">E</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 如果 remove 方法返回 true，表示该 key 在 HashMap 中存在并且已被移除</span>
        <span class="token keyword">return</span> map<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 检查 HashSet 是否包含某个元素</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">contains</span><span class="token punctuation">(</span><span class="token class-name">E</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 如果 get 方法返回非 null 值，表示该 key 在 HashMap 中存在</span>
        <span class="token keyword">return</span> map<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 为了展示 HashSet 的内容，我们提供一个简单的方法来打印它</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">printSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">E</span> e <span class="token operator">:</span> map<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 主函数，用于测试 MyHashSet</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">MyHashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> myHashSet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyHashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        myHashSet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"apple"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        myHashSet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"banana"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        myHashSet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"apple"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 这将不会添加，因为 "apple" 已经存在</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>myHashSet<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"apple"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出：true</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>myHashSet<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"orange"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出：false</span>
        myHashSet<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">"banana"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        myHashSet<span class="token punctuation">.</span><span class="token function">printSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出：apple</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/82/54/jW04QvjB_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="2_HashSet__89"></a>2、 HashSet 的特点</h2> 
<ul><li><strong>无序性</strong>：HashSet 不保证元素的迭代顺序与插入顺序相同。这是因为 HashSet 是基于 HashMap 实现的，而 HashMap 本身不保证映射的顺序。</li><li><strong>元素唯一性</strong>：HashSet 中的元素是唯一的，不允许重复。这是通过 HashMap 的 key 唯一性保证的。</li><li><strong>性能</strong>：HashSet 的查找、添加和删除操作的时间复杂度通常为 O(1)，但在最坏的情况下可能会达到 O(n)（当哈希冲突严重，导致链表或红黑树过长时）。</li></ul> 
<h2><a id="3__95"></a>3、 总结</h2> 
<p><strong><code>HashSet 的底层实现是基于 HashMap 的，通过利用 HashMap 的 key 唯一性来保证集合中元素的唯一性。HashSet 隐藏了 HashMap 的复杂性，只提供了简单的集合操作接口，使得我们可以更加方便地使用它来处理不重复的元素集合。</code></strong></p> 
<p><img src="https://images2.imgbox.com/0e/aa/S2dv0kwz_o.png" alt="在这里插入图片描述"></p> 
<br> 
<table width="100%"><tbody><tr><td width="50%"> 
    <div align="center"> 
     <font color="#E73B3E"><em>💖The End💖点点关注，收藏不迷路💖<em></em></em></font> 
    </div> </td></tr></tbody></table>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1ce2886a20a57231b3a7c76727da0866/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Unity踩坑记录</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b0cb79bd48c63452885106ce17433447/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">蓝桥杯 经典算法题 合并排序数组</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>