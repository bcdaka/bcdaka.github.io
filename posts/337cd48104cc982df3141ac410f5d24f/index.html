<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【MySQL】跟着示例学 SQL - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/337cd48104cc982df3141ac410f5d24f/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【MySQL】跟着示例学 SQL">
  <meta property="og:description" content="下面所有示例均来自 SQL之母 - SQL自学网站
-- 查询所有学生 -- 请编写 SQL 查询语句，从名为 `student` 的数据表中查询出所有学生的信息。 select * from student; -- 查询学生的姓名和年龄 -- 请编写一条 SQL 查询语句，从名为 `student` 的数据表中选择出所有学生的姓名（name）和年龄（age）信息。 select name, age from student; -- 查询 - 别名 -- 请编写一条 SQL 查询语句，从名为 `student` 的数据表中选择出所有学生的姓名（name）和年龄（age）信息，并为它们取别名为 `学生姓名` 和 `学生年龄`。 select name as 学生姓名, age as 学生年龄 from student; -- 查询 - 常量和运算 -- 请编写一条 SQL 查询语句，从名为`student`的数据表中选择出所有学生的姓名（name）和分数（score），并且额外计算出分数的 2 倍（double_score）。 select name, score, 2 * score as double_score from student; -- 条件查询 - where -- 请编写一条 SQL 查询语句，从名为`student` 的数据表中选择出所有学生的姓名（name）和成绩（score），要求学生姓名为 &#39;鱼皮&#39;。 select name, score from student where name = &#39;鱼皮&#39; -- 条件查询 - 运算符 -- 请编写一条 SQL 查询语句，从名为 `student` 的数据表中选择出所有学生的姓名（name）和年龄（age），要求学生姓名不等于 &#39;热dog&#39; 。 select name, age from student where name !">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-04T12:54:47+08:00">
    <meta property="article:modified_time" content="2024-04-04T12:54:47+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【MySQL】跟着示例学 SQL</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atelier-sulphurpool-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>下面所有示例均来自 <a href="http://sqlmother.yupi.icu/#/learn" rel="nofollow">SQL之母 - SQL自学网站</a></p> 
<pre><code class="prism language-sql"><span class="token comment">-- 查询所有学生</span>
<span class="token comment">-- 请编写 SQL 查询语句，从名为 `student` 的数据表中查询出所有学生的信息。</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> student<span class="token punctuation">;</span>
<span class="token comment">-- 查询学生的姓名和年龄</span>
<span class="token comment">-- 请编写一条 SQL 查询语句，从名为 `student` 的数据表中选择出所有学生的姓名（name）和年龄（age）信息。</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span> age <span class="token keyword">from</span> student<span class="token punctuation">;</span>
<span class="token comment">-- 查询 - 别名</span>
<span class="token comment">-- 请编写一条 SQL 查询语句，从名为 `student` 的数据表中选择出所有学生的姓名（name）和年龄（age）信息，并为它们取别名为 `学生姓名` 和 `学生年龄`。</span>
<span class="token keyword">select</span> name <span class="token keyword">as</span> 学生姓名<span class="token punctuation">,</span> age <span class="token keyword">as</span> 学生年龄 <span class="token keyword">from</span> student<span class="token punctuation">;</span>
<span class="token comment">-- 查询 - 常量和运算</span>
<span class="token comment">-- 请编写一条 SQL 查询语句，从名为`student`的数据表中选择出所有学生的姓名（name）和分数（score），并且额外计算出分数的 2 倍（double_score）。</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span> score<span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">*</span> score <span class="token keyword">as</span> double_score <span class="token keyword">from</span> student<span class="token punctuation">;</span>
<span class="token comment">-- 条件查询 - where</span>
<span class="token comment">-- 请编写一条 SQL 查询语句，从名为`student` 的数据表中选择出所有学生的姓名（name）和成绩（score），要求学生姓名为 '鱼皮'。</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span> score <span class="token keyword">from</span> student <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'鱼皮'</span>
<span class="token comment">-- 条件查询 - 运算符</span>
<span class="token comment">-- 请编写一条 SQL 查询语句，从名为 `student` 的数据表中选择出所有学生的姓名（name）和年龄（age），要求学生姓名不等于 '热dog' 。</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span> age <span class="token keyword">from</span> student <span class="token keyword">where</span> name <span class="token operator">!=</span> <span class="token string">'热dog'</span>
<span class="token comment">-- 条件查询 - 空值</span>
<span class="token comment">-- 请编写一条 SQL 查询语句，从名为 `student` 的数据表中选择出所有学生的姓名（name）、年龄（age）和成绩（score），要求学生年龄不为空值。</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> score <span class="token keyword">from</span> student <span class="token keyword">where</span> age <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
<span class="token comment">-- 条件查询 - 模糊查询</span>
<span class="token comment">-- 请编写一条 SQL 查询语句，从名为 `student` 的数据表中选择出所有学生的姓名（name）和成绩（score），要求姓名（name）不包含 "李" 这个字。</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span> score <span class="token keyword">from</span> student <span class="token keyword">where</span> name <span class="token operator">not</span> <span class="token operator">like</span> <span class="token string">'%李%'</span>
<span class="token comment">-- 条件查询 - 逻辑运算</span>
<span class="token comment">-- 请编写一条 SQL 查询语句，从名为 `student` 的数据表中选择出所有学生的姓名（name）、成绩（score），要求学生的姓名包含 "李"，或者成绩（score）大于 500。</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span> score <span class="token keyword">from</span> student <span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">'%李%'</span> <span class="token operator">or</span> score <span class="token operator">&gt;=</span> <span class="token number">500</span>
<span class="token comment">-- 去重</span>
<span class="token comment">-- 请编写一条 SQL 查询语句，从名为 `student` 的数据表中选择出所有不重复的班级 ID（class_id）和考试编号（exam_num）的组合。</span>
<span class="token keyword">select</span> <span class="token keyword">distinct</span> class_id<span class="token punctuation">,</span> exam_num <span class="token keyword">from</span> student
<span class="token comment">-- 排序</span>
<span class="token comment">-- 请编写一条 SQL 查询语句，从名为 `student` 的数据表中选择出学生姓名（name）、年龄（age）和成绩（score），首先按照成绩从大到小排序，如果成绩相同，则按照年龄从小到大排序。</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> score <span class="token keyword">from</span> student <span class="token keyword">order</span> <span class="token keyword">by</span> score <span class="token keyword">desc</span><span class="token punctuation">,</span> age <span class="token keyword">asc</span>
<span class="token comment">-- 截断和偏移</span>
<span class="token comment">-- 请编写一条 SQL 查询语句，从名为 `student` 的数据表中选择学生姓名（name）和年龄（age），按照年龄从小到大排序，从第 2 条数据开始、截取 3 个学生的信息。</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span> age <span class="token keyword">from</span> student <span class="token keyword">order</span> <span class="token keyword">by</span> age <span class="token keyword">asc</span> <span class="token keyword">limit</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span>
<span class="token comment">-- 条件分支</span>
<span class="token comment">-- 假设有一个学生表 `student`，包含以下字段：`name`（姓名）、`age`（年龄）。请你编写一个 SQL 查询，将学生按照年龄划分为三个年龄等级（age_level）：60 岁以上为 "老同学"，20 岁以上（不包括 60 岁以上）为 "年轻"，20 岁及以下、以及没有年龄信息为 "小同学"。返回结果应包含学生的姓名（name）和年龄等级（age_level），并按姓名升序排序。</span>
<span class="token keyword">select</span> 
  name<span class="token punctuation">,</span>
  <span class="token keyword">case</span> <span class="token keyword">when</span> <span class="token punctuation">(</span>age <span class="token operator">&gt;</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token keyword">then</span> <span class="token string">'老同学'</span>
    <span class="token keyword">when</span> <span class="token punctuation">(</span>age <span class="token operator">&gt;</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">then</span> <span class="token string">'年轻'</span>
    <span class="token keyword">else</span> <span class="token string">'小同学'</span> 
    <span class="token keyword">end</span> <span class="token keyword">as</span> age_level
<span class="token keyword">from</span> 
student
<span class="token keyword">order</span> <span class="token keyword">by</span> name <span class="token keyword">asc</span>
<span class="token comment">-- 函数 - 时间函数</span>
<span class="token comment">-- 假设有一个学生表 `student`，包含以下字段：`name`（姓名）、`age`（年龄）。请你编写一个 SQL 查询，展示所有学生的姓名（name）和当前日期（列名为 "当前日期"）。</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span> <span class="token keyword">date</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> 当前日期 <span class="token keyword">from</span> student
<span class="token comment">-- 函数 - 字符串处理</span>
<span class="token comment">-- 假设有一个学生表 `student`，包含以下字段：`id`（学号）、`name`（姓名）。请你编写一个 SQL 查询，筛选出姓名为 '热dog' 的学生，展示其学号（id）、姓名（name）及其大写姓名（upper_name）。</span>
<span class="token keyword">select</span> id<span class="token punctuation">,</span> name<span class="token punctuation">,</span>  upper<span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token keyword">as</span> upper_name <span class="token keyword">from</span> student <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'热dog'</span>
<span class="token comment">-- 函数 - 聚合函数</span>
<span class="token comment">-- 假设有一个学生表 `student`，包含以下字段：`id`（学号）、`name`（姓名）、`class_id`（班级编号）、`score`（成绩）。请你编写一个 SQL 查询，汇总学生表中所有学生的总成绩（total_score）、平均成绩（avg_score）、最高成绩（max_score）和最低成绩（min_score）。</span>
<span class="token keyword">select</span> <span class="token function">sum</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">as</span> total_score<span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">as</span> avg_score<span class="token punctuation">,</span> <span class="token function">max</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">as</span> max_score<span class="token punctuation">,</span> <span class="token function">min</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">as</span> min_score <span class="token keyword">from</span> student
<span class="token comment">-- 分组聚合 - 单字段分组</span>
<span class="token comment">-- 假设有一个学生表 `student`，包含以下字段：`id`（学号）、`name`（姓名）、`class_id`（班级编号）、`score`（成绩）。请你编写一个 SQL 查询，统计学生表中的班级编号（class_id）和每个班级的平均成绩（avg_score）。</span>
<span class="token keyword">select</span> class_id<span class="token punctuation">,</span>  <span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">as</span> avg_score <span class="token keyword">from</span> student <span class="token keyword">group</span> <span class="token keyword">by</span> class_id
<span class="token comment">-- 分组聚合 - 多字段分组</span>
<span class="token comment">-- 假设有一个学生表 `student`，包含以下字段：`id`（学号）、`name`（姓名）、`class_id`（班级编号）、`exam_num`（考试次数）、`score`（成绩）。请你编写一个 SQL 查询，统计学生表中的班级编号（class_id），考试次数（exam_num）和每个班级每次考试的总学生人数（total_num）。</span>
<span class="token keyword">select</span> 
class_id<span class="token punctuation">,</span> exam_num<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> total_num 
<span class="token keyword">from</span> student 
<span class="token keyword">group</span> <span class="token keyword">by</span> class_id<span class="token punctuation">,</span> exam_num
<span class="token comment">-- 分组聚合 - having 子句</span>
<span class="token comment">-- 假设有一个学生表 `student`，包含以下字段：`id`（学号）、`name`（姓名）、`class_id`（班级编号）、`score`（成绩）。请你编写一个 SQL 查询，统计学生表中班级的总成绩超过 150 分的班级编号（class_id）和总成绩（total_score）。</span>
<span class="token keyword">select</span> 
class_id<span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">as</span> total_score 
<span class="token keyword">from</span> student 
<span class="token keyword">group</span> <span class="token keyword">by</span> class_id
<span class="token keyword">having</span> total_score <span class="token operator">&gt;</span> <span class="token number">150</span>
<span class="token comment">-- 查询进阶 - 关联查询 - cross join</span>
<span class="token comment">-- 假设有一个学生表 `student` ，包含以下字段：id（学号）、name（姓名）、age（年龄）、class_id（班级编号）；还有一个班级表 `class` ，包含以下字段：id（班级编号）、name（班级名称）。请你编写一个 SQL 查询，将学生表和班级表的所有行组合在一起，并返回学生姓名（student_name）、学生年龄（student_age）、班级编号（class_id）以及班级名称（class_name）。</span>
<span class="token keyword">select</span> s<span class="token punctuation">.</span>name <span class="token keyword">as</span> student_name<span class="token punctuation">,</span> s<span class="token punctuation">.</span>age <span class="token keyword">as</span> student_age<span class="token punctuation">,</span> s<span class="token punctuation">.</span>class_id<span class="token punctuation">,</span> c<span class="token punctuation">.</span>name <span class="token keyword">as</span> class_name
<span class="token keyword">from</span> student s
<span class="token keyword">cross</span> <span class="token keyword">join</span> class c
<span class="token comment">-- 查询进阶 - 关联查询 - inner join</span>
<span class="token comment">-- 假设有一个学生表 `student`，包含以下字段：`id`（学号）、`name`（姓名）、`age`（年龄）、`class_id`（班级编号）。还有一个班级表 `class`，包含以下字段：`id`（班级编号）、`name`（班级名称）、`level`（班级级别）。请你编写一个 SQL 查询，根据学生表和班级表之间的班级编号进行匹配，返回学生姓名（`student_name`）、学生年龄（`student_age`）、班级编号（`class_id`）、班级名称（`class_name`）、班级级别（`class_level`）。</span>
<span class="token keyword">select</span> s<span class="token punctuation">.</span>name <span class="token keyword">as</span> student_name<span class="token punctuation">,</span> s<span class="token punctuation">.</span>age <span class="token keyword">as</span> student_age<span class="token punctuation">,</span> s<span class="token punctuation">.</span>class_id<span class="token punctuation">,</span> c<span class="token punctuation">.</span>name <span class="token keyword">as</span> class_name<span class="token punctuation">,</span> c<span class="token punctuation">.</span><span class="token keyword">level</span> <span class="token keyword">as</span> class_level
<span class="token keyword">from</span> student s
<span class="token keyword">join</span> class c <span class="token keyword">on</span> s<span class="token punctuation">.</span>class_id <span class="token operator">=</span> c<span class="token punctuation">.</span>id
<span class="token comment">-- 查询进阶 - 关联查询 - outer join</span>
<span class="token comment">-- 假设有一个学生表 `student`，包含以下字段：`id`（学号）、`name`（姓名）、`age`（年龄）、`class_id`（班级编号）。还有一个班级表 `class`，包含以下字段：`id`（班级编号）、`name`（班级名称）、`level`（班级级别）。请你编写一个 SQL 查询，根据学生表和班级表之间的班级编号进行匹配，返回学生姓名（`student_name`）、学生年龄（`student_age`）、班级编号（`class_id`）、班级名称（`class_name`）、班级级别（`class_level`），要求必须返回所有学生的信息（即使对应的班级编号不存在）。</span>
<span class="token keyword">select</span> s<span class="token punctuation">.</span>name <span class="token keyword">as</span> student_name<span class="token punctuation">,</span> s<span class="token punctuation">.</span>age <span class="token keyword">as</span> student_age<span class="token punctuation">,</span> s<span class="token punctuation">.</span>class_id<span class="token punctuation">,</span> c<span class="token punctuation">.</span>name <span class="token keyword">as</span> class_name<span class="token punctuation">,</span> c<span class="token punctuation">.</span><span class="token keyword">level</span> <span class="token keyword">as</span> class_level
<span class="token keyword">from</span> student s
<span class="token keyword">left</span> <span class="token keyword">join</span> class c <span class="token keyword">on</span> s<span class="token punctuation">.</span>class_id <span class="token operator">=</span> c<span class="token punctuation">.</span>id
<span class="token comment">-- 查询进阶 - 子查询</span>
<span class="token comment">-- 假设有一个学生表 `student`，包含以下字段：`id`（学号）、`name`（姓名）、`age`（年龄）、`score`（分数）、`class_id`（班级编号）。还有一个班级表 `class`，包含以下字段：`id`（班级编号）、`name`（班级名称）。请你编写一个 SQL 查询，使用子查询的方式来获取存在对应班级的学生的所有数据，返回学生姓名（`name`）、分数（`score`）、班级编号（`class_id`）字段。</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span> score<span class="token punctuation">,</span> class_id
<span class="token keyword">from</span> student
<span class="token keyword">where</span> class_id <span class="token operator">in</span> <span class="token punctuation">(</span>
    <span class="token keyword">select</span> id 
    <span class="token keyword">from</span> class
<span class="token punctuation">)</span>
<span class="token comment">-- 查询进阶 - 子查询 - exists</span>
<span class="token comment">-- 假设有一个学生表 `student`，包含以下字段：`id`（学号）、`name`（姓名）、`age`（年龄）、`score`（分数）、`class_id`（班级编号）。还有一个班级表 `class`，包含以下字段：`id`（班级编号）、`name`（班级名称）。请你编写一个 SQL 查询，使用 exists 子查询的方式来获取 **不存在对应班级的** 学生的所有数据，返回学生姓名（`name`）、年龄（`age`）、班级编号（`class_id`）字段。</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> class_id
<span class="token keyword">from</span> student
<span class="token keyword">where</span> <span class="token operator">not</span> <span class="token keyword">exists</span> <span class="token punctuation">(</span>
    <span class="token keyword">select</span> id
    <span class="token keyword">from</span> class
    <span class="token keyword">where</span> class<span class="token punctuation">.</span>id <span class="token operator">=</span> student<span class="token punctuation">.</span>class_id
<span class="token punctuation">)</span>
<span class="token comment">-- 查询进阶 - 组合查询</span>
<span class="token comment">-- 假设有一个学生表 `student`，包含以下字段：`id`（学号）、`name`（姓名）、`age`（年龄）、`score`（分数）、`class_id`（班级编号）。还有一个新学生表 `student_new`，包含的字段和学生表完全一致。请编写一条 SQL 语句，获取所有学生表和新学生表的学生姓名（`name`）、年龄（`age`）、分数（`score`）、班级编号（`class_id`）字段，要求保留重复的学生记录。</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> score<span class="token punctuation">,</span> class_id 
<span class="token keyword">from</span> student
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> score<span class="token punctuation">,</span> class_id 
<span class="token keyword">from</span> student_new
<span class="token comment">-- 查询进阶 - 开窗函数 - sum over</span>
<span class="token comment">-- 假设有一个学生表 `student`，包含以下字段：`id`（学号）、`name`（姓名）、`age`（年龄）、`score`（分数）、`class_id`（班级编号）。请你编写一个 SQL 查询，返回每个学生的详细信息（字段顺序和原始表的字段顺序一致），并计算每个班级的学生平均分（class_avg_score）。</span>
<span class="token keyword">select</span> id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> score<span class="token punctuation">,</span> class_id<span class="token punctuation">,</span>
 <span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> class_id<span class="token punctuation">)</span> <span class="token keyword">as</span> class_avg_score
<span class="token keyword">from</span> student
<span class="token comment">-- 查询进阶 - 开窗函数 - sum over order by</span>
<span class="token comment">-- 假设有一个学生表 `student`，包含以下字段：`id`（学号）、`name`（姓名）、`age`（年龄）、`score`（分数）、`class_id`（班级编号）。请你编写一个 SQL 查询，返回每个学生的详细信息（字段顺序和原始表的字段顺序一致），并且按照分数升序的方式累加计算每个班级的学生总分（class_sum_score）。</span>
<span class="token keyword">select</span> id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> score<span class="token punctuation">,</span> class_id<span class="token punctuation">,</span> 
<span class="token function">sum</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> class_id <span class="token keyword">order</span> <span class="token keyword">by</span> score <span class="token keyword">asc</span><span class="token punctuation">)</span> <span class="token keyword">as</span> class_sum_score
<span class="token keyword">from</span> student
<span class="token comment">-- 查询进阶 - 开窗函数 - rank</span>
<span class="token comment">-- 假设有一个学生表 `student`，包含以下字段：`id`（学号）、`name`（姓名）、`age`（年龄）、`score`（分数）、`class_id`（班级编号）。请你编写一个 SQL 查询，返回每个学生的详细信息（字段顺序和原始表的字段顺序一致），并且按照分数降序的方式计算每个班级内的学生的分数排名（ranking）。</span>
<span class="token keyword">select</span> id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> score<span class="token punctuation">,</span> class_id<span class="token punctuation">,</span>
rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> class_id <span class="token keyword">order</span> <span class="token keyword">by</span> score <span class="token keyword">desc</span><span class="token punctuation">)</span> <span class="token keyword">as</span> ranking
<span class="token keyword">from</span> student
<span class="token comment">-- 查询进阶 - 开窗函数 - row_number</span>
<span class="token comment">-- 假设有一个学生表 `student`，包含以下字段：`id`（学号）、`name`（姓名）、`age`（年龄）、`score`（分数）、`class_id`（班级编号）。请你编写一个 SQL 查询，返回每个学生的详细信息（字段顺序和原始表的字段顺序一致），并且按照分数降序的方式给每个班级内的学生分配一个编号（row_number）。</span>
<span class="token keyword">select</span> id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> score<span class="token punctuation">,</span> class_id<span class="token punctuation">,</span>
row_number<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> class_id <span class="token keyword">order</span> <span class="token keyword">by</span> score <span class="token keyword">desc</span><span class="token punctuation">)</span> <span class="token keyword">as</span> row_number
<span class="token keyword">from</span> student
<span class="token comment">-- 查询进阶 - 开窗函数 - lag / lead</span>
<span class="token comment">-- 假设有一个学生表 `student`，包含以下字段：`id`（学号）、`name`（姓名）、`age`（年龄）、`score`（分数）、`class_id`（班级编号）。请你编写一个 SQL 查询，返回每个学生的详细信息（字段顺序和原始表的字段顺序一致），并且按照分数降序的方式获取每个班级内的学生的前一名学生姓名（prev_name）、后一名学生姓名（next_name）。</span>
<span class="token keyword">select</span> id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> score<span class="token punctuation">,</span> class_id<span class="token punctuation">,</span>
lag<span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> class_id <span class="token keyword">order</span> <span class="token keyword">by</span> score <span class="token keyword">desc</span><span class="token punctuation">)</span> <span class="token keyword">as</span> prev_name<span class="token punctuation">,</span>
lead<span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> class_id <span class="token keyword">order</span> <span class="token keyword">by</span> score <span class="token keyword">desc</span><span class="token punctuation">)</span> <span class="token keyword">as</span> next_name
<span class="token keyword">from</span> student
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d726abd5b88b2d1eb291d126819984c8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【数据仓库】血缘关系分析工具适用场景、常见产品、功能介绍</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bacfa7bfe6fc816c21ba769ad4ce9ef4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【C&#43;&#43;学习】哈希表的底层实现及其在unordered_set与unordered_map中的封装</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>