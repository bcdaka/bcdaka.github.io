<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【微信小程序开发】小程序更新、页面生命周期、用户信息获取应用实战 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/0de80014e6cb8f01694301b8233df586/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【微信小程序开发】小程序更新、页面生命周期、用户信息获取应用实战">
  <meta property="og:description" content="✨✨ 欢迎大家来到景天科技苑✨✨
🎈🎈 养成好习惯，先赞后看哦~🎈🎈
🏆 作者简介：景天科技苑
🏆《头衔》：大厂架构师，华为云开发者社区专家博主，阿里云开发者社区专家博主，CSDN全栈领域优质创作者，掘金优秀博主，51CTO博客专家等。
🏆《博客》：Python全栈，前后端开发，小程序开发，人工智能，js逆向，App逆向，网络系统安全，数据分析，Django，fastapi，flask等框架，linux，shell脚本等实操经验，网站搭建，数据库等分享。
所属的专栏：微信小程序开发零基础教学，难点与应用实战总结
景天的主页：景天科技苑
文章目录 1.小程序更新-生命周期1.1 小程序强制更新1.2 整个应用生命周期 app.js1.3 某个页面生命周期 页面.js 2.分享到朋友圈3.转发功能4.获取头像5.获取昵称6.获取手机号6.1 手机号快速验证6.2 手机号实时验证6.3 代码演示 7.客服功能 1.小程序更新-生命周期 1.1 小程序强制更新 后续我们代码更新
如果我们在微信端使用过小程序–》微信会把小程序代码拉到微信本地
下次打开，会优先使用本地的代码
咱们代码更新了–》强制更新到我们最先的代码
此时，只需要在 app.js 加入如下代码–》整个小程序第一次打开
onLaunch(){ const update=wx.getUpdateManager() update.onUpdateReady(function(){ wx.showModal({ title: &#39;发现新版本&#39;, content: &#39;重启应用，更新版本新版本?&#39;, success:(res)=&gt;{ if(res.confirm){ update.applyUpdate() } } }) }) } 怎么模拟出更新的效果呢？在开发者工具中 添加编译模式
将编译设置中 下次编译时模拟更新勾上，点击确定
然后就会看到小程序有弹窗，要求强制更新，是否重启应用。点确定 就会重启小程序，下载最新的版本
1.2 整个应用生命周期 app.js 我们在app.js里面将我们上面设置的强制更新删掉
输入App，点击这个带框的，就会自动生成各种生命周期函数
App({ /** * 当小程序初始化完成时，会触发 onLaunch（全局只触发一次） */ onLaunch: function () { console.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-06T07:15:00+08:00">
    <meta property="article:modified_time" content="2024-06-06T07:15:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【微信小程序开发】小程序更新、页面生命周期、用户信息获取应用实战</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/18/dc/Li6xz5AP_o.jpg" alt="在这里插入图片描述"></p> 
<p><strong>✨✨ 欢迎大家来到景天科技苑✨✨</strong></p> 
<p><strong>🎈🎈 养成好习惯，先赞后看哦~🎈🎈</strong></p> 
<blockquote> 
 <p>🏆 作者简介：景天科技苑<br> 🏆《头衔》：大厂架构师，华为云开发者社区专家博主，阿里云开发者社区专家博主，CSDN全栈领域优质创作者，掘金优秀博主，51CTO博客专家等。<br> 🏆《博客》：Python全栈，前后端开发，小程序开发，人工智能，js逆向，App逆向，网络系统安全，数据分析，Django，fastapi，flask等框架，linux，shell脚本等实操经验，网站搭建，数据库等分享。</p> 
 <p><strong>所属的专栏：</strong><a href="https://blog.csdn.net/littlefun591/category_12650706.html?spm=1001.2014.3001.5482">微信小程序开发零基础教学，难点与应用实战总结</a><br> <strong>景天的主页：</strong><a href="https://jingtian.blog.csdn.net/" rel="nofollow">景天科技苑</a></p> 
</blockquote> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#1_20" rel="nofollow">1.小程序更新-生命周期</a></li><li><ul><li><a href="#11__22" rel="nofollow">1.1 小程序强制更新</a></li><li><a href="#12___appjs_68" rel="nofollow">1.2 整个应用生命周期 app.js</a></li><li><a href="#13__js_113" rel="nofollow">1.3 某个页面生命周期 页面.js</a></li></ul> 
  </li><li><a href="#2_161" rel="nofollow">2.分享到朋友圈</a></li><li><a href="#3_189" rel="nofollow">3.转发功能</a></li><li><a href="#4_227" rel="nofollow">4.获取头像</a></li><li><a href="#5_299" rel="nofollow">5.获取昵称</a></li><li><a href="#6_365" rel="nofollow">6.获取手机号</a></li><li><ul><li><a href="#61__384" rel="nofollow">6.1 手机号快速验证</a></li><li><a href="#62__390" rel="nofollow">6.2 手机号实时验证</a></li><li><a href="#63__394" rel="nofollow">6.3 代码演示</a></li></ul> 
  </li><li><a href="#7_467" rel="nofollow">7.客服功能</a></li></ul> 
</div> 
<p></p> 
<h2><a id="1_20"></a>1.小程序更新-生命周期</h2> 
<h3><a id="11__22"></a>1.1 小程序强制更新</h3> 
<p>后续我们代码更新<br> 如果我们在微信端使用过小程序–》微信会把小程序代码拉到微信本地<br> 下次打开，会优先使用本地的代码<br> 咱们代码更新了–》强制更新到我们最先的代码</p> 
<p>此时，只需要在 app.js 加入如下代码–》整个小程序第一次打开</p> 
<pre><code class="prism language-javascript"><span class="token function">onLaunch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> update<span class="token operator">=</span>wx<span class="token punctuation">.</span><span class="token function">getUpdateManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    update<span class="token punctuation">.</span><span class="token function">onUpdateReady</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        wx<span class="token punctuation">.</span><span class="token function">showModal</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'发现新版本'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token string">'重启应用，更新版本新版本?'</span><span class="token punctuation">,</span>
            <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>confirm<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    update<span class="token punctuation">.</span><span class="token function">applyUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/4f/ef/xM7DIBQ0_o.png" alt="在这里插入图片描述"></p> 
<p>怎么模拟出更新的效果呢？在开发者工具中 添加编译模式<br> <img src="https://images2.imgbox.com/32/36/OQ3zWvey_o.png" alt="在这里插入图片描述"></p> 
<p>将编译设置中 下次编译时模拟更新勾上，点击确定<br> <img src="https://images2.imgbox.com/39/46/XehE4lxl_o.png" alt="在这里插入图片描述"></p> 
<p>然后就会看到小程序有弹窗，要求强制更新，是否重启应用。点确定 就会重启小程序，下载最新的版本<br> <img src="https://images2.imgbox.com/63/a6/KRAk3uXN_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="12___appjs_68"></a>1.2 整个应用生命周期 app.js</h3> 
<p>我们在app.js里面将我们上面设置的强制更新删掉<br> 输入App，点击这个带框的，就会自动生成各种生命周期函数<br> <img src="https://images2.imgbox.com/cb/b7/vPRTsAEV_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/5b/c3/yJAuPCqu_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-javascript"><span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>

  <span class="token comment">/**
   * 当小程序初始化完成时，会触发 onLaunch（全局只触发一次）
   */</span>
  <span class="token function-variable function">onLaunch</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'小程序只要启动，就触发它'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 当小程序启动，或从后台进入前台显示，会触发 onShow
   */</span>
  <span class="token function-variable function">onShow</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'小程序切回来了'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 当小程序从前台进入后台，会触发 onHide
   */</span>
  <span class="token function-variable function">onHide</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'小程序切到后台了'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 当小程序发生脚本错误，或者 api 调用失败时，会触发 onError 并带上错误信息
   */</span>
  <span class="token function-variable function">onError</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="13__js_113"></a>1.3 某个页面生命周期 页面.js</h3> 
<pre><code class="prism language-javascript">  <span class="token comment">/**
   * 生命周期函数--监听页面加载
   */</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1 页面加载了'</span><span class="token punctuation">)</span>
    <span class="token comment">// 向后端发送请求</span>
    
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 生命周期函数--监听页面初次渲染完成
   */</span>
  <span class="token function-variable function">onReady</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'3 初次渲染完成'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 生命周期函数--监听页面显示
   */</span>
  <span class="token function-variable function">onShow</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'2 页面显示'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 生命周期函数--监听页面隐藏
   */</span>
  <span class="token function-variable function">onHide</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'4 页面隐藏'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 生命周期函数--监听页面卸载
   */</span>
  <span class="token function-variable function">onUnload</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'5 页面卸载'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<h2><a id="2_161"></a>2.分享到朋友圈</h2> 
<p>当我们点击小程序右上角三个点时，会弹出分享小程序等按钮<br> 由于我们的小程序中未设置，所以图标是灰色的，没有分享功能<br> <img src="https://images2.imgbox.com/f2/e4/FkYWmoLE_o.png" alt="在这里插入图片描述"></p> 
<p>分享到朋友圈，需要在当前页面的js中加上一段代码如下：</p> 
<pre><code class="prism language-javascript"><span class="token comment">// 允许发送到朋友圈，右上角 ... 分享到朋友圈</span>
<span class="token function">onShareTimeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">title</span><span class="token operator">:</span><span class="token string">"这是一个神奇的页面"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">query</span><span class="token operator">:</span><span class="token string">'name=justin&amp;age=19'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">imageUrl</span><span class="token operator">:</span><span class="token string">'/images/b.jpg'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e2/c1/KvwYpMMa_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/32/b1/hxwqTxoa_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="3_189"></a>3.转发功能</h2> 
<p>1 方式一：通过右上方 …<br> 2 方式二：通过按钮， 需要给button设置 open-type=“share”</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">open-type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>share<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>转发<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>3 js中编写</p> 
<pre><code class="prism language-javascript">  <span class="token function">onShareAppMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">title</span><span class="token operator">:</span><span class="token string">"是朋友就点一下"</span><span class="token punctuation">,</span>
      <span class="token literal-property property">path</span><span class="token operator">:</span><span class="token string">"/pages/my/my"</span><span class="token punctuation">,</span> <span class="token comment">//当前转发的页面</span>
      <span class="token literal-property property">imageUrl</span><span class="token operator">:</span><span class="token string">'/images/b.jpg'</span>
    <span class="token punctuation">}</span>

  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/35/17/GUZkgZh9_o.png" alt="在这里插入图片描述"></p> 
<p>点击转发，会显示出我们设置的图片和主题<br> <img src="https://images2.imgbox.com/d8/36/UUe0qmCi_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="4_227"></a>4.获取头像</h2> 
<p>#####wxml###</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn<span class="token punctuation">"</span></span> <span class="token attr-name">open-type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>chooseAvatar<span class="token punctuation">"</span></span> <span class="token attr-name">bindchooseavatar</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>choosePhoto<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{phono}}<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>photo<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>点击图片的时候获取头像<br> <img src="https://images2.imgbox.com/34/75/ki5Ew2y1_o.png" alt="在这里插入图片描述"></p> 
<p>####js###</p> 
<pre><code class="prism language-javascript"><span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">phono</span><span class="token operator">:</span><span class="token string">'/images/b.jpg'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">choosePhoto</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>avatarUrl<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">phono</span><span class="token operator">:</span>event<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>avatarUrl  <span class="token comment">//将获取到的头像设置到按钮位置</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/34/ce/GMQSgr2O_o.png" alt="在这里插入图片描述"></p> 
<p>###wxss###</p> 
<pre><code class="prism language-css"><span class="token selector">.btn</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">/* 透明的 */</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> transparent<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 去掉边框 */</span>
<span class="token selector">.btn::after</span><span class="token punctuation">{<!-- --></span>
  <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.photo</span><span class="token punctuation">{<!-- --></span>
  <span class="token property">height</span><span class="token punctuation">:</span> 250rpx<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 250rpx<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ce/fb/9MmRs3E1_o.png" alt="在这里插入图片描述"></p> 
<p>一点击按钮，就让你选择头像来源，可以是微信头像，可以拍照，可以从相册选<br> <img src="https://images2.imgbox.com/7c/ae/C3BdIEgP_o.png" alt="在这里插入图片描述"></p> 
<p>我们选择用微信头像，微信头像就被设置到按钮位置<br> 如果想用这个图片，可以传到后端保存起来<br> <img src="https://images2.imgbox.com/7f/b5/tWubxyod_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="5_299"></a>5.获取昵称</h2> 
<p>###wxml###</p> 
<pre><code class="prism language-html"><span class="token comment">&lt;!-- type一定得是 nickname --&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>  <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nickname<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>输入或获取昵称<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">model:</span>value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{username}}<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span> <span class="token attr-name">plain</span> <span class="token attr-name"><span class="token namespace">bind:</span>tap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>showName<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>提交<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c3/6a/Ym8qnUt6_o.png" alt="在这里插入图片描述"></p> 
<p>###js####</p> 
<pre><code class="prism language-javascript"><span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">username</span><span class="token operator">:</span><span class="token string">""</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>username<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d7/00/oSe9bgdD_o.png" alt="在这里插入图片描述"></p> 
<p>###wxss##</p> 
<pre><code class="prism language-css"><span class="token selector">input</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">border</span><span class="token punctuation">:</span> 1rpx solid pink<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/15/88/DHXYXRMs_o.png" alt="在这里插入图片描述"></p> 
<p>如此，当我们点击输入或获取用户名时，就会弹出微信昵称<br> <img src="https://images2.imgbox.com/97/5d/yRXiIqCt_o.png" alt="在这里插入图片描述"></p> 
<p>选择，就会填到输入框中<br> <img src="https://images2.imgbox.com/66/59/97UJuMet_o.png" alt="在这里插入图片描述"></p> 
<p>点击提交，根据js设置的绑定事件，就会在控制台打印出来<br> <img src="https://images2.imgbox.com/8a/62/2HOdFLOu_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="6_365"></a>6.获取手机号</h2> 
<p>快速登录</p> 
<ul><li>前后端配合</li><li>前端配合获取手机号–》带着code到后端</li><li>后端：注册+登录接口 
  <ul><li>后端你通过code–》去微信开发平台–》获取真正手机号</li><li>检测你用户表，这个用户有没有注册过，如果注册过，直接签发token登录成功</li><li>检测你用户表，这个用户有没有注册过，如果没有注册，先注册，再签发token登录成功</li></ul> </li></ul> 
<p>前提<br> 1 手机号接口，必须是非个人开发者，并且完成了认证的小程序 个人注册的小程序无法获取<br> 2 两种验证方式需要付费使用，每个小程序账号有1000次体验额度</p> 
<p>3 小程序端<br> https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/getPhoneNumber.html</p> 
<h3><a id="61__384"></a>6.1 手机号快速验证</h3> 
<p>如下图<br> <img src="https://images2.imgbox.com/7b/55/1Fp2025F_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="62__390"></a>6.2 手机号实时验证</h3> 
<p>给你手机发送验证码–》输入验证码后–》才能获取到手机号</p> 
<h3><a id="63__394"></a>6.3 代码演示</h3> 
<p>后端获取手机号的接口</p> 
<p>POST https://api.weixin.qq.com/wxa/business/getuserphonenumber?access_token=ACCESS_TOKEN</p> 
<p>###微信小程序端<br> ###wxml###</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>  <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>warn<span class="token punctuation">"</span></span> <span class="token attr-name">open-type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>getPhoneNumber<span class="token punctuation">"</span></span> 
<span class="token attr-name">bindgetphonenumber</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>getPhoneNumber<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>快速手机号<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>  <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>default<span class="token punctuation">"</span></span> <span class="token attr-name">plain</span> <span class="token attr-name">open-type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>getRealtimePhoneNumber<span class="token punctuation">"</span></span>
<span class="token attr-name">bindgetrealtimephonenumber</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>getRealPhoneNumber<span class="token punctuation">"</span></span>
<span class="token punctuation">&gt;</span></span>实时手机号<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>###js###</p> 
<pre><code class="prism language-javascript"><span class="token function">getPhoneNumber</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    <span class="token comment">// 通过获取手机号返回的code--传递给后端--后端调用：POST https://api.weixin.qq.com/wxa/business/getuserphonenumber?access_token=ACCESS_TOKEN --&gt;获取手机号--》后端签发token给前端</span>

    云调用
    wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'我们后端地址'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">method</span><span class="token operator">:</span><span class="token string">'POST'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">code</span><span class="token operator">:</span>event<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>code
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//在此返回登录信息，用户登录</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">getRealPhoneNumber</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/16/35/eVubeji1_o.png" alt="在这里插入图片描述"></p> 
<p>需要真机调试，个人小程序会提示没有权限<br> <img src="https://images2.imgbox.com/9f/81/27P3UKmT_o.png" alt="在这里插入图片描述"></p> 
<p>如果是企业小程序，有权限的话，会获取服务端返回的一串code<br> <img src="https://images2.imgbox.com/1a/5c/ok1Uh48c_o.png" alt="在这里插入图片描述"></p> 
<p>当我们向微信后台发送请求的时候，请求参数里面携带上这个code。就会获取到手机号<br> <img src="https://images2.imgbox.com/c1/3d/mvrGUmKn_o.png" alt="在这里插入图片描述"></p> 
<p>官方给的获取手机号接口<br> <img src="https://images2.imgbox.com/d9/97/FQ6mPt3c_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/0f/46/d3u6xShI_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="7_467"></a>7.客服功能</h2> 
<p>微信为小程序提供客服消息能力，以便小程序用户可以方便快捷地与小程序服务提供方进行沟通<br> https://developers.weixin.qq.com/miniprogram/introduction/custom.html</p> 
<p><img src="https://images2.imgbox.com/46/22/dPRjCPNO_o.png" alt="在这里插入图片描述"></p> 
<p>需要我们登录微信公众平台<br> 点击客服，添加客服<br> <img src="https://images2.imgbox.com/52/80/K1VIKx1d_o.png" alt="在这里插入图片描述"></p> 
<p>输入微信id号，添加客服<br> <img src="https://images2.imgbox.com/71/21/FvgPzIvN_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/14/b3/fwN1CsY2_o.png" alt="在这里插入图片描述"></p> 
<p>点击确定，添加成功<br> <img src="https://images2.imgbox.com/95/74/f9dhTUOW_o.png" alt="在这里插入图片描述"></p> 
<p>在微信小程序界面，添加个按钮</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>---------------------客服-------------------<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>default<span class="token punctuation">"</span></span> <span class="token attr-name">plain</span> <span class="token attr-name">open-type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>contact<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>联系客服<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p><img src="https://images2.imgbox.com/13/51/XWaoeG4q_o.png" alt="在这里插入图片描述"></p> 
<p>需要真机调试，用手机点击联系客服按钮<br> <img src="https://images2.imgbox.com/91/80/BKD21oe4_o.png" alt="在这里插入图片描述"></p> 
<p>然后在微信公众平台，登录查看客服消息<br> <img src="https://images2.imgbox.com/91/c3/vUTqzHwn_o.png" alt="在这里插入图片描述"></p> 
<p>看到待接入 1人<br> <img src="https://images2.imgbox.com/11/07/a1RXn1Sc_o.png" alt="在这里插入图片描述"></p> 
<p>接入，就可以看到用户消息<br> <img src="https://images2.imgbox.com/79/4c/SYgB8Rbv_o.png" alt="在这里插入图片描述"></p> 
<p>就可以与用户对话了<br> <img src="https://images2.imgbox.com/c2/82/PGmfBnJr_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/843959992be1f236928f0b1ab083a17a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">神经网络应用与实战案例详解（AIGC技术方向）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fe98f5b3e55709f4136981f297125ca8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">湖南（品牌控价）源点调研 手机价格管理对品牌的影响分析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>