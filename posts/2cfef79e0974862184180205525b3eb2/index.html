<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>JDBC如何连接SQL Server数据库实现增删改查 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/2cfef79e0974862184180205525b3eb2/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="JDBC如何连接SQL Server数据库实现增删改查">
  <meta property="og:description" content="目录
一、连接前准备
1. 环境配置
2. 下载JAR包
3. 添加环境变量
4. 导入JDBC包
二、连接SQL Server
三、实现增删改查
1. 查询数据
2. 添加数据
3. 修改数据
4. 删除数据
5. 拓展
JDBC的全称是Java数据库连接(Java DataBase Connectivity) ，应用程序通过JDBC连接到数据库，使用SQL语句对数据库中的表进行查询、增加、修改、删除等操作。此文章提供JDBC连接SQL Server的所有步骤，帮助大家实现Java对数据库的增删改查！
JDBC访问数据库的方式 一、连接前准备 1. 环境配置 我们右键点击“开始”菜单打开“计算机管理”，接下来以此打开树形菜单，启用所有协议。
下一步，打开控制面版—&gt;程序—&gt;程序与功能—&gt;启用或关闭Windows功能 —&gt;勾选 Telnet客户端
接下来，重启计算机，在此之前请务必点击“收藏”或“关注”，以免找不到下一步教程。
重启后，按Win&#43;R，输入cmd后按回车，输入命令：
telnet localhost 1433 进入只有光标闪烁的空白页面即通信成功。
2. 下载JAR包 下面讲解的方法都是基于 IntelliJ IDEA 软件，如果是 Eclipse 会有细微差别。
首先，在连接JDBC之前，需要下载MS JDBC Driver包，下载地址：下载 Microsoft SQL Server JDBC 驱动程序https://learn.microsoft.com/zh-cn/sql/connect/jdbc/download-microsoft-jdbc-driver-for-sql-server
那么如何选择正确的JDBC呢？
请参照以下对应规则下载相应的JDBC驱动版本。
从 Microsoft JDBC Driver 12.2 for SQL Server 开始，支持 Java 开发工具包 (JDK) 19.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-11T18:24:59+08:00">
    <meta property="article:modified_time" content="2024-01-11T18:24:59+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">JDBC如何连接SQL Server数据库实现增删改查</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E4%B8%80%E3%80%81%E8%BF%9E%E6%8E%A5%E5%89%8D%E5%87%86%E5%A4%87-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81%E8%BF%9E%E6%8E%A5%E5%89%8D%E5%87%86%E5%A4%87" rel="nofollow">一、连接前准备</a></p> 
<p id="%C2%A01.%20%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE-toc" style="margin-left:40px;"><a href="#%C2%A01.%20%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE" rel="nofollow"> 1. 环境配置</a></p> 
<p id="%C2%A02.%20%E5%AF%BC%E5%85%A5JDBC%20Driver%E5%8C%85-toc" style="margin-left:40px;"><a href="#%C2%A02.%20%E5%AF%BC%E5%85%A5JDBC%20Driver%E5%8C%85" rel="nofollow"> 2. 下载JAR包</a></p> 
<p id="3.%20%E6%B7%BB%E5%8A%A0%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F-toc" style="margin-left:40px;"><a href="#3.%20%E6%B7%BB%E5%8A%A0%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F" rel="nofollow">3. 添加环境变量</a></p> 
<p id="4.%20%E5%AF%BC%E5%85%A5JDBC%E5%8C%85-toc" style="margin-left:40px;"><a href="#4.%20%E5%AF%BC%E5%85%A5JDBC%E5%8C%85" rel="nofollow">4. 导入JDBC包</a></p> 
<p id="%C2%A0%E4%BA%8C%E3%80%81%E8%BF%9E%E6%8E%A5SQL%20Server-toc" style="margin-left:0px;"><a href="#%C2%A0%E4%BA%8C%E3%80%81%E8%BF%9E%E6%8E%A5SQL%20Server" rel="nofollow"> 二、连接SQL Server</a></p> 
<p id="%C2%A0%E4%B8%89%E3%80%81%E5%AE%9E%E7%8E%B0%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5-toc" style="margin-left:0px;"><a href="#%C2%A0%E4%B8%89%E3%80%81%E5%AE%9E%E7%8E%B0%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5" rel="nofollow"> 三、实现增删改查</a></p> 
<p id="1.%20%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE-toc" style="margin-left:40px;"><a href="#1.%20%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE" rel="nofollow">1. 查询数据</a></p> 
<p id="2.%20%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE-toc" style="margin-left:40px;"><a href="#2.%20%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE" rel="nofollow">2. 添加数据</a></p> 
<p id="3.%20%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE-toc" style="margin-left:40px;"><a href="#3.%20%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE" rel="nofollow">3. 修改数据</a></p> 
<p id="4.%20%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE-toc" style="margin-left:40px;"><a href="#4.%20%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE" rel="nofollow">4. 删除数据</a></p> 
<p id="5.%20%E6%8B%93%E5%B1%95-toc" style="margin-left:40px;"><a href="#5.%20%E6%8B%93%E5%B1%95" rel="nofollow">5. 拓展</a></p> 
<hr id="hr-toc"> 
<p></p> 
<p>JDBC的全称是Java数据库连接<em>(Java DataBase Connectivity)</em> ，应用程序通过JDBC连接到数据库，使用SQL语句对数据库中的表进行查询、增加、修改、删除等操作。此文章提供JDBC连接SQL Server的所有步骤，帮助大家实现Java对数据库的增删改查！</p> 
<p style="text-align:center;"><img alt="" height="423" src="https://images2.imgbox.com/36/17/Lw7dHAsM_o.png" width="585"></p> 
<p style="text-align:center;"><span style="color:#7b7f82;">JDBC访问数据库的方式</span> </p> 
<h2 id="%E4%B8%80%E3%80%81%E8%BF%9E%E6%8E%A5%E5%89%8D%E5%87%86%E5%A4%87">一、连接前准备</h2> 
<h3 id="%C2%A01.%20%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"> 1. 环境配置</h3> 
<p>我们右键点击“开始”菜单打开“计算机管理”，接下来以此打开树形菜单，启用所有协议。</p> 
<p style="text-align:center;"><img alt="" height="474" src="https://images2.imgbox.com/7f/5b/F2YFgyTc_o.png" width="639"></p> 
<p> 下一步，打开控制面版—&gt;程序—&gt;程序与功能—&gt;启用或关闭Windows功能 —&gt;勾选 Telnet客户端</p> 
<p style="text-align:center;"><img alt="" height="425" src="https://images2.imgbox.com/f2/87/CmLO6VrP_o.png" width="429"></p> 
<p> 接下来，重启计算机，在此之前请务必点击“收藏”或“关注”，以免找不到下一步教程。</p> 
<hr> 
<p> 重启后，按Win+R，输入cmd后按回车，输入命令：</p> 
<pre><code>telnet localhost 1433</code></pre> 
<p>进入只有光标闪烁的空白页面即通信成功。</p> 
<h3 id="%C2%A02.%20%E5%AF%BC%E5%85%A5JDBC%20Driver%E5%8C%85"> 2. 下载JAR包</h3> 
<p style="text-align:justify;">下面讲解的方法都是基于 IntelliJ <em>IDEA </em>软件，如果是 <em>Eclipse </em>会有细微差别。</p> 
<p style="text-align:justify;">首先，在连接JDBC之前，需要下载MS JDBC Driver包，下载地址：<a class="has-card" href="https://learn.microsoft.com/zh-cn/sql/connect/jdbc/download-microsoft-jdbc-driver-for-sql-server" rel="nofollow" title="下载 Microsoft SQL Server JDBC 驱动程序"><span class="link-card-box"><span class="link-title">下载 Microsoft SQL Server JDBC 驱动程序</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/8e/4e/hpmqw089_o.png" alt="icon-default.png?t=N7T8">https://learn.microsoft.com/zh-cn/sql/connect/jdbc/download-microsoft-jdbc-driver-for-sql-server</span></span></a></p> 
<p>那么如何选择正确的JDBC呢？</p> 
<p>请参照以下对应规则下载相应的JDBC驱动版本。</p> 
<pre><code>从 Microsoft JDBC Driver 12.2 for SQL Server 开始，支持 Java 开发工具包 (JDK) 19.0 和 Java Runtime Environment (JRE) 19.0。

从 Microsoft JDBC Driver 11.2 for SQL Server 开始，支持 Java 开发工具包 (JDK) 18.0 和 Java Runtime Environment (JRE) 18.0。

从 Microsoft JDBC Driver 10.2 for SQL Server 开始，支持 Java Development Kit (JDK) 17.0 和 Java Runtime Environment (JRE) 17.0。

从 Microsoft JDBC Driver 9.4 for SQL Server 开始，支持 Java Development Kit (JDK) 16.0 和 Java Runtime Environment (JRE) 16.0。

从 Microsoft JDBC Driver 9.2 for SQL Server 开始，支持 Java Development Kit (JDK) 15.0 和 Java Runtime Environment (JRE) 15.0。

从 Microsoft JDBC Driver 8.4 for SQL Server 开始，支持 Java Development Kit (JDK) 14.0 和 Java Runtime Environment (JRE) 14.0。

从 Microsoft JDBC Driver 8.2 for SQL Server 开始，支持 Java Development Kit (JDK) 13.0 和 Java Runtime Environment (JRE) 13.0。

从 Microsoft JDBC Driver 7.4 for SQL Server 开始，支持 Java Development Kit (JDK) 12.0 和 Java Runtime Environment (JRE) 12.0。

从 Microsoft JDBC Driver 7.2 for SQL Server 开始，支持 Java Development Kit (JDK) 11.0 和 Java Runtime Environment (JRE) 11.0。

从 Microsoft JDBC Driver 7.0 for SQL Server 开始，支持 Java Development Kit (JDK) 10.0 和 Java Runtime Environment (JRE) 10.0。

从 Microsoft JDBC Driver 6.4 for SQL Server 开始，支持 Java Development Kit (JDK) 9.0 和 Java Runtime Environment (JRE) 9.0。

从 Microsoft JDBC Driver 4.2 for SQL Server 开始，支持 Java Development Kit (JDK) 8.0 和 Java Runtime Environment (JRE) 8.0。 对 JDBC 规范 API 的支持已扩展为包含 JDBC 4.1 和 4.2 API。

从 Microsoft JDBC Driver 4.1 for SQL Server 开始，支持 Java Development Kit (JDK) 7.0 和 Java Runtime Environment (JRE) 7.0。

从 Microsoft JDBC Driver 4.0 for SQL Server 开始，JDBC 规范 API 的JDBC 驱动程序支持扩展为包含 JDBC 4.0 API。 已在 Java 开发工具包 (JDK) 6.0 和 Java 运行时环境 (JRE) 6.0 中引入了 JDBC 4.0 API。 JDBC 4.0 是 JDBC 3.0 API 的超集。

</code></pre> 
<p>更详细的与你的JDK版本匹配的JAR包可以从下面的官网文档链接中查找，<a href="https://learn.microsoft.com/zh-cn/sql/connect/jdbc/system-requirements-for-the-jdbc-driver?view=sql-server-ver16" rel="nofollow" title="系统要求 - JDBC Driver for SQL Server | Microsoft Learn">系统要求 - JDBC Driver for SQL Server | Microsoft Learn</a></p> 
<p> 例如下表就准确指定了相应的版本：</p> 
<table><thead><tr><th>JAR</th><th>JDBC 版本法规遵从性</th><th>推荐的 Java 版本</th><th>说明</th></tr></thead><tbody><tr><td>mssql-jdbc-12.4.0.jre8.jar</td><td>4.2</td><td>8</td><td>需要 Java Runtime Environment (JRE) 1.8。 使用 JRE 1.7 或更低版本会引发异常。</td></tr><tr><td>mssql-jdbc-12.4.0.jre11.jar</td><td>4.3</td><td>20</td><td>需要 Java Runtime Environment (JRE) 11.0 或更高版本。 使用 JRE 10.0 或更低版本会引发异常。</td></tr></tbody></table> 
<p>然后在此链接下载合适的jar包：<a class="has-card" href="https://learn.microsoft.com/zh-cn/sql/connect/jdbc/release-notes-for-the-jdbc-driver?view=sql-server-ver16#84" rel="nofollow" title="发行说明 - JDBC Driver for SQL Server | Microsoft Learn"><span class="link-card-box"><span class="link-title">发行说明 - JDBC Driver for SQL Server | Microsoft Learn</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/67/9c/tJXo9HW9_o.png" alt="icon-default.png?t=N7T8">https://learn.microsoft.com/zh-cn/sql/connect/jdbc/release-notes-for-the-jdbc-driver?view=sql-server-ver16#84</span></span></a></p> 
<p>下载完后解压缩并打开，可以在目录中找到后缀名为.jar的文件，即需要导入到项目工程的包。</p> 
<p style="text-align:center;"><img alt="" height="311" src="https://images2.imgbox.com/2f/a2/bNk1B7ZM_o.png" width="345"></p> 
<h3 id="3.%20%E6%B7%BB%E5%8A%A0%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F">3. 添加环境变量</h3> 
<p>在添加两个包含.jar的环境变量，例如：</p> 
<pre><code>变量名：CLASSPATH
变量值：C:\Program Files\Microsoft JDBC Driver 11.2 for SQL Server\sqljdbc_12.2\chs\mssql-jdbc-12.2.0.jre8.jar;C:\Program Files\Microsoft JDBC Driver 11.2 for SQL Server\sqljdbc_12.2\chs\mssql-jdbc-12.2.0.jre11.jar</code></pre> 
<p style="text-align:center;"><img alt="" height="381" src="https://images2.imgbox.com/98/28/Dc1A6y2t_o.png" width="415"></p> 
<p>打开环境变量的方式。Win7：桌面或开始菜单找到“计算机”-&gt;右键单击选择"属性"-&gt;高级系统设置-&gt;环境变量，Win10：设置-&gt;系统-&gt;关于-&gt;高级系统设置-&gt;环境变量，Win11：设置-&gt;系统-&gt;系统信息-&gt;高级系统设置-&gt;环境变量。</p> 
<h3 id="4.%20%E5%AF%BC%E5%85%A5JDBC%E5%8C%85">4. 导入JDBC包</h3> 
<p>然后我们进入IDEA，点击File—&gt;Priject Structure—&gt;Libraries—&gt; + —&gt;Java —&gt;Select Library Files，选择sqljdbc.jar</p> 
<p style="text-align:center;"> <img alt="" height="310" src="https://images2.imgbox.com/d7/46/RZnPxA1X_o.png" width="384"></p> 
<p style="text-align:center;"><img alt="" height="518" src="https://images2.imgbox.com/e2/77/gbBkCUo6_o.png" width="652"></p> 
<p style="text-align:center;"><img alt="" height="331" src="https://images2.imgbox.com/49/91/sHZvv5v5_o.png" width="1040"></p> 
<p style="text-align:center;"><img alt="" height="334" src="https://images2.imgbox.com/f2/d8/vnxVkte7_o.png" width="343"></p> 
<p> 如果能在首页看到External Libraries下面有sqljdbc42即表示导入成功。</p> 
<h2 id="%C2%A0%E4%BA%8C%E3%80%81%E8%BF%9E%E6%8E%A5SQL%20Server"> 二、连接SQL Server</h2> 
<p style="text-align:center;"><img alt="" height="179" src="https://images2.imgbox.com/23/b1/0g9q5U57_o.png" width="602"></p> 
<p style="text-align:center;"> <span style="color:#7b7f82;">JDBC的实现步骤</span></p> 
<p>通过上图我们了解到，想要实现JDBC首先就需要加载并注册数据库驱动。第一步，加载并注册驱动可以通过java.lang.Class类的静态方法forName实现。</p> 
<pre><code class="language-java">Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");</code></pre> 
<p> 第二步，通过DriverManager类的getConnection方法实现数据库连接。</p> 
<pre><code class="language-java">String databaseName = "数据库名";
String username = "用户名";
String password = "密码";
String dbURL = "jdbc:sqlserver://localhost:1433;databaseName=" + databaseName;
Connection conn = DriverManager.getConnection(dbURL, username, password);</code></pre> 
<p>第三步，try…catch抛出异常。</p> 
<pre><code class="language-java">
        try {
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver";);
            String dbURL = "jdbc:sqlserver://localhost:1433;databaseName=" + databaseName;
            Connection conn = DriverManager.getConnection(dbURL, username, password);
            System.out.println("Successful Connection !");
        } catch (Exception e) {
            e.printStackTrace();
            System.out.println("Connection failed !");
        }</code></pre> 
<h2 id="%C2%A0%E4%B8%89%E3%80%81%E5%AE%9E%E7%8E%B0%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5"> 三、实现增删改查</h2> 
<p>实现增删改查之前，为了阅读方便，我们需要新建一个容纳这些功能的类，并且创建两个类变量，方便在各个方法中调用。这里我们将类命名为ConnectionDb，创建Connection对象conn。</p> 
<pre><code class="language-java">public class ConnectDb {
    public Connection conn;
}</code></pre> 
<p>接下来创建四个方法：查询、增加、修改、删除。</p> 
<pre><code class="language-java">public class ConnectDb {
    private Connection conn;
    public void SelectAll(){}//查询表
    public void AddValue(){}//添加数据
    public void DeleteValue(){}//修改数据
    public void ModifyValue(){}//删除数据
}</code></pre> 
<p>下面就是实现方法的代码： </p> 
<h3 id="1.%20%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE">1. 查询数据</h3> 
<pre><code class="language-java">public void SelectAll(String tableName,String where) {
        ResultSetMetaData rsmd = null;
        try {//try catch判断是否有异常
            Statement sqlStatement = conn.createStatement();//创建sql语句
            String sql = "select * from " + tableName+" "+where;
            ResultSet rs = sqlStatement.executeQuery(sql);//执行sql语句
            //下面根据该table输出属性组和所有元组
            rsmd = rs.getMetaData();//获取属性名
            String []arr = new String[0];
            if(rsmd != null) {
                int count = rsmd.getColumnCount();//统计属性个数
                arr = new String[count];
                for (int i = 1; i &lt;= count; i++) {
                    arr[i-1] = rsmd.getColumnName(i);//把属性名输入arr
                    System.out.print(rsmd.getColumnName(i)+"  ");//输出属性名
                }
            }
            System.out.println();//换一行，保证格式正确
            while (rs.next()) {
                //判断是否存在下一行，如果存在，就使用foreach循环输出元组
                for (String s : arr) {
                    System.out.print(rs.getString(s) + "  ");
                }
                System.out.println();//控制格式
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }</code></pre> 
<h3 id="2.%20%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE">2. 添加数据</h3> 
<pre><code class="language-java">public void AddValue(String tableName){
        ResultSetMetaData rsmd = null;
        Scanner in = new Scanner(System.in);
        StringBuilder s1 = new StringBuilder();//创建字符串对象

        try {
            Statement sqlStatement = conn.createStatement();//创建语句对象
            String sql = "select * from " + tableName;
            ResultSet rs = sqlStatement.executeQuery(sql);//执行sql语句
            //下面根据该table输出属性组
            rsmd = rs.getMetaData();//获取属性名
            System.out.print("Input values according to :");
            if (rsmd != null) {
                int count = rsmd.getColumnCount();//统计属性个数
                for (int i = 1; i &lt;= count; i++) {
                    if(i&lt;count){
                        //输出属性名
                        System.out.print(rsmd.getColumnName(i) + "["+rsmd.getColumnTypeName(i)+"("+rsmd.getColumnDisplaySize(i)+")],");
                    }else System.out.print(rsmd.getColumnName(i) + "["+rsmd.getColumnTypeName(i)+"("+rsmd.getColumnDisplaySize(i)+")]");
                }
            }
            System.out.println();
            //输入需要添加的值用英文逗号分隔
            String values =in.next();
            String[] arr = values.split(",");
            for(int i = 0; i&lt;arr.length; i++){
                //把每个分量按SQL格式依次输入到对象s1中
                if(i&lt;arr.length-1)
                {
                    s1.append("'").append(arr[i]).append("',");
                }else s1.append("'").append(arr[i]).append("'");
            }
            String insertSql = "insert into " + tableName + " values("+s1+")";//SQL语句
            sqlStatement.executeUpdate(insertSql);
            System.out.println("Execute Successful !");
        } catch (Exception e) {
            e.printStackTrace();
            System.out.println("Execute failed !");
        }
    }</code></pre> 
<h3 id="3.%20%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE">3. 修改数据</h3> 
<pre><code class="language-java">public void ModifyValue(String tableName){
        ResultSetMetaData rsmd = null;
        Scanner in = new Scanner(System.in);
        try {
            Statement sqlStatement = conn.createStatement();//创建sql语句
            String sql = "select * from " + tableName;
            ResultSet rs = sqlStatement.executeQuery(sql);//执行sql语句
            //下面根据该table输出属性组
            rsmd = rs.getMetaData();//获取属性名
            Map map = new HashMap();
            System.out.print("Filter column. ");
            if (rsmd != null) {
                int count = rsmd.getColumnCount();//统计属性个数
                for (int i = 1; i &lt;= count; i++) {
                    map.put(i,rsmd.getColumnName(i));
                    System.out.print("["+i+": "+rsmd.getColumnName(i)+"]");//输出属性名
                }
            }
            System.out.print("\nInput the number: ");//筛选属性
            Object num = in.nextInt();
            System.out.print("Filter value: ");//筛选元组
            String value = in.next();
            SelectAll(tableName,"where "+map.get(num)+"='"+value+"'");//调用查询方法，查询筛选数据
            System.out.println("Are these values that need to be modified? [Y/N]");
            String YesOrNo = in.next();
            if(YesOrNo.charAt(0) == 'Y')
            {
                System.out.println("Which column should be modified?");
                if (rsmd != null) {//输出属性名
                    int count = rsmd.getColumnCount();
                    for (int i = 1; i &lt;= count; i++) {
                        System.out.print("["+i+": "+rsmd.getColumnName(i)+"]");
                    }
                }
                System.out.print("\nInput the number: ");//输入需要修改的属性
                int num2 = in.nextInt();
                System.out.println("What value is modified to?");//修改成什么值
                String value2 = in.next();
                String modifySql = "update "+tableName+" set "+map.get(num2)+"='"+value2+"'"+" where "+map.get(num)+"="+"'"+value+"'";
                sqlStatement.executeUpdate(modifySql);
                System.out.println("Execute Successful !");
            } else if (YesOrNo.charAt(0) == 'N') {
                ModifyValue(tableName);//如果不修改以上内容，重新选择需要修改的元组
            } else System.out.println("Input error! System exit.");//除Y和N以外的键自动退出
        } catch (Exception e) {
            e.printStackTrace();
            System.out.println("Execute failed !");
        }
    }</code></pre> 
<h3 id="4.%20%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE">4. 删除数据</h3> 
<pre><code class="language-java">public void DeleteValue(String tableName){
        //选择列名，询问是否删除以下数据，选择Y删除。
        ResultSetMetaData rsmd = null;
        Scanner in = new Scanner(System.in);
        try {
            Statement sqlStatement = conn.createStatement();//创建sql语句
            String sql = "select * from " + tableName;
            ResultSet rs = sqlStatement.executeQuery(sql);//执行sql语句
            //下面根据该table输出属性组
            rsmd = rs.getMetaData();//获取属性名
            Map map = new HashMap();
            System.out.print("Filter column. ");//筛选属性
            if (rsmd != null) {//输出属性名
                int count = rsmd.getColumnCount();
                for (int i = 1; i &lt;= count; i++) {
                    map.put(i,rsmd.getColumnName(i));
                    System.out.print("["+i+": "+rsmd.getColumnName(i)+"]");
                }
            }
            System.out.print("\nInput the number: ");
            Object num = in.nextInt();
            System.out.println("Filter value: ");//筛选元组
            String value = in.next();
            System.out.println("These values will be deleted.");
            SelectAll(tableName,"where "+map.get(num)+"='"+value+"'");//调用查询方法，查询需要删除的元组
            System.out.println("[Y/N]?");
            String YesOrNo = in.next();
            if(YesOrNo.charAt(0) == 'Y')
            {
                String deleteSql = "delete from "+tableName+" where "+map.get(num)+"='"+value+"'";
                sqlStatement.executeUpdate(deleteSql);//执行删除语句
                System.out.println("Execute Successful !");
            } else if (YesOrNo.charAt(0) == 'N') {
                DeleteValue(tableName);//如果不删除，重新选择需要删除的元组
            } else System.out.println("Input error! System exit.");//除Y和N以外的键自动退出
        } catch (Exception e) {
            e.printStackTrace();
            System.out.println("Execute failed !");
        }
    }</code></pre> 
<h3 id="5.%20%E6%8B%93%E5%B1%95">5. 拓展</h3> 
<p>数据库增删改功能定义好后我们可以进一步整合，首先在main方法中调用并测试。</p> 
<pre><code class="language-java">connectDb.SelectAll("表名","where条件句");//where条件句为空则查询所有元组
connectDb.AddValue("表名");//增加元组
connectDb.DeleteValue("表名");//删除元组
connectDb.ModifyValue("表名");//修改元组</code></pre> 
<p>我们可以发现，在操作表时，我们必须在方法中输入实参：表名，如果操作不同的表就需要再次修改实参，下面我们定义一个可以自行选择数据库表名的方法。</p> 
<p>第一步，在class ConnectDb中声明一个tableName全局变量。</p> 
<pre><code class="language-java">public class ConnectDb {
    public String tableName;
    ...
}</code></pre> 
<p>第二步，创建TableList方法，输出数据库内所有表，并要求选择一个表，将表名赋给tableName，代码如下。</p> 
<pre><code class="language-java">public void TableList(){
        Scanner in = new Scanner(System.in);
        Map map = new HashMap();
        int i = 0;
        try {
            DatabaseMetaData metaData = conn.getMetaData();
            ResultSet mrs = metaData.getTables(null, null, null, new String[]{"TABLE"});
            while (mrs.next()) {
                i++;
                map.put(i, mrs.getString(3));
                System.out.println("[" + i + ": " + mrs.getString(3) + "]");
            }
            System.out.print("Input the number: ");
            int num = in.nextInt();
            this.tableName = (String) map.get(num);
        }catch (Exception e){
            e.printStackTrace();
        }
    }</code></pre> 
<p> 第三步，补充main方法。</p> 
<pre><code class="language-java">import java.util.Scanner;

public class Main {
    public static void main(String[] args) {
        ConnectDb connectDb = new ConnectDb("数据库名","用户名","密码");
        System.out.println("Please choose a table.");
        connectDb.TableList();
        String n;
        do {//Y/N判断是否继续操作数据表
            System.out.println("Please choose an operation.\n[1: Select all rows],[2: Add values],[3: Delete values],[4: Modify values]");
            Scanner in = new Scanner(System.in);
            System.out.print("Input the number: ");
            int i = in.nextInt();
            switch (i) {
                case 1:
                    connectDb.SelectAll(connectDb.tableName,"");//查询所有元组
                    break;
                case 2:
                    connectDb.AddValue(connectDb.tableName);//增加元组
                    break;
                case 3:
                    connectDb.DeleteValue(connectDb.tableName);//删除元组
                    break;
                case 4:
                    connectDb.ModifyValue(connectDb.tableName);//修改元组
            }
            System.out.println("Do you wanna continue to operate? [Y/N]");
            n = in.next();
        }while((n.charAt(0) == 'Y') &amp;&amp; (n.charAt(0) != 'N'));
    }
}
</code></pre> 
<p>结果展示。</p> 
<p><img alt="" height="494" src="https://images2.imgbox.com/be/46/DHKctySz_o.png" width="757"></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f9cfc2a82374522f3b221bb8e0695064/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Oracle-并集、交集、差集（union、union all、intersect、minus）的使用方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ea3d43027af5507c7a0536b189a6148c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java 学生信息管理系统课程设计</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>