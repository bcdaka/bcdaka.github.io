<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>什么是JWT(Json-Web-Token)？JWT的用途和优势是什么？讲解&#43;实战，一篇文章学会JWT怎么用！ - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/041ba411aacc4c668a646509274d7f6c/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="什么是JWT(Json-Web-Token)？JWT的用途和优势是什么？讲解&#43;实战，一篇文章学会JWT怎么用！">
  <meta property="og:description" content="1、什么是JWT 最近刚刚启动搭建一个会员支付系统的项目，单点登录用到JWT来认证，借此机会来谈一谈JWT的相关知识，后续也会分享项目中的相关技术点，大家点赞关注哦~~~
1.1、JWT的介绍 官方解释：JSON Web Token （JWT） 是一种开放标准 （RFC 7519），它定义了一种紧凑且独立的方式，用于在各方之间以 JSON 对象的形式安全地传输信息。此信息可以验证和信任，因为它是经过数字签名的。JWT 可以使用密钥（使用 HMAC算法）或使用 RSA 或 ECDSA 的公钥/私钥对进行签名。
简单来说，JWT就是用来判断某种信息是否可以被信任的一种签名json
1.2、JWT的使用场景 身份验证（Authentication）：JWT 可以被用作用户登录的身份验证凭证。当用户成功登录后，服务端可以生成一个包含用户信息的 JWT，并将其返回给客户端。以后，客户端在每次请求时都会携带这个 JWT，服务端通过验证 JWT 的签名来确认用户的身份。
授权（Authorization）：在用户登录后，服务端可以生成包含用户角色、权限等信息的 JWT，并在用户每次请求时进行验证。通过解析 JWT 中的声明信息，服务端可以判断用户是否有权限执行特定的操作或访问特定的资源。
信息交换（Information Exchange）：由于 JWT 的声明信息可以被加密，因此可以安全地在用户和服务器之间传递信息。这在分布式系统中非常有用，因为可以确保信息在各个环节中的安全传递。
单点登录（Single Sign-On）：JWT 可以被用于支持单点登录，使得用户在多个应用之间只需要登录一次即可使用多个应用，从而提高用户体验。
1.3、JWT的优势 无状态：JWT 的验证是基于密钥的，因此它不需要在服务端存储用户信息。这使得 JWT 可以作为一种无状态的身份认证机制。
跨语言支持：JWT 的标准化和简单性质使得它可以在多种语言和平台之间使用。
安全性高：由于 JWT 的载荷可以进行加密处理，因此 JWT 能够保证数据的安全传输。同时，JWT 的签名机制也能够保证数据的完整性和真实性。
2、JWT的结构 JWT由Header&#43;Payload&#43;Signature三部分组成 Header JWT 的头部通常由两部分组成，分别是令牌类型（typ）和加密算法（alg）。一般情况下，头部会采用 Base64 编码。 { &#34;alg&#34;: &#34;HS256&#34;, &#34;typ&#34;: &#34;JWT&#34; } Payload JWT 的载荷也称为声明信息，包含了一些有关实体（通常是用户）的信息以及其他元数据。通常包括以下几种声明：
Registered Claims：这些声明是预定义的，包括 iss（发行者）、sub（主题）、aud（受众）、exp（过期时间）、nbf（生效时间）、iat（发布时间）和 jti（JWT ID）等。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-20T13:57:23+08:00">
    <meta property="article:modified_time" content="2024-04-20T13:57:23+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">什么是JWT(Json-Web-Token)？JWT的用途和优势是什么？讲解&#43;实战，一篇文章学会JWT怎么用！</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 id="1%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AFJWT">1、什么是JWT</h2> 
<p>最近刚刚启动搭建一个会员支付系统的项目，单点登录用到JWT来认证，借此机会来谈一谈JWT的相关知识，后续也会分享项目中的相关技术点，大家点赞关注哦~~~</p> 
<h3 id="1.1%E3%80%81JWT%E7%9A%84%E4%BB%8B%E7%BB%8D">1.1、JWT的介绍</h3> 
<p><strong>官方解释</strong>：JSON Web Token （JWT） 是一种开放标准 （<a href="https://tools.ietf.org/html/rfc7519" rel="nofollow" title="RFC 7519">RFC 7519</a>），它定义了一种紧凑且独立的方式，用于在各方之间以 JSON 对象的形式安全地传输信息。此信息可以验证和信任，因为它是经过数字签名的。JWT 可以使用密钥（使用 <strong>HMAC</strong>算法）或使用 <strong>RSA</strong> 或 <strong>ECDSA</strong> 的公钥/私钥对进行签名。<br><br> 简单来说，JWT就是用来判断某种信息是否可以被信任的一种签名json</p> 
<h3 id="1.2%E3%80%81JWT%E7%9A%84%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF1.3%E3%80%81JWT%E7%9A%84%E4%BC%98%E5%8A%BF">1.2、JWT的使用场景</h3> 
<ol><li> <p>身份验证（Authentication）：JWT 可以被用作用户登录的身份验证凭证。当用户成功登录后，服务端可以生成一个包含用户信息的 JWT，并将其返回给客户端。以后，客户端在每次请求时都会携带这个 JWT，服务端通过验证 JWT 的签名来确认用户的身份。</p> </li><li> <p>授权（Authorization）：在用户登录后，服务端可以生成包含用户角色、权限等信息的 JWT，并在用户每次请求时进行验证。通过解析 JWT 中的声明信息，服务端可以判断用户是否有权限执行特定的操作或访问特定的资源。</p> </li><li> <p>信息交换（Information Exchange）：由于 JWT 的声明信息可以被加密，因此可以安全地在用户和服务器之间传递信息。这在分布式系统中非常有用，因为可以确保信息在各个环节中的安全传递。</p> </li><li> <p>单点登录（Single Sign-On）：JWT 可以被用于支持单点登录，使得用户在多个应用之间只需要登录一次即可使用多个应用，从而提高用户体验。</p> </li></ol> 
<h3>1.3、JWT的优势</h3> 
<ol><li> <p>无状态：JWT 的验证是基于密钥的，因此它不需要在服务端存储用户信息。这使得 JWT 可以作为一种无状态的身份认证机制。</p> </li><li> <p>跨语言支持：JWT 的标准化和简单性质使得它可以在多种语言和平台之间使用。</p> </li><li> <p>安全性高：由于 JWT 的载荷可以进行加密处理，因此 JWT 能够保证数据的安全传输。同时，JWT 的签名机制也能够保证数据的完整性和真实性。</p> </li></ol> 
<h2 id="2%E3%80%81JWT%E7%9A%84%E6%9E%84%E6%88%90">2、JWT的结构</h2> 
<p><img alt="" height="351" src="https://images2.imgbox.com/e0/06/IB6mrKwc_o.png" width="461"></p> 
<h4>JWT由Header+Payload+Signature三部分组成 </h4> 
<h4><strong>Header</strong></h4> 
<p>JWT 的头部通常由两部分组成，分别是令牌类型（typ）和加密算法（alg）。一般情况下，头部会采用 Base64 编码。 </p> 
<pre><code class="language-java">{
  "alg": "HS256",
  "typ": "JWT"
}</code></pre> 
<h4><strong>Payload</strong></h4> 
<p>JWT 的载荷也称为声明信息，包含了一些有关实体（通常是用户）的信息以及其他元数据。通常包括以下几种声明：</p> 
<ul><li> <p>Registered Claims：这些声明是预定义的，包括 iss（发行者）、sub（主题）、aud（受众）、exp（过期时间）、nbf（生效时间）、iat（发布时间）和 jti（JWT ID）等。</p> </li><li> <p>Public Claims：这些声明可以自定义，但需要注意避免与注册声明的名称冲突。</p> </li><li> <p>Private Claims：这些声明是保留给特定的应用程序使用的，不会与其他应用程序冲突。</p> </li></ul> 
<blockquote> 
 <p>注意：Payload中一定不要存放敏感或重要信息，如密码等</p> 
</blockquote> 
<pre><code class="language-java">{
  "sub": "666666",
  "name": "warriors",
  "admin": true
}</code></pre> 
<h4> <strong>Signature</strong></h4> 
<p>JWT 的签名是由头部、载荷和密钥共同生成的。它用于验证 JWT 的真实性和完整性。一般情况下，签名也会采用 Base64 编码。<br> 例如，如果要使用 HMAC SHA256 算法，将按以下方式创建签名:</p> 
<pre><code class="language-java">HMACSHA256(
  base64UrlEncode(header) + "." +
  base64UrlEncode(payload),
  secret)</code></pre> 
<h2 id="3%E3%80%81SpringMVC%E6%9E%B6%E6%9E%84%E4%B8%AD%E7%9A%84JWT%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B">3、SpringMVC架构中的JWT使用示例</h2> 
<h3 id="3.1%E3%80%81%E5%BC%95%E5%85%A5Maven%E4%BE%9D%E8%B5%96">3.1、引入Maven依赖</h3> 
<pre><code class="language-java">&lt;dependency&gt;
   &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;
   &lt;artifactId&gt;jjwt-api&lt;/artifactId&gt;
   &lt;version&gt;0.11.5&lt;/version&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
   &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;
   &lt;artifactId&gt;jjwt-impl&lt;/artifactId&gt;
   &lt;version&gt;0.11.5&lt;/version&gt;
   &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
   &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;
   &lt;artifactId&gt;jjwt-jackson&lt;/artifactId&gt;
   &lt;version&gt;0.11.5&lt;/version&gt;
   &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;</code></pre> 
<h3 id="3.2%20%E3%80%81%E7%BC%96%E5%86%99JWT%E5%B7%A5%E5%85%B7%E7%B1%BB%EF%BC%8C%E5%AE%9E%E7%8E%B0JWT%E7%94%9F%E6%88%90%EF%BC%8CJWT%E6%A0%A1%E9%AA%8C%E7%AD%89%E5%8A%9F%E8%83%BD">3.2 、编写JWT工具类，实现JWT生成，JWT校验等功能<br>  </h3> 
<pre><code class="language-java">public class JWTUtil {
    // JWT过期时间
    public static final long JWT_TTL = 60 * 60 * 1000L * 24 * 14;
    // JWT_KEY为服务器私钥，注意保密
    public static final String JWT_KEY = "aBcDeFgHdkfajdja50490fjaifeja4ief";

    public static String getUUID() {
        return UUID.randomUUID().toString().replaceAll("-", "");
    }

    /**
     * 生成JWT
     * @param subject 用户唯一标识ID
     * @return
     */
    public static String createJWT(String subject) {
        JwtBuilder builder = getJwtBuilder(subject, null, getUUID());
        return builder.compact();
    }

    private static JwtBuilder getJwtBuilder(String subject, Long ttlMillis, String uuid) {
        // 自行选择加密算法
        SignatureAlgorithm signatureAlgorithm = SignatureAlgorithm.HS256;
        SecretKey secretKey = generalKey();
        long nowMillis = System.currentTimeMillis();
        Date now = new Date(nowMillis);
        if (ttlMillis == null) {
            ttlMillis = JWTUtil.JWT_TTL;
        }

        long expMillis = nowMillis + ttlMillis;
        Date expDate = new Date(expMillis);
        return Jwts.builder()
                .setId(uuid)
                .setSubject(subject)
                .setIssuer("sg")
                .setIssuedAt(now)
                .signWith(signatureAlgorithm, secretKey)
                .setExpiration(expDate);
    }

    public static SecretKey generalKey() {
        byte[] encodeKey = Base64.getDecoder().decode(JWTUtil.JWT_KEY);
        return new SecretKeySpec(encodeKey, 0, encodeKey.length, "HmacSHA256");
    }

    /**
     * 校验JWT
     */
    public static Claims parseJWT(String jwt) throws Exception {
        SecretKey secretKey = generalKey();
        return Jwts.parserBuilder()
                .setSigningKey(secretKey)
                .build()
                .parseClaimsJws(jwt)
                .getBody();
    }
}
</code></pre> 
<h3>3.3、自定义拦截器</h3> 
<pre><code class="language-java">public class JWTIntercepter implements HandlerInterceptor {
    public static final Logger LOGGER = LoggerFactory.getLogger(JWTIntercepter.class);

    /**
     * 添加用户身份认证
     * @param request
     * @param response
     * @param handler
     * @return
     * @throws Exception
     */
    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {
        String jwttoken = HttpRequestUtil.getCookieValue(request, "jwt_token");
        if (jwttoken == null || jwttoken.isEmpty()) {
            return false;
        }
        try {
            Claims claims = JWTUtil.parseJWT(jwttoken);
        } catch (JwtException e) {
            LOGGER.info("JWT解析异常:" + e.getMessage());
            return false;
        }
        response.sendError(ResponseEnum.USER_UNAUTHORIZED.getCode(),
                ResponseEnum.USER_UNAUTHORIZED.getMessage());
        return false;
    }
}</code></pre> 
<h3>3.4、配置拦截器到拦截器链中</h3> 
<pre><code class="language-java">@Configuration
public class WebMVCConfig implements WebMvcConfigurer {
    @Override
    public void addInterceptors(InterceptorRegistry registry) {
        JWTIntercepter jwtIntercepter = new JWTIntercepter();
        registry.addInterceptor(jwtIntercepter)
                .addPathPatterns("/**")
                //注意：登陆和注册请求放行
                .excludePathPatterns("/user/login", "/user/register");
    }
}
</code></pre> 
<p><strong>至此，jwt的配置已全部完成~~~</strong> </p> 
<h2 id="%E5%A4%A7%E5%AE%B6%E6%9C%89%E4%BB%BB%E4%BD%95%E9%97%AE%E9%A2%98%EF%BC%8C%E8%AF%B7%E5%9C%A8%E8%AF%84%E8%AE%BA%E5%8C%BA%E7%95%99%E8%A8%80%EF%BC%8C%E7%9C%8B%E5%88%B0%E4%BC%9A%E7%AC%AC%E4%B8%80%E6%97%B6%E9%97%B4%E7%AD%94%E5%A4%8D%EF%BC%8C%E5%A6%82%E5%86%85%E5%AE%B9%E6%8A%80%E6%9C%AF%E4%B8%8A%E5%AD%98%E5%9C%A8%E9%97%AE%E9%A2%98%EF%BC%8C%E8%AF%B7%E5%A4%A7%E8%83%86%E6%8C%87%E6%AD%A3%EF%BC%81%EF%BC%81%EF%BC%81">大家有任何问题，欢迎在评论区留言，看到会第一时间答复，如</h2>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b5e793499c933b492a241519ebf47f3e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">安卓神器---scrcpy(1)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/dcb10d4705f43f1e5d4d7cb7cd966376/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">2024华为OD机试真题指南宝典—持续更新（JAVA&amp;Python&amp;C&#43;&#43;&amp;JS）【彻底搞懂算法和数据结构—算法之翼】</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>