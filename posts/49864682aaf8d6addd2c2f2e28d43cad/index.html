<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Redis学习——Redisson 分布式锁集成及其简单使用 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/49864682aaf8d6addd2c2f2e28d43cad/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Redis学习——Redisson 分布式锁集成及其简单使用">
  <meta property="og:description" content="文章目录 引言1. Redisson概述1.1 Redisson的基本概念1.2 Redisson的主要功能1.3 Redisson的优点 2. 开发环境3. Redisson的安装与配置3.1 添加依赖3.2 配置Redisson 4. 使用Redisson4.1 可重入锁4.1.1 可重入锁的概念4.1.2 可重入锁的实现原理4.1.3 简单使用锁的获取和释放 4.2 公平锁4.2.1 公平锁的概念4.2.2 公平锁的实现原理4.2.3 简单使用 4.3 读写锁4.3.1 读写锁的概念4.3.2 读写锁的实现原理4.3.3 简单使用 4.4 联锁4.4.1 联锁的概念4.4.2 联锁的实现原理4.4.3 简单使用 5. WatchDog机制6. 总结 引言 在分布式系统中，经常需要对共享资源进行并发访问控制，以确保数据的一致性和完整性。分布式锁是一种用于在分布式环境中控制对共享资源访问的机制，它可以保证在同一时刻只有一个客户端能够访问某些特定资源。
1. Redisson概述 1.1 Redisson的基本概念 Redisson是一个基于Redis的Java客户端，它不仅提供了对Redis的基础操作支持，还封装了许多高级功能，如分布式锁、分布式集合、分布式队列等。Redisson的设计目标是简化分布式系统的开发，提高开发效率和系统的可维护性。
1.2 Redisson的主要功能 分布式锁：支持可重入锁、公平锁、读写锁、红锁等多种分布式锁机制，保证分布式环境下的资源访问控制。比如：在电商系统中，防止超卖现象；在订单系统中，防止同一订单被多次处理。分布式集合：提供分布式Set、List、Map等集合类型，支持高并发环境下的数据操作。分布式队列：支持分布式阻塞队列、延迟队列等，适用于任务调度和消息传递场景。分布式对象：提供分布式AtomicLong、AtomicDouble、CountDownLatch、Semaphore等对象，简化分布式系统的开发。分布式服务：支持分布式执行器、分布式调度器等服务，增强分布式系统的功能。 1.3 Redisson的优点 Redisson是一个基于Redis的Java客户端，提供了许多高级特性和分布式数据结构。相比其他Redis客户端，Redisson的优势在于：
简洁易用：提供了丰富的API，简化了分布式编程的复杂性。高可用性：支持多种Redis部署模式，包括单节点、主从复制和集群模式。分布式对象：提供了分布式锁、分布式集合、分布式队列等高级数据结构，便于在分布式环境中使用。自动续期：Redisson的Watchdog机制可以自动续期分布式锁，避免锁超时问题。 2. 开发环境 JDK版本：JDK 17Spring Boot版本：Spring Boot 3.2.2Redis版本：5.0.14.1构建工具：Maven 3. Redisson的安装与配置 3.1 添加依赖 &lt;dependency&gt; &lt;groupId&gt;org.redisson&lt;/groupId&gt; &lt;artifactId&gt;redisson&lt;/artifactId&gt; &lt;version&gt;3.24.3&lt;/version&gt; &lt;/dependency&gt; 3.2 配置Redisson 配置参考文档：2. Configuration · redisson/redisson Wiki (github.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-01T09:28:05+08:00">
    <meta property="article:modified_time" content="2024-07-01T09:28:05+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Redis学习——Redisson 分布式锁集成及其简单使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_6" rel="nofollow">引言</a></li><li><a href="#1_Redisson_10" rel="nofollow">1. Redisson概述</a></li><li><ul><li><a href="#11_Redisson_12" rel="nofollow">1.1 Redisson的基本概念</a></li><li><a href="#12_Redisson_18" rel="nofollow">1.2 Redisson的主要功能</a></li><li><a href="#13_Redisson_26" rel="nofollow">1.3 Redisson的优点</a></li></ul> 
  </li><li><a href="#2__37" rel="nofollow">2. 开发环境</a></li><li><a href="#3_Redisson_44" rel="nofollow">3. Redisson的安装与配置</a></li><li><ul><li><a href="#31__46" rel="nofollow">3.1 添加依赖</a></li><li><a href="#32_Redisson_56" rel="nofollow">3.2 配置Redisson</a></li></ul> 
  </li><li><a href="#4_Redisson_106" rel="nofollow">4. 使用Redisson</a></li><li><ul><li><a href="#41__112" rel="nofollow">4.1 可重入锁</a></li><li><ul><li><a href="#411__114" rel="nofollow">4.1.1 可重入锁的概念</a></li><li><a href="#412__123" rel="nofollow">4.1.2 可重入锁的实现原理</a></li><li><a href="#413__129" rel="nofollow">4.1.3 简单使用</a></li><li><ul><li><ul><li><a href="#_182" rel="nofollow">锁的获取和释放</a></li></ul> 
    </li></ul> 
   </li></ul> 
   </li><li><a href="#42__187" rel="nofollow">4.2 公平锁</a></li><li><ul><li><a href="#421__189" rel="nofollow">4.2.1 公平锁的概念</a></li><li><a href="#422__193" rel="nofollow">4.2.2 公平锁的实现原理</a></li><li><a href="#423__199" rel="nofollow">4.2.3 简单使用</a></li></ul> 
   </li><li><a href="#43__229" rel="nofollow">4.3 读写锁</a></li><li><ul><li><a href="#431__231" rel="nofollow">4.3.1 读写锁的概念</a></li><li><a href="#432__240" rel="nofollow">4.3.2 读写锁的实现原理</a></li><li><a href="#433__246" rel="nofollow">4.3.3 简单使用</a></li></ul> 
   </li><li><a href="#44___289" rel="nofollow">4.4 联锁</a></li><li><ul><li><a href="#441__291" rel="nofollow">4.4.1 联锁的概念</a></li><li><a href="#442__300" rel="nofollow">4.4.2 联锁的实现原理</a></li><li><a href="#443__308" rel="nofollow">4.4.3 简单使用</a></li></ul> 
  </li></ul> 
  </li><li><a href="#5_WatchDog_348" rel="nofollow">5. WatchDog机制</a></li><li><a href="#6__385" rel="nofollow">6. 总结</a></li></ul> 
</div> 
<br> 
<img src="https://images2.imgbox.com/19/f9/oSLmW2bb_o.gif" alt="在这里插入图片描述"> 
<p></p> 
<h2><a id="_6"></a>引言</h2> 
<p>在分布式系统中，经常需要对共享资源进行并发访问控制，以确保数据的一致性和完整性。分布式锁是一种用于在分布式环境中控制对共享资源访问的机制，它可以保证在同一时刻只有一个客户端能够访问某些特定资源。</p> 
<h2><a id="1_Redisson_10"></a>1. Redisson概述</h2> 
<h3><a id="11_Redisson_12"></a>1.1 Redisson的基本概念</h3> 
<p>Redisson是一个基于Redis的Java客户端，它不仅提供了对Redis的基础操作支持，还封装了许多高级功能，如分布式锁、分布式集合、分布式队列等。Redisson的设计目标是简化分布式系统的开发，提高开发效率和系统的可维护性。</p> 
<p><img src="https://images2.imgbox.com/c3/6d/FiTiXBHv_o.png" alt="下载 (6)"></p> 
<h3><a id="12_Redisson_18"></a>1.2 Redisson的主要功能</h3> 
<ol><li><strong>分布式锁</strong>：支持可重入锁、公平锁、读写锁、红锁等多种分布式锁机制，保证分布式环境下的资源访问控制。比如：在电商系统中，防止超卖现象；在订单系统中，防止同一订单被多次处理。</li><li><strong>分布式集合</strong>：提供分布式Set、List、Map等集合类型，支持高并发环境下的数据操作。</li><li><strong>分布式队列</strong>：支持分布式阻塞队列、延迟队列等，适用于任务调度和消息传递场景。</li><li><strong>分布式对象</strong>：提供分布式AtomicLong、AtomicDouble、CountDownLatch、Semaphore等对象，简化分布式系统的开发。</li><li><strong>分布式服务</strong>：支持分布式执行器、分布式调度器等服务，增强分布式系统的功能。</li></ol> 
<h3><a id="13_Redisson_26"></a>1.3 Redisson的优点</h3> 
<p>Redisson是一个基于Redis的Java客户端，提供了许多高级特性和分布式数据结构。相比其他Redis客户端，Redisson的优势在于：</p> 
<ul><li><strong>简洁易用</strong>：提供了丰富的API，简化了分布式编程的复杂性。</li><li><strong>高可用性</strong>：支持多种Redis部署模式，包括单节点、主从复制和集群模式。</li><li><strong>分布式对象</strong>：提供了分布式锁、分布式集合、分布式队列等高级数据结构，便于在分布式环境中使用。</li><li><strong>自动续期</strong>：Redisson的Watchdog机制可以自动续期分布式锁，避免锁超时问题。</li></ul> 
<h2><a id="2__37"></a>2. 开发环境</h2> 
<ul><li><strong>JDK版本</strong>：JDK 17</li><li><strong>Spring Boot版本</strong>：Spring Boot 3.2.2</li><li><strong>Redis版本</strong>：5.0.14.1</li><li><strong>构建工具</strong>：Maven</li></ul> 
<h2><a id="3_Redisson_44"></a>3. Redisson的安装与配置</h2> 
<h3><a id="31__46"></a>3.1 添加依赖</h3> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.redisson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>redisson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.24.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h3><a id="32_Redisson_56"></a>3.2 配置Redisson</h3> 
<blockquote> 
 <p>配置参考文档：<a href="https://github.com/redisson/redisson/wiki/2.-Configuration">2. Configuration · redisson/redisson Wiki (github.com)</a></p> 
</blockquote> 
<p>添加配置类<code>RedissonConfig</code>：</p> 
<pre><code class="prism language-java"><span class="token comment">/**
 * Redisson配置类，用于配置Redisson客户端。
 */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedissonConfig</span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">/**
     * 创建并配置RedissonClient Bean。
     * 
     * @return 配置好的RedissonClient实例
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RedissonClient</span> <span class="token function">redissonClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 创建Redisson配置对象</span>
        <span class="token class-name">Config</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 配置单节点模式</span>
        config<span class="token punctuation">.</span><span class="token function">useSingleServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment">// 设置Redis服务器地址</span>
                <span class="token punctuation">.</span><span class="token function">setAddress</span><span class="token punctuation">(</span><span class="token string">"redis://127.0.0.1:6379"</span><span class="token punctuation">)</span>
                <span class="token comment">// 设置Redis服务器密码</span>
                <span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"123321"</span><span class="token punctuation">)</span>
                <span class="token comment">// 设置连接池大小</span>
                <span class="token punctuation">.</span><span class="token function">setConnectionPoolSize</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span>
                <span class="token comment">// 设置最小空闲连接数</span>
                <span class="token punctuation">.</span><span class="token function">setConnectionMinimumIdleSize</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span>
                <span class="token comment">// 设置空闲连接超时时间（毫秒）</span>
                <span class="token punctuation">.</span><span class="token function">setIdleConnectionTimeout</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span>
                <span class="token comment">// 设置连接超时时间（毫秒）</span>
                <span class="token punctuation">.</span><span class="token function">setConnectTimeout</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span>
                <span class="token comment">// 设置命令等待超时时间（毫秒）</span>
                <span class="token punctuation">.</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span>
                <span class="token comment">// 设置命令重试次数</span>
                <span class="token punctuation">.</span><span class="token function">setRetryAttempts</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
                <span class="token comment">// 设置命令重试间隔时间（毫秒）</span>
                <span class="token punctuation">.</span><span class="token function">setRetryInterval</span><span class="token punctuation">(</span><span class="token number">1500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 创建并返回RedissonClient实例</span>
        <span class="token keyword">return</span> <span class="token class-name">Redisson</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="4_Redisson_106"></a>4. 使用Redisson</h2> 
<blockquote> 
 <p>官方wiki文档：<a href="https://github.com/redisson/redisson/wiki/8.-distributed-locks-and-synchronizers">8. Distributed locks and synchronizers · redisson/redisson Wiki (github.com)</a></p> 
 <p>中文版wiki文档（已经有5年没有更新了，不建议看）：<a href="https://github.com/redisson/redisson/wiki/8.-%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E5%92%8C%E5%90%8C%E6%AD%A5%E5%99%A8">8. 分布式锁和同步器 · redisson/redisson Wiki (github.com)</a></p> 
</blockquote> 
<h3><a id="41__112"></a>4.1 可重入锁</h3> 
<h4><a id="411__114"></a>4.1.1 可重入锁的概念</h4> 
<p>可重入锁（Reentrant Lock）是一种允许同一个线程多次获取同一把锁的锁机制。也就是说，当一个线程已经持有某个锁时，它可以再次获取该锁而不会被阻塞。这种锁机制能够避免死锁问题，并简化锁的使用。</p> 
<p>可重入锁的主要特点是：</p> 
<ul><li><strong>同一线程可多次获取</strong>：同一个线程可以多次获取同一把锁，而不会被阻塞。</li><li><strong>计数器维护</strong>：可重入锁内部维护一个计数器，每次获取锁时计数器加1，每次释放锁时计数器减1，当计数器为0时，锁才真正被释放。</li></ul> 
<h4><a id="412__123"></a>4.1.2 可重入锁的实现原理</h4> 
<p>可重入锁的实现通常依赖于一个计数器和一个持有锁的线程标识。当一个线程第一次获取锁时，计数器加1，并记录持有锁的线程标识。当同一个线程再次获取锁时，只需将计数器加1，而不会阻塞线程。当线程释放锁时，计数器减1，当计数器为0时，锁才真正被释放，并允许其他线程获取锁。</p> 
<p>在Redisson中，可重入锁的实现基于Redis的原子操作和Lua脚本。Redisson通过维护一个计数器和持有锁的线程标识，实现了可重入锁的功能。</p> 
<h4><a id="413__129"></a>4.1.3 简单使用</h4> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">RequiredArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>redisson<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">RLock</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>redisson<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">RedissonClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">TimeUnit</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 服务类示例
 */</span>
<span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">XXXXService</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">RedissonClient</span> redissonClient<span class="token punctuation">;</span> 

    <span class="token comment">/**
     * 使用 Redisson 可重入锁执行任务
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">performTaskWithLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 获取可重入锁对象，指定锁的名称</span>
        <span class="token class-name">RLock</span> lock <span class="token operator">=</span> redissonClient<span class="token punctuation">.</span><span class="token function">getLock</span><span class="token punctuation">(</span><span class="token string">"myLock"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 尝试获取锁，参数分别是：获取锁的最大等待时间，锁自动释放时间，时间单位，返回值为是否获取锁成功</span>
            <span class="token keyword">boolean</span> isLock <span class="token operator">=</span> lock<span class="token punctuation">.</span><span class="token function">tryLock</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
            
            <span class="token comment">// 判断获取锁成功</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>isLock<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> 
                <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"执行业务"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
                    <span class="token comment">// 在这里编写需要进行锁保护的业务逻辑</span>
                <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// 释放锁</span>
                    lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 获取锁失败，可以进行相应的处理，例如记录日志或返回错误信息</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"获取锁失败！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 处理中断异常</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <p>在上述代码中，我们使用<code>redissonClient.getLock("myLock")</code>获取一个分布式锁对象，然后使用<code>lock.tryLock()</code>方法尝试获取锁，并在任务完成后释放锁。</p> 
 <h6><a id="_182"></a>锁的获取和释放</h6> 
 <ul><li><strong>获取锁</strong>：使用<code>RLock</code>对象的<code>tryLock()</code>或<code>lock()</code>方法来获取锁。<code>tryLock()</code>方法允许设置等待时间和锁的自动释放时间。</li><li><strong>释放锁</strong>：使用<code>RLock</code>对象的<code>unlock()</code>方法来释放锁。确保在<code>finally</code>块中释放锁，以避免死锁。</li></ul> 
</blockquote> 
<h3><a id="42__187"></a>4.2 公平锁</h3> 
<h4><a id="421__189"></a>4.2.1 公平锁的概念</h4> 
<p>公平锁（Fair Lock）是一种确保锁的获取顺序与请求顺序相同的锁机制。即先请求锁的线程优先获取锁，后请求的线程只能在前面的线程释放锁后才能获取锁。这种机制可以避免“饥饿”现象，确保每个线程都能公平地获取锁。</p> 
<h4><a id="422__193"></a>4.2.2 公平锁的实现原理</h4> 
<p>公平锁的实现通常依赖于一个队列来记录请求锁的顺序。每次有线程请求锁时，会将其添加到队列中，当锁被释放时，从队列中按照请求顺序依次唤醒等待的线程。</p> 
<p>在Redisson中，公平锁的实现基于Redis的有序集合（Sorted Set）和Lua脚本。每次请求锁时，线程会被添加到一个有序集合中，并按照时间戳排序。当锁被释放时，按照有序集合中的顺序依次唤醒等待的线程。</p> 
<h4><a id="423__199"></a>4.2.3 简单使用</h4> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">performTaskWithFairLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 1. 获取公平锁对象</span>
    <span class="token class-name">RLock</span> fairLock <span class="token operator">=</span> redissonClient<span class="token punctuation">.</span><span class="token function">getFairLock</span><span class="token punctuation">(</span><span class="token string">"myFairLock"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 2. 尝试获取锁</span>
        <span class="token keyword">boolean</span> isLock <span class="token operator">=</span> fairLock<span class="token punctuation">.</span><span class="token function">tryLock</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

        <span class="token comment">// 3. 判断是否获取到锁</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>isLock<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> 
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"获得公平锁，正在执行任务..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 执行任务</span>
            <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 4. 释放锁</span>
                fairLock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"释放公平锁。"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"无法获取公平锁。"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="43__229"></a>4.3 读写锁</h3> 
<h4><a id="431__231"></a>4.3.1 读写锁的概念</h4> 
<p>读写锁（Read-Write Lock）是一种允许多个读操作同时进行，但写操作必须独占的锁机制。读写锁分为两种锁：读锁和写锁。</p> 
<ul><li><strong>读锁</strong>：允许多个线程同时获取读锁，只要没有线程持有写锁。读锁之间是共享的。</li><li><strong>写锁</strong>：只允许一个线程获取写锁，并且在写锁持有期间，其他线程不能获取读锁或写锁。写锁是独占的。</li></ul> 
<p>读写锁的主要目的是提高并发性和性能。在读多写少的场景下，读写锁可以显著提高系统的并发处理能力。</p> 
<h4><a id="432__240"></a>4.3.2 读写锁的实现原理</h4> 
<p>读写锁的实现通常依赖于两个锁：一个读锁和一个写锁。读锁允许多个线程同时获取，而写锁只允许一个线程获取。在获取写锁时，需要确保没有线程持有读锁或写锁。</p> 
<p>在Redisson中，读写锁的实现基于Redis的原子操作和Lua脚本。Redisson通过两个键来分别控制读锁和写锁，并使用Lua脚本确保锁操作的原子性。</p> 
<h4><a id="433__246"></a>4.3.3 简单使用</h4> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">performTaskWithReadWriteLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 1. 获取读写锁对象</span>
    <span class="token class-name">RReadWriteLock</span> readWriteLock <span class="token operator">=</span> redissonClient<span class="token punctuation">.</span><span class="token function">getReadWriteLock</span><span class="token punctuation">(</span><span class="token string">"myReadWriteLock"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 2. 从读写锁对象中分别获取读锁和写锁</span>
    <span class="token class-name">RLock</span> readLock <span class="token operator">=</span> readWriteLock<span class="token punctuation">.</span><span class="token function">readLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">RLock</span> writeLock <span class="token operator">=</span> readWriteLock<span class="token punctuation">.</span><span class="token function">writeLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 3. 尝试获取读锁</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>readLock<span class="token punctuation">.</span><span class="token function">tryLock</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> 
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"获取读锁，正在执行读任务..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 执行读任务</span>
            <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 4. 释放读锁</span>
                readLock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"释放读锁。"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 5. 尝试获取写锁</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>writeLock<span class="token punctuation">.</span><span class="token function">tryLock</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> 
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"获取写锁，正在执行写任务..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 执行写任务</span>
            <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 6. 释放写锁</span>
                writeLock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"释放写锁。"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="44___289"></a>4.4 联锁</h3> 
<h4><a id="441__291"></a>4.4.1 联锁的概念</h4> 
<p>联锁（MultiLock）是一种允许将多个锁关联在一起，实现“全部获取”或“全部释放”的锁机制。</p> 
<ul><li><strong>全部获取</strong>: 只有当所有参与联锁的锁都被成功获取后，才算成功获取联锁。</li><li><strong>全部释放</strong>: 释放联锁时，会自动释放所有参与联锁的锁。</li></ul> 
<p>联锁适用于需要同时获取多个资源的场景，例如分布式事务中需要锁定多个数据表。</p> 
<h4><a id="442__300"></a>4.4.2 联锁的实现原理</h4> 
<p>Redisson 的联锁基于 <code>RedissonMultiLock</code> 对象实现。<code>RedissonMultiLock</code> 对象可以将多个 <code>RLock</code> 对象关联在一起，并提供 <code>tryLock()</code> 和 <code>unlock()</code> 方法来统一管理这些锁。</p> 
<p>在调用 <code>tryLock()</code> 方法时，<code>RedissonMultiLock</code> 会尝试依次获取所有参与联锁的锁。如果所有锁都获取成功，则返回 <code>true</code>，否则释放已经获取到的锁，并返回 <code>false</code>。</p> 
<p>在调用 <code>unlock()</code> 方法时，<code>RedissonMultiLock</code> 会自动释放所有参与联锁的锁，无论这些锁是否被当前线程持有。</p> 
<h4><a id="443__308"></a>4.4.3 简单使用</h4> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">performTaskWithMultiLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 获取多个锁对象</span>
    <span class="token class-name">RLock</span> lock1 <span class="token operator">=</span> redissonClient<span class="token punctuation">.</span><span class="token function">getLock</span><span class="token punctuation">(</span><span class="token string">"lock1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">RLock</span> lock2 <span class="token operator">=</span> redissonClient<span class="token punctuation">.</span><span class="token function">getLock</span><span class="token punctuation">(</span><span class="token string">"lock2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">RLock</span> lock3 <span class="token operator">=</span> redissonClient<span class="token punctuation">.</span><span class="token function">getLock</span><span class="token punctuation">(</span><span class="token string">"lock3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 创建联锁对象</span>
    <span class="token class-name">RLock</span> multiLock <span class="token operator">=</span> redissonClient<span class="token punctuation">.</span><span class="token function">getMultiLock</span><span class="token punctuation">(</span>lock1<span class="token punctuation">,</span> lock2<span class="token punctuation">,</span> lock3<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 尝试获取联锁，等待 10 秒</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>multiLock<span class="token punctuation">.</span><span class="token function">tryLock</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"获取联锁成功，正在执行任务..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 执行需要所有锁的任务</span>
            <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 释放联锁</span>
                multiLock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"释放联锁。"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"获取联锁失败。"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <p>代码分析：</p> 
 <ol><li><strong>获取多个锁对象</strong>: 首先，获取需要参与联锁的多个 <code>RLock</code> 对象。</li><li><strong>创建联锁对象</strong>: 使用 <code>redissonClient.getMultiLock(lock1, lock2, lock3)</code> 创建一个 <code>RLock</code> 对象，并将之前获取的多个锁对象作为参数传入。</li><li><strong>尝试获取联锁</strong>: 调用 <code>multiLock.tryLock(10, TimeUnit.SECONDS)</code> 尝试获取联锁，最多等待 10 秒。</li><li><strong>执行任务</strong>: 如果成功获取联锁，则执行需要所有锁保护的任务。</li><li><strong>释放联锁</strong>: 最后，在 <code>finally</code> 块中调用 <code>multiLock.unlock()</code> 释放联锁，这会自动释放所有参与联锁的锁。</li></ol> 
</blockquote> 
<h2><a id="5_WatchDog_348"></a>5. WatchDog机制</h2> 
<p>想象一下，我们正在进行一场激烈的拔河比赛。我们队好不容易抓住了绳子，眼看就要赢了，结果突然有人手滑，绳子就被对方抢走了！</p> 
<p>在分布式系统中，获取锁就好像抓住这根拔河绳。Redisson 分布式锁的租约时间就好像我们抓住绳子的时间。如果在租约时间内，我们没有完成任务，锁就自动释放了，其他线程就有机会获取锁，这就像拔河比赛中我们手滑绳子被抢走一样，可能会导致数据不一致的问题。</p> 
<p>为了避免这种情况发生，Redisson 提供了 Watch Dog 机制，就像我们队伍里安排了一个“观察员”。这位观察员会每隔一段时间关注我们是否还抓着绳子，如果发现我们快坚持不住了，就会及时提醒我们，让我们重新握紧绳子，并延长我们抓住绳子的时间。</p> 
<p>具体来说，Redisson 的Watch Dog 机制会在 Redisson 实例被关闭前，不断的延长锁的有效期，也就是说，如果一个拿到锁的线程一直没有完成逻辑，那么看门狗会帮助线程不断的延长锁超时时间，锁不会因为超时而被释放。</p> 
<p>**开启方式：**在获取锁的时候，不能指定<code>leaseTime</code>或者只能将<code>leaseTime</code>设置为-1，这样才能开启看门狗机制。</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">RLock</span> lock <span class="token operator">=</span> redissonClient<span class="token punctuation">.</span><span class="token function">getLock</span><span class="token punctuation">(</span><span class="token string">"myLock"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 方式一: 不停重试，直到获取锁成功，具有 Watch Dog 自动延期机制，默认续约时间为 30 秒</span>
    lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

    <span class="token comment">// 方式二: 尝试获取锁 10 秒，获取成功返回 true，否则返回 false，具有 Watch Dog 自动延期机制，默认续约时间为 30 秒</span>
    <span class="token keyword">boolean</span> res1 <span class="token operator">=</span> lock<span class="token punctuation">.</span><span class="token function">tryLock</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

    <span class="token comment">// 方式三:  尝试获取锁 10 秒，如果获取成功，则持有锁，否则抛出异常，leaseTime 为 10 秒，不会自动续约</span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 处理异常</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 方式四: 尝试获取锁 100 秒，如果获取成功，则持有锁 10 秒，leaseTime 为 10 秒，不会自动续约</span>
    <span class="token keyword">boolean</span> res2 <span class="token operator">=</span> lock<span class="token punctuation">.</span><span class="token function">tryLock</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">40000L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="6__385"></a>6. 总结</h2> 
<p>在本文中，我们简要介绍了Redisson及其优势，介绍了如何在Spring Boot项目中集成Redisson。通过代码示例展示了基本的分布式锁用法，以及高级用法如公平锁、可重入锁、读写锁和联锁。除此之外我们还简要介绍了Redisson 的Watch Dog 机制，希望本文对大家有所帮助😊。</p> 
<p><img src="https://images2.imgbox.com/6d/08/TQ8qbujS_o.gif" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c0f8f5d3ee4fbd9478ff1fd812ae4264/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">问题解决|endnote文献手工导入</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/734cf9bfe36b0ac24021536d1ee8a6e1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">基于SpringBoot&#43;数据可视化&#43;协同过滤算法的非遗推荐系统设计和实现(源码&#43;LW&#43;部署讲解)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>