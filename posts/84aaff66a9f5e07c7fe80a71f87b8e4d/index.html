<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>深度模型中的优化 - 基本算法篇 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/84aaff66a9f5e07c7fe80a71f87b8e4d/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="深度模型中的优化 - 基本算法篇">
  <meta property="og:description" content="序言 在深度学习中，模型优化是提升模型性能与训练效率的关键环节。深度模型通过优化算法不断调整其内部参数，以最小化损失函数，从而实现对复杂数据的有效拟合与预测。本篇章将简要概述深度模型中的几种基本优化算法，包括梯度下降法及其变种，这些算法在推动深度学习领域的发展中起到了至关重要的作用。
概述 梯度下降法（Gradient Descent, GD） 作为最基础的优化算法，梯度下降法通过计算损失函数关于模型参数的梯度，并沿着梯度的反方向更新参数，从而逐步逼近损失函数的最小值。然而，标准梯度下降法需要计算整个数据集的梯度，计算量大且不适合大数据集。
随机梯度下降法（Stochastic Gradient Descent, SGD） 为了克服标准梯度下降法的缺点，SGD每次随机选取一个样本计算梯度并更新参数，显著提高了计算效率。但SGD的梯度估计存在噪声，可能导致收敛过程震荡。
小批量梯度下降法（Mini-batch Gradient Descent） 作为GD与SGD的折中方案，小批量梯度下降法每次选取一小批样本计算梯度并更新参数，既保持了计算效率，又相对稳定了梯度估计。
动量法（Momentum） 在SGD基础上引入动量项，利用历史梯度信息加速收敛并减少震荡。
自适应学习率算法（如Adam） 结合了动量法和 RMSprop \text{RMSprop} RMSprop算法的优点，通过维护梯度的一阶矩和二阶矩估计来动态调整学习率，具有较快的收敛速度和较强的适应性。
基本算法 之前我们已经介绍了梯度下降（基于梯度的优化方法），即沿着整个训练集梯度下降的方向。这可以使用随机梯度下降很大程度地加速，沿着随机挑选的 minibatch \text{minibatch} minibatch数据的梯度下降方向，请参阅随机梯度下降算法篇和批算法和 minibatch \text{minibatch} minibatch算法。 随机梯度下降 随机梯度下降（ SGD \text{SGD} SGD）及其变种很可能是一般机器学习中用得最多的优化算法，特别是在深度学习中。如批算法和 minibatch \text{minibatch} minibatch算法中讨论，通过计算独立同分布地从数据生成分布中抽取的 m m m个 minibatch \text{minibatch} minibatch样本的梯度均值，我们可以得到梯度的无偏估计。
算法1：展示了如何使用这个下降梯度的估计。
算法1描述：随机梯度下降( SGD \text{SGD} SGD)在第 k k k个训练迭代的更新
伪代码：
R e q u i r e \bold{Require} Require: 学习速率 ϵ k \epsilon_k ϵk​
R e q u i r e \bold{Require} Require: 初始参数 θ \boldsymbol{\theta} θ">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-26T07:45:00+08:00">
    <meta property="article:modified_time" content="2024-07-26T07:45:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">深度模型中的优化 - 基本算法篇</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>序言</h2> 
<p>在深度学习中，模型优化是提升模型性能与训练效率的关键环节。深度模型通过优化算法不断调整其内部参数，以最小化损失函数，从而实现对复杂数据的有效拟合与预测。本篇章将简要概述深度模型中的几种基本优化算法，包括梯度下降法及其变种，这些算法在推动深度学习领域的发展中起到了至关重要的作用。</p> 
<h2><a id="_3"></a>概述</h2> 
<h3><a id="Gradient_Descent_GD_4"></a>梯度下降法（Gradient Descent, GD）</h3> 
<p>作为最基础的优化算法，梯度下降法通过计算损失函数关于模型参数的梯度，并沿着梯度的反方向更新参数，从而逐步逼近损失函数的最小值。然而，标准梯度下降法需要计算整个数据集的梯度，计算量大且不适合大数据集。</p> 
<h3><a id="Stochastic_Gradient_Descent_SGD_6"></a>随机梯度下降法（Stochastic Gradient Descent, SGD）</h3> 
<p>为了克服标准梯度下降法的缺点，SGD每次随机选取一个样本计算梯度并更新参数，显著提高了计算效率。但SGD的梯度估计存在噪声，可能导致收敛过程震荡。</p> 
<h3><a id="Minibatch_Gradient_Descent_8"></a>小批量梯度下降法（Mini-batch Gradient Descent）</h3> 
<p>作为GD与SGD的折中方案，小批量梯度下降法每次选取一小批样本计算梯度并更新参数，既保持了计算效率，又相对稳定了梯度估计。</p> 
<h3><a id="Momentum_10"></a>动量法（Momentum）</h3> 
<p>在SGD基础上引入动量项，利用历史梯度信息加速收敛并减少震荡。</p> 
<h3><a id="Adam_12"></a>自适应学习率算法（如Adam）</h3> 
<p>结合了动量法和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         RMSprop 
        
       
      
        \text{RMSprop} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;"></span><span class="mord text"><span class="mord">RMSprop</span></span></span></span></span></span>算法的优点，通过维护梯度的一阶矩和二阶矩估计来动态调整学习率，具有较快的收敛速度和较强的适应性。</p> 
<h2><a id="_15"></a>基本算法</h2> 
<ul><li>之前我们已经介绍了梯度下降（<a href="https://blog.csdn.net/benny_zhou2004/article/details/139738795?spm=1001.2014.3001.5501#nc_gbo">基于梯度的优化方法</a>），即沿着整个训练集梯度下降的方向。这可以使用随机梯度下降很大程度地加速，沿着随机挑选的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          minibatch 
         
        
       
         \text{minibatch} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord text"><span class="mord">minibatch</span></span></span></span></span></span>数据的梯度下降方向，请参阅<a href="https://blog.csdn.net/benny_zhou2004/article/details/139929724?spm=1001.2014.3001.5501">随机梯度下降算法篇</a>和<a href="https://blog.csdn.net/benny_zhou2004/article/details/140604047?spm=1001.2014.3001.5501#hldfpo_bmb">批算法和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           minibatch 
          
         
        
          \text{minibatch} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord text"><span class="mord">minibatch</span></span></span></span></span></span>算法</a>。</li></ul> 
<h3><a id="a_idba_sgda_19"></a><a id="ba_sgd">随机梯度下降</a></h3> 
<ul><li> <p>随机梯度下降（<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           SGD 
          
         
        
          \text{SGD} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord text"><span class="mord">SGD</span></span></span></span></span></span>）及其变种很可能是一般机器学习中用得最多的优化算法，特别是在深度学习中。如<a href="https://blog.csdn.net/benny_zhou2004/article/details/140604047?spm=1001.2014.3001.5501#hldfpo_bmb">批算法和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            minibatch 
           
          
         
           \text{minibatch} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord text"><span class="mord">minibatch</span></span></span></span></span></span>算法</a>中讨论，通过计算独立同分布地从数据生成分布中抽取的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           m 
          
         
        
          m 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></span>个<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           minibatch 
          
         
        
          \text{minibatch} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord text"><span class="mord">minibatch</span></span></span></span></span></span>样本的梯度均值，我们可以得到梯度的无偏估计。</p> </li><li> <p><a id="ba_alg1">算法1：展示了如何使用这个下降梯度的估计。</a></p> 
  <hr> <p><strong>算法1描述</strong>：随机梯度下降(<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           SGD 
          
         
        
          \text{SGD} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord text"><span class="mord">SGD</span></span></span></span></span></span>)在第<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           k 
          
         
        
          k 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span></span></span>个训练迭代的更新</p> 
  <hr> <p><strong>伪代码</strong>：<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           R 
          
         
           e 
          
         
           q 
          
         
           u 
          
         
           i 
          
         
           r 
          
         
           e 
          
         
        
          \bold{Require} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathbf">Require</span></span></span></span></span></span>: 学习速率<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            ϵ 
           
          
            k 
           
          
         
        
          \epsilon_k 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           R 
          
         
           e 
          
         
           q 
          
         
           u 
          
         
           i 
          
         
           r 
          
         
           e 
          
         
        
          \bold{Require} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathbf">Require</span></span></span></span></span></span>: 初始参数<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           θ 
          
         
        
          \boldsymbol{\theta} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
          
            w 
           
          
            h 
           
          
            i 
           
          
            l 
           
          
            e 
           
          
         
        
          \quad\bold{while} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathbf">while</span></span></span></span></span></span> 没有达到停止准则 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           d 
          
         
           o 
          
         
        
          \bold{do} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord"><span class="mord mathbf">do</span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
         
        
          \qquad 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>从训练集中采包含<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           m 
          
         
        
          m 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></span>个样本<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           { 
          
          
          
            x 
           
           
           
             ( 
            
           
             i 
            
           
             ) 
            
           
          
         
           , 
          
         
           … 
          
         
           , 
          
          
          
            x 
           
           
           
             ( 
            
           
             m 
            
           
             ) 
            
           
          
         
           } 
          
         
        
          \{\boldsymbol{x}^{(i)},\dots,\boldsymbol{x}^{(m)}\} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.138em; vertical-align: -0.25em;"></span><span class="mopen">{<!-- --></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">m</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span>的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           minibatch 
          
         
        
          \text{minibatch} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord text"><span class="mord">minibatch</span></span></span></span></span></span>，对应目标为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            y 
           
           
           
             ( 
            
           
             i 
            
           
             ) 
            
           
          
         
        
          \boldsymbol{y}^{(i)} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.0824em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">y</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
         
        
          \qquad 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>计算梯度估计：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            g 
           
          
            ^ 
           
          
         
           ← 
          
         
           + 
          
          
          
            1 
           
          
            m 
           
          
          
          
            ∇ 
           
          
            θ 
           
          
          
          
            ∑ 
           
          
            i 
           
          
         
           L 
          
         
           ( 
          
         
           f 
          
         
           ( 
          
          
          
            x 
           
           
           
             ( 
            
           
             i 
            
           
             ) 
            
           
          
         
           ; 
          
         
           θ 
          
         
           ) 
          
         
           , 
          
          
          
            y 
           
           
           
             ( 
            
           
             i 
            
           
             ) 
            
           
          
         
           ) 
          
         
        
          \hat{\boldsymbol{g}}\gets +\frac{1}{m}\nabla_\theta\sum_i L(f(\boldsymbol{x}^{(i)};\boldsymbol{\theta}),\boldsymbol{y}^{(i)}) 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.9023em; vertical-align: -0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.7079em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">g</span></span></span></span><span class="" style="top: -3.0134em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1944em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.233em; vertical-align: -0.345em;"></span><span class="mord">+</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8451em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: 0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.162em;"><span class="" style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2997em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">y</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
         
        
          \qquad 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>应用更新：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           θ 
          
         
           ← 
          
         
           θ 
          
         
           − 
          
         
           ϵ 
          
          
          
            g 
           
          
            ^ 
           
          
         
        
          \boldsymbol{\theta}\gets\boldsymbol{\theta}-\epsilon\hat{\boldsymbol{g}} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7778em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9023em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">ϵ</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.7079em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">g</span></span></span></span><span class="" style="top: -3.0134em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1944em;"><span class=""></span></span></span></span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
          
            e 
           
          
            n 
           
          
            d 
           
          
         
        
          \quad\bold{end} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathbf">end</span></span></span></span></span></span> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           w 
          
         
           h 
          
         
           i 
          
         
           l 
          
         
           e 
          
         
        
          \bold{while} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord"><span class="mord mathbf">while</span></span></span></span></span></span></p> 
  <hr> </li><li> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           SGD 
          
         
        
          \text{SGD} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord text"><span class="mord">SGD</span></span></span></span></span></span>算法中的一个关键参数是学习速率。之前，我们介绍的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           SGD 
          
         
        
          \text{SGD} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord text"><span class="mord">SGD</span></span></span></span></span></span>使用固定的学习速率。在实践中，有必要随着时间的推移逐渐降低学习速率，因此我们将第<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           k 
          
         
        
          k 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span></span></span>步迭代的学习速率记作<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            ϵ 
           
          
            k 
           
          
         
        
          \epsilon_k 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>。</p> </li><li> <p>这是因为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           SGD 
          
         
        
          \text{SGD} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord text"><span class="mord">SGD</span></span></span></span></span></span>梯度估计引入的噪源（<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           m 
          
         
        
          m 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></span>个训练样本的随机采样）并不会在极小值处消失。相比之下，当我们使用<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           batch 
          
         
        
          \text{batch} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord text"><span class="mord">batch</span></span></span></span></span></span>梯度下降到达极小值时，整个代价函数的真实梯度会变得很小，甚至为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           0 
          
         
        
          0 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0</span></span></span></span></span>，因此<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           batch 
          
         
        
          \text{batch} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord text"><span class="mord">batch</span></span></span></span></span></span>梯度下降可以使用固定的学习速率。保证<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           SGD 
          
         
        
          \text{SGD} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord text"><span class="mord">SGD</span></span></span></span></span></span>收敛的一个充分条件是：<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            ∑ 
           
           
           
             k 
            
           
             = 
            
           
             1 
            
           
          
            ∞ 
           
          
          
          
            ϵ 
           
          
            k 
           
          
         
           = 
          
         
           ∞ 
          
         
        
          \sum\limits_{k=1}^\infty \epsilon_k=\infty 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.3535em; vertical-align: -1.0021em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3514em;"><span class="" style="top: -2.0979em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop op-symbol small-op">∑</span></span></span><span class="" style="top: -3.95em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.0021em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord">∞</span></span></span></span></span> <a id="ba_eq1"><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
           
           
           
             — 
            
            
            
              公式1 
             
            
           
          
         
           \quad\textbf{---\footnotesize{公式1}} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5489em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord textbf">—</span><span class="mord sizing reset-size6 size4"><span class="mord textbf cjk_fallback">公式</span><span class="mord textbf">1</span></span></span></span></span></span></span></a><br> 且<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            ∑ 
           
           
           
             k 
            
           
             = 
            
           
             1 
            
           
          
            ∞ 
           
          
          
          
            ϵ 
           
          
            k 
           
          
            2 
           
          
         
           &lt; 
          
         
           ∞ 
          
         
        
          \sum\limits_{k=1}^\infty \epsilon_k^2&lt;\infty 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.3535em; vertical-align: -1.0021em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3514em;"><span class="" style="top: -2.0979em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop op-symbol small-op">∑</span></span></span><span class="" style="top: -3.95em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.0021em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -2.4169em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2831em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord">∞</span></span></span></span></span> <a id="ba_eq2"><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
           
           
           
             — 
            
            
            
              公式2 
             
            
           
          
         
           \quad\textbf{---\footnotesize{公式2}} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5489em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord textbf">—</span><span class="mord sizing reset-size6 size4"><span class="mord textbf cjk_fallback">公式</span><span class="mord textbf">2</span></span></span></span></span></span></span></a></p> </li><li> <p>实践中，一般会线性衰减学习速率到第<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           τ 
          
         
        
          \tau 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.1132em;">τ</span></span></span></span></span> 次迭代：<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            ϵ 
           
          
            k 
           
          
         
           = 
          
         
           ( 
          
         
           1 
          
         
           − 
          
         
           α 
          
         
           ) 
          
          
          
            ϵ 
           
          
            0 
           
          
         
           + 
          
         
           α 
          
          
          
            ϵ 
           
          
            τ 
           
          
         
        
          \epsilon_k=(1-\alpha)\epsilon_0+\alpha\epsilon_\tau 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> <a id="ba_eq3"><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
           
           
           
             — 
            
            
            
              公式3 
             
            
           
          
         
           \quad\textbf{---\footnotesize{公式3}} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5489em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord textbf">—</span><span class="mord sizing reset-size6 size4"><span class="mord textbf cjk_fallback">公式</span><span class="mord textbf">3</span></span></span></span></span></span></span></a></p> 
  <ul><li>其中<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            α 
           
          
            = 
           
           
            
            
              k 
             
            
              τ 
             
            
           
          
         
           \alpha=\displaystyle\frac{k}{\tau} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.0574em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3714em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1132em;">τ</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></li><li>在<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            τ 
           
          
         
           \tau 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.1132em;">τ</span></span></span></span></span>步迭代之后，一般使<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            ϵ 
           
          
         
           \epsilon 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span>保持常数</li></ul> </li><li> <p><u><strong>学习速率</strong></u>可通过试验和误差来选取，通常最好的选择方法是画出目标函数值随时间变化的学习曲线。</p> 
  <ul><li>与其说是科学，这更是一门艺术，关于这个问题的大多数指导都应该被怀疑地看待。</li><li>使用线性时间表时，参数选择为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
           
           
             ϵ 
            
           
             0 
            
           
          
         
           \epsilon_0 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
           
           
             ϵ 
            
           
             τ 
            
           
          
         
           \epsilon_\tau 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            τ 
           
          
         
           \tau 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.1132em;">τ</span></span></span></span></span>。</li><li>通常<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            τ 
           
          
         
           \tau 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.1132em;">τ</span></span></span></span></span>被设为需要反复遍历训练样本几百次的迭代次数。</li><li>通常<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
           
           
             ϵ 
            
           
             τ 
            
           
          
         
           \epsilon_\tau 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>应设为大约<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            1 
           
          
            % 
           
          
         
           1\% 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8056em; vertical-align: -0.0556em;"></span><span class="mord">1%</span></span></span></span></span> 的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
           
           
             ϵ 
            
           
             0 
            
           
          
         
           \epsilon_0 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>。</li><li>主要问题是如何设置<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
           
           
             ϵ 
            
           
             0 
            
           
          
         
           \epsilon_0 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>。</li><li>若<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
           
           
             ϵ 
            
           
             0 
            
           
          
         
           \epsilon_0 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>太大，学习曲线将会剧烈振荡，代价函数值通常会明显增加。</li><li>温和的振荡是良好的，特别是训练于随机代价函数上，例如由信号丢失引起的代价函数。</li><li>如果学习速率太慢，那么学习进程会缓慢。</li><li>如果初始学习速率太低，那么学习可能会卡在一个相当高的损失值。</li><li>通常，就总训练时间和最终损失值而言，最优初始学习速率会高于大约迭代<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            100 
           
          
         
           100 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">100</span></span></span></span></span>步后输出最好效果的学习速率。</li><li>因此，通常最好是检测最早的几轮迭代，使用一个高于此时效果最佳学习速率的学习速率，但又不能太高以致严重的不稳定性。</li></ul> </li><li> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           SGD 
          
         
        
          \text{SGD} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord text"><span class="mord">SGD</span></span></span></span></span></span>和相关的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           minibatch 
          
         
        
          \text{minibatch} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord text"><span class="mord">minibatch</span></span></span></span></span></span>或在线基于梯度的优化的最重要的性质是每一步更新的计算时间不会随着训练样本数目而增加。</p> 
  <ul><li>即使训练样本数目非常大时，这也能收敛。</li><li>对于足够大的数据集，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            SGD 
           
          
         
           \text{SGD} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord text"><span class="mord">SGD</span></span></span></span></span></span>可能会在处理整个训练集之前就收敛到最终测试集误差的某个固定容差范围内。</li></ul> </li><li> <p>研究优化算法的收敛率，一般会衡量<strong>额外误差</strong>(excess error) <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           J 
          
         
           ( 
          
         
           θ 
          
         
           ) 
          
         
           − 
          
          
           
           
             min 
            
           
             ⁡ 
            
           
          
            θ 
           
          
         
           J 
          
         
           ( 
          
         
           θ 
          
         
           ) 
          
         
        
          J(\boldsymbol{\theta}) − \min_{\boldsymbol{\theta}} J(\boldsymbol{\theta}) 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0962em;">J</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop"><span class="mop">min</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right: 0.0319em;">θ</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0962em;">J</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span><span class="mclose">)</span></span></span></span></span>，即当前代价函数超出最低可能损失的量。</p> 
  <ul><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            SGD 
           
          
         
           \text{SGD} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord text"><span class="mord">SGD</span></span></span></span></span></span>应用于凸问题时，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            k 
           
          
         
           k 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span></span></span>步迭代后的额外误差量级是<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            O 
           
          
            ( 
           
           
            
            
              1 
             
             
             
               k 
              
             
            
           
             ) 
            
           
          
         
           \Omicron(\displaystyle\frac{1}{\sqrt{k}}) 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.2514em; vertical-align: -0.93em;"></span><span class="mord mathrm">O</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.1778em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.9322em;"><span class="svg-align" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="padding-left: 0.833em;"><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span><span class="" style="top: -2.8922em;"><span class="pstrut" style="height: 3em;"></span><span class="hide-tail" style="min-width: 0.853em; height: 1.08em;"> 
                     <svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"> 
                      <path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path> 
                     </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1078em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.93em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span>，在强凸情况下是<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            O 
           
          
            ( 
           
           
            
            
              1 
             
            
              k 
             
            
           
             ) 
            
           
          
         
           \Omicron(\displaystyle\frac{1}{k}) 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.0074em; vertical-align: -0.686em;"></span><span class="mord mathrm">O</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span>。</li><li>除非假定额外的条件，否则这些界限不能进一步改进。</li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            batch 
           
          
         
           \text{batch} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord text"><span class="mord">batch</span></span></span></span></span></span>梯度下降在理论上比随机梯度下降有更好的收敛率。</li><li>然而，Cramér-Rao界限 (Cramér, 1946; Rao, 1945) 指出，泛化误差的下降速度不会快于<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            O 
           
          
            ( 
           
           
            
            
              1 
             
            
              k 
             
            
           
             ) 
            
           
          
         
           \Omicron(\displaystyle\frac{1}{k}) 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.0074em; vertical-align: -0.686em;"></span><span class="mord mathrm">O</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span>。</li><li>Bottou and Bousquet (2008b) 由此认为对于机器学习任务，不值得探寻收敛快于<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            O 
           
          
            ( 
           
           
            
            
              1 
             
            
              k 
             
            
           
             ) 
            
           
          
         
           \Omicron(\displaystyle\frac{1}{k}) 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.0074em; vertical-align: -0.686em;"></span><span class="mord mathrm">O</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span>的优化算法—更快的收敛可能对应着过拟合。</li><li>此外，渐近分析掩盖随机梯度下降在少量更新步之后的很多优点。</li><li>对于大数据集，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            SGD 
           
          
         
           \text{SGD} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord text"><span class="mord">SGD</span></span></span></span></span></span>初始快速更新只需非常少量样本计算梯度的能力远远超过了其缓慢的渐近收敛。</li><li>本篇章剩余部分介绍的大多数算法都实现了实践中有用的好处，但是丢失了常数倍<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            O 
           
          
            ( 
           
           
            
            
              1 
             
            
              k 
             
            
           
             ) 
            
           
          
         
           \Omicron(\displaystyle\frac{1}{k}) 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.0074em; vertical-align: -0.686em;"></span><span class="mord mathrm">O</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span>的渐近分析。</li><li>我们也可以权衡batch梯度下降和随机梯度下降两者的优点，在学习过程中逐渐增大<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            minibatch 
           
          
         
           \text{minibatch} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord text"><span class="mord">minibatch</span></span></span></span></span></span>的大小。</li></ul> </li></ul> 
<h3><a id="a_idba_ma_72"></a><a id="ba_m">动量</a></h3> 
<ul><li> <p>虽然随机梯度下降仍然是非常受欢迎的优化方法，但学习速率有时会很慢。</p> </li><li> <p>动量方法(Polyak, 1964)旨在加速学习，特别是处理高曲率，小但一致的梯度，或是带噪扰的梯度。</p> 
  <ul><li>动量算法积累了之前梯度指数级衰减的移动平均，并且继续沿该方向移动。</li><li>动量的效果如<a href="#ba_fig1" rel="nofollow">图例1</a>所示。</li></ul> </li><li> <p>从形式上看，动量算法引入了变量<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           v 
          
         
        
          \boldsymbol{v} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">v</span></span></span></span></span></span></span>充当速度的角色—它代表参数在参数空间移动的方向和速度。</p> 
  <ul><li>速度被设为负梯度的指数衰减平均。</li><li>名称<strong>动量</strong>(momentum)来自物理类比，根据牛顿运动定律，负梯度是移动参数空间中粒子的力。</li><li><u>动量在物理学上是质量乘以速度</u>。</li><li>在动量学习算法中，我们假设是单位质量，因此速度向量<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            v 
           
          
         
           \boldsymbol{v} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">v</span></span></span></span></span></span></span>也可以看作是粒子的动量。超参数<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            α 
           
          
            ∈ 
           
          
            [ 
           
          
            0 
           
          
            , 
           
          
            1 
           
          
            ) 
           
          
         
           \alpha\in\text{[}0,1\text{)} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">[</span></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">1</span><span class="mord text"><span class="mord">)</span></span></span></span></span></span>决定了之前梯度的贡献衰减得有多快。</li><li>更新规则如下：<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            v 
           
          
            ← 
           
          
            α 
           
          
            v 
           
          
            − 
           
          
            ϵ 
           
           
           
             ∇ 
            
           
             θ 
            
           
           
           
             ( 
            
            
             
             
               1 
              
             
               m 
              
             
             
             
               ∑ 
              
              
              
                i 
               
              
                = 
               
              
                1 
               
              
             
               m 
              
             
            
              L 
             
            
              ( 
             
            
              f 
             
            
              ( 
             
             
             
               x 
              
              
              
                ( 
               
              
                i 
               
              
                ) 
               
              
             
            
              ; 
             
            
              θ 
             
            
              ) 
             
            
              , 
             
             
             
               y 
              
              
              
                ( 
               
              
                i 
               
              
                ) 
               
              
             
            
              ) 
             
            
           
             ) 
            
           
          
         
           \boldsymbol{v}\gets\alpha \boldsymbol{v}-\epsilon\nabla_\theta \left(\displaystyle\frac{1}{m}\sum\limits_{i=1}^m L(f(\boldsymbol{x}^{(i)};\boldsymbol{\theta}),\boldsymbol{y}^{(i)})\right) 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">v</span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">v</span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 3.0277em; vertical-align: -1.2777em;"></span><span class="mord mathnormal">ϵ</span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size4">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.6514em;"><span class="" style="top: -1.8723em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.3em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.2777em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">y</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size4">)</span></span></span></span></span></span></span> <a id="ba_eq4"><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
            
            
            
              — 
             
             
             
               公式4 
              
             
            
           
          
            \quad\textbf{---\footnotesize{公式4}} 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5489em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord textbf">—</span><span class="mord sizing reset-size6 size4"><span class="mord textbf cjk_fallback">公式</span><span class="mord textbf">4</span></span></span></span></span></span></span></a><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            θ 
           
          
            ← 
           
          
            θ 
           
          
            + 
           
          
            v 
           
          
         
           \boldsymbol{\theta}\gets\boldsymbol{\theta}+\boldsymbol{v} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7778em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">v</span></span></span></span></span></span></span> <a id="ba_eq5"><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
            
            
            
              — 
             
             
             
               公式5 
              
             
            
           
          
            \quad\textbf{---\footnotesize{公式5}} 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5489em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord textbf">—</span><span class="mord sizing reset-size6 size4"><span class="mord textbf cjk_fallback">公式</span><span class="mord textbf">5</span></span></span></span></span></span></span></a></li><li>速度<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            v 
           
          
         
           \boldsymbol{v} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">v</span></span></span></span></span></span></span>累积了梯度元素<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
           
           
             ∇ 
            
           
             θ 
            
           
           
           
             ( 
            
            
             
             
               1 
              
             
               m 
              
             
             
             
               ∑ 
              
              
              
                i 
               
              
                = 
               
              
                1 
               
              
             
               m 
              
             
            
              L 
             
            
              ( 
             
            
              f 
             
            
              ( 
             
             
             
               x 
              
              
              
                ( 
               
              
                i 
               
              
                ) 
               
              
             
            
              ; 
             
            
              θ 
             
            
              ) 
             
            
              , 
             
             
             
               y 
              
              
              
                ( 
               
              
                i 
               
              
                ) 
               
              
             
            
              ) 
             
            
           
             ) 
            
           
          
         
           \nabla_\theta \left(\displaystyle\frac{1}{m}\sum\limits_{i=1}^m L(f(\boldsymbol{x}^{(i)};\boldsymbol{\theta}),\boldsymbol{y}^{(i)})\right) 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 3.0277em; vertical-align: -1.2777em;"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size4">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.6514em;"><span class="" style="top: -1.8723em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.3em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.2777em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">y</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size4">)</span></span></span></span></span></span></span>。相对于<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            ϵ 
           
          
         
           \epsilon 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span>的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            α 
           
          
         
           \alpha 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span></span></span></span></span>越大，之前梯度对现在方向的影响也越大。带动量的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            SGD 
           
          
         
           \text{SGD} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord text"><span class="mord">SGD</span></span></span></span></span></span>算法如<a href="#ba_alg2" rel="nofollow">算法2</a>所示。</li></ul> </li><li> <p><a id="ba_alg2">算法2：使用动量的随机梯度下降(<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            SGD 
           
          
         
           \text{SGD} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord text"><span class="mord">SGD</span></span></span></span></span></span>)</a></p> 
  <hr> <p><strong>算法2描述</strong>：使用动量的随机梯度下降(<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           SGD 
          
         
        
          \text{SGD} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord text"><span class="mord">SGD</span></span></span></span></span></span>)</p> 
  <hr> <p><strong>伪代码</strong>：<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           R 
          
         
           e 
          
         
           q 
          
         
           u 
          
         
           i 
          
         
           r 
          
         
           e 
          
         
        
          \bold{Require} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathbf">Require</span></span></span></span></span></span>: 学习速率<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            ϵ 
           
          
            k 
           
          
         
        
          \epsilon_k 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，动量参数<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           α 
          
         
        
          \alpha 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           R 
          
         
           e 
          
         
           q 
          
         
           u 
          
         
           i 
          
         
           r 
          
         
           e 
          
         
        
          \bold{Require} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathbf">Require</span></span></span></span></span></span>: 初始参数<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           θ 
          
         
        
          \boldsymbol{\theta} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span></span></span></span></span>，初始速度<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           v 
          
         
        
          \boldsymbol{v} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">v</span></span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
          
            w 
           
          
            h 
           
          
            i 
           
          
            l 
           
          
            e 
           
          
         
        
          \quad\bold{while} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathbf">while</span></span></span></span></span></span> 没有达到停止准则 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           d 
          
         
           o 
          
         
        
          \bold{do} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord"><span class="mord mathbf">do</span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
         
        
          \qquad 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>从训练集中采包含<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           m 
          
         
        
          m 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></span>个样本<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           { 
          
          
          
            x 
           
           
           
             ( 
            
           
             i 
            
           
             ) 
            
           
          
         
           , 
          
         
           … 
          
         
           , 
          
          
          
            x 
           
           
           
             ( 
            
           
             m 
            
           
             ) 
            
           
          
         
           } 
          
         
        
          \{\boldsymbol{x}^{(i)},\dots,\boldsymbol{x}^{(m)}\} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.138em; vertical-align: -0.25em;"></span><span class="mopen">{<!-- --></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">m</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span>的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           minibatch 
          
         
        
          \text{minibatch} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord text"><span class="mord">minibatch</span></span></span></span></span></span>，对应目标为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            y 
           
           
           
             ( 
            
           
             i 
            
           
             ) 
            
           
          
         
        
          \boldsymbol{y}^{(i)} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.0824em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">y</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
         
        
          \qquad 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>计算梯度估计：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            g 
           
          
            ^ 
           
          
         
           ← 
          
          
           
           
             1 
            
           
             m 
            
           
           
           
             ∇ 
            
           
             θ 
            
           
           
           
             ∑ 
            
           
             i 
            
           
          
            L 
           
          
            ( 
           
          
            f 
           
          
            ( 
           
           
           
             x 
            
            
            
              ( 
             
            
              i 
             
            
              ) 
             
            
           
          
            ; 
           
          
            θ 
           
          
            ) 
           
          
            , 
           
           
           
             y 
            
            
            
              ( 
             
            
              i 
             
            
              ) 
             
            
           
          
            ) 
           
          
         
        
          \hat{\boldsymbol{g}}\gets \displaystyle\frac{1}{m}\nabla_\theta\sum_i L(f(\boldsymbol{x}^{(i)};\boldsymbol{\theta}),\boldsymbol{y}^{(i)}) 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.9023em; vertical-align: -0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.7079em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">g</span></span></span></span><span class="" style="top: -3.0134em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1944em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.5991em; vertical-align: -1.2777em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -1.8723em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.2777em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">y</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
         
        
          \qquad 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>计算速度更新：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           v 
          
         
           ← 
          
         
           α 
          
         
           v 
          
         
           − 
          
         
           ϵ 
          
         
           g 
          
         
        
          \boldsymbol{v}\gets\alpha \boldsymbol{v}-\epsilon\boldsymbol{g} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">v</span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">v</span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6389em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">ϵ</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">g</span></span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
         
        
          \qquad 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>应用更新：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           θ 
          
         
           ← 
          
         
           θ 
          
         
           + 
          
         
           v 
          
         
        
          \boldsymbol{\theta}\gets\boldsymbol{\theta}+\boldsymbol{v} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7778em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">v</span></span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
          
            e 
           
          
            n 
           
          
            d 
           
          
         
        
          \quad\bold{end} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathbf">end</span></span></span></span></span></span> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           w 
          
         
           h 
          
         
           i 
          
         
           l 
          
         
           e 
          
         
        
          \bold{while} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord"><span class="mord mathbf">while</span></span></span></span></span></span></p> 
  <hr> 
  <ul><li>之前，步长只是梯度范数乘以学习速率。现在，步长取决于梯度序列的大小和排列。</li><li>当许多连续的梯度指向相同的方向时，步长最大。</li><li>如果动量算法总是观测到梯度<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            g 
           
          
         
           \boldsymbol{g} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6389em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">g</span></span></span></span></span></span></span>，那么它会在方向<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            − 
           
          
            g 
           
          
         
           −g 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7778em; vertical-align: -0.1944em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right: 0.0359em;">g</span></span></span></span></span>上不停加速，直到达到最后速度的步长为：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
           
            
             
             
               ϵ 
              
             
               ∥ 
              
             
               g 
              
             
               ∥ 
              
             
             
             
               1 
              
             
               − 
              
             
               α 
              
             
            
           
          
         
           \displaystyle\frac{\epsilon\Vert\boldsymbol{g}\Vert}{1-\alpha} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.1963em; vertical-align: -0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">g</span></span></span><span class="mord">∥</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7693em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> <a id="ba_eq6"><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
            
            
            
              — 
             
             
             
               公式6 
              
             
            
           
          
            \quad\textbf{---\footnotesize{公式6}} 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5489em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord textbf">—</span><span class="mord sizing reset-size6 size4"><span class="mord textbf cjk_fallback">公式</span><span class="mord textbf">6</span></span></span></span></span></span></span></a></li><li>因此将动量的超参数视为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
           
            
            
              1 
             
             
             
               1 
              
             
               − 
              
             
               α 
              
             
            
           
          
         
           \displaystyle\frac{1}{1-\alpha} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.0908em; vertical-align: -0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7693em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>有助于理解。例如，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            α 
           
          
            = 
           
          
            0.9 
           
          
         
           \alpha=0.9 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0.9</span></span></span></span></span>对应着最大速度<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            10 
           
          
         
           10 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">10</span></span></span></span></span>倍于梯度下降算法。</li><li>在实践中，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            α 
           
          
         
           \alpha 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span></span></span></span></span>的一般取值为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            0.5 
           
          
         
           0.5 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0.5</span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            0.9 
           
          
         
           0.9 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0.9</span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            0.99 
           
          
         
           0.99 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0.99</span></span></span></span></span>。和学习速率一样，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            α 
           
          
         
           \alpha 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span></span></span></span></span>也会随着时间变化。一般初始值是一个较小的值，随后会慢慢变大。随着时间推移改变<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            α 
           
          
         
           \alpha 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span></span></span></span></span>没有收缩<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            ϵ 
           
          
         
           \epsilon 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span>更重要。</li></ul> </li><li> <p>我们可以将<u>动量算法</u>视为模拟连续时间下牛顿动力学下的粒子。这种物理类比有助于直觉上理解动量和梯度下降算法是如何表现的。</p> 
  <ul><li>粒子在任意时间点的位置由<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            θ 
           
          
            ( 
           
          
            t 
           
          
            ) 
           
          
         
           \boldsymbol{\theta}(t) 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span>给定。粒子会受到净力<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            f 
           
          
            ( 
           
          
            t 
           
          
            ) 
           
          
         
           \boldsymbol{f}(t) 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.1104em;">f</span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span>。该力会导致粒子加速：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            f 
           
          
            ( 
           
          
            t 
           
          
            ) 
           
          
            = 
           
           
            
             
             
               ∂ 
              
             
               2 
              
             
             
             
               ∂ 
              
              
              
                t 
               
              
                2 
               
              
             
            
           
             θ 
            
           
             ( 
            
           
             t 
            
           
             ) 
            
           
          
         
           \boldsymbol{f}(t)=\displaystyle\frac{\partial^2}{\partial t^2}\boldsymbol{\theta}(t) 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.1104em;">f</span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.1771em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.4911em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.0556em;">∂</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7401em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord" style="margin-right: 0.0556em;">∂</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span> <a id="ba_eq7"><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
            
            
            
              — 
             
             
             
               公式7 
              
             
            
           
          
            \quad\textbf{---\footnotesize{公式7}} 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5489em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord textbf">—</span><span class="mord sizing reset-size6 size4"><span class="mord textbf cjk_fallback">公式</span><span class="mord textbf">7</span></span></span></span></span></span></span></a></li><li>与其将其视为位置的二阶微分方程，我们不如引入表示粒子在时间<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            t 
           
          
         
           t 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span>处速度的变量<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            v 
           
          
            ( 
           
          
            t 
           
          
            ) 
           
          
         
           \boldsymbol{v}(t) 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">v</span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span>，将牛顿动力学重写为一阶微分方程：<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            v 
           
          
            ( 
           
          
            t 
           
          
            ) 
           
          
            = 
           
           
            
            
              ∂ 
             
             
             
               ∂ 
              
             
               t 
              
             
            
           
             θ 
            
           
             ( 
            
           
             t 
            
           
             ) 
            
           
          
         
           \boldsymbol{v}(t)=\displaystyle\frac{\partial}{\partial t}\boldsymbol{\theta}(t) 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">v</span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.0574em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3714em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.0556em;">∂</span><span class="mord mathnormal">t</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.0556em;">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span> <a id="ba_eq8"><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
            
            
            
              — 
             
             
             
               公式8 
              
             
            
           
          
            \quad\textbf{---\footnotesize{公式8}} 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5489em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord textbf">—</span><span class="mord sizing reset-size6 size4"><span class="mord textbf cjk_fallback">公式</span><span class="mord textbf">8</span></span></span></span></span></span></span></a><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
           
          
         
           \quad 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0em;"></span><span class="mspace" style="margin-right: 1em;"></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            f 
           
          
            ( 
           
          
            t 
           
          
            ) 
           
          
            = 
           
           
            
            
              ∂ 
             
             
             
               ∂ 
              
             
               t 
              
             
            
           
             v 
            
           
             ( 
            
           
             t 
            
           
             ) 
            
           
          
         
           \boldsymbol{f}(t)=\displaystyle\frac{\partial}{\partial t}\boldsymbol{v}(t) 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.1104em;">f</span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.0574em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3714em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.0556em;">∂</span><span class="mord mathnormal">t</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.0556em;">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">v</span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span> <a id="ba_eq9"><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
            
            
            
              — 
             
             
             
               公式9 
              
             
            
           
          
            \quad\textbf{---\footnotesize{公式9}} 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5489em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord textbf">—</span><span class="mord sizing reset-size6 size4"><span class="mord textbf cjk_fallback">公式</span><span class="mord textbf">9</span></span></span></span></span></span></span></a></li><li>由此，动量算法包括由数值模拟求解微分方程。求解微分方程的一个简单数值方法是欧拉方法，通过在每个梯度方向上小且有限的步来简单模拟该等式定义的动力学。</li></ul> </li><li> <p><u>这解释了动量更新的基本形式，但具体什么是力呢？</u></p> 
  <ul><li>力正比于代价函数的负梯度：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            − 
           
           
           
             ∇ 
            
           
             θ 
            
           
          
            J 
           
          
            ( 
           
          
            θ 
           
          
            ) 
           
          
         
           -\nabla_{\boldsymbol{\theta}}J(\boldsymbol{\theta}) 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">−</span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right: 0.0319em;">θ</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right: 0.0962em;">J</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span><span class="mclose">)</span></span></span></span></span>。 
    <ul><li>该力推动粒子沿着代价函数表面下坡的方向移动。</li><li>梯度下降算法基于每个梯度简单地更新一步，而使用动量算法的牛顿方案则使用该力改变粒子的速度。</li><li>我们可以将粒子视作在冰面上滑行的冰球。</li><li>每当它沿着表面最陡的部分下降时，它会累积继续在该方向上滑行的速度，直到其开始向上滑动为止。</li></ul> </li><li>另一个力也是必要的。如果代价函数的梯度是唯一的力，那么粒子可能永远不会停下来。 
    <ul><li>想象一下，假设冰面没有摩擦，一个冰球从山谷的一端下滑，上升到另一端，永远来回振荡。</li><li>要解决这个问题，我们添加另一个正比于<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
          
           
            
            
              − 
             
            
              v 
             
            
              ( 
             
            
              t 
             
            
              ) 
             
            
           
             −\boldsymbol{v}(t) 
            
           
         </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">−</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">v</span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span>的力。</li><li>在物理术语中，此力对应于<strong>粘性阻力</strong>，就像粒子必须通过一个抵抗介质，如糖浆。</li><li>这会导致粒子随着时间推移逐渐失去能量，最终收敛到局部极小点。</li></ul> </li></ul> </li><li> <p><u>为什么要特别使用<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            − 
           
          
            v 
           
          
            ( 
           
          
            t 
           
          
            ) 
           
          
         
           -\boldsymbol{v}(t) 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">−</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">v</span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span>和粘性阻力呢？</u></p> 
  <ul><li>部分原因是因为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            − 
           
          
            v 
           
          
            ( 
           
          
            t 
           
          
            ) 
           
          
         
           -\boldsymbol{v}(t) 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">−</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">v</span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span>在数学上的便利——速度的整数幂很容易处理。 
    <ul><li>然而，其他物理系统具有基于速度的其他整数幂的其他类型的阻力。</li><li>例如，颗粒通过空气时会受到正比于速度平方的湍流阻力，而颗粒沿着地面移动时会受到恒定大小的摩擦力。这些选择都不合适。</li><li>湍流阻力，正比于速度的平方，在速度很小时会很弱。</li><li>不够强到使粒子停下来。</li><li>非零值初始速度的粒子仅受到湍流阻力，会从初始位置永远地移动下去，和初始位置的距离大概正比于<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
          
           
            
            
              O 
             
            
              ( 
             
            
              log 
             
            
              ⁡ 
             
            
              t 
             
            
              ) 
             
            
           
             \Omicron(\log t) 
            
           
         </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathrm">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right: 0.0139em;">g</span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span>。</li><li>因此我们必须使用速度较低幂次的力。如果幂次为零，相当于干摩擦，那么力太强了。</li><li>当代价函数的梯度表示的力很小但非零时，由于摩擦导致的恒力会使得粒子在达到局部极小点之前就停下来。</li></ul> </li><li><strong>粘性阻力</strong> 
    <ul><li>粘性阻力避免了这两个问题——它足够弱，可以使梯度引起的运动直到达到最小，但又足够强，使得坡度不够时可以阻止运动。</li></ul> </li></ul> </li></ul> 
<h3><a id="a_idba_nmNesterova_140"></a><a id="ba_nm">Nesterov动量</a></h3> 
<ul><li> <p>受 Nesterov 加速梯度算法 (Nesterov, 1983, 2004) 启发，Sutskever et al. (2013)提出了动量算法的一个变种。这种情况的更新规则如下：<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           v 
          
         
           ← 
          
         
           α 
          
         
           v 
          
         
           − 
          
         
           ϵ 
          
          
          
            ∇ 
           
          
            θ 
           
          
          
          
            [ 
           
           
            
            
              1 
             
            
              m 
             
            
            
            
              ∑ 
             
             
             
               i 
              
             
               = 
              
             
               1 
              
             
            
              m 
             
            
           
             L 
            
           
             ( 
            
           
             f 
            
           
             ( 
            
            
            
              x 
             
             
             
               ( 
              
             
               i 
              
             
               ) 
              
             
            
           
             ; 
            
           
             θ 
            
           
             + 
            
           
             α 
            
           
             v 
            
           
             ) 
            
           
             , 
            
            
            
              y 
             
             
             
               ( 
              
             
               i 
              
             
               ) 
              
             
            
           
             ) 
            
           
          
            ] 
           
          
         
        
          \boldsymbol{v}\gets\alpha \boldsymbol{v}-\epsilon\nabla_\theta \left[\displaystyle\frac{1}{m}\sum\limits_{i=1}^m L(f(\boldsymbol{x}^{(i)};\boldsymbol{\theta}+\alpha\boldsymbol{v}),\boldsymbol{y}^{(i)})\right] 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">v</span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">v</span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 3.0277em; vertical-align: -1.2777em;"></span><span class="mord mathnormal">ϵ</span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size4">[</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.6514em;"><span class="" style="top: -1.8723em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.3em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.2777em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">v</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">y</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size4">]</span></span></span></span></span></span></span> <a id="ba_eq10"><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
           
           
           
             — 
            
            
            
              公式10 
             
            
           
          
         
           \quad\textbf{---\footnotesize{公式10}} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5489em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord textbf">—</span><span class="mord sizing reset-size6 size4"><span class="mord textbf cjk_fallback">公式</span><span class="mord textbf">10</span></span></span></span></span></span></span></a><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           θ 
          
         
           ← 
          
         
           θ 
          
         
           + 
          
         
           v 
          
         
        
          \boldsymbol{\theta}\gets\boldsymbol{\theta}+\boldsymbol{v} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7778em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">v</span></span></span></span></span></span></span> <a id="ba_eq11"><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
           
           
           
             — 
            
            
            
              公式11 
             
            
           
          
         
           \quad\textbf{---\footnotesize{公式11}} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5489em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord textbf">—</span><span class="mord sizing reset-size6 size4"><span class="mord textbf cjk_fallback">公式</span><span class="mord textbf">11</span></span></span></span></span></span></span></a></p> </li><li> <p>其中参数<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           α 
          
         
        
          \alpha 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           ϵ 
          
         
        
          \epsilon 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span>发挥了和标准动量方法中类似的作用。 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           Nesterov 
          
         
        
          \text{Nesterov} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord text"><span class="mord">Nesterov</span></span></span></span></span></span>动量和标准动量之间的区别体现在梯度计算上。<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           Nesterov 
          
         
        
          \text{Nesterov} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord text"><span class="mord">Nesterov</span></span></span></span></span></span>动量中，梯度计算在施加当前速度之后。因此，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           Nesterov 
          
         
        
          \text{Nesterov} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord text"><span class="mord">Nesterov</span></span></span></span></span></span>动量可以解释为往标准动量方法中添加了一个校正因子。完整的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           Nesterov 
          
         
        
          \text{Nesterov} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord text"><span class="mord">Nesterov</span></span></span></span></span></span>动量算法如<a href="#ba_alg3" rel="nofollow">算法3</a>所示。</p> </li><li> <p><a id="ba_alg3">算法3：使用<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            Nesterov 
           
          
         
           \text{Nesterov} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord text"><span class="mord">Nesterov</span></span></span></span></span></span>动量的随机梯度下降(<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            SGD 
           
          
         
           \text{SGD} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord text"><span class="mord">SGD</span></span></span></span></span></span>)</a></p> 
  <hr> <p><strong>算法3描述</strong>：使用<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           Nesterov 
          
         
        
          \text{Nesterov} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord text"><span class="mord">Nesterov</span></span></span></span></span></span>动量的随机梯度下降(<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           SGD 
          
         
        
          \text{SGD} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord text"><span class="mord">SGD</span></span></span></span></span></span>)</p> 
  <hr> <p><strong>伪代码</strong>：<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           R 
          
         
           e 
          
         
           q 
          
         
           u 
          
         
           i 
          
         
           r 
          
         
           e 
          
         
        
          \bold{Require} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathbf">Require</span></span></span></span></span></span>: 学习速率<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            ϵ 
           
          
            k 
           
          
         
        
          \epsilon_k 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，动量参数<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           α 
          
         
        
          \alpha 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           R 
          
         
           e 
          
         
           q 
          
         
           u 
          
         
           i 
          
         
           r 
          
         
           e 
          
         
        
          \bold{Require} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathbf">Require</span></span></span></span></span></span>: 初始参数<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           θ 
          
         
        
          \boldsymbol{\theta} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span></span></span></span></span>，初始速度<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           v 
          
         
        
          \boldsymbol{v} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">v</span></span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
          
            w 
           
          
            h 
           
          
            i 
           
          
            l 
           
          
            e 
           
          
         
        
          \quad\bold{while} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathbf">while</span></span></span></span></span></span> 没有达到停止准则 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           d 
          
         
           o 
          
         
        
          \bold{do} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord"><span class="mord mathbf">do</span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
         
        
          \qquad 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>从训练集中采包含<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           m 
          
         
        
          m 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></span>个样本<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           { 
          
          
          
            x 
           
           
           
             ( 
            
           
             i 
            
           
             ) 
            
           
          
         
           , 
          
         
           … 
          
         
           , 
          
          
          
            x 
           
           
           
             ( 
            
           
             m 
            
           
             ) 
            
           
          
         
           } 
          
         
        
          \{\boldsymbol{x}^{(i)},\dots,\boldsymbol{x}^{(m)}\} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.138em; vertical-align: -0.25em;"></span><span class="mopen">{<!-- --></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">m</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span>的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           minibatch 
          
         
        
          \text{minibatch} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord text"><span class="mord">minibatch</span></span></span></span></span></span>，对应目标为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            y 
           
           
           
             ( 
            
           
             i 
            
           
             ) 
            
           
          
         
        
          \boldsymbol{y}^{(i)} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.0824em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">y</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
         
        
          \qquad 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>应用临时更新：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            θ 
           
          
            ~ 
           
          
         
           ← 
          
         
           θ 
          
         
           + 
          
         
           α 
          
         
           v 
          
         
        
          \tilde{\boldsymbol{\theta}}\gets\boldsymbol{\theta}+\alpha\boldsymbol{v} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.9313em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9313em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span></span><span class="" style="top: -3.6134em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;"><span class="mord">~</span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7778em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.4444em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">v</span></span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
         
        
          \qquad 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>计算梯度（在临时点）：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           g 
          
         
           ← 
          
          
           
           
             1 
            
           
             m 
            
           
           
           
             ∇ 
            
           
             θ 
            
           
           
           
             ∑ 
            
           
             i 
            
           
          
            L 
           
          
            ( 
           
          
            f 
           
          
            ( 
           
           
           
             x 
            
            
            
              ( 
             
            
              i 
             
            
              ) 
             
            
           
          
            ; 
           
          
            θ 
           
          
            ) 
           
          
            , 
           
           
           
             y 
            
            
            
              ( 
             
            
              i 
             
            
              ) 
             
            
           
          
            ) 
           
          
         
        
          \boldsymbol{g}\gets \displaystyle\frac{1}{m}\nabla_\theta\sum_i L(f(\boldsymbol{x}^{(i)};\boldsymbol{\theta}),\boldsymbol{y}^{(i)}) 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6389em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">g</span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.5991em; vertical-align: -1.2777em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -1.8723em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.2777em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">y</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
         
        
          \qquad 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>计算速度更新：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           v 
          
         
           ← 
          
         
           α 
          
         
           v 
          
         
           − 
          
         
           ϵ 
          
         
           g 
          
         
        
          \boldsymbol{v}\gets\alpha \boldsymbol{v}-\epsilon\boldsymbol{g} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">v</span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord mathnormal" style="margin-right: 0.0037em;">α</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">v</span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6389em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">ϵ</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">g</span></span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
         
        
          \qquad 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span></span></span></span></span>应用更新：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           θ 
          
         
           ← 
          
         
           θ 
          
         
           + 
          
         
           v 
          
         
        
          \boldsymbol{\theta}\gets\boldsymbol{\theta}+\boldsymbol{v} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7778em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.0319em;">θ</span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right: 0.037em;">v</span></span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
          
            e 
           
          
            n 
           
          
            d 
           
          
         
        
          \quad\bold{end} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathbf">end</span></span></span></span></span></span> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           w 
          
         
           h 
          
         
           i 
          
         
           l 
          
         
           e 
          
         
        
          \bold{while} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord"><span class="mord mathbf">while</span></span></span></span></span></span></p> 
  <hr> </li><li> <p>在凸<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           batch 
          
         
        
          \text{batch} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord text"><span class="mord">batch</span></span></span></span></span></span>梯度的情况下，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           Nesterov 
          
         
        
          \text{Nesterov} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord text"><span class="mord">Nesterov</span></span></span></span></span></span>动量将额外误差收敛率从<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           O 
          
         
           ( 
          
          
           
           
             1 
            
           
             k 
            
           
          
            ) 
           
          
         
        
          \Omicron(\displaystyle\frac{1}{k}) 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.0074em; vertical-align: -0.686em;"></span><span class="mord mathrm">O</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span>（<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           k 
          
         
        
          k 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span></span></span>步后）改进到<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           O 
          
         
           ( 
          
          
           
           
             1 
            
            
            
              k 
             
            
              2 
             
            
           
          
            ) 
           
          
         
        
          \Omicron(\displaystyle\frac{1}{k^2}) 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.0074em; vertical-align: -0.686em;"></span><span class="mord mathrm">O</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7401em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span>，如Nesterov(1983)所示。不幸的是，在随机梯度的情况下，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           Nesterov 
          
         
        
          \text{Nesterov} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord text"><span class="mord">Nesterov</span></span></span></span></span></span>动量没有改进收敛率。</p> </li><li> <p><a id="ba_fig1">图例1：动量的主要目的是解决两个问题：<u><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
           
             Hessian 
            
           
          
            \text{Hessian} 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord text"><span class="mord">Hessian</span></span></span></span></span></span>矩阵的不良条件数</u>和<u>随机梯度的方差</u>。</a></p> 
  <ul><li> <p>动量的主要目的是解决两个问题：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
           
             Hessian 
            
           
          
            \text{Hessian} 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord text"><span class="mord">Hessian</span></span></span></span></span></span>矩阵的不良条件数和随机梯度的方差。<br> <img src="https://images2.imgbox.com/fd/ff/WHXAmAea_o.png" alt="在这里插入图片描述"></p> </li><li> <p>说明：</p> 
    <ul><li>我们通过此图说明动量如何克服这两个问题的第一个。</li><li>轮廓线描绘了一个二次损失函数（具有不良条件数的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
          
           
            
            
              Hessian 
             
            
           
             \text{Hessian} 
            
           
         </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord text"><span class="mord">Hessian</span></span></span></span></span></span>矩阵）。</li><li>横跨轮廓的红色路径表示动量学习规则所遵循的路径，它使该函数最小化。</li><li>我们在每个步骤画一个箭头，指示梯度下降将在该点采取的步骤。</li><li>我们可以看到，一个条件数较差的二次目标函数看起来像一个长而窄的山谷或陡峭的峡谷。</li><li>动量正确地纵向穿过峡谷，而梯度步骤则会浪费时间在峡谷的窄轴上来回移动。比较<a href="https://blog.csdn.net/benny_zhou2004/article/details/140614096?spm=1001.2014.3001.5501#btgjh_fig3">图：梯度下降无法利用包含在Hessian矩阵中的曲率信息</a>，它也显示了没有动量的梯度下降的行为。</li></ul> </li></ul> </li></ul> 
<h2><a id="_177"></a>总结</h2> 
<p>深度模型中的优化算法是提升模型性能的重要工具。从基础的梯度下降法到先进的自适应学习率算法，这些算法在不断演进中解决了计算效率、收敛速度及稳定性等问题。<br> 未来，随着深度学习应用的不断拓展，优化算法的研究将继续深入，为更高效的模型训练提供有力支持。</p> 
<h2><a id="_181"></a>往期内容回顾</h2> 
<p><a href="https://blog.csdn.net/benny_zhou2004/article/details/139929724?spm=1001.2014.3001.5501">应用数学与机器学习基础 - 随机梯度下降算法篇</a><br> <a href="https://blog.csdn.net/benny_zhou2004/article/details/140614096?spm=1001.2014.3001.5501">应用数学与机器学习基础 - 数值计算之梯度之上Jacobian和Hessian矩阵篇</a><br> <a href="https://blog.csdn.net/benny_zhou2004/article/details/140095807?spm=1001.2014.3001.5501">深度网络现代实践 - 深度前馈网络之基于梯度的学习篇</a><br> <a href="https://blog.csdn.net/benny_zhou2004/article/details/139740854?spm=1001.2014.3001.5501">梯度下降算法之随机梯度下降</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ceeab73504d1874949c51ddc47fa3bab/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">如何在 Debian 8 上安装和使用 PostgreSQL 9.4</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/03852927083e88529111ab4f3698b6b2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Python酷库之旅-第三方库Pandas(045)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>