<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>pyspark从0开始的入门教程 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/ad60fd3abc8d0b84a32fd029f9d7c6ce/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="pyspark从0开始的入门教程">
  <meta property="og:description" content="Apache Spark 简介 Apache Spark 是一种分布式处理系统，用于在大型数据集上执行大数据和机器学习任务。
作为数据科学爱好者，您可能熟悉在本地设备上存储文件并使用 R 和 Python 等语言进行处理。但是，本地工作站有其局限性，无法处理非常大的数据集。
这就是像Apache Spark这样的分布式处理系统的用武之地。分布式处理是使用多个处理器来运行应用程序的设置。无需尝试在一台计算机上处理大型数据集，而是可以在相互通信的多个设备之间分配任务。
借助 Apache Spark，用户可以对 PB 级数据运行查询和机器学习工作流，这在本地设备上是无法做到的。
这个框架甚至比以前的数据处理引擎（如Hadoop）更快，并且在过去八年中越来越受欢迎。IBM、亚马逊和雅虎等公司正在使用 Apache Spark 作为他们的计算框架。
如果您想成为一名数据科学家，在大规模数据集上分析数据和训练机器学习模型的能力是一项宝贵的技能。拥有使用 Apache Spark 等大数据框架的专业知识将使您在该领域的其他人中脱颖而出。
什么是 PySpark？ PySpark 是 Python 中 Apache Spark 的接口。使用 PySpark，您可以编写类似 Python 和类似 SQL 的命令，以在分布式处理环境中操作和分析数据。这是一个初学者程序，将引导您使用 PySpark 操作数据、构建机器学习管道和调整模型。
PySpark是做什么用的？ 大多数数据科学家和分析师都熟悉 Python，并使用它来实现机器学习工作流。PySpark允许他们在大规模分布式数据集上使用熟悉的语言。
为什么选择 PySpark？ 收集TB级数据的公司将拥有像Apache Spark这样的大数据框架。要使用这些大规模数据集，仅了解 Python 和 R 框架是不够的。
你需要学习一个框架，允许你在分布式处理系统之上操作数据集，因为大多数数据驱动的组织都会要求你这样做。PySpark 是一个很好的入门点，因为它的语法很简单，如果您已经熟悉 Python，则可以轻松上手。
公司选择使用像PySpark这样的框架的原因是因为它可以快速处理大数据。它比 Pandas 和 Dask 等库更快，并且可以处理比这些框架更多的数据。例如，如果您要处理超过 PB 的数据，Pandas 和 Dask 将失败，但 PySpark 将能够轻松处理它。
虽然也可以在像Hadoop这样的分布式系统上编写Python代码，但许多组织选择使用Spark并使用PySpark API，因为它速度更快，可以处理实时数据。使用 PySpark，您可以编写代码从不断更新的源中收集数据，而数据只能使用 Hadoop 以批处理模式进行。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-27T11:55:29+08:00">
    <meta property="article:modified_time" content="2024-06-27T11:55:29+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">pyspark从0开始的入门教程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="Apache_Spark__0"></a>Apache Spark 简介</h3> 
<p><code>Apache Spark</code> 是一种分布式处理系统，用于在大型数据集上执行大数据和机器学习任务。</p> 
<p>作为数据科学爱好者，您可能熟悉在本地设备上存储文件并使用 R 和 Python 等语言进行处理。但是，本地工作站有其局限性，无法处理非常大的数据集。</p> 
<p>这就是像<code>Apache Spark</code>这样的分布式处理系统的用武之地。分布式处理是使用多个处理器来运行应用程序的设置。无需尝试在一台计算机上处理大型数据集，而是可以在相互通信的多个设备之间分配任务。</p> 
<p>借助<code> Apache Spark</code>，用户可以对 PB 级数据运行查询和机器学习工作流，这在本地设备上是无法做到的。</p> 
<p>这个框架甚至比以前的数据处理引擎（如<code>Hadoop</code>）更快，并且在过去八年中越来越受欢迎。IBM、亚马逊和雅虎等公司正在使用 <code>Apache Spark</code> 作为他们的计算框架。</p> 
<p>如果您想成为一名数据科学家，在大规模数据集上分析数据和训练机器学习模型的能力是一项宝贵的技能。拥有使用 <code>Apache Spark</code> 等大数据框架的专业知识将使您在该领域的其他人中脱颖而出。</p> 
<h4><a id="_PySpark_13"></a>什么是 <code>PySpark</code>？</h4> 
<p><code>PySpark</code> 是 Python 中 <code>Apache Spark</code> 的接口。使用 <code>PySpark</code>，您可以编写类似 Python 和类似 SQL 的命令，以在分布式处理环境中操作和分析数据。这是一个初学者程序，将引导您使用 PySpark 操作数据、构建机器学习管道和调整模型。</p> 
<h4><a id="PySpark_16"></a><code>PySpark</code>是做什么用的？</h4> 
<p>大多数数据科学家和分析师都熟悉 Python，并使用它来实现机器学习工作流。PySpark允许他们在大规模分布式数据集上使用熟悉的语言。</p> 
<h4><a id="_PySpark_19"></a>为什么选择 <code>PySpark</code>？</h4> 
<p>收集TB级数据的公司将拥有像<code>Apache Spark</code>这样的大数据框架。要使用这些大规模数据集，仅了解 Python 和 R 框架是不够的。</p> 
<p>你需要学习一个框架，允许你在分布式处理系统之上操作数据集，因为大多数数据驱动的组织都会要求你这样做。<code>PySpark</code> 是一个很好的入门点，因为它的语法很简单，如果您已经熟悉 Python，则可以轻松上手。</p> 
<p>公司选择使用像<code>PySpark</code>这样的框架的原因是因为它可以快速处理大数据。它比 <code>Pandas</code> 和 <code>Dask</code> 等库更快，并且可以处理比这些框架更多的数据。例如，如果您要处理超过 PB 的数据，<code>Pandas</code> 和 <code>Dask</code> 将失败，但 <code>PySpark</code> 将能够轻松处理它。</p> 
<p>虽然也可以在像<code>Hadoop</code>这样的分布式系统上编写Python代码，但许多组织选择使用<code>Spark</code>并使用<code>PySpark API</code>，因为它速度更快，可以处理实时数据。使用 <code>PySpark</code>，您可以编写代码从不断更新的源中收集数据，而数据只能使用 <code>Hadoop</code> 以批处理模式进行。</p> 
<p><code>Apache Flink</code> 是一个分布式处理系统，它有一个叫做 <code>PyFlink</code> 的 <code>Python API</code>，在性能方面实际上比 <code>Spark</code> 快。但是，<code>Apache Spark</code> 已经存在了更长的时间，并且拥有更好的社区支持，这意味着它更可靠。</p> 
<p>此外，<code>PySpark</code> 提供容错能力，这意味着它能够在故障发生后恢复损失。该框架还具有内存计算功能，并存储在随机存取存储器 （RAM） 中。它可以在未安装硬盘驱动器或 SSD 的计算机上运行。</p> 
<h3><a id="_PySpark_31"></a>如何安装 <code>PySpark</code></h3> 
<h4><a id="_32"></a>先决条件：</h4> 
<p>在安装 Apache Spark 和 PySpark 之前，您需要在设备上设置以下软件：</p> 
<h5><a id="python_36"></a><code>python</code></h5> 
<p>如果您尚未安装 Python，请按照我们的 <a href="https://www.datacamp.com/tutorial/python-developer-set-up" rel="nofollow">Python 开发人员设置指南进行设置</a>，然后再继续下一步。</p> 
<h5><a id="java_39"></a><code>java</code></h5> 
<p>接下来，如果您使用的是 Windows，请按照本教程在您的计算机上<a href="https://www.freecodecamp.org/news/how-to-install-java-on-windows" rel="nofollow">安装 Java</a>。这是<a href="https://www.geeksforgeeks.org/how-to-install-java-on-macos/" rel="nofollow">MacOs的安装指南</a>，这是<a href="https://www.scaler.com/topics/java/how-to-install-java-in-linux/" rel="nofollow">Linux</a>的安装指南。</p> 
<h5><a id="Jupyter_Notebook_42"></a><code>Jupyter Notebook</code></h5> 
<p>Jupyter Notebook 是一个 Web 应用程序，可用于编写代码和显示公式、可视化效果和文本。它是数据科学家最常用的编程编辑器之一。在本教程中，我们将使用 <code>Jupyter Notebook</code>编写所有 <code>PySpark</code> 代码，因此请确保已安装它。</p> 
<p>您可以按照我们的教程在本地设备上<a href="https://www.datacamp.com/tutorial/installing-jupyter-notebook" rel="nofollow">启动并运行 Jupyter</a>。</p> 
<h5><a id="_47"></a>数据</h5> 
<p>在本教程中，我们将使用 Datacamp 的<a href="https://www.datacamp.com/datalab/datasets/dataset-r-e-commerce" rel="nofollow">电子商务数据集</a>进行所有分析，因此请务必下载它。我们已将文件重命名为“datacamp_ecommerce.csv”并将其保存到父目录，您可以执行相同的操作，以便更轻松地编写代码。</p> 
<h4><a id="_50"></a>安装指南</h4> 
<p>设置好所有先决条件后，可以继续安装<code>Apache Spark</code> 和 <code>PySpark</code>。</p> 
<h5><a id="_Apache_Spark_53"></a>安装 <code>Apache Spark</code></h5> 
<p>要安装 <code>Apache Spark</code>，请导航到下载页面并下载页面上显示的 .tgz 文件：</p> 
<p><img src="https://images2.imgbox.com/d3/5d/ntF7J2rJ_o.png" alt="Apache Spark"><br> 然后，如果您使用的是 Windows，请在 C 目录中创建一个名为“spark”的文件夹。如果您使用的是 Linux 或 Mac，则可以将其粘贴到主目录中的新文件夹中。</p> 
<p>接下来，提取您刚刚下载的文件并将其内容粘贴到此“spark”文件夹中。文件夹路径应如下所示：<br> <img src="https://images2.imgbox.com/65/52/DsmlqPMt_o.png" alt="在这里插入图片描述"><br> 现在，您需要设置环境变量。有两种方法可以做到这一点：</p> 
<p><strong>方法 1</strong>：使用 Powershell 更改环境变量</p> 
<p>如果使用的是 Windows 计算机，则更改环境变量的第一种方法是使用 Powershell：</p> 
<p>步骤1：单击“开始”-&gt;Windows Powershell -&gt;“以管理员身份运行”</p> 
<p>步骤 2：在 Windows Powershell 中键入以下行以设置SPARK_HOME：</p> 
<pre><code class="prism language-ps1">setx SPARK_HOME <span class="token string">"C:\spark\spark-3.3.0-bin-hadoop3"</span> <span class="token comment"># 更改为你的安装路径</span>
</code></pre> 
<p>第 3 步：接下来，将 Spark bin 目录设置为路径变量：</p> 
<pre><code class="prism language-ps1">setx PATH <span class="token string">"C:\spark\spark-3.3.0-bin-hadoop3\bin"</span>
</code></pre> 
<p><strong>方法 2</strong>：手动更改环境变量</p> 
<p>步骤1：导航到“开始”-&gt;“系统”-“&gt;设置”-&gt;“高级设置”</p> 
<p>步骤2：单击环境变量</p> 
<p><img src="https://images2.imgbox.com/fe/bd/zgb4f4Am_o.png" alt="在这里插入图片描述"></p> 
<p>步骤3：在“环境变量”选项卡中，单击“新建”。</p> 
<p>步骤4：在变量名称和变量值中输入以下值。请注意，安装的版本可能与下面显示的版本不同，因此请将路径复制并粘贴到 Spark 目录。</p> 
<p><img src="https://images2.imgbox.com/05/79/bLZ1hjFY_o.png" alt="变量值"></p> 
<p>步骤5：接下来，在“环境变量”选项卡中，单击“path”，然后选择“编辑”。</p> 
<p>第 6 步：单击“新建”并粘贴到 Spark bin 目录的路径中。下面是 bin 目录的示例：</p> 
<pre><code class="prism language-ps1">C:\spark\spark-3<span class="token punctuation">.</span>3<span class="token punctuation">.</span>0-bin-hadoop3\bin
</code></pre> 
<p>如果您使用 Linux 设备，<a href="https://www.geeksforgeeks.org/environment-variables-in-linux-unix/" rel="nofollow">以下是</a>设置环境变量的指南，<a href="https://phoenixnap.com/kb/set-environment-variable-mac" rel="nofollow">这是</a>适用于 MacOS 的指南。</p> 
<h5><a id="_PySpark_101"></a>安装 PySpark</h5> 
<p>现在，您已成功安装 Apache Spark 和所有其他必要的先决条件，请在 Jupyter Notebook 中打开 Python 文件，并在第一个单元格中运行以下代码行：</p> 
<pre><code>!pip install pyspark
</code></pre> 
<p>或者，您可以按照此端到端 PySpark 安装指南在您的设备上安装软件。</p> 
<h3><a id="PySpark__109"></a>端到端机器学习PySpark 教程</h3> 
<p>现在，您已经启动并运行了 <code>PySpark</code>，我们将向您展示如何使用该库执行端到端客户细分项目。</p> 
<p>客户细分是公司用来识别和分组表现出相似特征的用户的一种营销技术。例如，如果你只在夏天去星巴克购买冷饮，你可以被细分为“季节性购物者”，并被夏季策划的特别促销活动所吸引。</p> 
<p>数据科学家通常构建无监督机器学习算法，例如<code>K-Means</code> 聚类或分层聚类来执行客户细分。这些模型非常擅长识别用户组之间的相似模式，而这些模式往往不被人眼注意到。</p> 
<p>在本教程中，我们将使用 <code>K-Means</code> 聚类对之前下载的电子商务数据集进行客户细分。</p> 
<p>在本教程结束时，你将熟悉以下概念：</p> 
<ul><li>使用 PySpark 读取 csv 文件</li><li>使用 PySpark 进行探索性数据分析</li><li>对数据进行分组和排序</li><li>执行算术运算</li><li>聚合数据集</li><li>使用PySpark 进行数据预处理</li><li>使用日期时间值</li><li>类型转换</li><li>联接两个数据帧</li><li>rank（） 函数</li><li>PySpark 机器学习</li><li>创建特征向量</li><li>标准化数据</li><li>构建 K-Means 聚类分析模型</li><li>解释模型</li></ul> 
<h4><a id="_1_SparkSession_136"></a>步骤 1：创建 <code>SparkSession</code></h4> 
<p><code>SparkSession</code> 是 <code>Spark</code> 中所有功能的入口点，如果要在 <code>PySpark</code> 中生成数据帧，则需要 <code>SparkSession</code>。运行以下代码行以初始化 <code>SparkSession</code>：</p> 
<pre><code class="prism language-python">spark <span class="token operator">=</span> SparkSession<span class="token punctuation">.</span>builder<span class="token punctuation">.</span>appName<span class="token punctuation">(</span><span class="token string">"Datacamp Pyspark Tutorial"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>config<span class="token punctuation">(</span><span class="token string">"spark.memory.offHeap.enabled"</span><span class="token punctuation">,</span><span class="token string">"true"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>config<span class="token punctuation">(</span><span class="token string">"spark.memory.offHeap.size"</span><span class="token punctuation">,</span><span class="token string">"10g"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>getOrCreate<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>使用上面的代码，我们构建了一个 spark 会话并为应用程序设置了一个名称。然后，将数据缓存在堆外内存中，以避免将其直接存储在磁盘上，并手动指定内存量。</p> 
<h4><a id="_2_DataFrame_144"></a>步骤 2：创建 DataFrame</h4> 
<p>我们现在可以读取刚刚下载的数据集：</p> 
<pre><code class="prism language-python">df <span class="token operator">=</span> spark<span class="token punctuation">.</span>read<span class="token punctuation">.</span>csv<span class="token punctuation">(</span><span class="token string">'datacamp_ecommerce.csv'</span><span class="token punctuation">,</span>header<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>escape<span class="token operator">=</span><span class="token string">"\""</span><span class="token punctuation">)</span>
</code></pre> 
<blockquote> 
 <p>请注意，我们定义了一个转义字符，以避免在解析时在 .csv 文件中使用逗号。</p> 
</blockquote> 
<p>让我们使用 <code>show（）</code> 函数看一下 dataframe 的前几行数据：</p> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ae/45/Ntn5oGA0_o.png" alt="在这里插入图片描述"><br> 数据由 8 个变量组成：</p> 
<p><code>InvoiceNo</code>：每个客户发票的唯一标识符。<br> <code>StockCode</code>：库存中每件商品的唯一标识符。<br> <code>Description</code>：客户购买的商品。<br> <code>Quantity</code>：客户在单张发票中购买的每件商品的编号。<br> <code>InvoiceDate</code>：购买日期。<br> <code>UnitPrice</code>：每件商品一个单位的价格。<br> <code>CustomerID</code>：分配给每个用户的唯一标识符。<br> <code>Country</code>：购买地的国家/地区</p> 
<h4><a id="_3__167"></a>第 3 步：探索性数据分析</h4> 
<p>现在我们已经看到了此数据集中存在的变量，让我们进行一些探索性数据分析以进一步了解这些数据点：</p> 
<ol><li>让我们先计算数据帧中的行数：</li></ol> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># Answer: 2,500</span>
</code></pre> 
<ol start="2"><li>数据帧中有多少个唯一客户？</li></ol> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">'CustomerID'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>distinct<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># Answer: 95</span>
</code></pre> 
<ol start="3"><li>大多数购买来自哪个国家？<br> 要查找大多数购买的国家/地区，我们需要在 <code>PySpark</code> 中使用 <code>groupBy（）</code> 子句：</li></ol> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pyspark<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>functions <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> pyspark<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>types <span class="token keyword">import</span> <span class="token operator">*</span>
df<span class="token punctuation">.</span>groupBy<span class="token punctuation">(</span><span class="token string">'Country'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span>countDistinct<span class="token punctuation">(</span><span class="token string">'CustomerID'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>alias<span class="token punctuation">(</span><span class="token string">'country_count'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>运行上述代码后，将呈现下表：<br> <img src="https://images2.imgbox.com/c0/6c/yyYf1nC5_o.png" alt="在这里插入图片描述"><br> 平台上几乎所有的购买都是从英国购买的，只有少数是从德国、澳大利亚和法国等国家购买的。</p> 
<ol start="4"><li>请注意，上表中的数据不是按购买顺序显示的。为了对这个表进行排序，我们可以包括 <code>orderBy（）</code> 子句：</li></ol> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>groupBy<span class="token punctuation">(</span><span class="token string">'Country'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span>countDistinct<span class="token punctuation">(</span><span class="token string">'CustomerID'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>alias<span class="token punctuation">(</span><span class="token string">'country_count'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>orderBy<span class="token punctuation">(</span>desc<span class="token punctuation">(</span><span class="token string">'country_count'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>显示的输出现在按降序排序：<br> <img src="https://images2.imgbox.com/c0/26/VKNfsJkO_o.png" alt="在这里插入图片描述"></p> 
<ol start="5"><li>客户最近一次在电子商务平台上购买是什么时候？<br> 要查找在平台上进行的最新购买时间，我们需要将<code>InvoiceDate</code>列转换为时间戳格式，并使用 <code>Pyspark</code> 中的 <code>max（）</code> 函数：</li></ol> 
<pre><code class="prism language-python">spark<span class="token punctuation">.</span>sql<span class="token punctuation">(</span><span class="token string">"set spark.sql.legacy.timeParserPolicy=LEGACY"</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> df<span class="token punctuation">.</span>withColumn<span class="token punctuation">(</span><span class="token string">'date'</span><span class="token punctuation">,</span>to_timestamp<span class="token punctuation">(</span><span class="token string">"InvoiceDate"</span><span class="token punctuation">,</span> <span class="token string">'yy/MM/dd HH:mm'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token string">"date"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>运行上述代码后，应会看到下表显示：<br> <img src="https://images2.imgbox.com/a0/3d/GIwnEleb_o.png" alt="在这里插入图片描述"></p> 
<ol start="6"><li>客户最早在电商平台上购买是什么时候？<br> 与我们上面所做的类似，<code>min（）</code> 函数可用于查找最早的购买日期和时间：</li></ol> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token string">"date"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e5/8d/Bop5cxvf_o.png" alt="在这里插入图片描述"><br> 请注意，最近和最早的购买是在同一天进行的，相隔仅几个小时。这意味着我们下载的数据集仅包含一天内购买的信息。</p> 
<h4><a id="_4__216"></a>第 4 步：数据预处理</h4> 
<p>现在我们已经分析了数据集并更好地了解了每个数据点，我们需要准备数据以输入机器学习算法。</p> 
<p>让我们再次看一下数据帧的前几行数据，以了解如何进行预处理：</p> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/fe/9f/6gCYBwKV_o.png" alt="在这里插入图片描述"><br> 从上面的数据集中，我们需要根据每个用户的购买行为创建多个客户细分。</p> 
<p>此数据集中的变量采用的格式不容易引入客户细分模型。这些功能单独并不能告诉我们太多关于客户购买行为的信息。</p> 
<p>因此，我们将使用现有变量来推导出三个新的信息特征——最近购买（Recency）、购买频率（Frequency）和货币价值 （RFM）。</p> 
<p>RFM通常用于营销中，根据客户的价值来评估客户的价值：</p> 
<p>最近购买：每个客户最近购买过什么？<br> 购买频率：他们多久买一次东西？<br> 货币价值：他们在购物时平均花多少钱？<br> 现在，我们将对数据帧进行预处理以创建上述变量。</p> 
<h5><a id="_237"></a>最近购买</h5> 
<p>首先，让我们计算新近度的值 - 在平台上进行购买的最新日期和时间。这可以通过两个步骤实现：</p> 
<p>i） 为每个客户分配一个新近度分数<br> 我们将从最早的日期中减去数据框中的每个日期。这将告诉我们最近在数据帧中看到客户的时间。值 0 表示最低新近度，因为它将分配给在最早日期看到进行购买的人。</p> 
<pre><code class="prism language-python">df <span class="token operator">=</span> df<span class="token punctuation">.</span>withColumn<span class="token punctuation">(</span><span class="token string">"from_date"</span><span class="token punctuation">,</span> lit<span class="token punctuation">(</span><span class="token string">"12/1/10 08:26"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> df<span class="token punctuation">.</span>withColumn<span class="token punctuation">(</span><span class="token string">'from_date'</span><span class="token punctuation">,</span>to_timestamp<span class="token punctuation">(</span><span class="token string">"from_date"</span><span class="token punctuation">,</span> <span class="token string">'yy/MM/dd HH:mm'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

df2<span class="token operator">=</span>df<span class="token punctuation">.</span>withColumn<span class="token punctuation">(</span><span class="token string">'from_date'</span><span class="token punctuation">,</span>to_timestamp<span class="token punctuation">(</span>col<span class="token punctuation">(</span><span class="token string">'from_date'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>withColumn<span class="token punctuation">(</span><span class="token string">'recency'</span><span class="token punctuation">,</span>col<span class="token punctuation">(</span><span class="token string">"date"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>cast<span class="token punctuation">(</span><span class="token string">"long"</span><span class="token punctuation">)</span> <span class="token operator">-</span> col<span class="token punctuation">(</span><span class="token string">'from_date'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>cast<span class="token punctuation">(</span><span class="token string">"long"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>ii） 选择最近购买的产品<br> 一个客户可以在不同的时间进行多次购买。我们只需要选择他们最后一次购买产品的时间，因为这表示最近一次购买的时间：</p> 
<pre><code class="prism language-python">df2 <span class="token operator">=</span> df2<span class="token punctuation">.</span>join<span class="token punctuation">(</span>df2<span class="token punctuation">.</span>groupBy<span class="token punctuation">(</span><span class="token string">'CustomerID'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token string">'recency'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>alias<span class="token punctuation">(</span><span class="token string">'recency'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>on<span class="token operator">=</span><span class="token string">'recency'</span><span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">'leftsemi'</span><span class="token punctuation">)</span>
</code></pre> 
<p>让我们看一下新数据帧的头部。它现在附加了一个名为<code>recency</code>的变量：</p> 
<pre><code class="prism language-python">df2<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/25/49/W2iPc0sR_o.png" alt="在这里插入图片描述"></p> 
<p>查看 <code>PySpark</code> 数据帧中存在的所有变量的更简单方法是使用其 <code>printSchema（）</code> 函数。这相当于<code> Pandas</code> 中的<code> info（）</code> 函数：</p> 
<pre><code class="prism language-python">df2<span class="token punctuation">.</span>printSchema<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>呈现的输出应如下所示：<br> <img src="https://images2.imgbox.com/5c/1b/ImTJ5kF7_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_268"></a>购买频率</h5> 
<p>现在让我们计算一下频率的价值——客户在平台上购买东西的频率。为此，我们只需要按每个客户 ID 进行分组，并计算他们购买的商品数量：</p> 
<pre><code class="prism language-python">df_freq <span class="token operator">=</span> df2<span class="token punctuation">.</span>groupBy<span class="token punctuation">(</span><span class="token string">'CustomerID'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span>count<span class="token punctuation">(</span><span class="token string">'InvoiceDate'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>alias<span class="token punctuation">(</span><span class="token string">'frequency'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>看看我们刚刚创建的这个新数据帧的前几行：</p> 
<pre><code class="prism language-python">df_freq<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/54/cf/XMVxEr6s_o.png" alt="在这里插入图片描述"></p> 
<p>在数据帧中，每个客户都会追加一个频率值。这个新的数据帧只有两列，我们需要将它与前一列连接起来：</p> 
<pre><code class="prism language-python">df3 <span class="token operator">=</span> df2<span class="token punctuation">.</span>join<span class="token punctuation">(</span>df_freq<span class="token punctuation">,</span>on<span class="token operator">=</span><span class="token string">'CustomerID'</span><span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">'inner'</span><span class="token punctuation">)</span>
</code></pre> 
<p>让我们打印此数据帧的架构：</p> 
<pre><code class="prism language-python">df3<span class="token punctuation">.</span>printSchema<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/53/88/sqaflRjJ_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_294"></a>货币价值</h5> 
<p>最后，让我们计算货币价值 - 每个客户在数据帧中花费的总金额。实现此目的有两个步骤：</p> 
<p>i） 查找每次购买的总花费金额：<br> 对于单次购买，每个<code>customerID</code>都带有名为<code>Quantity</code>和<code>UnitPrice</code>的变量：</p> 
<p><img src="https://images2.imgbox.com/06/44/sGaFb2gA_o.png" alt="在这里插入图片描述"><br> 要获得每个客户在一次购买中花费的总金额，我们需要将<code>Quantity</code>乘以<code>UnitPrice</code>：</p> 
<pre><code class="prism language-python">m_val <span class="token operator">=</span> df3<span class="token punctuation">.</span>withColumn<span class="token punctuation">(</span><span class="token string">'TotalAmount'</span><span class="token punctuation">,</span>col<span class="token punctuation">(</span><span class="token string">"Quantity"</span><span class="token punctuation">)</span> <span class="token operator">*</span> col<span class="token punctuation">(</span><span class="token string">"UnitPrice"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>ii） 查找每个客户的总消费金额：<br> 要找到每个客户总体花费的总金额，我们只需要按 <code>CustomerID</code> 列分组并汇总花费的金额：</p> 
<pre><code class="prism language-python">m_val <span class="token operator">=</span> m_val<span class="token punctuation">.</span>groupBy<span class="token punctuation">(</span><span class="token string">'CustomerID'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token string">'TotalAmount'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>alias<span class="token punctuation">(</span><span class="token string">'monetary_value'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>将此数据帧与所有其他变量合并：</p> 
<pre><code>finaldf = m_val.join(df3,on='CustomerID',how='inner')
</code></pre> 
<p>现在，我们已经创建了构建模型所需的所有变量，请运行以下代码行以仅选择所需的列并从数据帧中删除重复的行：</p> 
<pre><code class="prism language-python">finaldf <span class="token operator">=</span> finaldf<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'recency'</span><span class="token punctuation">,</span><span class="token string">'frequency'</span><span class="token punctuation">,</span><span class="token string">'monetary_value'</span><span class="token punctuation">,</span><span class="token string">'CustomerID'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>distinct<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>查看最终数据帧，以确保预处理已准确完成：</p> 
<p><img src="https://images2.imgbox.com/24/18/69WjoXR3_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_322"></a>标准化</h5> 
<p>在构建客户细分模型之前，让我们对数据帧进行标准化，以确保所有变量的规模都差不多：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pyspark<span class="token punctuation">.</span>ml<span class="token punctuation">.</span>feature <span class="token keyword">import</span> VectorAssembler
<span class="token keyword">from</span> pyspark<span class="token punctuation">.</span>ml<span class="token punctuation">.</span>feature <span class="token keyword">import</span> StandardScaler

assemble<span class="token operator">=</span>VectorAssembler<span class="token punctuation">(</span>inputCols<span class="token operator">=</span><span class="token punctuation">[</span>
    <span class="token string">'recency'</span><span class="token punctuation">,</span><span class="token string">'frequency'</span><span class="token punctuation">,</span><span class="token string">'monetary_value'</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span> outputCol<span class="token operator">=</span><span class="token string">'features'</span><span class="token punctuation">)</span>

assembled_data<span class="token operator">=</span>assemble<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>finaldf<span class="token punctuation">)</span>

scale<span class="token operator">=</span>StandardScaler<span class="token punctuation">(</span>inputCol<span class="token operator">=</span><span class="token string">'features'</span><span class="token punctuation">,</span>outputCol<span class="token operator">=</span><span class="token string">'standardized'</span><span class="token punctuation">)</span>
data_scale<span class="token operator">=</span>scale<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>assembled_data<span class="token punctuation">)</span>
data_scale_output<span class="token operator">=</span>data_scale<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>assembled_data<span class="token punctuation">)</span>
</code></pre> 
<p>运行以下代码行，查看标准化特征向量的样子：</p> 
<pre><code class="prism language-python">data_scale_output<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">'standardized'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>truncate<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a6/e2/z6mVjfVQ_o.png" alt="在这里插入图片描述"><br> 这些是将馈送到聚类分析算法中的缩放特征。</p> 
<h4><a id="_5_347"></a>步骤 5：构建机器学习模型</h4> 
<p>现在我们已经完成了所有的数据分析和准备工作，让我们构建<code>K-Means</code>聚类模型。<br> 该算法将使用<code>PySpark</code>的机器学习 API 创建。<br> i） 查找要使用的集群数量<br> 在构建 <code>K-Means</code> 聚类模型时，我们首先需要确定我们希望算法返回的聚类或组的数量。例如，如果我们决定三个集群，那么我们将有三个客户群。<br> 用于决定在 K-Means 中使用多少个聚类的最流行的技术称为“肘部方法”。<br> 只需对各种聚类运行 K-Means 算法并可视化每个聚类的模型结果即可。该图将有一个看起来像肘部的拐点，我们此时只需选择聚类的数量。</p> 
<p>让我们运行以下代码行来构建一个从 2 到 10 个聚类的<code>K-Means</code>聚类算法：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pyspark<span class="token punctuation">.</span>ml<span class="token punctuation">.</span>clustering <span class="token keyword">import</span> KMeans
<span class="token keyword">from</span> pyspark<span class="token punctuation">.</span>ml<span class="token punctuation">.</span>evaluation <span class="token keyword">import</span> ClusteringEvaluator
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

cost <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>

evaluator <span class="token operator">=</span> ClusteringEvaluator<span class="token punctuation">(</span>predictionCol<span class="token operator">=</span><span class="token string">'prediction'</span><span class="token punctuation">,</span> featuresCol<span class="token operator">=</span><span class="token string">'standardized'</span><span class="token punctuation">,</span>metricName<span class="token operator">=</span><span class="token string">'silhouette'</span><span class="token punctuation">,</span> distanceMeasure<span class="token operator">=</span><span class="token string">'squaredEuclidean'</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    KMeans_algo<span class="token operator">=</span>KMeans<span class="token punctuation">(</span>featuresCol<span class="token operator">=</span><span class="token string">'standardized'</span><span class="token punctuation">,</span> k<span class="token operator">=</span>i<span class="token punctuation">)</span>
    KMeans_fit<span class="token operator">=</span>KMeans_algo<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>data_scale_output<span class="token punctuation">)</span>
    output<span class="token operator">=</span>KMeans_fit<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>data_scale_output<span class="token punctuation">)</span>
    cost<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> KMeans_fit<span class="token punctuation">.</span>summary<span class="token punctuation">.</span>trainingCost
</code></pre> 
<p>通过上述代码，我们成功地构建并评估了具有 2 到 10 个聚类的 K-Means 聚类模型。结果已放置在一个数组中，现在可以在折线图中可视化：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> pylab <span class="token keyword">as</span> pl
df_cost <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>cost<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df_cost<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"cost"</span><span class="token punctuation">]</span>
new_col <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span>
df_cost<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'cluster'</span><span class="token punctuation">,</span> new_col<span class="token punctuation">)</span>
pl<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>df_cost<span class="token punctuation">.</span>cluster<span class="token punctuation">,</span> df_cost<span class="token punctuation">.</span>cost<span class="token punctuation">)</span>
pl<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Number of Clusters'</span><span class="token punctuation">)</span>
pl<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Score'</span><span class="token punctuation">)</span>
pl<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Elbow Curve'</span><span class="token punctuation">)</span>
pl<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>上面的代码将呈现以下图表：</p> 
<p><img src="https://images2.imgbox.com/fd/24/egIr2RBP_o.png" alt="在这里插入图片描述"><br> ii） 构建 K-Means 聚类模型<br> 从上图中，我们可以看到有一个拐点，看起来像四点处的肘部。因此，我们将继续构建具有四个聚类的 K-Means 算法：</p> 
<pre><code class="prism language-python">KMeans_algo<span class="token operator">=</span>KMeans<span class="token punctuation">(</span>featuresCol<span class="token operator">=</span><span class="token string">'standardized'</span><span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>
KMeans_fit<span class="token operator">=</span>KMeans_algo<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>data_scale_output<span class="token punctuation">)</span>
</code></pre> 
<p>iii） 做出预测<br> 让我们使用我们创建的模型将集群分配给数据集中的每个客户：</p> 
<pre><code class="prism language-python">preds<span class="token operator">=</span>KMeans_fit<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>data_scale_output<span class="token punctuation">)</span>

preds<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre> 
<p>请注意，此数据帧中有一个“预测”列，它告诉我们每个 CustomerID 属于哪个集群：<br> <img src="https://images2.imgbox.com/70/8e/f31nyPuE_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_6_404"></a>步骤 6：聚类分析</h4> 
<p>整个教程的最后一步是分析我们刚刚构建的客户群。</p> 
<p>运行以下代码行以可视化数据帧中每个 customerID 的新近度、频率和货币值：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns

df_viz <span class="token operator">=</span> preds<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">'recency'</span><span class="token punctuation">,</span><span class="token string">'frequency'</span><span class="token punctuation">,</span><span class="token string">'monetary_value'</span><span class="token punctuation">,</span><span class="token string">'prediction'</span><span class="token punctuation">)</span>
df_viz <span class="token operator">=</span> df_viz<span class="token punctuation">.</span>toPandas<span class="token punctuation">(</span><span class="token punctuation">)</span>
avg_df <span class="token operator">=</span> df_viz<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'prediction'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> as_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>

list1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'recency'</span><span class="token punctuation">,</span><span class="token string">'frequency'</span><span class="token punctuation">,</span><span class="token string">'monetary_value'</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> list1<span class="token punctuation">:</span>
    sns<span class="token punctuation">.</span>barplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">'prediction'</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>data<span class="token operator">=</span>avg_df<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>上面的代码将呈现以下图：<br> <img src="https://images2.imgbox.com/16/8f/kj4oe90B_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/61/87/h237ozca_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/a6/3d/b7AEQexZ_o.png" alt="在这里插入图片描述"><br> 以下是客户在每个集群中显示的特征的概述：<br> <strong>类别0：</strong> 此细分市场中的客户显示新近度、频率和货币价值较低。他们很少在平台上购物，并且是低潜在客户，他们可能会停止与电子商务公司开展业务。<br> <strong>类别1：</strong> 此集群中的用户表现出较高的新近度，但尚未看到在平台上花费太多。他们也不经常访问该网站。这表明他们可能是刚刚开始与该公司开展业务的新客户。<br> <strong>类别2：</strong> 该细分市场的客户表现出中等的新近度和频率，并在平台上花费大量资金。这表明他们倾向于购买高价值物品或进行批量购买。<br> <strong>类别33：</strong> 最后一个细分市场包括在平台上表现出高新近度并频繁购买的用户。但是，他们在平台上花费不多，这可能意味着他们倾向于在每次购买中选择更便宜的商品。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/02bc91cd59cf0167dbe6f64fe813b064/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【数据结构】--栈</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1ee972be3c526caafec62853b8415c56/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">一键进阶ComfyUI！懂AI的设计师现在都在用的节点式Stable Diffusion！内附安装包</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>