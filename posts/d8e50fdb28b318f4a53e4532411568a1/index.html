<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python 安装库pycrypto失败的一系列问题[已解决] - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/d8e50fdb28b318f4a53e4532411568a1/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="python 安装库pycrypto失败的一系列问题[已解决]">
  <meta property="og:description" content="需要安装pycrypto这个库。 /*****************安装pycryptodome***********************/ 说来难受，后面发现这个貌似不再维护了，可以安装另外一个库pycryptodome，是这个库的延伸版本，和这个库的作用是一样的，我也是看别人的。
安装pycryptodome
pip install pycryptodome /*****************安装pycryptodome***********************/ 安装pycrypto 需要安装pycrypto的继续：注意3.9以上版本的python可能都无法使用。存在一个错误。
File &#34;c:\Users\ice\Desktop\112.py&#34;, line 7, in &lt;module&gt; cipher = AES.new(key, AES.MODE_ECB) ^^^^^^^^^^^^^^^^^^^^^^^^^^ File &#34;D:\software\compiler\python\python3.11.5\Lib\site-packages\Crypto\Cipher\AES.py&#34;, line 95, in new return AESCipher(key, *args, **kwargs) ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ File &#34;D:\software\compiler\python\python3.11.5\Lib\site-packages\Crypto\Cipher\AES.py&#34;, line 59, in __init__ blockalgo.BlockAlgo.__init__(self, _AES, key, *args, **kwargs) File &#34;D:\software\compiler\python\python3.11.5\Lib\site-packages\Crypto\Cipher\blockalgo.py&#34;, line 141, in __init__ self._cipher = factory.new(key, *args, **kwargs) ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ SystemError: PY_SSIZE_T_CLEAN macro must be defined for &#39;#&#39; formats 目前知道是要加宏定义
Note For all # variants of formats (s#, y#, etc.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-07T22:55:20+08:00">
    <meta property="article:modified_time" content="2024-03-07T22:55:20+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python 安装库pycrypto失败的一系列问题[已解决]</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4><a id="pycrypto_0"></a><strong><s>需要安装pycrypto这个库。</s></strong></h4> 
<pre><code class="prism language-c"><span class="token comment">/*****************安装pycryptodome***********************/</span>
</code></pre> 
<p>说来难受，后面发现这个貌似不再维护了，可以安装另外一个库pycryptodome，是这个库的延伸版本，和这个库的作用是一样的，我也是看别人的。<br> <strong>安装pycryptodome</strong></p> 
<pre><code class="prism language-python">pip install pycryptodome
</code></pre> 
<pre><code class="prism language-c"><span class="token comment">/*****************安装pycryptodome***********************/</span>
</code></pre> 
<h4><a id="pycrypto_14"></a>安装pycrypto</h4> 
<p>需要<strong>安装pycrypto</strong>的继续：注意<strong>3.9以上版本的python可能都无法使用</strong>。存在一个错误。</p> 
<pre><code class="prism language-python">  File <span class="token string">"c:\Users\ice\Desktop\112.py"</span><span class="token punctuation">,</span> line <span class="token number">7</span><span class="token punctuation">,</span> <span class="token keyword">in</span> <span class="token operator">&lt;</span>module<span class="token operator">&gt;</span>
    cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span>
             <span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span>
  File <span class="token string">"D:\software\compiler\python\python3.11.5\Lib\site-packages\Crypto\Cipher\AES.py"</span><span class="token punctuation">,</span> line <span class="token number">95</span><span class="token punctuation">,</span> <span class="token keyword">in</span> new
    <span class="token keyword">return</span> AESCipher<span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
           <span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span>
  File <span class="token string">"D:\software\compiler\python\python3.11.5\Lib\site-packages\Crypto\Cipher\AES.py"</span><span class="token punctuation">,</span> line <span class="token number">59</span><span class="token punctuation">,</span> <span class="token keyword">in</span> __init__
    blockalgo<span class="token punctuation">.</span>BlockAlgo<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> _AES<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
  File <span class="token string">"D:\software\compiler\python\python3.11.5\Lib\site-packages\Crypto\Cipher\blockalgo.py"</span><span class="token punctuation">,</span> line <span class="token number">141</span><span class="token punctuation">,</span> <span class="token keyword">in</span> __init__
    self<span class="token punctuation">.</span>_cipher <span class="token operator">=</span> factory<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
                   <span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span><span class="token operator">^</span>
SystemError<span class="token punctuation">:</span> PY_SSIZE_T_CLEAN macro must be defined <span class="token keyword">for</span> <span class="token string">'#'</span> formats

</code></pre> 
<p>目前知道是要加宏定义</p> 
<p>Note For all # variants of formats (s#, y#, etc.), the macro PY_SSIZE_T_CLEAN must be defined before including Python.h. On Python 3.9 and older, the type of the length argument is Py_ssize_t if the PY_SSIZE_T_CLEAN macro is defined, or int otherwise.</p> 
<p>但是还没有测试，不知道要怎么加。</p> 
<p><strong>python3.8版本测试是可以使用的。python3.8版本以下都可以使用。</strong><br> 应该是不兼容。python3.9以上版本，需要有定义<br> <em><strong>继续安装 pycrypto</strong></em></p> 
<pre><code class="prism language-powershell">pip install pycrypto
</code></pre> 
<p>但是直接安装就会出现错误如下：</p> 
<pre><code class="prism language-powershell">Building wheels <span class="token keyword">for</span> collected packages: pycrypto
  Building wheel <span class="token keyword">for</span> pycrypto <span class="token punctuation">(</span>pyproject<span class="token punctuation">.</span>toml<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> error
  error: subprocess-exited-with-error

  × Building wheel <span class="token keyword">for</span> pycrypto <span class="token punctuation">(</span>pyproject<span class="token punctuation">.</span>toml<span class="token punctuation">)</span> did not run successfully<span class="token punctuation">.</span>
  │ <span class="token keyword">exit</span> code: 1
  ╰─&gt; <span class="token punctuation">[</span>2 lines of output<span class="token punctuation">]</span>
      warning: GMP or MPIR library not found<span class="token punctuation">;</span> Not building Crypto<span class="token punctuation">.</span>PublicKey<span class="token punctuation">.</span>_fastmath<span class="token punctuation">.</span>
      error: Microsoft Visual C+<span class="token operator">+</span> 14<span class="token punctuation">.</span>0 or greater is required<span class="token punctuation">.</span> Get it with <span class="token string">"Microsoft C++ Build Tools"</span>: https:<span class="token operator">/</span><span class="token operator">/</span>visualstudio<span class="token punctuation">.</span>microsoft<span class="token punctuation">.</span>com/visual-<span class="token function">cpp</span><span class="token operator">-</span>build-tools/
      <span class="token namespace">[end of output]</span>

  note: This error originates <span class="token keyword">from</span> a subprocess<span class="token punctuation">,</span> and is likely not a problem with pip<span class="token punctuation">.</span>
  ERROR: Failed building wheel <span class="token keyword">for</span> pycrypto
Failed to build pycrypto
ERROR: Could not build wheels <span class="token keyword">for</span> pycrypto<span class="token punctuation">,</span> which is required to install pyproject<span class="token punctuation">.</span>toml-based projects
</code></pre> 
<p><font color="red">error: Microsoft Visual C++ 14.0 or greater is required. Get it with “Microsoft C++ Build Tools”: https://visualstudio.microsoft.com/visual-cpp-build-tools/</font></p> 
<p>这说需要一个C++ 14.0以上的版本<br> <a href="https://visualstudio.microsoft.com/visual-cpp-build-tools/" rel="nofollow">https://visualstudio.microsoft.com/visual-cpp-build-tools/</a><br> 去这个网址下载一个安装工具</p> 
<p><img src="https://images2.imgbox.com/5f/6a/iCXcZJdG_o.png" alt="下载工具"></p> 
<p>下载后直接运行安装</p> 
<p><img src="https://images2.imgbox.com/6b/6d/v3Tpsq0n_o.png" alt="安装"><br> 在下载过程中还可以确认一个东西，但是实际上只要下载了python版本都自己带有，不管是老版本还是新版本，3.8，3.11亲测都有，这个东西就是<strong>setuptools</strong>。这个的版本应该和python安装的时间有关，安装早的版本可能会老一点。<br> 安装这个c++编译器 Microsoft Visual C++ ，需要有配对的setuptools版本。<br> 安装最新的Microsoft Visual C++，需要配备最新的setuptools。（实践证明较新的也可以，估测60版本以上都可以）</p> 
<pre><code class="prism language-powershell">Microsoft Visual C+<span class="token operator">+</span> 14<span class="token punctuation">.</span>2 standalone: Build Tools <span class="token keyword">for</span> Visual Studio 2019 <span class="token punctuation">(</span>x86<span class="token punctuation">,</span> x64<span class="token punctuation">,</span> ARM<span class="token punctuation">,</span> ARM64<span class="token punctuation">)</span>
This is a standalone version of Visual C+<span class="token operator">+</span> 14<span class="token punctuation">.</span>2 compiler<span class="token punctuation">,</span> you don't need to install Visual Studio 2019<span class="token punctuation">.</span>

In Build tools<span class="token punctuation">,</span> install C+<span class="token operator">+</span> build tools and ensure the latest versions of MSVCv142 <span class="token operator">-</span> VS 2019 C+<span class="token operator">+</span> x64/x86 build tools and Windows 10 SDK are checked<span class="token punctuation">.</span>
The setuptools Python package version must be at least 34<span class="token punctuation">.</span>4<span class="token punctuation">.</span>0<span class="token punctuation">.</span>

</code></pre> 
<p><strong>安装Visual C++ 14.2 compiler版本的需要setuptools至少34.4.0。</strong><br> 详细版本对应可以参考<a href="https://wiki.python.org/moin/WindowsCompilers#Microsoft_Visual_C.2B-.2B-_14.2_standalone:_Build_Tools_for_Visual_Studio_2019_.28x86.2C_x64.2C_ARM.2C_ARM64.29" rel="nofollow">Visual C++ 14.2 compiler对应版本</a></p> 
<p>查看setuptools版本的方法。</p> 
<pre><code class="prism language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">import</span> setuptools
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>setuptools<span class="token punctuation">.</span>_version__<span class="token punctuation">)</span>
Traceback <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span><span class="token punctuation">:</span>
  File <span class="token string">"&lt;stdin&gt;"</span><span class="token punctuation">,</span> line <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">in</span> <span class="token operator">&lt;</span>module<span class="token operator">&gt;</span>
AttributeError<span class="token punctuation">:</span> module <span class="token string">'setuptools'</span> has no attribute <span class="token string">'_version__'</span><span class="token punctuation">.</span> Did you mean<span class="token punctuation">:</span> <span class="token string">'__version__'</span>?
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>setuptools<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
<span class="token number">65.5</span><span class="token number">.0</span>
</code></pre> 
<p>我查了3.8和3.11的python，版本差别不大的，都是高版本（11：68）。我的是65版本，可以直接安装最新的Visual C++ 14.3。（setuptools的版本应该和python版本关系不大，和python的安装时间有关，大家可以查看自己的版本，在65以上必然就可以安装最新的）</p> 
<p>安装好后会出现如下界面：</p> 
<p><img src="https://images2.imgbox.com/34/b7/5TAmYIyF_o.png" alt="C++"><br> 选中<strong>使用C++的桌面开发</strong>这个即可，然后右边有默认选项，会默认选了五个，后两个可以不用选，不会有影响，但是选上也没占多少内存。建议默认选项即可。<br> 最好是默认，默认可以成果，其他的可能存在错误（选低版本的SDK和编译器会报错）<br> 另外这里要注意选的是windows 11 SDK，这个无论你是window10的系统还是window11的系统都可以安装，亲测有效，win7其他的就不清楚了。<br> 同时还可以修改安装位置，安装这个编译器包括这个window11SDK,总共大小有接近6G，可以换到其他盘进行安装，同时也可以取消勾选保留下载缓存。<br> <img src="https://images2.imgbox.com/63/57/D3dDDWXW_o.png" alt="选择安装"><br> 下载安装需要一定时间，不需要连到外网也可以下载。</p> 
<p><img src="https://images2.imgbox.com/54/e2/2d8uCSRq_o.png" alt="ok"><br> 安装好后继续输入：</p> 
<pre><code class="prism language-python">pip install pycrypto
</code></pre> 
<p>发现会有另外一个错误。</p> 
<p><img src="https://images2.imgbox.com/35/64/n9O38s8g_o.png" alt="error"></p> 
<pre><code class="prism language-powershell"> C:\Program Files <span class="token punctuation">(</span>x86<span class="token punctuation">)</span>\Windows Kits\10\include\10<span class="token punctuation">.</span>0<span class="token punctuation">.</span>22621<span class="token punctuation">.</span>0\ucrt\inttypes<span class="token punctuation">.</span>h<span class="token punctuation">(</span>31<span class="token punctuation">)</span>: error C2061: 语法错误: 标识符“intmax_t”
</code></pre> 
<p>提示这个文件存在语法错误。标识符错误，这个变量类型错误。</p> 
<p>参考这篇文章解决的。<br> https://blog.csdn.net/miffy2017may/article/details/107546033<br> 方法如下：<br> <strong>1、找到你刚刚下载的编译器保存的文件位置。</strong></p> 
<pre><code class="prism language-powershell">C:\Program Files <span class="token punctuation">(</span>x86<span class="token punctuation">)</span>\Microsoft Visual Studio\2022\BuildTools\VC\Tools\MSVC\14<span class="token punctuation">.</span>39<span class="token punctuation">.</span>33519\include
</code></pre> 
<p>默认是这个路径，可能版本区别，路径会有些许区别，但也可以找到。</p> 
<p><strong>2、找到这个路径下的一个文件stdint.h，复制该文件</strong><br> <img src="https://images2.imgbox.com/a2/6f/JTLltT3P_o.png" alt="stdint.h"><br> 3、找到另外一个文件夹<strong>C:\Program Files (x86)\Windows Kits\10\Include\10.0.22621.0\ucrt</strong><br> 这个文件夹，大家都有的，将上一步复制的<strong>stdint.h</strong>复制到这个文件夹下。</p> 
<p>4、<strong>编辑该文件夹下的inttypes.h文件，记事本打开即可</strong></p> 
<p><img src="https://images2.imgbox.com/1a/ec/Tx2us9Pz_o.png" alt="inttypers.h"><br> 5、修改文件中的#include &lt;stdint.h&gt;,为 #include “stdint.h”，就是把尖括号改为双引号。涉及c头文件读取方面的问题。</p> 
<p><img src="https://images2.imgbox.com/a3/7e/y0UgHciO_o.png" alt="xiu"><br> 完成上面步骤，再次运行命令 <strong>pip install pycrypto</strong>。</p> 
<p><img src="https://images2.imgbox.com/ab/9d/AALJzZ1n_o.png" alt="succeed"><br> 这样就成功安装<strong>pycrypto</strong>。</p> 
<p>貌似没用了，都2024年了，用<strong>pycryptodome</strong>吧。<br> 安装<strong>pycryptodome</strong>。</p> 
<pre><code class="prism language-python">pip install pycryptodome
</code></pre> 
<p>这是注定一个悲剧的晚上，以此篇注定无人问津的文章哀悼。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/77b625e3ada59637e0fca66227dcc0a9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Web自动化测试—webdriver的环境配置</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b5f975527d7c6e826e524e180f7446f9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">图像分割实战-系列教程2：Unet系列算法（Unet、Unet&#43;&#43;、Unet&#43;&#43;&#43;、网络架构、损失计算方法）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>