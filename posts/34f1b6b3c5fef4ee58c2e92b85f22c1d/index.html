<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>vector模拟实现【C&#43;&#43;】 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/34f1b6b3c5fef4ee58c2e92b85f22c1d/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="vector模拟实现【C&#43;&#43;】">
  <meta property="og:description" content="文章目录 全部的实现代码放在了文章末尾准备工作包含头文件定义命名空间和类类的成员变量 迭代器迭代器获取函数 构造函数默认构造使用n个值构造迭代器区间构造解决迭代器区间构造 和 用n个值构造的冲突拷贝构造 析构函数swap【交换函数】赋值运算符重载emptysize和capacityoperator[]reserve【调整容量大小】resize【调整size大小】push_backassign【把所有数据替换成迭代器区间中的数据】insert为什么扩容会导致pos迭代器失效？为什么要返回pos-1？ erase为什么要返回pos？ 全部代码 全部的实现代码放在了文章末尾 准备工作 创建两个文件，一个头文件myvector.hpp，一个源文件 tesr.cpp
【因为模板的声明和定义不能分处于不同的文件中，所以把成员函数的声明和定义放在了同一个文件myvector.hpp中】
mystring.hpp：存放包含的头文件，命名空间的定义，成员函数和命名空间中的函数的定义
test.cpp：存放main函数，以及测试代码
包含头文件 iostream：用于输入输出
assert.h：用于使用报错函数assert
定义命名空间和类 在文件myvector.hpp中定义上一个命名空间myvector
把vector类和它的成员函数放进命名空间封装起来，防止与包含的头文件中的函数/变量重名的冲突问题
类的成员变量 参考了stl源码中的vector的实现
成员变量有3个，都是迭代器
画图理解一下
迭代器 迭代器
因为存放数据的空间是从堆区申请的连续的内存，且只是简单模拟
所以我用了指针T*作为普通迭代器，const T*作为const迭代器
【T是vector中存储的数据的类型】
直接把T*重命名为iterator，把const T*重命名为const_iterator就完成了迭代器的实现
迭代器获取函数 因为const修饰的对象只能调用const修饰的成员函数
所以如果是const修饰的对象调用begin()和end()的时候，就会自动调用到const修饰的begin和end.
构造函数 默认构造 因为stl库里实现的默认构造是没开空间的，所以默认构造直接让3个成员变量都为nullptr就行
直接在声明的时候给缺省值，缺省值会传给成员初始化列表
即
而成员初始化列表会比构造函数先调用
并且每个构造函数调用之前都会先调用成员初始化列表，这样不管调用哪一个构造函数初始化，都会先把3个成员变量初始化成nullptr
使用n个值构造 迭代器区间构造 解决迭代器区间构造 和 用n个值构造的冲突 当重载了迭代器区间构造和用n个值构造的时候
如果传入的两个参数都是int类型的话就会报错
为什么？
因为在模板函数构成重载时，编译器会调用更合适的那一个
什么叫更合适？
就是不会类型转
如果传入的两个参数都是int类型，那么调用的应该是使用n个值构造，因为没有int类型的迭代器
但是使用n个值构造的第一个参数是size_t,int传进去要隐式类型转换
而调用迭代器区间构造，两个int的实参传进去，就会直接把InputIterator推导成int，不会发生类型转换，所以编译器会调用迭代器区间构造
解决方法：
再重载一个使用n个值构造的函数，把第一个参数改成int，这样根据模板偏特化，就会在都不类型转换时优先调用第一个参数特化成int的那个构造函数
拷贝构造 因为成员申请了堆区空间，所以要深拷贝
【不知道什么是深拷贝的可以看我这篇文章：类和对象【三】析构函数和拷贝构造函数】
析构函数 swap【交换函数】 因为存放数据的空间是在堆区开辟的，用3个成员变量去指向的
所以直接交换两个对象的成员变量就可以了
不需要拷贝数据
赋值运算符重载 因为成员申请了堆区空间，所以要深拷贝">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-10T11:57:28+08:00">
    <meta property="article:modified_time" content="2024-07-10T11:57:28+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">vector模拟实现【C&#43;&#43;】</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_2" rel="nofollow">全部的实现代码放在了文章末尾</a></li><li><a href="#_4" rel="nofollow">准备工作</a></li><li><ul><li><a href="#_16" rel="nofollow">包含头文件</a></li><li><a href="#_24" rel="nofollow">定义命名空间和类</a></li><li><ul><li><a href="#_31" rel="nofollow">类的成员变量</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_44" rel="nofollow">迭代器</a></li><li><ul><li><a href="#_56" rel="nofollow">迭代器获取函数</a></li></ul> 
  </li><li><a href="#_66" rel="nofollow">构造函数</a></li><li><ul><li><a href="#_67" rel="nofollow">默认构造</a></li><li><a href="#n_82" rel="nofollow">使用n个值构造</a></li><li><a href="#_88" rel="nofollow">迭代器区间构造</a></li><li><a href="#____n_93" rel="nofollow">解决迭代器区间构造 和 用n个值构造的冲突</a></li><li><a href="#_114" rel="nofollow">拷贝构造</a></li></ul> 
  </li><li><a href="#_122" rel="nofollow">析构函数</a></li><li><a href="#swap_128" rel="nofollow">swap【交换函数】</a></li><li><a href="#_139" rel="nofollow">赋值运算符重载</a></li><li><a href="#empty_157" rel="nofollow">empty</a></li><li><a href="#sizecapacity_164" rel="nofollow">size和capacity</a></li><li><a href="#operator_177" rel="nofollow">operator[]</a></li><li><a href="#reserve_186" rel="nofollow">reserve【调整容量大小】</a></li><li><a href="#resizesize_191" rel="nofollow">resize【调整size大小】</a></li><li><a href="#push_back_198" rel="nofollow">push_back</a></li><li><a href="#assign_205" rel="nofollow">assign【把所有数据替换成迭代器区间中的数据】</a></li><li><a href="#insert_211" rel="nofollow">insert</a></li><li><ul><li><a href="#pos_250" rel="nofollow">为什么扩容会导致pos迭代器失效？</a></li><li><a href="#pos1_260" rel="nofollow">为什么要返回pos-1？</a></li></ul> 
  </li><li><a href="#erase_270" rel="nofollow">erase</a></li><li><ul><li><a href="#pos_273" rel="nofollow">为什么要返回pos？</a></li></ul> 
  </li><li><a href="#_290" rel="nofollow">全部代码</a></li></ul> 
</div> 
<p></p> 
<h2><a id="_2"></a>全部的实现代码放在了文章末尾</h2> 
<h2><a id="_4"></a>准备工作</h2> 
<p>创建两个文件，一个头文件<code>myvector.hpp</code>，一个源文件 <code>tesr.cpp</code><br> 【因为模板的<mark>声明和定义<code>不能</code>分处于不同的文件中</mark>，所以把成员函数的声明和定义放在了同一个文件<code>myvector.hpp</code>中】</p> 
<ol><li> <p>mystring.hpp：存放包含的头文件，命名空间的定义，成员函数和命名空间中的函数的定义</p> </li><li> <p>test.cpp：存放main函数，以及测试代码</p> </li></ol> 
<hr> 
<h3><a id="_16"></a>包含头文件</h3> 
<ol><li> <p>iostream：用于输入输出</p> </li><li> <p>assert.h：用于使用报错函数assert</p> </li></ol> 
<hr> 
<h3><a id="_24"></a>定义命名空间和类</h3> 
<p>在文件<code>myvector.hpp</code>中定义上一个命名空间<code>myvector</code><br> 把vector类和它的成员函数<mark>放进命名空间封装起来</mark>，防止与包含的头文件中的函数/变量重名的冲突问题</p> 
<h4><a id="_31"></a>类的成员变量</h4> 
<p><mark>参考了stl源码中的vector的实现</mark><br> 成员变量有3个，都是迭代器</p> 
<p><img src="https://images2.imgbox.com/ba/10/Hg9DHplC_o.png" alt="在这里插入图片描述"><br> 画图理解一下<br> <img src="https://images2.imgbox.com/7a/ae/eyXwn9hD_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h2><a id="_44"></a>迭代器</h2> 
<p>迭代器<br> 因为存放数据的空间是从堆区申请的<code>连续的内存</code>，且只是简单模拟</p> 
<p>所以我用了指针<code>T*</code>作为普通迭代器，<code>const T*</code>作为const迭代器<br> 【<mark>T是vector中存储的数据的类型</mark>】</p> 
<p>直接把<code>T*</code>重命名为<code>iterator</code>，把<code>const T*</code>重命名为<code>const_iterator</code>就完成了迭代器的实现</p> 
<p><img src="https://images2.imgbox.com/10/cb/SShw4yPF_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_56"></a>迭代器获取函数</h3> 
<p><img src="https://images2.imgbox.com/95/7e/8xDeGCbC_o.png" alt="在这里插入图片描述"></p> 
<p><mark>因为const修饰的对象只能调用const修饰的成员函数</mark><br> 所以如果是const修饰的对象调用begin()和end()的时候，就会自动调用到const修饰的begin和end.</p> 
<hr> 
<h2><a id="_66"></a>构造函数</h2> 
<h3><a id="_67"></a>默认构造</h3> 
<p>因为stl库里实现的默认构造是没开空间的，所以默认构造直接让3个成员变量都为<code>nullptr</code>就行</p> 
<p><mark>直接在<code>声明</code>的时候给缺省值，缺省值会传给成员初始化列表</mark><br> 即<br> <img src="https://images2.imgbox.com/a1/d9/k1GNVzBz_o.png" alt="在这里插入图片描述"></p> 
<p>而成员初始化列表会比构造函数先调用<br> <mark>并且每个构造函数调用之前都会先调用成员初始化列表</mark>，这样不管调用哪一个构造函数初始化，都会先把3个成员变量初始化成<code>nullptr</code></p> 
<hr> 
<h3><a id="n_82"></a>使用n个值构造</h3> 
<p><img src="https://images2.imgbox.com/bf/0d/lIEBJ0AW_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h3><a id="_88"></a>迭代器区间构造</h3> 
<p><img src="https://images2.imgbox.com/a8/4e/BAOfIPkC_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h3><a id="____n_93"></a>解决迭代器区间构造 和 用n个值构造的冲突</h3> 
<p>当重载了迭代器区间构造和用n个值构造的时候<br> <mark>如果传入的<code>两个参数都是int类型</code>的话就会报错</mark></p> 
<p>为什么？<br> 因为在模板函数构成重载时，编译器会调用更合适的那一个<br> 什么叫更合适？<br> <mark>就是<code>不会</code>类型转</mark></p> 
<p>如果传入的<code>两个参数都是int类型</code>，那么调用的应该是<code>使用n个值构造</code>，因为没有int类型的迭代器</p> 
<p>但是<code>使用n个值构造</code>的第一个参数是size_t,<mark>int传进去要隐式类型转换</mark><br> 而调用<code>迭代器区间构造</code>，两个int的实参传进去，就会直接把<code>InputIterator</code>推导成int，<mark><code>不会</code>发生类型转换</mark>，所以编译器会调用<code>迭代器区间构造</code></p> 
<p>解决方法：<br> 再重载一个<code>使用n个值构造</code>的函数，把<mark>第一个参数改成int</mark>，这样根据<code>模板偏特化</code>，就会在都不类型转换时优先调用第一个参数特化成int的那个构造函数<br> <img src="https://images2.imgbox.com/3a/20/RfyavqKn_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h3><a id="_114"></a>拷贝构造</h3> 
<p><mark>因为成员申请了堆区空间，所以要<code>深拷贝</code></mark><br> 【不知道什么是深拷贝的可以看我这篇文章：<a href="http://t.csdnimg.cn/Uv8eN" rel="nofollow">类和对象【三】析构函数和拷贝构造函数</a>】<br> <img src="https://images2.imgbox.com/5c/c8/niAe7u9e_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h2><a id="_122"></a>析构函数</h2> 
<p><img src="https://images2.imgbox.com/b1/dd/N7dLSDW6_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h2><a id="swap_128"></a>swap【交换函数】</h2> 
<p>因为存放数据的空间是在堆区开辟的，用3个成员变量去指向的</p> 
<p>所以直接交换两个对象的成员变量就可以了</p> 
<p><mark>不需要拷贝数据</mark></p> 
<p><img src="https://images2.imgbox.com/b6/f2/IvNrTGfk_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h2><a id="_139"></a>赋值运算符重载</h2> 
<p><mark>因为成员申请了堆区空间，所以要<code>深拷贝</code></mark><br> 【不知道什么是深拷贝的可以看我这篇文章：<a href="http://t.csdnimg.cn/Uv8eN" rel="nofollow">类和对象【三】析构函数和拷贝构造函数</a>】</p> 
<p><img src="https://images2.imgbox.com/60/8b/1p2lBRAf_o.png" alt="在这里插入图片描述"><br> 为什么上面的两句代码就可以完成深拷贝呢？<br> 这是因为：</p> 
<p><mark>使用了传值传参，会在传参之前调用拷贝构造，再把拷贝构造出的临时对象作为参数传递进去</mark></p> 
<p>赋值运算符的左操作数，*this再与传入的临时对象obj交换，就直接完成了拷贝</p> 
<p>在函数结束之后，存储在栈区的obj再函数结束之后，obj生命周期结束</p> 
<p><mark>obj调用析构函数，把指向的从*this那里交换来的不需要的空间销毁</mark></p> 
<hr> 
<h2><a id="empty_157"></a>empty</h2> 
<p><img src="https://images2.imgbox.com/4a/9a/9Gb5WmxS_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h2><a id="sizecapacity_164"></a>size和capacity</h2> 
<p><img src="https://images2.imgbox.com/d8/ea/CbKBxnQd_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/91/9c/mvPEkGHZ_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<p><img src="https://images2.imgbox.com/7b/90/PSxT8adf_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h2><a id="operator_177"></a>operator[]</h2> 
<p><img src="https://images2.imgbox.com/c6/98/TPzzo5r0_o.png" alt="在这里插入图片描述"><br> 因为<br> <mark>const修饰的对象只能调用const修饰的成员函数</mark></p> 
<p>所以const对象只会调用下面的那个重载</p> 
<hr> 
<h2><a id="reserve_186"></a>reserve【调整容量大小】</h2> 
<p><img src="https://images2.imgbox.com/49/d6/wSryvTDA_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h2><a id="resizesize_191"></a>resize【调整size大小】</h2> 
<p><img src="https://images2.imgbox.com/3f/f3/xqT2WZuz_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h2><a id="push_back_198"></a>push_back</h2> 
<p><img src="https://images2.imgbox.com/e5/33/SNkNq8T1_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h2><a id="assign_205"></a>assign【把所有数据替换成迭代器区间中的数据】</h2> 
<p><img src="https://images2.imgbox.com/9f/7c/MOjcIyI9_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h2><a id="insert_211"></a>insert</h2> 
<pre><code class="prism language-cpp">	iterator <span class="token function">insert</span><span class="token punctuation">(</span>iterator pos<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span> val<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;=</span> _finish<span class="token punctuation">)</span><span class="token punctuation">;</span>  防止插入的位置是 越界的

		<span class="token keyword">if</span> <span class="token punctuation">(</span>_finish <span class="token operator">==</span> _end_of_storage<span class="token punctuation">)</span>  如果容量满了
		<span class="token punctuation">{<!-- --></span>
			记录一下扩容前的pos与start的相对位置
			因为扩容的话会导致pos迭代器失效
			size_t n <span class="token operator">=</span> pos<span class="token operator">-</span>_start<span class="token punctuation">;</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>  如果容量为<span class="token number">0</span>
				<span class="token function">reserve</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">else</span>  容量不为<span class="token number">0</span>，就扩<span class="token number">2</span>倍
			    <span class="token function">reserve</span><span class="token punctuation">(</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			更新pos
			pos <span class="token operator">=</span> _start <span class="token operator">+</span> n<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		iterator it <span class="token operator">=</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

		把pos及其之后的数据向后挪动一位
		<span class="token keyword">while</span> <span class="token punctuation">(</span>it <span class="token operator">&gt;=</span> pos<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token operator">*</span><span class="token punctuation">(</span>it <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span>it<span class="token punctuation">;</span>
			it<span class="token operator">--</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		_finish<span class="token operator">++</span><span class="token punctuation">;</span>

		<span class="token operator">*</span>pos <span class="token operator">=</span> val<span class="token punctuation">;</span>插入数据

        返回指向新插入的数据的迭代器  
        用于处理迭代器失效问题
		<span class="token keyword">return</span> pos<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="pos_250"></a>为什么扩容会导致pos迭代器失效？</h3> 
<p><img src="https://images2.imgbox.com/bd/f8/0V7BEMVN_o.png" alt="在这里插入图片描述"><br> <mark>因为扩容之后原来的空间被释放了</mark><br> 又因为使用的扩容方式是reserve所以那3个成员变量的值扩容后可以指向正确的位置。<br> 但是pos如果不更新的话，就还是指向被释放的空间，就成了野指针了。</p> 
<p>更新方法也很简单，保存扩容之前的pos与start的相对距离n，扩容之后再让pos=_start+n就可以了。</p> 
<h3><a id="pos1_260"></a>为什么要返回pos-1？</h3> 
<p><mark>这是stl库里面处理迭代器失效的方法之一</mark><br> 因为我们在使用stl库里面的insert函数的时候，是不知道什么时候会扩容的【<mark>每个平台实现的vector<code>是不同的</code></mark>】<br> 只能默认使用了之后传进去pos，在调用一次insert之后就失效了，失效的迭代器是不能使用的。<br> 所以如果还要用pos就要把它更新一下，stl库里提供的更新方式就是：<br> ==让pos接收insert的返回值。【<code>pos是传值调用，形参改变不影响实参</code>】==并且规定insert的返回值要是<code>指向新插入的数据的迭代器</code></p> 
<hr> 
<h2><a id="erase_270"></a>erase</h2> 
<p><img src="https://images2.imgbox.com/6e/3c/8XYEKcV0_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="pos_273"></a>为什么要返回pos？</h3> 
<p><mark>因为使用了erase之后的迭代器也会失效，需要提供更新的方法</mark></p> 
<p>为什么使用了erase之后的迭代器会失效？</p> 
<ol><li>不确定是否删除到一定数据时，会不会减小容量，以适应size<br> 此时和insert的一样，因为不能部分释放，<mark>所以会把原来的空间释放掉，申请新空间</mark></li><li>不确定是否删除的是最后一个数据，如果是那么调用完erase之后pos指向的就<br> <mark><code>不是</code>vector的有效数据范围了</mark></li></ol> 
<p>所以和insert一样，调用了erase之后如果还要使用pos，就要接收返回值。</p> 
<p>stl库里面规定erase的返回值是<code>指向删除数据的下一个数据的迭代器</code>，因为挪动覆盖的原因，下一个数据就是pos指向的数据，所以返回pos【<mark>没有接收返回值的迭代器，在检测较严格的编译器中，<code>不管指向的位置是否正确，都会禁止使用，使用了就报错</code></mark>】</p> 
<hr> 
<h2><a id="_290"></a>全部代码</h2> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;assert.h&gt;</span></span>

<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">namespace</span> myvector
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
	<span class="token keyword">class</span> <span class="token class-name">vector</span>
	<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">public</span><span class="token operator">:</span>
		<span class="token keyword">typedef</span> T<span class="token operator">*</span> iterator<span class="token punctuation">;</span>

		<span class="token keyword">typedef</span> <span class="token keyword">const</span> T<span class="token operator">*</span> const_iterator<span class="token punctuation">;</span>


		<span class="token function">vector</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
		<span class="token punctuation">}</span>

		<span class="token function">vector</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">,</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> val<span class="token operator">=</span><span class="token function">T</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_start <span class="token operator">=</span> <span class="token keyword">new</span> T<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//从堆区可容纳申请n个元素大小的空间</span>

			_finish <span class="token operator">=</span> _start<span class="token punctuation">;</span><span class="token comment">//还没有 有效数据 时start与finish重合</span>

			_end_of_storage <span class="token operator">=</span> _start <span class="token operator">+</span> n<span class="token punctuation">;</span><span class="token comment">//指向最大容量 的 下一个位置</span>

			<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">//循环n次</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token function">push_back</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//把数据尾插进去</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

		<span class="token function">vector</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span> val <span class="token operator">=</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_start <span class="token operator">=</span> <span class="token keyword">new</span> T<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>

			_finish <span class="token operator">=</span> _start<span class="token punctuation">;</span>

			_end_of_storage <span class="token operator">=</span> _start <span class="token operator">+</span> n<span class="token punctuation">;</span>

			<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token function">push_back</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>


		<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">InputIterator</span><span class="token operator">&gt;</span>
		<span class="token function">vector</span><span class="token punctuation">(</span>InputIterator first<span class="token punctuation">,</span> InputIterator last<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">//使用迭代器进行循环</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span>first <span class="token operator">!=</span> last<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token function">push_back</span><span class="token punctuation">(</span><span class="token operator">*</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//把数据尾插进去</span>

				<span class="token operator">++</span>first<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

	
		<span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">&amp;</span> obj<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">//使用库里面的swap交换3个成员变量</span>
			std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_start<span class="token punctuation">,</span> obj<span class="token punctuation">.</span>_start<span class="token punctuation">)</span><span class="token punctuation">;</span>

			std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_finish<span class="token punctuation">,</span> obj<span class="token punctuation">.</span>_finish<span class="token punctuation">)</span><span class="token punctuation">;</span>

			std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_end_of_storage<span class="token punctuation">,</span> obj<span class="token punctuation">.</span>_end_of_storage<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token function">vector</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">&amp;</span> obj<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			size_t size <span class="token operator">=</span> obj<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//记录有效数据个数</span>
			size_t capacity <span class="token operator">=</span> obj<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//记录容量大小</span>

			_start <span class="token operator">=</span> <span class="token keyword">new</span> T<span class="token punctuation">[</span>capacity<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//申请与obj相同大小的空间</span>

			_end_of_storage <span class="token operator">=</span> _start <span class="token operator">+</span> capacity<span class="token punctuation">;</span><span class="token comment">//指向最大容量 的 下一个位置</span>

			<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">//循环size次</span>
			<span class="token punctuation">{<!-- --></span>
				_start<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> obj<span class="token punctuation">.</span>_start<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//把有效数据拷贝过去</span>
			<span class="token punctuation">}</span>
			_finish <span class="token operator">=</span> _start <span class="token operator">+</span> size<span class="token punctuation">;</span><span class="token comment">//指向最后一个有效数据的  下一个 位置</span>
		<span class="token punctuation">}</span>


		<span class="token operator">~</span><span class="token function">vector</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">//释放从堆区申请的空间</span>
			<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> _start<span class="token punctuation">;</span>
			 
			<span class="token comment">//把3个成员变量  置空</span>
			_start <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
			_finish <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
			_end_of_storage <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>


		vector<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span> <span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> obj<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">swap</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>


		<span class="token keyword">bool</span> <span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">//如果size等于0，就是空的</span>
			<span class="token keyword">return</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		size_t <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">//finish指向最后一个有效数据的 下一个</span>
			<span class="token comment">//start指向第一个有效数据</span>
			<span class="token comment">//两个指针相减就是  两个指针之间的  数据个数</span>
			<span class="token keyword">return</span> _finish <span class="token operator">-</span> _start<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		size_t <span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">//end_of_storage指向最大容量的 下一个位置</span>
			<span class="token comment">//start指向第一个有效数据</span>
			<span class="token comment">//两个指针相减就是  两个指针之间的  数据个数</span>
			<span class="token keyword">return</span> _end_of_storage <span class="token operator">-</span> _start<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		
		T<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">(</span>size_t n<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">//防止越界访问</span>
			<span class="token function">assert</span><span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token comment">//因为start是T*类型，所以可以像数组一样直接随机访问</span>
			<span class="token keyword">return</span> _start<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>


		<span class="token keyword">const</span> T<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">(</span>size_t n<span class="token punctuation">)</span> <span class="token keyword">const</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">//防止越界访问</span>
			<span class="token function">assert</span><span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


			<span class="token comment">//因为start是T*类型，所以可以像数组一样直接随机访问</span>
			<span class="token keyword">return</span> _start<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>


		iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//普通起始迭代器</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _start<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// 普通结束迭代器</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _finish<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		const_iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span><span class="token comment">//const起始迭代器</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _start<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		const_iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span><span class="token comment">//const结束迭代器</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _finish<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>


		<span class="token keyword">void</span> <span class="token function">reserve</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> <span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//要调整的容量n，大于capacity才扩容</span>
			<span class="token punctuation">{<!-- --></span>
				size_t origsize <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//记录扩容前的size</span>

				T<span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token keyword">new</span> T<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//申请空间</span>

				<span class="token comment">//把原来的数据拷贝到  新空间</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span>origsize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
				<span class="token punctuation">{<!-- --></span>
					tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> _start<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

				<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> _start<span class="token punctuation">;</span><span class="token comment">//释放旧空间</span>

				<span class="token comment">//让成员变量指向  新的空间的相对位置</span>
				_start <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
				_finish <span class="token operator">=</span> _start <span class="token operator">+</span> origsize<span class="token punctuation">;</span>
				_end_of_storage <span class="token operator">=</span> _start <span class="token operator">+</span> n<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>


		<span class="token keyword">void</span> <span class="token function">resize</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span> val <span class="token operator">=</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> n<span class="token punctuation">)</span><span class="token comment">//如果size与要调整的n相等</span>
				<span class="token keyword">return</span><span class="token punctuation">;</span><span class="token comment">//直接返回</span>

			<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> n<span class="token punctuation">)</span><span class="token comment">//如果size小于n</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> <span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//如果n大于capacity</span>
				<span class="token punctuation">{<!-- --></span>
					<span class="token function">reserve</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//把容量调整到n</span>
				<span class="token punctuation">}</span>

				<span class="token comment">//再把size到n 之间的空间用  val填上</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
				<span class="token punctuation">{<!-- --></span>
					<span class="token function">push_back</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">else</span><span class="token comment">//如果size  大于  n</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token comment">//就调整标识有效数据的末尾的finish</span>
				<span class="token comment">//让size=_finish - _start = n</span>
				_finish <span class="token operator">=</span> _start <span class="token operator">+</span> n<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>


		<span class="token keyword">void</span> <span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span>val<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>_end_of_storage <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token comment">//如果容量为0</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token function">reserve</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//把容量调整到可容纳 2个元素大小</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>_finish<span class="token operator">==</span>_end_of_storage<span class="token punctuation">)</span><span class="token comment">//容量满了</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token function">reserve</span><span class="token punctuation">(</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//扩容</span>
			<span class="token punctuation">}</span>
			<span class="token comment">//在下标为size【最后一个有效数据的下一个】</span>
			<span class="token comment">//插入值</span>
			_start<span class="token punctuation">[</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> val<span class="token punctuation">;</span>
		
			_finish<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//更新有效数据的末尾</span>
		<span class="token punctuation">}</span>


		<span class="token keyword">void</span> <span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">assret</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			_finish<span class="token operator">--</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">InputIterator</span><span class="token operator">&gt;</span>
		<span class="token keyword">void</span> <span class="token function">assign</span><span class="token punctuation">(</span>InputIterator first<span class="token punctuation">,</span> InputIterator last<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> _start<span class="token punctuation">;</span><span class="token comment">//释放原来申请的空间</span>

			<span class="token comment">//把3个成员变量置空</span>
			_start <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
			_finish <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
			_end_of_storage <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>

			<span class="token keyword">while</span> <span class="token punctuation">(</span>first <span class="token operator">!=</span> last<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token comment">//一个一个尾插进去</span>
				<span class="token function">push_back</span><span class="token punctuation">(</span><span class="token operator">*</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token operator">++</span>first<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

		iterator <span class="token function">insert</span><span class="token punctuation">(</span>iterator pos<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span> val<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;=</span> _finish<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//防止插入的位置是 越界的</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span>_finish <span class="token operator">==</span> _end_of_storage<span class="token punctuation">)</span><span class="token comment">//如果容量满了</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token comment">//记录一下扩容前的pos与start的相对位置</span>
				<span class="token comment">//因为扩容的话会导致pos迭代器失效</span>
				size_t n <span class="token operator">=</span> pos<span class="token operator">-</span>_start<span class="token punctuation">;</span>

				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">//如果容量为0</span>
					<span class="token function">reserve</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">else</span><span class="token comment">//容量不为0，就扩2倍</span>
				    <span class="token function">reserve</span><span class="token punctuation">(</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token comment">//更新pos</span>
				pos <span class="token operator">=</span> _start <span class="token operator">+</span> n<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			iterator it <span class="token operator">=</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

			<span class="token comment">//把pos及其之后的数据向后挪动一位</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span>it <span class="token operator">&gt;=</span> pos<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token operator">*</span><span class="token punctuation">(</span>it <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span>it<span class="token punctuation">;</span>
				it<span class="token operator">--</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			_finish<span class="token operator">++</span><span class="token punctuation">;</span>

			<span class="token operator">*</span>pos <span class="token operator">=</span> val<span class="token punctuation">;</span><span class="token comment">//插入数据</span>

			<span class="token keyword">return</span> pos<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">InputIterator</span><span class="token operator">&gt;</span>
		<span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span>iterator pos<span class="token punctuation">,</span> InputIterator first<span class="token punctuation">,</span> InputIterator last<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;=</span> _finish<span class="token punctuation">)</span><span class="token punctuation">;</span>

			size_t len <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			InputIterator in <span class="token operator">=</span> first<span class="token punctuation">;</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span>in <span class="token operator">!=</span> last<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				in<span class="token operator">++</span><span class="token punctuation">;</span>
				len<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>_finish <span class="token operator">+</span> len <span class="token operator">&gt;=</span> _end_of_storage<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				size_t n <span class="token operator">=</span> pos <span class="token operator">-</span> _start<span class="token punctuation">;</span>

				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
				<span class="token punctuation">{<!-- --></span>
					<span class="token function">reserve</span><span class="token punctuation">(</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token function">reserve</span><span class="token punctuation">(</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
				pos <span class="token operator">=</span> _start <span class="token operator">+</span> n<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			iterator it <span class="token operator">=</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span>it <span class="token operator">&gt;=</span> pos<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token operator">*</span><span class="token punctuation">(</span>it <span class="token operator">+</span> len<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span>it<span class="token punctuation">;</span>
				it<span class="token operator">--</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			_finish<span class="token operator">+=</span>len<span class="token punctuation">;</span>

			it <span class="token operator">=</span> pos<span class="token punctuation">;</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span>it <span class="token operator">!=</span> pos <span class="token operator">+</span> len<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token operator">*</span>it <span class="token operator">=</span> <span class="token operator">*</span>first<span class="token punctuation">;</span>
				it<span class="token operator">++</span><span class="token punctuation">;</span>
				first<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>


		iterator <span class="token function">erase</span><span class="token punctuation">(</span>iterator pos<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">// 防止传入的pos 是越界的</span>
			<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _finish<span class="token punctuation">)</span><span class="token punctuation">;</span>

			iterator it <span class="token operator">=</span> pos<span class="token punctuation">;</span>

			<span class="token comment">//把pos之后的数据都向前挪动一位，把pos指向的位置给覆盖掉</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span>it <span class="token operator">&lt;</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token operator">*</span>it <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>it <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				it<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token comment">//更新数据末尾 迭代器</span>
			_finish<span class="token operator">--</span><span class="token punctuation">;</span>

			<span class="token comment">//返回pos</span>
			<span class="token keyword">return</span> pos<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>


		iterator <span class="token function">erase</span><span class="token punctuation">(</span>iterator first<span class="token punctuation">,</span> iterator last<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">assert</span><span class="token punctuation">(</span>first <span class="token operator">&gt;=</span> <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">assert</span><span class="token punctuation">(</span>last <span class="token operator">&lt;=</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			iterator fi <span class="token operator">=</span> first<span class="token punctuation">;</span>
			iterator la <span class="token operator">=</span> last<span class="token punctuation">;</span>
			size_t len <span class="token operator">=</span> last <span class="token operator">-</span> first<span class="token punctuation">;</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span>la <span class="token operator">!=</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token operator">*</span>fi <span class="token operator">=</span> <span class="token operator">*</span>la<span class="token punctuation">;</span>
				fi<span class="token operator">++</span><span class="token punctuation">;</span>
				la<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			_finish <span class="token operator">-=</span> len<span class="token punctuation">;</span>
			<span class="token keyword">return</span> first<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token keyword">private</span><span class="token operator">:</span>
		<span class="token comment">//start指向从堆区申请的空间的  起始  位置，与begin()返回的迭代器相等</span>
		<span class="token comment">//标识有效数组的开始</span>
		iterator _start <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>

		<span class="token comment">//finish指向  最后一个有效数据的  下一个位置，与end()返回的迭代器相等</span>
		<span class="token comment">//标识有效数据的结束</span>
		iterator _finish <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>

		<span class="token comment">//_end_of_storage指向从堆区申请的空间的 末尾的 下一个位置</span>
		<span class="token comment">//标识容量</span>
		iterator _end_of_storage <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b8bc97eb615ee8bedfa87cdd01dd0d4a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Objective-C 中的 isa 不再是简单的结构体指针</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a68ff8be4068e6dc270b9e0595dbc13c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">数据库系统安全</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>