<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【C语言】基于C语言实现的贪吃蛇游戏 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/d4eef116b0b4f087a8f54d2232490f16/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【C语言】基于C语言实现的贪吃蛇游戏">
  <meta property="og:description" content="【C语言】基于C语言实现的贪吃蛇游戏 🔥个人主页：大白的编程日记
🔥专栏：C语言学习之路
文章目录 【C语言】基于C语言实现的贪吃蛇游戏前言一.最终实现效果一.Win32 API介绍1.1Win32 API1.2控制台程序1.3控制台屏幕上的坐标COORD1.4GetStdHandle1.5GetConsoleCursorInfo1.6SetConsoleCursorInfo1.7SetConsoleCursorPosition1.8GetAsyncKeyState 二.C语言的国际化2.1国际化2.2&lt;locale.h&gt;本地化2.3类项2.4setlocale函数2.5宽字符的打印 三.思路分析四.GameStar函数4.1设置控制台信息4.2欢迎界面的打印4.3地图的绘制4.4初始化贪吃蛇 五.GameRun函数5.1提示信息函数5.2打印分数5.3检测键值5.4蛇的移动5.5检测是否撞墙 六.GameEnd函数七.游戏主体设计八.源码后言 前言 哈喽，各位小伙伴大家好！今天给大家带来的是使用C语言实现的贪吃蛇小游戏。也是检验C语言是否学好的试金石。话不多说，咱们进入正题！向大厂冲锋！
一.最终实现效果 贪吃蛇实现视频
一.Win32 API介绍 本次实现贪吃蛇会使用到的⼀些Win32 API知识，接下来我们就学习⼀下什么是Win32 API。
1.1Win32 API Windows 这个多作业系统除了协调应⽤程序的执行、分配内存、管理资源之外，
它同时也是⼀个很大的服务中心，调用这个服务中心的各种服务（每⼀种服务就是⼀个函数），可以帮应用程序达到开启视窗、描绘图形、使⽤周边设备等目的，由于这些函数服务的对象是应⽤程序(Application)， 所以便称之为 Application Programming Interface，简称 API 函数。
WIN32 API也就是Microsoft Windows32位平台的应用程序编程接口。
1.2控制台程序 平常我们运行起来的黑框程序其实就是控制台程序。
那这个控制台的大小我们可不可设置呢？其实是能的。
设置大小
我们可以使用cmd命令来设置控制台窗口的长宽：设置控制台窗口的大小，30行，100列。 mode con cols=100 lines=30 我们要设置控制台的话就需要使用system函数，system函数可以用来执行系统命令。
int main() { system(&#34;mode con cols=40 lines=40&#34;); return 0; } 设置名字
控制台的名字也能修改，使用title命令即可 title 贪吃蛇 int main() { system(&#34;mode con cols=100 lines=30&#34;); system(&#34;title 贪吃蛇&#34;); getchar(); return 0; } 控制台设置">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-08T17:36:20+08:00">
    <meta property="article:modified_time" content="2024-06-08T17:36:20+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【C语言】基于C语言实现的贪吃蛇游戏</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="CC_0"></a>【C语言】基于C语言实现的贪吃蛇游戏</h2> 
<p><img src="https://images2.imgbox.com/63/56/vFmBoluT_o.gif" alt=""></p> 
<p><font color="pink" size="4"><b>🔥个人主页</b>：<a href="https://blog.csdn.net/2301_81670477?spm=1011.2415.3001.5343"><font color="#33CCCC" size="4"><b>大白的编程日记</b></font></a></font></p> 
<p><font color="pink" size="4">🔥<strong>专栏</strong></font>：<a href="https://blog.csdn.net/2301_81670477/category_12572839.html"><font color="#33CCCC" size="4"><b>C语言学习之路</b></font></a></p> 
<p><img src="https://images2.imgbox.com/67/1d/IOztuxnd_o.gif" alt=""></p> 
<hr> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#CC_0" rel="nofollow">【C语言】基于C语言实现的贪吃蛇游戏</a></li><li><ul><li><a href="#_14" rel="nofollow">前言</a></li><li><a href="#_20" rel="nofollow">一.最终实现效果</a></li><li><a href="#Win32_API_25" rel="nofollow">一.Win32 API介绍</a></li><li><ul><li><a href="#11Win32_API_27" rel="nofollow">1.1Win32 API</a></li><li><a href="#12_32" rel="nofollow">1.2控制台程序</a></li><li><a href="#13COORD_89" rel="nofollow">1.3控制台屏幕上的坐标COORD</a></li><li><a href="#14GetStdHandle_116" rel="nofollow">1.4GetStdHandle</a></li><li><a href="#15GetConsoleCursorInfo_137" rel="nofollow">1.5GetConsoleCursorInfo</a></li><li><a href="#16SetConsoleCursorInfo_204" rel="nofollow">1.6SetConsoleCursorInfo</a></li><li><a href="#17SetConsoleCursorPosition_225" rel="nofollow">1.7SetConsoleCursorPosition</a></li><li><a href="#18GetAsyncKeyState_267" rel="nofollow">1.8GetAsyncKeyState</a></li></ul> 
   </li><li><a href="#C_294" rel="nofollow">二.C语言的国际化</a></li><li><ul><li><a href="#21_299" rel="nofollow">2.1国际化</a></li><li><a href="#22localeh_310" rel="nofollow">2.2&lt;locale.h&gt;本地化</a></li><li><a href="#23_318" rel="nofollow">2.3类项</a></li><li><a href="#24setlocale_326" rel="nofollow">2.4setlocale函数</a></li><li><a href="#25_348" rel="nofollow">2.5宽字符的打印</a></li></ul> 
   </li><li><a href="#_377" rel="nofollow">三.思路分析</a></li><li><a href="#GameStar_406" rel="nofollow">四.GameStar函数</a></li><li><ul><li><a href="#41_417" rel="nofollow">4.1设置控制台信息</a></li><li><a href="#42_437" rel="nofollow">4.2欢迎界面的打印</a></li><li><a href="#43_464" rel="nofollow">4.3地图的绘制</a></li><li><a href="#44_499" rel="nofollow">4.4初始化贪吃蛇</a></li></ul> 
   </li><li><a href="#GameRun_651" rel="nofollow">五.GameRun函数</a></li><li><ul><li><a href="#51_652" rel="nofollow">5.1提示信息函数</a></li><li><a href="#52_671" rel="nofollow">5.2打印分数</a></li><li><a href="#53_682" rel="nofollow">5.3检测键值</a></li><li><a href="#54_780" rel="nofollow">5.4蛇的移动</a></li><li><a href="#55_837" rel="nofollow">5.5检测是否撞墙</a></li></ul> 
   </li><li><a href="#GameEnd_888" rel="nofollow">六.GameEnd函数</a></li><li><a href="#_921" rel="nofollow">七.游戏主体设计</a></li><li><a href="#_942" rel="nofollow">八.源码</a></li><li><a href="#_1392" rel="nofollow">后言</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_14"></a>前言</h3> 
<blockquote> 
 <p>哈喽，各位小伙伴大家好！今天给大家带来的是使用C语言实现的贪吃蛇小游戏。也是检验C语言是否学好的试金石。话不多说，咱们进入正题！向大厂冲锋！<br> <img src="https://images2.imgbox.com/73/50/C0lb5hIf_o.gif" alt=""></p> 
</blockquote> 
<h3><a id="_20"></a>一.最终实现效果</h3> 
<p></p> 
<div class="csdn-video-box"> 
 <iframe id="3JlDCoZv-1717072613356" frameborder="0" src="https://live.csdn.net/v/embed/394617" allowfullscreen="true" data-mediaembed="csdn"></iframe> 
 <p>贪吃蛇实现视频</p> 
</div> 
<p></p> 
<h3><a id="Win32_API_25"></a>一.Win32 API介绍</h3> 
<p>本次实现贪吃蛇会使用到的⼀些Win32 API知识，接下来我们就学习⼀下什么是Win32 API。</p> 
<h4><a id="11Win32_API_27"></a>1.1Win32 API</h4> 
<blockquote> 
 <p>Windows 这个多作业系统除了协调应⽤程序的执行、分配内存、管理资源之外，<br> 它同时也是⼀个很大的服务中心，调用这个服务中心的各种服务（每⼀种服务就是⼀个函数），可以帮应用程序达到开启视窗、描绘图形、使⽤周边设备等目的，由于这些函数服务的对象是应⽤程序(Application)， 所以便称之为 Application Programming Interface，简称 API 函数。<br> WIN32 API也就是Microsoft Windows32位平台的应用程序编程接口。</p> 
</blockquote> 
<h4><a id="12_32"></a>1.2控制台程序</h4> 
<p><img src="https://images2.imgbox.com/8c/17/onZ8dTVe_o.png" alt=""><br> 平常我们运行起来的黑框程序其实就是控制台程序。<br> 那这个控制台的大小我们可不可设置呢？其实是能的。</p> 
<ul><li>设置大小<br> 我们可以使用cmd命令来设置控制台窗口的长宽：设置控制台窗口的大小，30行，100列。</li></ul> 
<pre><code class="prism language-c">mode con cols<span class="token operator">=</span><span class="token number">100</span> lines<span class="token operator">=</span><span class="token number">30</span>
</code></pre> 
<p>我们要设置控制台的话就需要使用system函数，system函数可以用来执行系统命令。</p> 
<pre><code class="prism language-c"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"mode con cols=40 lines=40"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b6/da/aydFyFKa_o.png" alt=""><br> <img src="https://images2.imgbox.com/45/fb/vvob7pKb_o.png" alt=""></p> 
<ul><li>设置名字<br> 控制台的名字也能修改，使用title命令即可</li></ul> 
<pre><code class="prism language-c">title 贪吃蛇
</code></pre> 
<pre><code class="prism language-c"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"mode con cols=100 lines=30"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"title 贪吃蛇"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/6f/ef/46FklA4v_o.png" alt=""></p> 
<ul><li>控制台设置<br> 我们平时的默认是控制台终端，但是它实现不了我们想要的效果，所以我们要修改一下。<br> <img src="https://images2.imgbox.com/97/9d/RqdBv9ne_o.png" alt=""><br> 先点箭头后出现的设置<br> <img src="https://images2.imgbox.com/67/7e/9rtn80T6_o.png" alt=""><br> 之后找到默认终端程序应用，改为控制台主机即可。</li></ul> 
<h4><a id="13COORD_89"></a>1.3控制台屏幕上的坐标COORD</h4> 
<blockquote> 
 <p>我们的贪吃蛇游戏里面有蛇，食物，墙等等。他们涉及到的位置是我们游戏中的关键信息，那我们再屏幕上也要定位他们的位置，那怎么定位呢？这就涉及到COORD了。<br> COORD是WindowsAPI中定义的⼀个结构体，表示一个字符在控制台屏幕幕缓冲区上的坐标，坐标系(0，0)的原点位于缓冲区的顶部左侧单元格。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/91/ba/LLCi82yr_o.png" alt=" "><br> COORD是一种结构体类型</p> 
<ul><li>结构体类型</li></ul> 
<pre><code class="prism language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_COORD</span> <span class="token punctuation">{<!-- --></span>
 SHORT X<span class="token punctuation">;</span>
 SHORT Y<span class="token punctuation">;</span>
<span class="token punctuation">}</span> COORD<span class="token punctuation">,</span> <span class="token operator">*</span>PCOORD<span class="token punctuation">;</span>
</code></pre> 
<ul><li>头文件<br> 使用COORD结构体需要包含windows.h的头文件</li></ul> 
<p>那现在我们定义一个坐标就可以这样写</p> 
<pre><code class="prism language-c">	COORD pos <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	COORD pos1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="14GetStdHandle_116"></a>1.4GetStdHandle</h4> 
<blockquote> 
 <p>GetStdHandle是⼀个WindowsAPI函数。它用于从⼀个特定的标准设备（标准输入、标准输出或标准错误）中取得⼀个句柄（用来标识不同设备的数值），使用这个句柄可以操作设备。<br> 我们在控制台窗口中进行光标隐藏等操作时，都需要先获得这个窗口。而GetStdHandle就可以获得一个对窗口操作的把手，也就是句柄。通过这个把手我们就可以对控制台窗口进行操作。</p> 
</blockquote> 
<pre><code class="prism language-c">HANDLE <span class="token function">GetStdHandle</span><span class="token punctuation">(</span>DWORD nStdHandle<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a1/32/L4q34gwG_o.png" alt=""></p> 
<ul><li>参数<br> 标准设备。 此参数的取值可为下列值之一。<br> <img src="https://images2.imgbox.com/a0/6c/OYaLqoOL_o.png" alt=""></li></ul> 
<p>那我们贪吃蛇进行蛇的移动，食物的绘制等都是在屏幕上输出信息。所以我们需要或许标准输出设备的句柄</p> 
<pre><code class="prism language-c">	HANDLE houtput <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	houtput<span class="token operator">=</span><span class="token function">GetStdHandle</span><span class="token punctuation">(</span>STD_OUTPUT_HANDLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="15GetConsoleCursorInfo_137"></a>1.5GetConsoleCursorInfo</h4> 
<p><img src="https://images2.imgbox.com/f7/fe/CpQEPU1f_o.png" alt=""></p> 
<blockquote> 
 <p>大家可以发现我们运行时窗口会有一个光标闪烁，那等下贪吃蛇运行时我们是不希望它闪烁的，有没有办法把它隐藏掉呢？那我们得先获取光标信息。<br> GetConsoleCursorInfo是检索有关指定控制台屏幕缓冲区的光标大小可见性的信息的函数</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/59/62/epKRawfz_o.png" alt=""></p> 
<p>它的参数有两个：<br> <img src="https://images2.imgbox.com/11/16/QVuLgfSp_o.png" alt=""></p> 
<ul><li>光标控制台句柄</li></ul> 
<p>第一个参数是一个跟光标关联的控制台窗口的句柄</p> 
<pre><code class="prism language-c"> _In_  HANDLE               hConsoleOutput<span class="token punctuation">,</span>
</code></pre> 
<ul><li>光标信息<br> 第二个参数是指向光标信息结构体CONSOLE_CURSOR_INFO的指针</li></ul> 
<pre><code class="prism language-c"> _Out_ PCONSOLE_CURSOR_INFO lpConsoleCursorInfo
</code></pre> 
<ul><li>光标信息结构体</li></ul> 
<blockquote> 
 <p>dwSize，由光标填充的字符单元格的百分比。此值介于1到100之间。光标外观会变化，范围从完全填充单元格到单元底部的水平线条<br> bVisible，游标的可见性。如果光标可见，则此成员为TRUE。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/4f/7d/15aruiY0_o.png" alt=""><br> 那我们现在获取光标就可以这样写</p> 
<pre><code class="prism language-c">HANDLE hOutput <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token comment">//获取标准输出的句柄(⽤来标识不同设备的数值) </span>
hOutput <span class="token operator">=</span> <span class="token function">GetStdHandle</span><span class="token punctuation">(</span>STD_OUTPUT_HANDLE<span class="token punctuation">)</span><span class="token punctuation">;</span>

CONSOLE_CURSOR_INFO CursorInfo<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//光标信息结构体</span>
<span class="token function">GetConsoleCursorInfo</span><span class="token punctuation">(</span>hOutput<span class="token punctuation">,</span> <span class="token operator">&amp;</span>CursorInfo<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取控制台光标信息 </span>
</code></pre> 
<p>现在我们输出一下光标的信息看一下</p> 
<pre><code class="prism language-c">	<span class="token comment">//获取标准输出的句柄(⽤来标识不同设备的数值) </span>
	HANDLE hOutput <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	hOutput <span class="token operator">=</span> <span class="token function">GetStdHandle</span><span class="token punctuation">(</span>STD_OUTPUT_HANDLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	CONSOLE_CURSOR_INFO CursorInfo <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//光标信息结构体</span>
	<span class="token function">GetConsoleCursorInfo</span><span class="token punctuation">(</span>hOutput<span class="token punctuation">,</span> <span class="token operator">&amp;</span>CursorInfo<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取控制台光标信息 </span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> CursorInfo<span class="token punctuation">.</span>dwSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8f/14/iB8jAo5D_o.png" alt=""><br> 现在我们把光标大小设为50</p> 
<pre><code class="prism language-c">HANDLE hOutput <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
hOutput <span class="token operator">=</span> <span class="token function">GetStdHandle</span><span class="token punctuation">(</span>STD_OUTPUT_HANDLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
CONSOLE_CURSOR_INFO CursorInfo <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//光标信息结构体</span>
<span class="token function">GetConsoleCursorInfo</span><span class="token punctuation">(</span>hOutput<span class="token punctuation">,</span> <span class="token operator">&amp;</span>CursorInfo<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取控制台光标信息 </span>
CursorInfo<span class="token punctuation">.</span>dwSize <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/84/9d/uuxcoVlu_o.png" alt=""><br> 可是为什么光标大小没变呢？<br> 这是因为我们只修改了光标的信息，我们还需要设置修改后光标信息。</p> 
<h4><a id="16SetConsoleCursorInfo_204"></a>1.6SetConsoleCursorInfo</h4> 
<p>SetConsoleCursorInfo是用来设置指定控制台屏幕缓冲区的光标的大小和可见性。</p> 
<ul><li>参数</li></ul> 
<pre><code class="prism language-c">BOOL WINAPI <span class="token function">SetConsoleCursorInfo</span><span class="token punctuation">(</span>
  _In_       HANDLE              hConsoleOutput<span class="token punctuation">,</span>
  _In_ <span class="token keyword">const</span> CONSOLE_CURSOR_INFO <span class="token operator">*</span>lpConsoleCursorInfo
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/6c/8d/sVO6XdJC_o.png" alt=""><br> 它的参数和GetConsoleCursorInfo一样。<br> 现在我们来设置光标信息</p> 
<ul><li>修改光标大小<br> <img src="https://images2.imgbox.com/6e/e0/6RUj9YvA_o.png" alt=""></li><li>隐藏光标<br> <img src="https://images2.imgbox.com/10/91/rbKGu22N_o.png" alt=""></li></ul> 
<h4><a id="17SetConsoleCursorPosition_225"></a>1.7SetConsoleCursorPosition</h4> 
<blockquote> 
 <p>那我们如何让光标移动到指定位置呢？<br> 设置指定控制台屏幕缓冲区中的光标位置，我们将想要设置的坐标信息放在COORD类型的pos中，调用SetConsoleCursorPosition函数将光标位置设置到指定的位置。</p> 
</blockquote> 
<ul><li>参数</li></ul> 
<blockquote> 
 <p>一个是控制台窗口的句柄 一个是光标位置的结构体</p> 
</blockquote> 
<pre><code class="prism language-c">BOOL WINAPI <span class="token function">SetConsoleCursorPosition</span><span class="token punctuation">(</span>
 HANDLE hConsoleOutput<span class="token punctuation">,</span>
 COORD pos
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>那我们现在想定位光标到第10行，第5列就可以这样写。</p> 
<pre><code class="prism language-c">COORD pos <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 HANDLE hOutput <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
 <span class="token comment">//获取标准输出的句柄(⽤来标识不同设备的数值) </span>
 hOutput <span class="token operator">=</span> <span class="token function">GetStdHandle</span><span class="token punctuation">(</span>STD_OUTPUT_HANDLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token comment">//设置标准输出上光标的位置为pos </span>
 <span class="token function">SetConsoleCursorPosition</span><span class="token punctuation">(</span>hOutput<span class="token punctuation">,</span> pos<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ac/ad/RQFglgP5_o.png" alt=""></p> 
<blockquote> 
 <p>为了方便我们后面游戏打印食物和移动蛇的位置，我们封装⼀个设置光标位置的函数</p> 
</blockquote> 
<pre><code class="prism language-c"><span class="token comment">//设置光标的坐标 </span>
<span class="token keyword">void</span> <span class="token function">SetPos</span><span class="token punctuation">(</span><span class="token keyword">short</span> x<span class="token punctuation">,</span> <span class="token keyword">short</span> y<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
   COORD pos <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span><span class="token punctuation">;</span>
   HANDLE hOutput <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
   <span class="token comment">//获取标准输出的句柄(⽤来标识不同设备的数值) </span>
   hOutput <span class="token operator">=</span> <span class="token function">GetStdHandle</span><span class="token punctuation">(</span>STD_OUTPUT_HANDLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//设置标准输出上光标的位置为pos </span>
   <span class="token function">SetConsoleCursorPosition</span><span class="token punctuation">(</span>hOutput<span class="token punctuation">,</span> pos<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="18GetAsyncKeyState_267"></a>1.8GetAsyncKeyState</h4> 
<blockquote> 
 <p>我们贪吃蛇游戏需要根据键盘的的按键进行上下左右的移动。 那如何让程序获取我们的按键信息呢？</p> 
</blockquote> 
<blockquote> 
 <p>这时就需要用到GetAsyncKeyState函数</p> 
 <p>将键盘上每个键的虚拟键值传递给函数，函数通过返回值来分辨按键的状态。<br> GetAsyncKeyState的返回值是short类型，在上⼀次调用GetAsyncKeyState 函数后，如果返回的16位的short数据中，最高 位是1，说明按键的状态是按下，如果最⾼是0，说明按键的状态是抬起；如果最低位被置为1则说明，该按键被按过，否则为0。 如果我们要判断⼀个键是否被按过，可以检测GetAsyncKeyState返回值的最低值是否为1.</p> 
</blockquote> 
<ul><li>参数<br> 函数的参数是一个int类型，代表要检测按键的虚拟键值</li></ul> 
<pre><code class="prism language-c">SHORT <span class="token function">GetAsyncKeyState</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> <span class="token keyword">int</span> vKey
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>虚拟键值表<br> <img src="https://images2.imgbox.com/01/4c/Zyju0AoH_o.png" alt=""></li></ul> 
<p>这样我们就可以定义一个宏来检测按键是否被按过，只需检测函数返回值的最低位即可。</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">KEY_PRESS</span><span class="token expression"><span class="token punctuation">(</span>VK<span class="token punctuation">)</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token function">GetAsyncKeyState</span><span class="token punctuation">(</span>VK<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">)</span></span></span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c5/f3/Rfs47UPk_o.png" alt=""></p> 
<h3><a id="C_294"></a>二.C语言的国际化</h3> 
<blockquote> 
 <p>在游戏地图上，我们打印墙体使⽤宽字符：□，打印蛇使⽤宽字符●，打印食物使用宽字符★ 普通的字符是占⼀个字节的，这类宽字符是占用2个字节。<br> 这⾥再简单的讲⼀下C语言的国际化特性相关的知识，过去C语言并不适合非英语国家（地区）使用。C语言最初假定字符都是单字节的。但是这些假定并不是在世界的任何地方都适用。</p> 
</blockquote> 
<h4><a id="21_299"></a>2.1国际化</h4> 
<blockquote> 
 <p>C语言字符默认是采⽤ASCII编码的，ASCII字符集采⽤的是单字节编码，且只使用了单字节中的低7 位，最高位是没有使用的，可表⽰为0xxxxxxxx；可以看到，ASCII字符集共包含128个字符，在英语国家中，128个字符是基本够用的，但是，在其他国家语言中，比如，在法语中，字母上方有注音符号，它就无法用ASCII码表示。于是，⼀些欧洲国家就决定，利用字节中闲置的最高位编入新的符号。</p> 
</blockquote> 
<blockquote> 
 <p>比如，法语中的é的编码为130（⼆进制10000010）。这样⼀来，这些欧洲国家使⽤的编码体系，可以表示最多256个符号。但是，这⾥又出现了新的问题。不同的国家有不同的字母，因此，哪怕它们都使用256个符号的编码⽅式，代表的字母却不⼀样。比如，130在法语编码中代表了é，在希伯来语编码中却代表了字⺟Gimel在俄语编码中又会代表另⼀个符号。但是不管怎样，所有这些编码方式中，0–127表示的符号是⼀样的，不⼀样的只是128–255的这一段。</p> 
 <p>至于亚洲国家的文字，使⽤的符号就更多了，汉字就多达10万左右。⼀个字节只能表示256种符号，肯定是不够的，就必须使用多个字节表达⼀个符号。比如，简体中文常见的编码方式是GB2312，使用两个字节表示⼀个汉字，所以理论上最多可以表示256x25=65536个符号。</p> 
</blockquote> 
<blockquote> 
 <p>后来为了使C语言适应国际化，C语言的标准中不断加入了国际化的支持。比如：加入了宽字符的类型wchar_t 和宽字符的输⼊和输出函数，加⼊了&lt;locale.h&gt;头文件，其中提供了允许程序员针对特定地区（通常是国家或者说某种特定语⾔的地理区域）调整程序行为的函数。</p> 
</blockquote> 
<h4><a id="22localeh_310"></a>2.2&lt;locale.h&gt;本地化</h4> 
<p>&lt;locale.h&gt;提供的函数用于控制C标准库中对于不同的地区会产生不⼀样行为的部分。<br> 在标准中，依赖地区的部分有以下几项：</p> 
<ul><li>数字量的格式</li><li>货币量的格式</li><li>字符集</li><li>日期和时间的表示形式</li></ul> 
<h4><a id="23_318"></a>2.3类项</h4> 
<p>通过修改地区，程序可以改变它的行为来适应世界的不同区域。但地区的改变可能会影响库的许多部分，其中⼀部分可能是我们不希望修改的。所以C语言支持针对不同的类项进行修改，下面的⼀个宏，指定⼀个类项：</p> 
<ul><li>LC_COLLATE：影响字符串比较函数 strcoll() 和 strxfrm()</li><li>LC_CTYPE：影响字符处理函数的行为。</li><li>LC_MONETARY：影响货币格式。</li><li>LC_NUMERIC：影响 printf() 的数字格式。</li><li>LC_TIME：影响时间格式 strftime() 和 wcsftime() 。</li><li>LC_ALL-针对所有类项修改，将以上所有类别设置为给定的语⾔环境。</li></ul> 
<h4><a id="24setlocale_326"></a>2.4setlocale函数</h4> 
<blockquote> 
 <p>setlocale函数⽤于修改当前地区，可以针对一个类项修改，也可以针对所有类项。setlocale的第⼀个参数可以是前⾯说明的类项中的⼀个，那么每次只会影响⼀个类项，如果第⼀个参数是LC_ALL，就会影响所有的类项。</p> 
</blockquote> 
<p>C标准给第⼆个参数仅定义了2种可能取值：“C”（正常模式）和""（本地模式）。</p> 
<ul><li>正常模式<br> 在任意程序执行开始，都会隐藏式执行调用:</li></ul> 
<pre><code class="prism language-c"><span class="token function">setlocale</span><span class="token punctuation">(</span>LC_ALL<span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>地区设置为"C"时，库函数按正常方式执行，小数点是⼀个点</p> 
<ul><li>本地模式<br> 当程序运行起来后想改变地区，就只能显示调用setlocale函数。⽤"作为第2个参数，调用setlocale函数就可以切换到本地模式，这种模式下程序会适应本地环境。<br> 比如：切换到我们的本地模式后就支持宽字符（汉字）的输出等。</li></ul> 
<pre><code class="prism language-c"><span class="token function">setlocale</span><span class="token punctuation">(</span>LC_ALL<span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//切换到本地环境 </span>
</code></pre> 
<h4><a id="25_348"></a>2.5宽字符的打印</h4> 
<blockquote> 
 <p>那如果想在屏幕上打印宽字符，怎么打印呢？<br> 宽字符的字面量必须加上前缀“L”，否则C语言会把字面量当作窄字符类型处理。前缀“L”在单引<br> 号前面，表⽰宽字符，对应 wprintf() 的占位符为 %lc ；在双引号前⾯，表示宽字符串，对应<br> wprintf() 的占位符为 %ls 。</p> 
</blockquote> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;locale.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
 <span class="token function">setlocale</span><span class="token punctuation">(</span>LC_ALL<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token class-name">wchar_t</span> ch1 <span class="token operator">=</span> L<span class="token char">'●'</span><span class="token punctuation">;</span> 
 <span class="token class-name">wchar_t</span> ch2 <span class="token operator">=</span> L<span class="token char">'⽐'</span><span class="token punctuation">;</span>
 <span class="token class-name">wchar_t</span> ch3 <span class="token operator">=</span> L<span class="token char">'特'</span><span class="token punctuation">;</span>
 <span class="token class-name">wchar_t</span> ch4 <span class="token operator">=</span> L<span class="token char">'★'</span><span class="token punctuation">;</span>
 
 <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%c%c\n"</span><span class="token punctuation">,</span> <span class="token char">'a'</span><span class="token punctuation">,</span> <span class="token char">'b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%lc\n"</span><span class="token punctuation">,</span> ch1<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%lc\n"</span><span class="token punctuation">,</span> ch2<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%lc\n"</span><span class="token punctuation">,</span> ch3<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%lc\n"</span><span class="token punctuation">,</span> ch4<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/6f/21/zpVNpMCf_o.png" alt=""></p> 
<h3><a id="_377"></a>三.思路分析</h3> 
<blockquote> 
 <p>我们先把游戏分为三个大的模块。每个模块分别负责不同的功能。 每个模块具体实现又由多个小的函数模块合理设计拼接后组成。大体的思路如下：</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/5e/91/gbE6h1xw_o.png" alt=""></p> 
<ul><li> <p>GameStar函数<br> GameStar函数负责进入窗口大小和名字的设置，光标的隐藏。<br> 欢迎界面的打印，地图的绘制。<br> 贪吃蛇的创建和初始化，食物的创建。</p> </li><li> <p>GameRun函数<br> 右侧打印帮助信息-PrintHelpInfo<br> 打印当前已获得分数和每个食物的分数以提示用户<br> 根据按键情况移动蛇-SnakeMove直到游戏是结束状态</p> </li><li> <p>SnakeMove<br> 根据蛇头的坐标和方向，计算下⼀个节点的坐标<br> 判断下⼀个节点是否是食物-NextIsFood<br> 是食物就吃掉-EatFood<br> 不是食物，吃掉食物，尾巴删除⼀节-NoFood<br> 判断是否撞墙-KillByWall<br> 判断是否撞上自己-KillBySelf</p> </li><li> <p>GameEnd<br> 告知游戏结束的原因<br> 释放蛇身节点</p> </li></ul> 
<h3><a id="GameStar_406"></a>四.GameStar函数</h3> 
<p>为了方便阅读代码，这里先把我们定义好的宏给大家看<br> <img src="https://images2.imgbox.com/f0/ea/vSgtzoCd_o.png" alt=""></p> 
<ul><li>实现效果<br> <img src="https://images2.imgbox.com/17/4d/BmefZM2b_o.png" alt=""><br> <img src="https://images2.imgbox.com/30/20/tjKItgDH_o.png" alt=""><br> <img src="https://images2.imgbox.com/7f/76/AxmRuyz0_o.png" alt=""></li></ul> 
<h4><a id="41_417"></a>4.1设置控制台信息</h4> 
<p>首先我们需要设置控制台大小，名字，还要隐藏光标。<br> 这些操作我们前面讲过的了。不再过多赘述了。</p> 
<pre><code class="prism language-c"><span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"mode con cols=100 lines=30"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//设置控制台窗口大小</span>
<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"title 贪吃蛇"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//设置控制台名字</span>
HANDLE houtput <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
houtput <span class="token operator">=</span> <span class="token function">GetStdHandle</span><span class="token punctuation">(</span>STD_OUTPUT_HANDLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//定义一个光标信息的结构体</span>
CONSOLE_CURSOR_INFO cursor_info <span class="token punctuation">;</span>
<span class="token comment">//获取和houtput句柄相关的控制台上的光标信息，存放在cursor_info中</span>
<span class="token function">GetConsoleCursorInfo</span><span class="token punctuation">(</span>houtput<span class="token punctuation">,</span> <span class="token operator">&amp;</span>cursor_info<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//修改光标（隐藏光标）</span>
cursor_info<span class="token punctuation">.</span>bVisible<span class="token operator">=</span> false<span class="token punctuation">;</span>
<span class="token comment">//设置和houtput句柄相关的控制台上的光标信息</span>
<span class="token function">SetConsoleCursorInfo</span><span class="token punctuation">(</span>houtput<span class="token punctuation">,</span> <span class="token operator">&amp;</span>cursor_info<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="42_437"></a>4.2欢迎界面的打印</h4> 
<p><img src="https://images2.imgbox.com/72/d8/dyRRBeXR_o.png" alt=""><br> <img src="https://images2.imgbox.com/ca/18/D2VErK3X_o.png" alt=""><br> 这里我们把欢迎界面的打印封装为WelcomeToSnake函数<br> 我们只需要将光标定位到指定位置，然后打印文字即可。<br> 注意这里涉及到程序的暂停我们用system函数即可实现。<br> 打印完切换下一个界面时，我们清理屏幕。这个用system函数也能实现<br> 再定位打印文字。</p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">WelcomeToSnake</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位光标</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"欢迎来到贪吃蛇小游戏~\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位光标</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//暂停程序</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//清理屏幕</span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位光标</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"分别用↑.↓.←.→控制移动方向，F3加速，F4减速\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位光标</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"加速能够获得更高的分数\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位光标</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//暂停程序</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//清理屏幕</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="43_464"></a>4.3地图的绘制</h4> 
<p><img src="https://images2.imgbox.com/35/00/BQbwEMCd_o.png" alt=""></p> 
<p>地图的绘制我们也单独封装为一个Greatmap()函数<br> 假设我们要绘制一个27行 58列的地图，我们只需要关注好四个角落点的坐标，<br> 然后用四层for循环打印即可。<br> <img src="https://images2.imgbox.com/8e/e8/pJC6KmjV_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">Greatmap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位原点</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">29</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">//打印第一行墙体</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%lc"</span><span class="token punctuation">,</span> WALL<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位第二行起点</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">29</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">//打印第二行墙体</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%lc"</span><span class="token punctuation">,</span> WALL<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span><span class="token number">25</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">//打印第一列墙体</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//每次打印墙体下移</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%lc"</span><span class="token punctuation">,</span> WALL<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span><span class="token number">25</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">//打印第二列墙体</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">56</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//每次打印墙体下移</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%lc"</span><span class="token punctuation">,</span> WALL<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>这里大家要注意行的打印光标不需要移动，但是列的打印光标需要移动。</p> 
<h4><a id="44_499"></a>4.4初始化贪吃蛇</h4> 
<blockquote> 
 <p>游戏中食物的信息，贪吃蛇的信息，蛇的移动方向， 游戏状态，食物分数，总得分，蛇的移动快慢（休眠时间）， 食物信息。都是我们游戏过程中需要维护的信息。我们维护游戏其实就是维护这些信息。我们把他们用结构体包含，作为贪吃蛇，我们只需要维护这贪吃蛇即可。</p> 
</blockquote> 
<ul><li>游戏状态<br> 四种游戏状态：正常游戏 撞墙 咬到自己 玩家主动结束。<br> 用枚举类型即可。</li></ul> 
<pre><code class="prism language-c"><span class="token keyword">enum</span> <span class="token class-name">STATUS</span><span class="token comment">//游戏的状态</span>
<span class="token punctuation">{<!-- --></span>
	ok <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
	kill_by_wall<span class="token punctuation">,</span>
	kill_by_self<span class="token punctuation">,</span>
	end
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>蛇的移动方向<br> 四种移动状态：上 下 左 右。<br> 用枚举类型即可。</li></ul> 
<pre><code class="prism language-c"><span class="token keyword">enum</span> <span class="token class-name">DIRECTION</span><span class="token comment">//枚举蛇的方向</span>
<span class="token punctuation">{<!-- --></span>
	up <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
    down<span class="token punctuation">,</span>
	left <span class="token punctuation">,</span>
	right
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>蛇头<br> 蛇的维护我们只需要一个指向蛇头的指针即可。食物我们也可以看成蛇的节点。蛇的节点我们用链表来表示。</li></ul> 
<pre><code class="prism language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">SnakeNode</span> <span class="token comment">//蛇身</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> x<span class="token punctuation">;</span>
	<span class="token keyword">int</span> y<span class="token punctuation">;</span>
	<span class="token keyword">struct</span> <span class="token class-name">SnakeNode</span><span class="token operator">*</span> next<span class="token punctuation">;</span>
<span class="token punctuation">}</span>Snakenode<span class="token punctuation">,</span><span class="token operator">*</span> pSnakenode<span class="token punctuation">;</span>
</code></pre> 
<ul><li>其他信息<br> 食物分数 总分 休眠时间<br> 用int类型即可。</li></ul> 
<pre><code class="prism language-c"><span class="token keyword">int</span> fool_score<span class="token punctuation">;</span>
<span class="token keyword">int</span> score<span class="token punctuation">;</span>
<span class="token keyword">int</span> sleep_time<span class="token punctuation">;</span>
</code></pre> 
<ul><li>贪吃蛇信息</li></ul> 
<pre><code class="prism language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Snake</span><span class="token comment">//游戏中贪吃蛇的信息</span>
<span class="token punctuation">{<!-- --></span>
	pSnakenode shead<span class="token punctuation">;</span>
	pSnakenode snakefool<span class="token punctuation">;</span>
	<span class="token keyword">enum</span> <span class="token class-name">DRIECTION</span> dir<span class="token punctuation">;</span>
	<span class="token keyword">enum</span> <span class="token class-name">STATUS</span> statu<span class="token punctuation">;</span>
	<span class="token keyword">int</span> fool_score<span class="token punctuation">;</span>
	<span class="token keyword">int</span> score<span class="token punctuation">;</span>
	<span class="token keyword">int</span> sleep_time<span class="token punctuation">;</span>
<span class="token punctuation">}</span>Snake<span class="token punctuation">,</span><span class="token operator">*</span>psnake<span class="token punctuation">;</span>
</code></pre> 
<ul><li>创建食物函数<br> 我们创建一个蛇的节点作为食物节点。再用rand函数生成横纵坐标。<br> 然后循环遍历区判断食物节点和和蛇身的每一个节点坐标是否有重合。<br> 重合就用goto语句继续生成坐标知道不重合为止。接着打印食物即可。</li></ul> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">GreatFool</span><span class="token punctuation">(</span>psnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	pSnakenode pcur <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token punctuation">;</span>
	pSnakenode fool <span class="token operator">=</span> <span class="token punctuation">(</span>pSnakenode<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>Snakenode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//创建蛇的节点作为食物节点</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>fool <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token comment">//判空</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"GreatFool:malloc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">int</span> x<span class="token punctuation">,</span> y<span class="token punctuation">;</span>
again<span class="token operator">:</span>
	<span class="token keyword">do</span>
	<span class="token punctuation">{<!-- --></span>
	   x <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">53</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">//生成横坐标</span>
	   y <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">25</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//纵坐标</span>
	<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>x <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//保证横坐标为偶数</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>pcur<span class="token punctuation">)</span><span class="token comment">//遍历蛇身</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pcur<span class="token operator">-&gt;</span>x <span class="token operator">==</span> x <span class="token operator">&amp;&amp;</span> pcur<span class="token operator">-&gt;</span>y <span class="token operator">==</span> y<span class="token punctuation">)</span>
			<span class="token keyword">goto</span> again<span class="token punctuation">;</span><span class="token comment">//食物和蛇身重叠重新生成</span>
		pcur <span class="token operator">=</span> pcur<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	fool<span class="token operator">-&gt;</span>x <span class="token operator">=</span> x<span class="token punctuation">;</span><span class="token comment">//赋值横坐标</span>
	fool<span class="token operator">-&gt;</span>y <span class="token operator">=</span> y<span class="token punctuation">;</span><span class="token comment">//赋值纵坐标</span>
	fool<span class="token operator">-&gt;</span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token comment">//置空</span>
	<span class="token function">setpos</span><span class="token punctuation">(</span>fool<span class="token operator">-&gt;</span>x<span class="token punctuation">,</span> fool<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位光标</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%lc"</span><span class="token punctuation">,</span> FOOD<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//打印食物</span>
	ps<span class="token operator">-&gt;</span>snakefool<span class="token operator">=</span> fool<span class="token punctuation">;</span><span class="token comment">//存放食物节点</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>最后我们再循环创建五个初始的蛇身节点，初始化贪吃蛇信息，再创建食物即可。</p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">Initsnake</span><span class="token punctuation">(</span>psnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	psnake pcur <span class="token operator">=</span> ps<span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">//创建五个蛇的节点</span>
	<span class="token punctuation">{<!-- --></span>
		pSnakenode node <span class="token operator">=</span> <span class="token punctuation">(</span>pSnakenode<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>Snakenode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//创建蛇的节点</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token comment">//判空</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"Initsnake:malloc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		node<span class="token operator">-&gt;</span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
		node<span class="token operator">-&gt;</span>x <span class="token operator">=</span> POS_X <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> i<span class="token punctuation">;</span><span class="token comment">//横坐标</span>
		node<span class="token operator">-&gt;</span>y <span class="token operator">=</span> POS_Y<span class="token punctuation">;</span><span class="token comment">//纵坐标</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pcur<span class="token operator">-&gt;</span>shead <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			pcur<span class="token operator">-&gt;</span>shead <span class="token operator">=</span> node<span class="token punctuation">;</span><span class="token comment">//蛇头节点（第一个节点）</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">{<!-- --></span>
			node<span class="token operator">-&gt;</span>next <span class="token operator">=</span> pcur<span class="token operator">-&gt;</span>shead<span class="token punctuation">;</span><span class="token comment">//头插法</span>
			pcur<span class="token operator">-&gt;</span>shead <span class="token operator">=</span> node<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token comment">//遍历蛇身打印</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">setpos</span><span class="token punctuation">(</span>node<span class="token operator">-&gt;</span>x<span class="token punctuation">,</span> node<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位蛇身坐标</span>
			<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%lc"</span><span class="token punctuation">,</span> BODY<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//打印</span>
			node <span class="token operator">=</span> node<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span><span class="token comment">//遍历下一个蛇身节点</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	ps<span class="token operator">-&gt;</span>dir <span class="token operator">=</span> right<span class="token punctuation">;</span><span class="token comment">//默认移动方向为右</span>
	ps<span class="token operator">-&gt;</span>statu <span class="token operator">=</span> ok<span class="token punctuation">;</span><span class="token comment">//游戏状态正常</span>
	ps<span class="token operator">-&gt;</span>fool_score <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token comment">//默认食物分数为10</span>
	ps<span class="token operator">-&gt;</span>score <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//总分为0</span>
	ps<span class="token operator">-&gt;</span>sleep_time <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span><span class="token comment">//休眠时间默认为0</span>
	<span class="token function">GreatFool</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//创建食物</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="GameRun_651"></a>五.GameRun函数</h3> 
<h4><a id="51_652"></a>5.1提示信息函数</h4> 
<p><img src="https://images2.imgbox.com/25/d1/mi1PWEQJ_o.png" alt=""><br> 在游戏时我们打印一下提示信息给玩家。封装PrintHelpInfo()</p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">PrintHelpInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//打印提示信息</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"不能穿墙，不能咬到⾃⼰\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"分别用↑.↓.←.→分别控制蛇的移动\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"F3 为加速，F4 为减速\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"ESC ：退出游戏.space：暂停游戏."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"成杰MAKE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="52_671"></a>5.2打印分数</h4> 
<p><img src="https://images2.imgbox.com/f3/8a/BcGcH6Ss_o.png" alt=""><br> 游戏过程食物分数和总得分都需要更新<br> 我们也要打印出来。</p> 
<pre><code class="prism language-c"><span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"总分：%2d"</span><span class="token punctuation">,</span> ps<span class="token operator">-&gt;</span>score<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//打印信息</span>
<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"当前食物分数：%2d"</span><span class="token punctuation">,</span> ps<span class="token operator">-&gt;</span>fool_score<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//打印信息</span>
</code></pre> 
<h4><a id="53_682"></a>5.3检测键值</h4> 
<p>游戏过程我们需要根据键盘输入进行相对的相应<br> 蛇的移动，暂停 加速减速等。<br> 我们前面已经定义了一个宏，直接使用即可</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">KEY_PRESS</span><span class="token expression"><span class="token punctuation">(</span>VK<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">GetAsyncKeyState</span><span class="token punctuation">(</span>VK<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">)</span></span><span class="token comment">//检测虚拟键值</span></span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_UP<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> ps<span class="token operator">-&gt;</span>dir<span class="token operator">!=</span>down<span class="token punctuation">)</span><span class="token comment">//按键向上同时当前方向不能为下</span>
<span class="token punctuation">{<!-- --></span>
	ps<span class="token operator">-&gt;</span>dir <span class="token operator">=</span> up<span class="token punctuation">;</span><span class="token comment">//设置移动方向</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_DOWN<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> ps<span class="token operator">-&gt;</span>dir <span class="token operator">!=</span> up<span class="token punctuation">)</span><span class="token comment">//按键向下同时当前方向不能为上</span>
<span class="token punctuation">{<!-- --></span>
	ps<span class="token operator">-&gt;</span>dir <span class="token operator">=</span> down<span class="token punctuation">;</span><span class="token comment">//设置移动方向</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_LEFT<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> ps<span class="token operator">-&gt;</span>dir <span class="token operator">!=</span> right<span class="token punctuation">)</span><span class="token comment">//按键向左同时当前方向不能为右</span>
<span class="token punctuation">{<!-- --></span>
	ps<span class="token operator">-&gt;</span>dir <span class="token operator">=</span> left<span class="token punctuation">;</span><span class="token comment">//设置移动方向</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_RIGHT<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> ps<span class="token operator">-&gt;</span>dir <span class="token operator">!=</span> left<span class="token punctuation">)</span><span class="token comment">//按键向右同时当前方向不能为左</span>
<span class="token punctuation">{<!-- --></span>
	ps<span class="token operator">-&gt;</span>dir <span class="token operator">=</span> right<span class="token punctuation">;</span><span class="token comment">//设置移动方向</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_ESCAPE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//检测ESC按键</span>
<span class="token punctuation">{<!-- --></span>
	ps<span class="token operator">-&gt;</span>statu <span class="token operator">=</span> end<span class="token punctuation">;</span><span class="token comment">//设置退出游戏状态</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_SPACE<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token comment">//检测space按键</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">Pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//暂停游戏</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_F3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//检车f3加速按键</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>sleep_time <span class="token operator">&gt;</span> <span class="token number">120</span><span class="token punctuation">)</span><span class="token comment">//设置加速上限</span>
	<span class="token punctuation">{<!-- --></span>
		ps<span class="token operator">-&gt;</span>sleep_time <span class="token operator">-=</span> <span class="token number">20</span><span class="token punctuation">;</span><span class="token comment">//减少休眠加快速度</span>
		ps<span class="token operator">-&gt;</span>fool_score <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">//分数增加</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_F4<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//检测f4减速按键</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>fool_score<span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token comment">//设置减速上限</span>
	<span class="token punctuation">{<!-- --></span>
		ps<span class="token operator">-&gt;</span>sleep_time <span class="token operator">+=</span> <span class="token number">20</span><span class="token punctuation">;</span><span class="token comment">//增加休眠时间减慢速度</span>
		ps<span class="token operator">-&gt;</span>fool_score <span class="token operator">-=</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">//分数减少</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>注意我们移动时不能与当前移动方向相反。<br> 加速减速我们加减休眠时间即可。<br> 暂停我们用pause函数即可，检测space按键，按过直接break跳出即可。<br> 否则一直休眠。</p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">Pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//休眠</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_SPACE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//检测是否再次按space按键</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">break</span><span class="token punctuation">;</span><span class="token comment">//继续游戏</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>检测完后我们再根据按键输入进行蛇的移动即可。<br> 我们封装为Snakemove函数。<br> 我们先创建一个节点作为下一个蛇头节点。<br> 然后根据移动方向给节点横纵坐标赋值即可。</p> 
<pre><code class="prism language-c">pSnakenode pcur <span class="token operator">=</span> <span class="token punctuation">(</span>pSnakenode<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>Snakenode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//生成蛇头下一个位置的节点</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>pcur <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token comment">//判空</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"Snakemove:malloc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
<span class="token keyword">switch</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>dir<span class="token punctuation">)</span><span class="token comment">//检测蛇移动方向</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">case</span> up<span class="token operator">:</span>
	pcur<span class="token operator">-&gt;</span>y<span class="token operator">=</span>ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>y <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//赋值横坐标</span>
	pcur<span class="token operator">-&gt;</span>x <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>x<span class="token punctuation">;</span><span class="token comment">//赋值纵坐标</span>
	<span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token keyword">case</span> down<span class="token operator">:</span>
	pcur<span class="token operator">-&gt;</span>y <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>y <span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//赋值横坐</span>
	pcur<span class="token operator">-&gt;</span>x <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>x<span class="token punctuation">;</span> <span class="token comment">// 赋值纵坐标</span>
	<span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token keyword">case</span> right<span class="token operator">:</span>
	pcur<span class="token operator">-&gt;</span>x <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>x <span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">//赋值横坐</span>
	pcur<span class="token operator">-&gt;</span>y <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>y<span class="token punctuation">;</span> <span class="token comment">// 赋值纵坐标</span>
	<span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token keyword">case</span> left<span class="token operator">:</span>
	pcur<span class="token operator">-&gt;</span>x <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>x <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">//赋值横坐</span>
	pcur<span class="token operator">-&gt;</span>y <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>y<span class="token punctuation">;</span> <span class="token comment">// 赋值纵坐标</span>
	<span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="54_780"></a>5.4蛇的移动</h4> 
<p>蛇的移动分两种情况：</p> 
<ul><li>吃食物移动<br> 若下一个位置是食物。<br> 我们释放开辟的节点，然后让食物节点成为新的蛇头节点<br> 然后遍历打印蛇身，再创建新的食物即可。同时更新得分。</li></ul> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">EatFood</span><span class="token punctuation">(</span>pSnakenode pn<span class="token punctuation">,</span> psnake ps<span class="token punctuation">)</span><span class="token comment">//吃食物</span>
<span class="token punctuation">{<!-- --></span>
	ps<span class="token operator">-&gt;</span>snakefool<span class="token operator">-&gt;</span>next <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token punctuation">;</span><span class="token comment">//食物节点链接蛇头</span>
	ps<span class="token operator">-&gt;</span>shead <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>snakefool<span class="token punctuation">;</span><span class="token comment">//食物节点成为蛇头</span>
	<span class="token function">free</span><span class="token punctuation">(</span>pn<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//释放新开辟的蛇头节点</span>
	pn <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	pSnakenode cur <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>cur<span class="token punctuation">)</span><span class="token comment">//遍历打印蛇身</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">setpos</span><span class="token punctuation">(</span>cur<span class="token operator">-&gt;</span>x<span class="token punctuation">,</span> cur<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%lc"</span><span class="token punctuation">,</span> BODY<span class="token punctuation">)</span><span class="token punctuation">;</span>
		cur <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	ps<span class="token operator">-&gt;</span>score <span class="token operator">+=</span> ps<span class="token operator">-&gt;</span>fool_score<span class="token punctuation">;</span><span class="token comment">//总分增加</span>
	<span class="token function">GreatFool</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//生成新的食物</span>
<span class="token punctuation">}</span>
</code></pre> 
<ul><li>不吃食物移动<br> 让新开辟节点链接原来的蛇头，新开辟的节点成为新的蛇头。<br> 再遍历找到倒数第二个尾节点，释放尾巴节点，再让倒数第二个节点指向空封尾。同时记得打印空白覆盖掉蛇尾节点打印的信息。再遍历打印蛇身即可。</li></ul> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">NotFood</span><span class="token punctuation">(</span>pSnakenode pn<span class="token punctuation">,</span> psnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	pn<span class="token operator">-&gt;</span>next <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token punctuation">;</span><span class="token comment">//让新的蛇头连接原来的蛇头</span>
	ps<span class="token operator">-&gt;</span>shead <span class="token operator">=</span> pn<span class="token punctuation">;</span><span class="token comment">//让蛇下一个位置的节点成为新的蛇头</span>
	pSnakenode pcur <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>pcur<span class="token operator">-&gt;</span>next<span class="token operator">-&gt;</span>next <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token comment">//找到蛇尾倒数第二个节点</span>
	<span class="token punctuation">{<!-- --></span>
		pcur <span class="token operator">=</span> pcur<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span><span class="token comment">//移动</span>
	<span class="token punctuation">}</span>
	pSnakenode dle <span class="token operator">=</span> pcur<span class="token punctuation">;</span>
	<span class="token function">setpos</span><span class="token punctuation">(</span>pcur<span class="token operator">-&gt;</span>next<span class="token operator">-&gt;</span>x<span class="token punctuation">,</span> pcur<span class="token operator">-&gt;</span>next<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位光标到最后的蛇尾</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"  "</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//覆盖原来蛇尾打印的信息</span>
	<span class="token function">free</span><span class="token punctuation">(</span>dle<span class="token operator">-&gt;</span>next<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//释放最后的蛇尾节点</span>
	dle<span class="token operator">-&gt;</span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	pSnakenode cur <span class="token operator">=</span> pn<span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>cur<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">setpos</span><span class="token punctuation">(</span>cur<span class="token operator">-&gt;</span>x<span class="token punctuation">,</span> cur<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
	    <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%lc"</span><span class="token punctuation">,</span> BODY<span class="token punctuation">)</span><span class="token punctuation">;</span>
		cur <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="55_837"></a>5.5检测是否撞墙</h4> 
<p>我们只需要检测横坐标是否为0或56<br> 纵坐标是否为0或26。<br> 再根据穿墙的横坐标或纵坐标不变，修改蛇头另一变化坐标即可。<br> 最后即可设置游戏状态即可。<br> 要实现穿墙我们再让蛇每次移动都刷新城墙即可。<br> <img src="https://images2.imgbox.com/3f/b7/0Ce9QUG9_o.png" alt=""></p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">KillByWall</span><span class="token punctuation">(</span>psnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>x <span class="token operator">==</span> <span class="token number">56</span><span class="token punctuation">)</span><span class="token comment">//检测是否撞到第二列城墙</span>
	<span class="token punctuation">{<!-- --></span>
		ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//重新定位穿墙后的横坐标位置（第一列出）</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>x <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">//检测是否撞到第一列城墙</span>
	<span class="token punctuation">{<!-- --></span>
		ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>x <span class="token operator">=</span> <span class="token number">56</span><span class="token punctuation">;</span><span class="token comment">//重新定位穿墙后的横坐标位置（第二列出）</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>y <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">//检测是否撞到第一行城墙</span>
	<span class="token punctuation">{<!-- --></span>
		ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>y <span class="token operator">=</span> <span class="token number">26</span><span class="token punctuation">;</span><span class="token comment">//重新定位穿墙后的纵坐标位置（第一行出）</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>y <span class="token operator">==</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token comment">//检测是否撞到第二行城墙</span>
	<span class="token punctuation">{<!-- --></span>
		ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//重新定位穿墙后的纵坐标位置（第二行出）</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<ul><li>检测是否咬到自己<br> 我们只需要判断当前蛇头坐标是否与其他蛇身坐标重合即可。<br> 用循环遍历蛇身在判断即可。最后即可设置游戏状态即可</li></ul> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">KillBySelf</span><span class="token punctuation">(</span> psnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	pSnakenode pcur <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span><span class="token comment">//保存蛇头下一个节点</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>pcur<span class="token punctuation">)</span><span class="token comment">//遍历蛇身</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>x <span class="token operator">==</span> pcur<span class="token operator">-&gt;</span>x <span class="token operator">&amp;&amp;</span> ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>y <span class="token operator">==</span> pcur<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token comment">//蛇身与蛇头重合</span>
		<span class="token punctuation">{<!-- --></span>
			ps<span class="token operator">-&gt;</span>statu <span class="token operator">=</span> kill_by_self<span class="token punctuation">;</span><span class="token comment">//设置游戏状态</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span><span class="token comment">//结束循环</span>
		<span class="token punctuation">}</span>
		pcur <span class="token operator">=</span> pcur<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span><span class="token comment">//移动</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>每次移动后都检测撞墙和咬到自己。<br> 判断游戏状态，正常则继续游戏。</p> 
<h3><a id="GameEnd_888"></a>六.GameEnd函数</h3> 
<p>游戏结束我们需要检测游戏状态再打印对应提示信息。<br> 最后循环遍历销毁蛇身节点和食物节点即可</p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">GemaEnd</span><span class="token punctuation">(</span>psnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	pSnakenode pcur <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token punctuation">;</span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位光标</span>
	<span class="token keyword">switch</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>statu<span class="token punctuation">)</span><span class="token comment">//游戏状态</span>
	<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">case</span> kill_by_wall<span class="token operator">:</span><span class="token comment">//撞墙</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"您撞到墙上，游戏结束！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> kill_by_self<span class="token operator">:</span><span class="token comment">//咬到自己</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"您咬到自己，游戏结束！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> end<span class="token operator">:</span><span class="token comment">//自己结束</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"您主动结束了游戏！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位光标</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>pcur<span class="token punctuation">)</span><span class="token comment">//遍历蛇身销毁链表</span>
	<span class="token punctuation">{<!-- --></span>
		pSnakenode del <span class="token operator">=</span> pcur<span class="token punctuation">;</span><span class="token comment">//保存销毁节点</span>
		pcur <span class="token operator">=</span> pcur<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span><span class="token comment">//移动下一个销毁节点</span>
		<span class="token function">free</span><span class="token punctuation">(</span>del<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//销毁</span>
		del <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">free</span><span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>snakefool<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//销毁食物</span>
	ps<span class="token operator">-&gt;</span>snakefool <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> 
</code></pre> 
<h3><a id="_921"></a>七.游戏主体设计</h3> 
<p>最后我们调用三大模块函数即可，再用do_while循环给用户选择是否继续再来一局游戏的选择。注意使用宽字符要记得本地化。</p> 
<pre><code class="prism language-c"><span class="token function">setlocale</span><span class="token punctuation">(</span>LC_ALL<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">char</span> ch <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">do</span>
	<span class="token punctuation">{<!-- --></span>
		Snake snake <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
		<span class="token function">GemeStar</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>snake<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">GameRun</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>snake<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">GemaEnd</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>snake<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"再来一局吗？(Y/N):"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">==</span> <span class="token char">'Y'</span> <span class="token operator">||</span> ch <span class="token operator">==</span> <span class="token char">'y'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_942"></a>八.源码</h3> 
<ul><li>Snake.h</li></ul> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;Windows.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdbool.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;locale.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;time.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">WALL</span> <span class="token expression">L</span><span class="token char">'□'</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">FOOD</span> <span class="token expression">L</span><span class="token char">'★'</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">BODY</span> <span class="token expression">L</span><span class="token char">'●'</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">POS_X</span> <span class="token expression"><span class="token number">24</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">POS_Y</span> <span class="token expression"><span class="token number">5</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">KEY_PRESS</span><span class="token expression"><span class="token punctuation">(</span>VK<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">GetAsyncKeyState</span><span class="token punctuation">(</span>VK<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">)</span></span><span class="token comment">//检测虚拟键值</span></span>
<span class="token keyword">enum</span> <span class="token class-name">DIRECTION</span><span class="token comment">//枚举蛇的方向</span>
<span class="token punctuation">{<!-- --></span>
	up <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
    down<span class="token punctuation">,</span>
	left <span class="token punctuation">,</span>
	right
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">enum</span> <span class="token class-name">STATUS</span><span class="token comment">//游戏的状态</span>
<span class="token punctuation">{<!-- --></span>
	ok <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
	kill_by_wall<span class="token punctuation">,</span>
	kill_by_self<span class="token punctuation">,</span>
	end
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">SnakeNode</span> <span class="token comment">//蛇身</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> x<span class="token punctuation">;</span>
	<span class="token keyword">int</span> y<span class="token punctuation">;</span>
	<span class="token keyword">struct</span> <span class="token class-name">SnakeNode</span><span class="token operator">*</span> next<span class="token punctuation">;</span>
<span class="token punctuation">}</span>Snakenode<span class="token punctuation">,</span><span class="token operator">*</span> pSnakenode<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Snake</span><span class="token comment">//游戏中贪吃蛇的信息</span>
<span class="token punctuation">{<!-- --></span>
	pSnakenode shead<span class="token punctuation">;</span>
	pSnakenode snakefool<span class="token punctuation">;</span>
	<span class="token keyword">enum</span> <span class="token class-name">DRIECTION</span> dir<span class="token punctuation">;</span>
	<span class="token keyword">enum</span> <span class="token class-name">STATUS</span> statu<span class="token punctuation">;</span>
	<span class="token keyword">int</span> fool_score<span class="token punctuation">;</span>
	<span class="token keyword">int</span> score<span class="token punctuation">;</span>
	<span class="token keyword">int</span> sleep_time<span class="token punctuation">;</span>
<span class="token punctuation">}</span>Snake<span class="token punctuation">,</span><span class="token operator">*</span>psnake<span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">setpos</span><span class="token punctuation">(</span><span class="token keyword">short</span> x<span class="token punctuation">,</span><span class="token keyword">short</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">GemeStar</span><span class="token punctuation">(</span>psnake ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">Greatmap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">Initsnake</span><span class="token punctuation">(</span>psnake ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">GreatFool</span><span class="token punctuation">(</span>psnake ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">GameRun</span><span class="token punctuation">(</span>psnake ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">PrintHelpInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">Pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">Snakemove</span><span class="token punctuation">(</span>psnake ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">NextIsFood</span><span class="token punctuation">(</span>pSnakenode pn<span class="token punctuation">,</span> psnake ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">EatFood</span><span class="token punctuation">(</span>pSnakenode pn<span class="token punctuation">,</span> psnake ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">NotFood</span><span class="token punctuation">(</span>pSnakenode pn<span class="token punctuation">,</span> psnake ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">KillByWall</span><span class="token punctuation">(</span>psnake ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">KillBySelf</span><span class="token punctuation">(</span>psnake ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">GemaEnd</span><span class="token punctuation">(</span>psnake ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>Snake.c</li></ul> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_CRT_SECURE_NO_WARNINGS</span> <span class="token expression"><span class="token number">1</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"snake.h"</span></span>
<span class="token keyword">void</span> <span class="token function">WelcomeToSnake</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位光标</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"欢迎来到贪吃蛇小游戏~\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位光标</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//暂停程序</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//清理屏幕</span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位光标</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"分别用↑.↓.←.→控制移动方向，F3加速，F4减速\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位光标</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"加速能够获得更高的分数\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位光标</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//暂停程序</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//清理屏幕</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">GemeStar</span><span class="token punctuation">(</span>psnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"mode con cols=100 lines=30"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//设置控制台窗口大小</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"title 贪吃蛇"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//设置控制台名字</span>
	HANDLE houtput <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	houtput <span class="token operator">=</span> <span class="token function">GetStdHandle</span><span class="token punctuation">(</span>STD_OUTPUT_HANDLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//定义一个光标信息的结构体</span>
	CONSOLE_CURSOR_INFO cursor_info <span class="token punctuation">;</span>
	<span class="token comment">//获取和houtput句柄相关的控制台上的光标信息，存放在cursor_info中</span>
	<span class="token function">GetConsoleCursorInfo</span><span class="token punctuation">(</span>houtput<span class="token punctuation">,</span> <span class="token operator">&amp;</span>cursor_info<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//修改光标（隐藏光标）</span>
	cursor_info<span class="token punctuation">.</span>bVisible<span class="token operator">=</span> false<span class="token punctuation">;</span>
	<span class="token comment">//设置和houtput句柄相关的控制台上的光标信息</span>
	<span class="token function">SetConsoleCursorInfo</span><span class="token punctuation">(</span>houtput<span class="token punctuation">,</span> <span class="token operator">&amp;</span>cursor_info<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">WelcomeToSnake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//欢迎界面打印 </span>
	<span class="token function">Greatmap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//地图打印</span>
	<span class="token function">Initsnake</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//初始化贪吃蛇的信息</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">Greatmap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位原点</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">29</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">//打印第一行墙体</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%lc"</span><span class="token punctuation">,</span> WALL<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位第二行起点</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">29</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">//打印第二行墙体</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%lc"</span><span class="token punctuation">,</span> WALL<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span><span class="token number">25</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">//打印第一列墙体</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//每次打印墙体下移</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%lc"</span><span class="token punctuation">,</span> WALL<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span><span class="token number">25</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">//打印第二列墙体</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">56</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//每次打印墙体下移</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%lc"</span><span class="token punctuation">,</span> WALL<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">setpos</span><span class="token punctuation">(</span><span class="token keyword">short</span> x<span class="token punctuation">,</span> <span class="token keyword">short</span> y<span class="token punctuation">)</span><span class="token comment">//定位坐标函数</span>
<span class="token punctuation">{<!-- --></span>
	HANDLE houtput <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	houtput <span class="token operator">=</span> <span class="token function">GetStdHandle</span><span class="token punctuation">(</span>STD_OUTPUT_HANDLE<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//创建句柄</span>
	COORD pos <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>x<span class="token punctuation">,</span>y<span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//坐标的结构体</span>
	<span class="token function">SetConsoleCursorPosition</span><span class="token punctuation">(</span>houtput<span class="token punctuation">,</span> pos<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//设置光标位置</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">Initsnake</span><span class="token punctuation">(</span>psnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	psnake pcur <span class="token operator">=</span> ps<span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">//创建五个蛇的节点</span>
	<span class="token punctuation">{<!-- --></span>
		pSnakenode node <span class="token operator">=</span> <span class="token punctuation">(</span>pSnakenode<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>Snakenode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//创建蛇的节点</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token comment">//判空</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"Initsnake:malloc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		node<span class="token operator">-&gt;</span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
		node<span class="token operator">-&gt;</span>x <span class="token operator">=</span> POS_X <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> i<span class="token punctuation">;</span><span class="token comment">//横坐标</span>
		node<span class="token operator">-&gt;</span>y <span class="token operator">=</span> POS_Y<span class="token punctuation">;</span><span class="token comment">//纵坐标</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pcur<span class="token operator">-&gt;</span>shead <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			pcur<span class="token operator">-&gt;</span>shead <span class="token operator">=</span> node<span class="token punctuation">;</span><span class="token comment">//蛇头节点（第一个节点）</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">{<!-- --></span>
			node<span class="token operator">-&gt;</span>next <span class="token operator">=</span> pcur<span class="token operator">-&gt;</span>shead<span class="token punctuation">;</span><span class="token comment">//头插法</span>
			pcur<span class="token operator">-&gt;</span>shead <span class="token operator">=</span> node<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token comment">//遍历蛇身打印</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">setpos</span><span class="token punctuation">(</span>node<span class="token operator">-&gt;</span>x<span class="token punctuation">,</span> node<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位蛇身坐标</span>
			<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%lc"</span><span class="token punctuation">,</span> BODY<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//打印</span>
			node <span class="token operator">=</span> node<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span><span class="token comment">//遍历下一个蛇身节点</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	ps<span class="token operator">-&gt;</span>dir <span class="token operator">=</span> right<span class="token punctuation">;</span><span class="token comment">//默认移动方向为右</span>
	ps<span class="token operator">-&gt;</span>statu <span class="token operator">=</span> ok<span class="token punctuation">;</span><span class="token comment">//游戏状态正常</span>
	ps<span class="token operator">-&gt;</span>fool_score <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token comment">//默认食物分数为10</span>
	ps<span class="token operator">-&gt;</span>score <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//总分为0</span>
	ps<span class="token operator">-&gt;</span>sleep_time <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span><span class="token comment">//休眠时间默认为0</span>
	<span class="token function">GreatFool</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//创建食物</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">GreatFool</span><span class="token punctuation">(</span>psnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	pSnakenode pcur <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token punctuation">;</span>
	pSnakenode fool <span class="token operator">=</span> <span class="token punctuation">(</span>pSnakenode<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>Snakenode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//创建蛇的节点作为食物节点</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>fool <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token comment">//判空</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"GreatFool:malloc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">int</span> x<span class="token punctuation">,</span> y<span class="token punctuation">;</span>
again<span class="token operator">:</span>
	<span class="token keyword">do</span>
	<span class="token punctuation">{<!-- --></span>
	   x <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">53</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">//生成横坐标</span>
	   y <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">25</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//纵坐标</span>
	<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>x <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//保证横坐标为偶数</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>pcur<span class="token punctuation">)</span><span class="token comment">//遍历蛇身</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pcur<span class="token operator">-&gt;</span>x <span class="token operator">==</span> x <span class="token operator">&amp;&amp;</span> pcur<span class="token operator">-&gt;</span>y <span class="token operator">==</span> y<span class="token punctuation">)</span>
			<span class="token keyword">goto</span> again<span class="token punctuation">;</span><span class="token comment">//食物和蛇身重叠重新生成</span>
		pcur <span class="token operator">=</span> pcur<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	fool<span class="token operator">-&gt;</span>x <span class="token operator">=</span> x<span class="token punctuation">;</span><span class="token comment">//赋值横坐标</span>
	fool<span class="token operator">-&gt;</span>y <span class="token operator">=</span> y<span class="token punctuation">;</span><span class="token comment">//赋值纵坐标</span>
	fool<span class="token operator">-&gt;</span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token comment">//置空</span>
	<span class="token function">setpos</span><span class="token punctuation">(</span>fool<span class="token operator">-&gt;</span>x<span class="token punctuation">,</span> fool<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位光标</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%lc"</span><span class="token punctuation">,</span> FOOD<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//打印食物</span>
	ps<span class="token operator">-&gt;</span>snakefool<span class="token operator">=</span> fool<span class="token punctuation">;</span><span class="token comment">//存放食物节点</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">PrintHelpInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//打印提示信息</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"不能穿墙，不能咬到⾃⼰\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"分别用↑.↓.←.→分别控制蛇的移动\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"F3 为加速，F4 为减速\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"ESC ：退出游戏.space：暂停游戏."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"成杰MAKE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">Pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//休眠</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_SPACE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//检测是否再次按space按键</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">break</span><span class="token punctuation">;</span><span class="token comment">//继续游戏</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">NextIsFood</span><span class="token punctuation">(</span>pSnakenode pn<span class="token punctuation">,</span> psnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span>pn<span class="token operator">-&gt;</span>x <span class="token operator">==</span> ps<span class="token operator">-&gt;</span>snakefool<span class="token operator">-&gt;</span>x <span class="token operator">&amp;&amp;</span>
		    pn<span class="token operator">-&gt;</span>y <span class="token operator">==</span> ps<span class="token operator">-&gt;</span>snakefool<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//判断下一个节点是否是食物</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">Snakemove</span><span class="token punctuation">(</span>psnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	pSnakenode pcur <span class="token operator">=</span> <span class="token punctuation">(</span>pSnakenode<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>Snakenode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//生成蛇头下一个位置的节点</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>pcur <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token comment">//判空</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"Snakemove:malloc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span> 
	<span class="token punctuation">}</span>
	<span class="token keyword">switch</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>dir<span class="token punctuation">)</span><span class="token comment">//检测蛇移动方向</span>
	<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">case</span> up<span class="token operator">:</span>
		pcur<span class="token operator">-&gt;</span>y<span class="token operator">=</span>ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>y <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//赋值横坐标</span>
		pcur<span class="token operator">-&gt;</span>x <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>x<span class="token punctuation">;</span><span class="token comment">//赋值纵坐标</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> down<span class="token operator">:</span>
		pcur<span class="token operator">-&gt;</span>y <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>y <span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//赋值横坐</span>
		pcur<span class="token operator">-&gt;</span>x <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>x<span class="token punctuation">;</span> <span class="token comment">// 赋值纵坐标</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> right<span class="token operator">:</span>
		pcur<span class="token operator">-&gt;</span>x <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>x <span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">//赋值横坐</span>
		pcur<span class="token operator">-&gt;</span>y <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>y<span class="token punctuation">;</span> <span class="token comment">// 赋值纵坐标</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> left<span class="token operator">:</span>
		pcur<span class="token operator">-&gt;</span>x <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>x <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">//赋值横坐</span>
		pcur<span class="token operator">-&gt;</span>y <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>y<span class="token punctuation">;</span> <span class="token comment">// 赋值纵坐标</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">NextIsFood</span><span class="token punctuation">(</span>pcur<span class="token punctuation">,</span> ps<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//判断下一个节点是否为食物</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">EatFood</span><span class="token punctuation">(</span>pcur<span class="token punctuation">,</span> ps<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//吃食物的移动</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">NotFood</span><span class="token punctuation">(</span>pcur<span class="token punctuation">,</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//不吃食物的移动</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">GameRun</span><span class="token punctuation">(</span>psnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">PrintHelpInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//打印提示信息</span>
	<span class="token keyword">do</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"总分：%2d"</span><span class="token punctuation">,</span> ps<span class="token operator">-&gt;</span>score<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//打印信息</span>
		<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"当前食物分数：%2d"</span><span class="token punctuation">,</span> ps<span class="token operator">-&gt;</span>fool_score<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//打印信息</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_UP<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> ps<span class="token operator">-&gt;</span>dir<span class="token operator">!=</span>down<span class="token punctuation">)</span><span class="token comment">//按键向上同时当前方向不能为下</span>
		<span class="token punctuation">{<!-- --></span>
			ps<span class="token operator">-&gt;</span>dir <span class="token operator">=</span> up<span class="token punctuation">;</span><span class="token comment">//设置移动方向</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_DOWN<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> ps<span class="token operator">-&gt;</span>dir <span class="token operator">!=</span> up<span class="token punctuation">)</span><span class="token comment">//按键向下同时当前方向不能为上</span>
		<span class="token punctuation">{<!-- --></span>
			ps<span class="token operator">-&gt;</span>dir <span class="token operator">=</span> down<span class="token punctuation">;</span><span class="token comment">//设置移动方向</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_LEFT<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> ps<span class="token operator">-&gt;</span>dir <span class="token operator">!=</span> right<span class="token punctuation">)</span><span class="token comment">//按键向左同时当前方向不能为右</span>
		<span class="token punctuation">{<!-- --></span>
			ps<span class="token operator">-&gt;</span>dir <span class="token operator">=</span> left<span class="token punctuation">;</span><span class="token comment">//设置移动方向</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_RIGHT<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> ps<span class="token operator">-&gt;</span>dir <span class="token operator">!=</span> left<span class="token punctuation">)</span><span class="token comment">//按键向右同时当前方向不能为左</span>
		<span class="token punctuation">{<!-- --></span>
			ps<span class="token operator">-&gt;</span>dir <span class="token operator">=</span> right<span class="token punctuation">;</span><span class="token comment">//设置移动方向</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_ESCAPE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//检测ESC按键</span>
		<span class="token punctuation">{<!-- --></span>
			ps<span class="token operator">-&gt;</span>statu <span class="token operator">=</span> end<span class="token punctuation">;</span><span class="token comment">//设置退出游戏状态</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_SPACE<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token comment">//检测space按键</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">Pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//暂停游戏</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_F3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//检车f3加速按键</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>sleep_time <span class="token operator">&gt;</span> <span class="token number">120</span><span class="token punctuation">)</span><span class="token comment">//设置加速上限</span>
			<span class="token punctuation">{<!-- --></span>
				ps<span class="token operator">-&gt;</span>sleep_time <span class="token operator">-=</span> <span class="token number">20</span><span class="token punctuation">;</span><span class="token comment">//减少休眠加快速度</span>
				ps<span class="token operator">-&gt;</span>fool_score <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">//分数增加</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">KEY_PRESS</span><span class="token punctuation">(</span>VK_F4<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//检测f4减速按键</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>fool_score<span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token comment">//设置减速上限</span>
			<span class="token punctuation">{<!-- --></span>
				ps<span class="token operator">-&gt;</span>sleep_time <span class="token operator">+=</span> <span class="token number">20</span><span class="token punctuation">;</span><span class="token comment">//增加休眠时间减慢速度</span>
				ps<span class="token operator">-&gt;</span>fool_score <span class="token operator">-=</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">//分数减少</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token function">Snakemove</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//蛇移动</span>
		<span class="token function">Greatmap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//每次移动刷新城墙实现穿墙；</span>
		<span class="token function">Sleep</span><span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>sleep_time<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//休眠</span>
		<span class="token function">KillByWall</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//检测是否撞墙</span>
		<span class="token function">KillBySelf</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//检测是否咬到自己</span>
	<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>statu <span class="token operator">==</span> ok<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//检测游戏状态</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">EatFood</span><span class="token punctuation">(</span>pSnakenode pn<span class="token punctuation">,</span> psnake ps<span class="token punctuation">)</span><span class="token comment">//吃食物</span>
<span class="token punctuation">{<!-- --></span>
	ps<span class="token operator">-&gt;</span>snakefool<span class="token operator">-&gt;</span>next <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token punctuation">;</span><span class="token comment">//食物节点链接蛇头</span>
	ps<span class="token operator">-&gt;</span>shead <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>snakefool<span class="token punctuation">;</span><span class="token comment">//食物节点成为蛇头</span>
	<span class="token function">free</span><span class="token punctuation">(</span>pn<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//释放新开辟的蛇头节点</span>
	pn <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	pSnakenode cur <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>cur<span class="token punctuation">)</span><span class="token comment">//遍历打印蛇身</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">setpos</span><span class="token punctuation">(</span>cur<span class="token operator">-&gt;</span>x<span class="token punctuation">,</span> cur<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%lc"</span><span class="token punctuation">,</span> BODY<span class="token punctuation">)</span><span class="token punctuation">;</span>
		cur <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	ps<span class="token operator">-&gt;</span>score <span class="token operator">+=</span> ps<span class="token operator">-&gt;</span>fool_score<span class="token punctuation">;</span><span class="token comment">//总分增加</span>
	<span class="token function">GreatFool</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//生成新的食物</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">NotFood</span><span class="token punctuation">(</span>pSnakenode pn<span class="token punctuation">,</span> psnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	pn<span class="token operator">-&gt;</span>next <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token punctuation">;</span><span class="token comment">//让新的蛇头连接原来的蛇头</span>
	ps<span class="token operator">-&gt;</span>shead <span class="token operator">=</span> pn<span class="token punctuation">;</span><span class="token comment">//让蛇下一个位置的节点成为新的蛇头</span>
	pSnakenode pcur <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>pcur<span class="token operator">-&gt;</span>next<span class="token operator">-&gt;</span>next <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token comment">//找到蛇尾倒数第二个节点</span>
	<span class="token punctuation">{<!-- --></span>
		pcur <span class="token operator">=</span> pcur<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span><span class="token comment">//移动</span>
	<span class="token punctuation">}</span>
	pSnakenode dle <span class="token operator">=</span> pcur<span class="token punctuation">;</span>
	<span class="token function">setpos</span><span class="token punctuation">(</span>pcur<span class="token operator">-&gt;</span>next<span class="token operator">-&gt;</span>x<span class="token punctuation">,</span> pcur<span class="token operator">-&gt;</span>next<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位光标到最后的蛇尾</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"  "</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//覆盖原来蛇尾打印的信息</span>
	<span class="token function">free</span><span class="token punctuation">(</span>dle<span class="token operator">-&gt;</span>next<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//释放最后的蛇尾节点</span>
	dle<span class="token operator">-&gt;</span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	pSnakenode cur <span class="token operator">=</span> pn<span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>cur<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">setpos</span><span class="token punctuation">(</span>cur<span class="token operator">-&gt;</span>x<span class="token punctuation">,</span> cur<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
	    <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%lc"</span><span class="token punctuation">,</span> BODY<span class="token punctuation">)</span><span class="token punctuation">;</span>
		cur <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">KillByWall</span><span class="token punctuation">(</span>psnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>x <span class="token operator">==</span> <span class="token number">56</span><span class="token punctuation">)</span><span class="token comment">//检测是否撞到第二列城墙</span>
	<span class="token punctuation">{<!-- --></span>
		ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//重新定位穿墙后的横坐标位置（第一列出）</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>x <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">//检测是否撞到第一列城墙</span>
	<span class="token punctuation">{<!-- --></span>
		ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>x <span class="token operator">=</span> <span class="token number">56</span><span class="token punctuation">;</span><span class="token comment">//重新定位穿墙后的横坐标位置（第二列出）</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>y <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">//检测是否撞到第一行城墙</span>
	<span class="token punctuation">{<!-- --></span>
		ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>y <span class="token operator">=</span> <span class="token number">26</span><span class="token punctuation">;</span><span class="token comment">//重新定位穿墙后的纵坐标位置（第一行出）</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>y <span class="token operator">==</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token comment">//检测是否撞到第二行城墙</span>
	<span class="token punctuation">{<!-- --></span>
		ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//重新定位穿墙后的纵坐标位置（第二行出）</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">KillBySelf</span><span class="token punctuation">(</span> psnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	pSnakenode pcur <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span><span class="token comment">//保存蛇头下一个节点</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>pcur<span class="token punctuation">)</span><span class="token comment">//遍历蛇身</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>x <span class="token operator">==</span> pcur<span class="token operator">-&gt;</span>x <span class="token operator">&amp;&amp;</span> ps<span class="token operator">-&gt;</span>shead<span class="token operator">-&gt;</span>y <span class="token operator">==</span> pcur<span class="token operator">-&gt;</span>y<span class="token punctuation">)</span><span class="token comment">//蛇身与蛇头重合</span>
		<span class="token punctuation">{<!-- --></span>
			ps<span class="token operator">-&gt;</span>statu <span class="token operator">=</span> kill_by_self<span class="token punctuation">;</span><span class="token comment">//设置游戏状态</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span><span class="token comment">//结束循环</span>
		<span class="token punctuation">}</span>
		pcur <span class="token operator">=</span> pcur<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span><span class="token comment">//移动</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">GemaEnd</span><span class="token punctuation">(</span>psnake ps<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	pSnakenode pcur <span class="token operator">=</span> ps<span class="token operator">-&gt;</span>shead<span class="token punctuation">;</span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位光标</span>
	<span class="token keyword">switch</span> <span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>statu<span class="token punctuation">)</span><span class="token comment">//游戏状态</span>
	<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">case</span> kill_by_wall<span class="token operator">:</span><span class="token comment">//撞墙</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"您撞到墙上，游戏结束！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> kill_by_self<span class="token operator">:</span><span class="token comment">//咬到自己</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"您咬到自己，游戏结束！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> end<span class="token operator">:</span><span class="token comment">//自己结束</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"您主动结束了游戏！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定位光标</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>pcur<span class="token punctuation">)</span><span class="token comment">//遍历蛇身销毁链表</span>
	<span class="token punctuation">{<!-- --></span>
		pSnakenode del <span class="token operator">=</span> pcur<span class="token punctuation">;</span><span class="token comment">//保存销毁节点</span>
		pcur <span class="token operator">=</span> pcur<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span><span class="token comment">//移动下一个销毁节点</span>
		<span class="token function">free</span><span class="token punctuation">(</span>del<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//销毁</span>
		del <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">free</span><span class="token punctuation">(</span>ps<span class="token operator">-&gt;</span>snakefool<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//销毁食物</span>
	ps<span class="token operator">-&gt;</span>snakefool <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> 
</code></pre> 
<ul><li>test.c</li></ul> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_CRT_SECURE_NO_WARNINGS</span> <span class="token expression"><span class="token number">1</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"snake.h"</span></span>
<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">char</span> ch <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">do</span>
	<span class="token punctuation">{<!-- --></span>
		Snake snake <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
		<span class="token function">GemeStar</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>snake<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">GameRun</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>snake<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">GemaEnd</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>snake<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"再来一局吗？(Y/N):"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">setpos</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">==</span> <span class="token char">'Y'</span> <span class="token operator">||</span> ch <span class="token operator">==</span> <span class="token char">'y'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token punctuation">{<!-- --></span>
	<span class="token function">setlocale</span><span class="token punctuation">(</span>LC_ALL<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_1392"></a>后言</h3> 
<blockquote> 
 <p>这就是用C语言写出来的贪吃蛇小游戏。这游戏基本使用到C语言所学的全部内容。也算是C语言的试金石吧！今天就分享到这里，感谢小伙伴的耐心垂阅！咱们下期见！拜拜~<br> <img src="https://images2.imgbox.com/26/da/I9pVe6W6_o.gif" alt="在这里插入图片描述"></p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/85673f93a5f4429fba2e262c7b5becfa/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【计算机视觉】数字图像处理基础：以像素为单位的图像基本运算（点运算、代数运算、逻辑运算、几何运算、插值）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0d9821bf928a6a48902e172186e9b448/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Hadoop的安装与配置</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>