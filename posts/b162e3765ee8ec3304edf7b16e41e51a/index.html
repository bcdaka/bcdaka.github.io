<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Mysql知识总结 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/b162e3765ee8ec3304edf7b16e41e51a/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Mysql知识总结">
  <meta property="og:description" content="一、数据库操作 1.创建库 create database 库名 charset = &#39;utf8&#39;; 2.查看当前库 DESC databases 库名; 3.查看当前所有库 SHOW DATABASES; 4.使用库 USE 库名; 5.删除库 DROP DATABASE 库名 [cascade]; -- 加中括号内容表示强制删除 二、数据表操作 1.创建数据表 CREATE TABLE 表名 ( id INT, name VARCHAR(30), gender VARCHAR(30) ); 2.查看当前表 DESC 表名; 3.查看当前所有表 SHOW TABLES; 4.删除表 DROP TABLE 表名; 5.新增列 ALTER TABLE 表名 ADD 列名 类型; 6.修改列 ALTER TABLE 表名 change 旧列名 新列名 类型; 7.删除列 ALTER TABLE 表名 drop 列名; 8.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-20T19:48:48+08:00">
    <meta property="article:modified_time" content="2024-05-20T19:48:48+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Mysql知识总结</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>一、数据库操作</h3> 
<h6>1.创建库</h6> 
<pre>create database 库名 charset = 'utf8';</pre> 
<h6>2.查看当前库</h6> 
<pre>DESC databases 库名;</pre> 
<h6>3.查看当前所有库</h6> 
<pre>SHOW DATABASES;</pre> 
<h6>4.使用库</h6> 
<pre>USE 库名;</pre> 
<h6>5.删除库</h6> 
<pre>DROP DATABASE 库名 [cascade];  -- 加中括号内容表示强制删除</pre> 
<p></p> 
<h3>二、数据表操作</h3> 
<h6>1.创建数据表</h6> 
<pre>CREATE TABLE 表名
    (
        id     INT,
        name   VARCHAR(30),
        gender VARCHAR(30)
    );</pre> 
<h6>2.查看当前表</h6> 
<pre>DESC 表名;</pre> 
<h6>3.查看当前所有表</h6> 
<pre>SHOW TABLES;</pre> 
<h6>4.删除表</h6> 
<pre>DROP TABLE 表名;</pre> 
<h6>5.新增列</h6> 
<pre>ALTER TABLE 表名 ADD 列名 类型;</pre> 
<h6>6.修改列</h6> 
<pre>ALTER TABLE 表名 change 旧列名 新列名 类型;   </pre> 
<h6>7.删除列</h6> 
<pre>ALTER TABLE 表名 drop 列名; </pre> 
<h6>8.修改表名</h6> 
<pre>ALTER TABLE 旧表名 rename to 新表名;</pre> 
<p></p> 
<h3>三、数据操作</h3> 
<h6>1.插入数据</h6> 
<pre>INSERT INTO 表名 values (1, '小明', '男');</pre> 
<h6>2.修改数据</h6> 
<pre>UPDATE 表名 SET 字段名 = '女' WHERE id = 4;</pre> 
<h6>3.删除一整行</h6> 
<pre>DELETE FROM 表名 WHERE id = 5;</pre> 
<h6>4.删除一个格</h6> 
<pre>UPDATE 表名 SET 字段名 = NULL WHERE id = 6;</pre> 
<h6>5.删除表中所有数据</h6> 
<pre>DELETE FROM 表名;</pre> 
<p></p> 
<h3>四、建表条件</h3> 
<h6>1.主键</h6> 
<pre>primary key(既不重复，也不为空，放字段后)</pre> 
<h6>2.删除主键</h6> 
<pre>ALTER TABLE 表名 DROP PRIMARY KEY;</pre> 
<h6>3.自增</h6> 
<pre>auto increment(放字段后)    </pre> 
<h6>4.标签</h6> 
<pre>comment = ''(放字段后)  </pre> 
<h6>5.非空</h6> 
<pre>not null(放字段后)  </pre> 
<h6>6.唯一约束</h6> 
<pre>unique(该字段不能重复，放字段后)</pre> 
<p></p> 
<h3>五、查询语句</h3> 
<h6>1.语句的执行顺序</h6> 
<pre>目标列(第七)：SELECT 列1,列2..... 
        来自表名(第一)：from 表1 
        表连接(第二)：(LEFT/RIGHT) JOIN 表2 ON 表1.字段1 = 表2.字段2
        外部条件(第三)：WHERE   筛选条件
        分组(第四)：GROUP BY 分组字段
        内部条件(第五)：HAVING  分组后筛选条件
        排序(第六)：ORDER BY 排序
        选取(第八)：LIMIT 起始索引, 条目数;</pre> 
<h6>2.查看表</h6> 
<pre>select * from 表名;</pre> 
<h6>3.指定列</h6> 
<pre>SELECT 列名1, 列名2 FROM 表名;    (列可常数，可计算)</pre> 
<h6>4.条件</h6> 
<pre>SELECT * FROM 表名 WHERE 条件;   (也可 between and 或 in 范围)</pre> 
<h6>5.模糊查询</h6> 
<pre>SELECT * FROM 表名 WHERE name LIKE '李%';</pre> 
<h6>6.非空</h6> 
<pre>······ WHERE 列名 IS NOT NULL;</pre> 
<h6>7.排序</h6> 
<pre>一级：select 列 from 表 [where] order by 条件(1) (Asc升/Desc降)；
二级：select 列 from 表 [where] order by 条件(1) (升/降), 条件(2) (升/降)；</pre> 
<h6>8.分组</h6> 
<pre>select 列，[聚合结果] from 表名 group by 分组条件列；
分组后查询列只能是分组后所对应的字段，不一定为全部字段，强行使用可能会报错(详见第七题第4小题处)</pre> 
<h6>9.分页查询</h6> 
<pre>格式：select 列名 from 表名 limit m,n;</pre> 
<h6>10.别名</h6> 
<pre>表别名：在from 后的表名后添加 as 别名     表名 as 别名
字段别名：在select 之后的字段名添加 as    列名 as 别名</pre> 
<h6>11.连接查询</h6> 
<pre>(1)内：select 字段列表 from 左表 inner join 右表 on 连接规则 (and列指定);
(2)左：select 列名 from 左表 left outer join 右表 on 连接规则 (and列指定);
(3)右：select 列名 from 左表 right outer join 右表 on 连接规则 (and列指定);</pre> 
<h6>12.子查询</h6> 
<pre>select 列 from 表 (select........)  
可作为表或条件，子查询作为表时括号后必加别名！！！</pre> 
<p></p> 
<h3>六、Hive搭建</h3> 
<h6>1.启动hadoop</h6> 
<pre>start-all.sh</pre> 
<h6>2.检查mysql服务是否可以使用</h6> 
<pre>systemctl status mysqld</pre> 
<h6>3.启动metastore服务</h6> 
<pre>hive --service metastore</pre> 
<h6>4.实际开发中让服务后台运行(显示进程号)</h6> 
<pre>(1)nohup hive --service metastore &amp;(本地)
(2)nohup hive --service hiveserver2 &amp;(远程)</pre> 
<h6>5.查看运行的程序</h6> 
<pre>(1)jps(本地：有RunJar即可)
(2)lsof -i:10000(远程：有端口号服务即可)</pre> 
<h6>6.使用客户端连接</h6> 
<pre>(1)hive(一代)
(2)beeline(二代)      </pre> 
<h6>7.指定jdbc链接的地址</h6> 
<pre>!connect jdbc:hive2://node1:10000
用户名：root
密码不用谢</pre> 
<h6>8.建表</h6> 
<pre>(1)内部表：正常建    -- 删除时会全删          
(2)外部表：create external···   -- 删除时只删元数据</pre> 
<h6>9.指定分隔符</h6> 
<pre>row format delimited fields terminated by '分割符';</pre> 
<h6>10.表的修改(添加字段)</h6> 
<pre>alter table 表名  add columns(字段名 字段类型);</pre> 
<h6>11.表的修改(修改字段)</h6> 
<pre>alter table 表名 change 旧字段名  新字段 字段类型;</pre> 
<h6>12.表的修改(修改表属性)</h6> 
<pre>(1)alter table 表名  set  属性设置
(2)alter table tb_ddl2 set tblproperties('age'='20');</pre> 
<h6>13.删除表</h6> 
<pre>(1)drop table 表名;    -- 直接删除表
(2)truncate table 表名;    -- 清空表的元数据</pre> 
<h6>14.表分类</h6> 
<pre>(1)内部表 Managed Tabel
(2)外部表 External Tables
区别：
内部表会把表的所有数据删除(元数据和行数据)
外部表会把表的元数据删除，保留hdfs上的文件数据</pre> 
<h6>15.修改表内外部类型</h6> 
<pre>(1)alter table 表名 set tblproperties('EXTERNAL'='TRUE'); -- 设置为外部表
(2)alter table 表名 set tblproperties('EXTERNAL'='FALSE');-- 设置为内部表
(3)desc formatted 表名; -- 验证一下</pre> 
<h6>16.数据写入</h6> 
<pre>(1)INSERT OVERWRITE TABLE 表名 values···  覆盖写入(后可加查询语句) 
(2)INSERT INTO TABLE 表名 values···  追加写入(后可加查询语句)</pre> 
<h6>17.数据分区(分为多个目录)</h6> 
<pre>(1)创建主表
create table tb_user(
    id int,
    name string,
    age int,
    gender int,
    create_time date
)row format delimited fields terminated by ',';
(2)创建分区表
create table new_tb_user(
    id int,
    name string,
    age  int,
    gender int,
    create_time date
)partitioned by (分区列 int)  -- 指定分区列，分区列不能是已存在列
row format delimited fields terminated by ',';</pre> 
<h6>18.静态分区</h6> 
<pre>需先创建分区表，再添加分区内容
insert into new_tb_user partition(gender=0) values(1,'张',20,'2024-10-10 14:21:21');</pre> 
<h6>19.动态分区</h6> 
<pre>需先创建分区表，再添加分区内容
还要进行设置开启
(1)set hive.exec.dynamic.partition.mode=nonstrict;
动态分区数据写入，可以根据select中指定的字段数据最为分区的依据
(2)insert into 分区表名 partition(分区列) select id,name, age,create_time,gender from 主表名;</pre> 
<h6>20.数据分桶(分为多个文件)</h6> 
<pre>(1)创建主表见17题···
(2)创建分桶表
create table new_tb_buckets(
    id int,
    name string,
    age  int,
    gender int,
    create_time date
)clustered by (gender)   -- 拆分字段
    into 2 buckets  -- 拆分数量
row format delimited fields terminated by ',';     </pre> 
<h6>21.动态分桶</h6> 
<pre>原理：hash(字段)%分桶数
insert into new_tb_buckets select * from tb_user limit 100;   -- 先分前100个</pre> 
<h6>22.字符串切割</h6> 
<pre>-- 字符串切割转化为数组数据
(1)split(字段名,'-')[0]  -- 让该列以'-'切割，再取第一个
(2)split(split(字段名,'-')[0],":")  -- 层层切割</pre> 
<h6>23.正则表达式</h6> 
<pre>rlike  (\\d:数字开头  \\w:字母开头  \\s:匹配空白  \\S:匹配非空白)
···where email rlike '^\\d';  -- 表示以数字开头</pre> 
<h6>24.三大HS</h6> 
<pre>(1)Udf函数：计算前后数据量不变
(2)Udaf函数：聚合，多行变少行
(3)Udtf函数：爆炸，可以将数组中数据一行拆分为多行(见25题所示)</pre> 
<h6>25.多看一眼就会···</h6> 
<pre>(1)select 其他列,split(分割列,'分隔符') as 别名 from 表名;  -- 分割
(2)select explode(split(分割列,'分隔符'))as 别名 from 表名;  -- 爆炸
(3)select 其他列,新别名 from 表名 lateral view explode(split(分割列,'分隔符')) tb1 as 新别名;  -- 全新展示</pre> 
<h6>26.虚拟列</h6> 
<pre>(1)INPUT_FILE_NAME，-- 显示数据行所在的具体文件
(2)BLOCK OFFSET INSIDE FILE，-- 显示数据行所在文件的偏移量
(3)ROW_OFFSET_INSIDE_BLOCK，-- 显示数据所在HDFS块的偏移量
-- 此虚拟列需要设置:SET hive.exec.rowoffset=true 才可使用</pre> 
<h6>27.快速建表</h6> 
<pre>(1)creste table 新表 like 老表;  -- 只复制元数据，没有行数据
(2)as语法：creste table 新表名 as select * from 老表;  -- 所有数据都复制</pre> 
<h6>28.hive查询流程</h6> 
<pre>-- 1、物理创建txt文件并写入内容
-- 2、启动hadoop并远程连接客户端
-- 3、虚拟机创建目标目录
-- 4、开网页找到该目录并托入文件
-- 5、创建表连接到目标目录
create table abc.8o
(
    abc2 string
) location '/home/hadoop/worddata';
-- 6、对该表进行操作查询，explode爆炸函数对分割后的数组逐行展示
select explode(split(abc2,' ')) from abc.8o;</pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1161cda6b1c51264dfe1c6412c236b16/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">数据仓库ETL</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/23a8ff179f8ad1d75ad4d4f8a1955055/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Llama 3 模型家族构建安全可信赖企业级AI应用之使用 Llama Guard 保护大模型对话 （八）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>