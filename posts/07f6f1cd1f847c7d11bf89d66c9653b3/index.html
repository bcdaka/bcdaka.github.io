<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Spring Boot整合Redisson的两种方式 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/07f6f1cd1f847c7d11bf89d66c9653b3/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Spring Boot整合Redisson的两种方式">
  <meta property="og:description" content="项目场景 Spring Boot整合Redisson的两种方式，方式一直接使用yml配置，方式二创建RedissonConfig配置类。
前言 redisson和redis区别：
Redis是一个开源的内存数据库，支持多种数据类型，如字符串、哈希、列表、集合和有序集合等，常用于缓存、消息队列、计数器、分布式锁和搜索等应用场景。Redisson则是一个基于Redis实现的Java驻内存数据网格，提供了一系列分布式的Java常用对象和多种锁机制，以及分布式服务，使开发者能更集中于处理业务逻辑。Redisson不支持字符串操作、排序、事务、管道、分区等Redis特性，但Redisson 提供了许多其他功能，如分布式闭锁、分布式计数器、分布式信号量等。 前提准备 版本：spring boot2.3.1.RELEASE，redisson3.21.1
maven依赖：
&lt;dependency&gt; &lt;groupId&gt;org.redisson&lt;/groupId&gt; &lt;artifactId&gt;redisson-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;3.21.1&lt;/version&gt; &lt;/dependency&gt; 集成方案： 方式一：使用yml配置 1.单节点配置 单节点配置可以兼容redis的配置方式
application.yml
# redis配置 spring: redis: database: 0 host: 127.0.0.1 password: redis@pass port: 6001 或者使用 redisson.yml文件的方式
application.yml这里引用了redisson.yml文件
spring: redis: # redisson配置 redisson: file: classpath:redisson.yml redisson.yml
# 单节点配置 singleServerConfig: # 数据库编号 database: 0 # 节点地址 address: redis://127.0.0.1:6001 # 密码 password: redis@pass application.yml与 redisson.yml在同级，目录结构如下：
2.集群模式配置 集群模式不能兼容redis之前的配置方式
application.yml没变
spring: redis: # redisson配置 redisson: file: classpath:redisson.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-24T17:17:04+08:00">
    <meta property="article:modified_time" content="2024-04-24T17:17:04+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Spring Boot整合Redisson的两种方式</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 style="background-color:transparent;"><a id="_0"></a>项目场景</h2> 
<p><code>Spring Boot整合Redisson的两种方式，方式一直接使用yml配置，方式二创建RedissonConfig配置类。</code></p> 
<hr> 
<h2 style="background-color:transparent;"><a id="_7"></a>前言</h2> 
<blockquote> 
 <p>redisson和redis区别：</p> 
 <ol><li>Redis是一个开源的内存数据库，支持多种数据类型，如字符串、哈希、列表、集合和有序集合等，常用于缓存、消息队列、计数器、分布式锁和搜索等应用场景。</li><li>Redisson则是一个基于Redis实现的Java驻内存数据网格，提供了一系列分布式的Java常用对象和多种锁机制，以及分布式服务，使开发者能更集中于处理业务逻辑。</li><li>Redisson不支持字符串操作、排序、事务、管道、分区等Redis特性，但Redisson 提供了许多其他功能，如分布式闭锁、分布式计数器、分布式信号量等。<code class="language-c"> </code></li></ol> 
</blockquote> 
<hr> 
<h2 style="background-color:transparent;">前提准备 </h2> 
<blockquote> 
 <p>版本：spring boot2.3.1.RELEASE，redisson3.21.1</p> 
</blockquote> 
<p>maven依赖：</p> 
<pre><code class="language-XML">&lt;dependency&gt;
	&lt;groupId&gt;org.redisson&lt;/groupId&gt;
	&lt;artifactId&gt;redisson-spring-boot-starter&lt;/artifactId&gt;
	&lt;version&gt;3.21.1&lt;/version&gt;
&lt;/dependency&gt;</code></pre> 
<hr> 
<h2><a id="_30"></a>集成方案：</h2> 
<blockquote> 
 <h3 style="background-color:transparent;">方式一：使用yml配置</h3> 
</blockquote> 
<h4 style="background-color:transparent;">1.单节点配置</h4> 
<p>单节点配置可以兼容redis的配置方式</p> 
<p>application.yml</p> 
<pre><code class="language-python"># redis配置
spring:
  redis:
    database: 0
    host: 127.0.0.1
    password: redis@pass
    port: 6001</code></pre> 
<p>或者使用 redisson.yml文件的方式</p> 
<p>application.yml这里引用了redisson.yml文件</p> 
<pre><code class="language-python">spring:
  redis:
    # redisson配置
    redisson:
        file: classpath:redisson.yml</code></pre> 
<p>redisson.yml</p> 
<pre><code class="language-python"># 单节点配置
singleServerConfig:
  # 数据库编号
  database: 0
  # 节点地址
  address: redis://127.0.0.1:6001
  # 密码
  password: redis@pass</code></pre> 
<p>application.yml与 redisson.yml在同级，目录结构如下：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/f9/ef/vCCP8vF7_o.png"></p> 
<h4 style="background-color:transparent;">2.集群模式配置 </h4> 
<p>集群模式不能兼容redis之前的配置方式</p> 
<p>application.yml没变</p> 
<pre><code class="language-python">spring:
  redis:
    # redisson配置
    redisson:
        file: classpath:redisson.yml</code></pre> 
<p>更改redisson.yml内容</p> 
<pre><code class="language-python"># 集群模式
clusterServersConfig:
  # 集群节点地址
  nodeAddresses:
    - "redis://127.0.0.1:18001"
    - "redis://127.0.0.1:18002"
    - "redis://127.0.0.1:18003"
    - "redis://127.0.0.1:18004"
    - "redis://127.0.0.1:18005"
    - "redis://127.0.0.1:18006"
  # 密码
  password: redis@pass</code></pre> 
<p>Redis集群不支持多个数据库的概念，默认只有一个数据库，即db 0，所以这里是没有database这个参数的。</p> 
<hr> 
<blockquote> 
 <h3 style="background-color:transparent;">方式二：创建RedissonConfig配置类</h3> 
 <p>配置类已经兼容单节点和集群模式，参数名可以自定义，数据库默认使用db 0。</p> 
</blockquote> 
<p>application.yml</p> 
<pre><code class="language-python">spring:
  redis:
    # redisson配置
    redisson:
        # 如果该值为false，系统将不会创建RedissionClient的bean。
        enabled: true
        # mode的可用值为，single/cluster/sentinel/master-slave
        mode: single
        # single: 单机模式
        #   address: redis://localhost:6379
        # cluster: 集群模式
        #   每个节点逗号分隔，同时每个节点前必须以redis://开头。
        #   address: redis://localhost:6379,redis://localhost:6378,...
        # sentinel:
        #   每个节点逗号分隔，同时每个节点前必须以redis://开头。
        #   address: redis://localhost:6379,redis://localhost:6378,...
        # master-slave:
        #   每个节点逗号分隔，第一个为主节点，其余为从节点。同时每个节点前必须以redis://开头。
        #   address: redis://localhost:6379,redis://localhost:6378,...
        address: redis://127.0.0.1:6001
        # redis 密码，空可以不填。
        password: redis@pass
        database: 0</code></pre> 
<p> RedissonConfig</p> 
<pre><code class="language-java">import org.apache.commons.lang3.StringUtils;
import org.redisson.Redisson;
import org.redisson.api.RedissonClient;
import org.redisson.config.Config;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

/**
 * Redisson配置类。
 */
@Configuration
@ConditionalOnProperty(name = "spring.redis.redisson.enabled", havingValue = "true")
public class RedissonConfig {

    @Value("${spring.redis.redisson.mode}")
    private String mode;

    /**
     * 仅仅用于sentinel模式。
     */
    @Value("${spring.redis.redisson.masterName:}")
    private String masterName;

    @Value("${spring.redis.redisson.address}")
    private String address;

    @Value("${spring.redis.redisson.password:}")
    private String password;

    /**
     * 数据库默认0
     */
    @Value("${spring.redis.redisson.database:0}")
    private Integer database;

    @Bean
    public RedissonClient redissonClient() {
        if (StringUtils.isBlank(password)) {
            password = null;
        }
        Config config = new Config();
        if ("single".equals(mode)) {
            config.useSingleServer()
                    .setDatabase(database)
                    .setPassword(password)
                    .setAddress(address);
        } else if ("cluster".equals(mode)) {
            String[] clusterAddresses = address.split(",");
            config.useClusterServers()
                    //集群模式不支持多个数据库概念，默认db 0
                    .setPassword(password)
                    .addNodeAddress(clusterAddresses);
        } else if ("sentinel".equals(mode)) {
            String[] sentinelAddresses = address.split(",");
            config.useSentinelServers()
                    .setDatabase(database)
                    .setPassword(password)
                    .setMasterName(masterName)
                    .addSentinelAddress(sentinelAddresses);
        } else if ("master-slave".equals(mode)) {
            String[] masterSlaveAddresses = address.split(",");
            if (masterSlaveAddresses.length == 1) {
                throw new IllegalArgumentException(
                        "redis.redisson.address MUST have multiple redis addresses for master-slave mode.");
            }
            String[] slaveAddresses = new String[masterSlaveAddresses.length - 1];
            System.arraycopy(masterSlaveAddresses, 1, slaveAddresses, 0, slaveAddresses.length);
            config.useMasterSlaveServers()
                    .setDatabase(database)
                    .setPassword(password)
                    .setMasterAddress(masterSlaveAddresses[0])
                    .addSlaveAddress(slaveAddresses);
        } else {
            throw new IllegalArgumentException(mode);
        }
        return Redisson.create(config);
    }
}</code></pre> 
<p> </p> 
<p> </p> 
<h4></h4> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f3f2d8b1d3d4c45ab6e2468f782ef6cf/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">SQL中PIVOT函数的用法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d50fb56c6b13f6c3ffe06bd181bfc419/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">艾体宝案例 | 使用Redis和Spring Ai构建rag应用程序</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>