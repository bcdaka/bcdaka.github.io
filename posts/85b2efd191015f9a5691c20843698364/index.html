<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python 读取PDF文档内容 提取PDF文本和图片 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/85b2efd191015f9a5691c20843698364/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Python 读取PDF文档内容 提取PDF文本和图片">
  <meta property="og:description" content="目录
一、介绍
二、安装Python库
三、Python 实现PDF文本和图片提取/读取PDF文档内容
1、从整个PDF文档提取文本
2、从特定PDF页面提取文本
3、从特定PDF页面区域提取文本
4、从整个PDF文档提取图片
5、从特定PDF页面提取图片
一、介绍 在当今的工作和生活中，PDF文档已经成为无处不在的文件格式。许多企业和机构选择将重要文件，如合同、报告等，保存为PDF格式以进行存储和管理。有时候，我们需要读取这些文档中的内容，包括文字和图片等，以便进一步分析文档内容、提取关键信息或将其集成到其他系统中。这篇文章将探讨如何通过Python实现PDF文本和图片的提取。
二、安装Python库 Python中有许多可以处理PDF的库，这篇文章使用的库是Spire.PDF for Python，它支持在多种场景下提取PDF文档中的文本和图片。此外还支持文档格式转换，例如PDF与图片互转，PDF转Word或Excel等。可以使用pip命令来安装它：
pip install Spire.PDF 下面我们来看如何借助这个库提取PDF文档中的文本和图片。
三、Python 实现PDF文本和图片提取/读取PDF文档内容 提取PDF文本和图片可以有多种场景，这里介绍一些常见的场景：
从整个PDF文档提取文本从特定PDF页面提取文本从特定PDF页面区域提取文本从整个PDF文档提取图片从特定PDF页面提取图片 1、从整个PDF文档提取文本 从整个PDF文档中提取文本，大致步骤如下：
加载PDF文档。遍历每个页面并提取页面的文本内容。将提取的文本保存到文本文件中。 代码：
from spire.pdf.common import * from spire.pdf import * # 定义一个从PDF文档提取文本的函数，参数分别为输入PDF文档的路径，存放提取文本的文本文档的路径 def extract_text_from_pdf(file_path, output_file): # 创建PdfDocument类的实例 doc = PdfDocument() # 加载PDF文档 doc.LoadFromFile(file_path) # 创建list来存储提取的文本 extracted_text = [] # 遍历文档的页面 for i in range(doc.Pages.Count): page = doc.Pages.get_Item(i) # 从页面提取文本并存储到list text = page.ExtractText(True) extracted_text.append(text) # 将提取的文本保存到文本文档 with open(output_file, &#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-12-29T15:12:52+08:00">
    <meta property="article:modified_time" content="2023-12-29T15:12:52+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python 读取PDF文档内容 提取PDF文本和图片</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="-toc" style="margin-left:40px;"></p> 
<p id="%E4%B8%80%E3%80%81%E4%BB%8B%E7%BB%8D-toc" style="margin-left:40px;"><a href="#%E4%B8%80%E3%80%81%E4%BB%8B%E7%BB%8D" rel="nofollow">一、介绍</a></p> 
<p id="%E4%BA%8C%E3%80%81%E5%AE%89%E8%A3%85Python%E5%BA%93-toc" style="margin-left:40px;"><a href="#%E4%BA%8C%E3%80%81%E5%AE%89%E8%A3%85Python%E5%BA%93" rel="nofollow">二、安装Python库</a></p> 
<p id="%E4%B8%89%E3%80%81Python%20%E5%AE%9E%E7%8E%B0PDF%E6%96%87%E6%9C%AC%E5%92%8C%E5%9B%BE%E7%89%87%E6%8F%90%E5%8F%96%2F%E8%AF%BB%E5%8F%96PDF%E6%96%87%E6%A1%A3%E5%86%85%E5%AE%B9-toc" style="margin-left:40px;"><a href="#%E4%B8%89%E3%80%81Python%20%E5%AE%9E%E7%8E%B0PDF%E6%96%87%E6%9C%AC%E5%92%8C%E5%9B%BE%E7%89%87%E6%8F%90%E5%8F%96%2F%E8%AF%BB%E5%8F%96PDF%E6%96%87%E6%A1%A3%E5%86%85%E5%AE%B9" rel="nofollow">三、Python 实现PDF文本和图片提取/读取PDF文档内容</a></p> 
<p id="1%E3%80%81%E4%BB%8E%E6%95%B4%E4%B8%AAPDF%E6%96%87%E6%A1%A3%E6%8F%90%E5%8F%96%E6%96%87%E6%9C%AC-toc" style="margin-left:80px;"><a href="#1%E3%80%81%E4%BB%8E%E6%95%B4%E4%B8%AAPDF%E6%96%87%E6%A1%A3%E6%8F%90%E5%8F%96%E6%96%87%E6%9C%AC" rel="nofollow">1、从整个PDF文档提取文本</a></p> 
<p id="2%E3%80%81%E4%BB%8E%E7%89%B9%E5%AE%9APDF%E9%A1%B5%E9%9D%A2%E6%8F%90%E5%8F%96%E6%96%87%E6%9C%AC-toc" style="margin-left:80px;"><a href="#2%E3%80%81%E4%BB%8E%E7%89%B9%E5%AE%9APDF%E9%A1%B5%E9%9D%A2%E6%8F%90%E5%8F%96%E6%96%87%E6%9C%AC" rel="nofollow">2、从特定PDF页面提取文本</a></p> 
<p id="3%E3%80%81%E4%BB%8E%E7%89%B9%E5%AE%9APDF%E9%A1%B5%E9%9D%A2%E5%8C%BA%E5%9F%9F%E6%8F%90%E5%8F%96%E6%96%87%E6%9C%AC-toc" style="margin-left:80px;"><a href="#3%E3%80%81%E4%BB%8E%E7%89%B9%E5%AE%9APDF%E9%A1%B5%E9%9D%A2%E5%8C%BA%E5%9F%9F%E6%8F%90%E5%8F%96%E6%96%87%E6%9C%AC" rel="nofollow">3、从特定PDF页面区域提取文本</a></p> 
<p id="4%E3%80%81%E4%BB%8E%E6%95%B4%E4%B8%AAPDF%E6%96%87%E6%A1%A3%E6%8F%90%E5%8F%96%E5%9B%BE%E7%89%87-toc" style="margin-left:80px;"><a href="#4%E3%80%81%E4%BB%8E%E6%95%B4%E4%B8%AAPDF%E6%96%87%E6%A1%A3%E6%8F%90%E5%8F%96%E5%9B%BE%E7%89%87" rel="nofollow">4、从整个PDF文档提取图片</a></p> 
<p id="5%E3%80%81%E4%BB%8E%E7%89%B9%E5%AE%9APDF%E9%A1%B5%E9%9D%A2%E6%8F%90%E5%8F%96%E5%9B%BE%E7%89%87-toc" style="margin-left:80px;"><a href="#5%E3%80%81%E4%BB%8E%E7%89%B9%E5%AE%9APDF%E9%A1%B5%E9%9D%A2%E6%8F%90%E5%8F%96%E5%9B%BE%E7%89%87" rel="nofollow">5、从特定PDF页面提取图片</a></p> 
<hr id="hr-toc"> 
<h3><span style="color:#2e74b5;">一、介绍</span></h3> 
<p style="margin-left:0;">在当今的工作和生活中，PDF文档已经成为无处不在的文件格式。许多企业和机构选择将重要文件，如合同、报告等，保存为PDF格式以进行存储和管理。有时候，我们需要读取这些文档中的内容，包括文字和图片等，以便进一步分析文档内容、提取关键信息或将其集成到其他系统中。这篇文章将探讨如何通过Python实现PDF文本和图片的提取。</p> 
<h3 id="%E4%BA%8C%E3%80%81%E5%AE%89%E8%A3%85Python%E5%BA%93" style="margin-left:.0001pt;"><span style="color:#2e74b5;">二、安装Python库</span></h3> 
<p style="margin-left:0;">Python中有许多可以处理PDF的库，这篇文章使用的库是<a href="https://www.e-iceblue.cn/Downloads/Spire-PDF-Python.html" rel="nofollow" title="Spire.PDF for Python">Spire.PDF for Python</a>，它支持在多种场景下提取PDF文档中的文本和图片。此外还支持文档格式转换，例如<a href="https://blog.csdn.net/nuclear2011/article/details/135134402?spm=1001.2014.3001.5502" title="PDF与图片互转">PDF与图片互转</a>，PDF转Word或Excel等。可以使用pip命令来安装它：</p> 
<pre><code>pip install Spire.PDF</code></pre> 
<p style="margin-left:0;">下面我们来看如何借助这个库提取PDF文档中的文本和图片。</p> 
<h3 id="%E4%B8%89%E3%80%81Python%20%E5%AE%9E%E7%8E%B0PDF%E6%96%87%E6%9C%AC%E5%92%8C%E5%9B%BE%E7%89%87%E6%8F%90%E5%8F%96%2F%E8%AF%BB%E5%8F%96PDF%E6%96%87%E6%A1%A3%E5%86%85%E5%AE%B9" style="margin-left:.0001pt;"><span style="color:#2e74b5;">三、Python 实现PDF文本和图片提取/读取PDF文档内容</span></h3> 
<p style="margin-left:0;">提取PDF文本和图片可以有多种场景，这里介绍一些常见的场景：</p> 
<ul><li>从整个PDF文档提取文本</li><li>从特定PDF页面提取文本</li><li>从特定PDF页面区域提取文本</li><li>从整个PDF文档提取图片</li><li>从特定PDF页面提取图片</li></ul> 
<h4 id="1%E3%80%81%E4%BB%8E%E6%95%B4%E4%B8%AAPDF%E6%96%87%E6%A1%A3%E6%8F%90%E5%8F%96%E6%96%87%E6%9C%AC" style="margin-left:.0001pt;"><span style="color:#1f4d78;">1、从整个PDF文档提取文本</span></h4> 
<p style="margin-left:0;">从整个PDF文档中提取文本，大致步骤如下：</p> 
<ul><li>加载PDF文档。</li><li>遍历每个页面并提取页面的文本内容。</li><li>将提取的文本保存到文本文件中。</li></ul> 
<p style="margin-left:0;">代码：</p> 
<pre><code class="language-python">from spire.pdf.common import *
from spire.pdf import *

# 定义一个从PDF文档提取文本的函数，参数分别为输入PDF文档的路径，存放提取文本的文本文档的路径
def extract_text_from_pdf(file_path, output_file):
    # 创建PdfDocument类的实例
    doc = PdfDocument()
    # 加载PDF文档
    doc.LoadFromFile(file_path)

    # 创建list来存储提取的文本
    extracted_text = []

    # 遍历文档的页面
    for i in range(doc.Pages.Count):
        page = doc.Pages.get_Item(i)
        # 从页面提取文本并存储到list
        text = page.ExtractText(True)
        extracted_text.append(text)

    # 将提取的文本保存到文本文档
    with open(output_file, "w", encoding="utf-8") as text_file:
        text_file.write("\n".join(extracted_text))

    doc.Close()

# 调用函数实现从PDF提取文本
file_path = "测试.pdf"
output_file = "提取文本.txt"
extract_text_from_pdf(file_path, output_file)
</code></pre> 
<h4 id="2%E3%80%81%E4%BB%8E%E7%89%B9%E5%AE%9APDF%E9%A1%B5%E9%9D%A2%E6%8F%90%E5%8F%96%E6%96%87%E6%9C%AC" style="margin-left:.0001pt;"><span style="color:#1f4d78;">2、从特定PDF页面提取文本</span></h4> 
<p style="margin-left:0;">从指定的PDF页面提取文本，大致步骤如下：</p> 
<ul><li>加载PDF文档。</li><li>通过页面索引获取指定页面。</li><li>提取页面的文本内容。</li><li>将提取的文本保存到文本文件中。</li></ul> 
<p style="margin-left:0;">代码：</p> 
<pre><code class="language-python">from spire.pdf.common import *
from spire.pdf import *

# 定义一个从PDF文档指定页面提取文本的函数，参数分别为输入PDF文档的路径，需要提取文本的页面索引（从0开始），存放提取文本的文本文档的路径
def extract_text_from_page(file_path, page_num, output_file):
    # 创建PdfDocument类的实例
    doc = PdfDocument()
    # 加载PDF文档
    doc.LoadFromFile(file_path)

    # 根据页面索引获取特定页面
    page = doc.Pages[page_num]

    # 从该页面提取文本
    text = page.ExtractText(True)

    # 将提取的文本存储到文本文件
    with open(output_file, "w", encoding="utf-8") as text_file:
        text_file.write(text)

    doc.Close()

# 调用函数实现从PDF指定页面提取文本
file_path = "测试.pdf"
page_num = 0  # 指定从中提取文本的页码（页码索引从0开始）
output_file = "提取页面文本.txt"
extract_text_from_page(file_path, page_num, output_file)
</code></pre> 
<h4 id="3%E3%80%81%E4%BB%8E%E7%89%B9%E5%AE%9APDF%E9%A1%B5%E9%9D%A2%E5%8C%BA%E5%9F%9F%E6%8F%90%E5%8F%96%E6%96%87%E6%9C%AC" style="margin-left:.0001pt;"><span style="color:#1f4d78;">3、从特定PDF页面区域提取文本</span></h4> 
<p style="margin-left:0;">从指定PDF页面区域提取文本，大致步骤如下:</p> 
<ul><li>加载PDF文档。</li><li>通过页面索引获取指定页面。</li><li>指定需要提取文本内容的矩形区域的坐标、宽度和高度。</li><li>从页面的指定矩形区域中提取文本。</li><li>将提取的文本保存到文本文件中。</li></ul> 
<p style="margin-left:0;">代码：</p> 
<pre><code class="language-python">from spire.pdf.common import *
from spire.pdf import *

# 定义一个从PDF文档指定页面的指定区域提取文本的函数，参数分别为输入PDF文档的路径，需要提取文本的页面索引（从0开始），区域的X坐标，区域的Y坐标，区域的宽度，区域的高度，存放提取文本的文本文件路径
def extract_text_from_page_area(file_path, page_num, x, y, width, height, output_file):
    # 创建PdfDocument实例
    doc = PdfDocument()
    # 加载PDF文档
    doc.LoadFromFile(file_path)

    # 根据页面索引获取特定页面
    page = doc.Pages[page_num]

    # 定义一个矩形来指定文本提取的区域
    rectangle = RectangleF(x, y, width, height)

    # 从页面的指定矩形区域中提取文本
    text = page.ExtractText(rectangle)

    # 将提取的文本存储到文本文件
    with open(output_file, "w", encoding="utf-8") as text_file:
        text_file.write(text)

    doc.Close()

# 调用函数实现从PDF指定页面的指定区域提取文本
file_path = "测试.pdf"
page_num = 0  # 指定从中提取文本的页码（页码索引从0开始）
x = 0.0
y = 180.0
width = 500.0
height = 200.0
output_file = "提取页面区域文本.txt"
extract_text_from_page_area(file_path, page_num, x, y, width, height, output_file)
</code></pre> 
<h4 id="4%E3%80%81%E4%BB%8E%E6%95%B4%E4%B8%AAPDF%E6%96%87%E6%A1%A3%E6%8F%90%E5%8F%96%E5%9B%BE%E7%89%87" style="margin-left:.0001pt;"><span style="color:#1f4d78;">4、从整个PDF文档提取图片</span></h4> 
<p style="margin-left:0;">从整个PDF文档提取图片，大致步骤如下:</p> 
<ul><li>加载PDF文档。</li><li>遍历每个页面并提取页面上的图片。</li><li>将提取的图片保存到文件夹中。</li></ul> 
<p style="margin-left:0;">代码：</p> 
<pre><code class="language-python">from spire.pdf.common import *
from spire.pdf import *

# 定义一个从PDF文档提取图片的函数，参数分别为输入PDF文档的路径，存放提取的图片的文件夹路径
def extract_images_from_pdf(file_path, output_folder):
    # 创建PdfDocument类的实例
    doc = PdfDocument()
    # 加载PDF文档
    doc.LoadFromFile(file_path)

    # 创建list来存储提取的图片
    images = []

    # 遍历文档的页面
    for i in range(doc.Pages.Count):
        # 获取当前页
        page = doc.Pages.get_Item(i)
        # 从页面提取图片并存储到list
        for img in page.ExtractImages():
            images.append(img)

    # 将图片保存到指定文件夹
    for i, image in enumerate(images):
        image.Save(f"{output_folder}Image-{i+1}.png", ImageFormat.get_Png())

    doc.Close()

# 调用函数实现从PDF提取图片
file_path = "测试.pdf"
output_folder = "文档图片/"
extract_images_from_pdf(file_path, output_folder)
</code></pre> 
<h4 id="5%E3%80%81%E4%BB%8E%E7%89%B9%E5%AE%9APDF%E9%A1%B5%E9%9D%A2%E6%8F%90%E5%8F%96%E5%9B%BE%E7%89%87" style="margin-left:.0001pt;"><span style="color:#1f4d78;">5、从特定PDF页面提取图片</span></h4> 
<p style="margin-left:0;">从PDF文档的特定页面提取图片，大致步骤如下：</p> 
<ul><li>加载PDF文档。</li><li>通过页面索引获取指定页面。</li><li>提取页面上的图片。</li><li>将提取的图片保存到文件夹中。</li></ul> 
<p style="margin-left:0;">代码：</p> 
<pre><code class="language-python">from spire.pdf.common import *
from spire.pdf import *

# 定义一个从PDF文档指定页面提取图片的函数，参数分别为输入PDF文档的路径，需要提取图片的页码索引，存放提取的图片的文件夹路径
def extract_images_from_pdf_page(file_path, page_num, output_folder):
    # 创建PdfDocument类的实例
    doc = PdfDocument()
    # 加载PDF文档
    doc.LoadFromFile(file_path)

    # 创建list来存储提取的图片
    images = []

    # 根据页面索引获取特定页面
    page = doc.Pages.get_Item(page_num)

    # 提取该页面上的图片并将它们存储到list
    for img in page.ExtractImages():
        images.append(img)

    # 将图片保存到指定文件夹
    for i, image in enumerate(images):
        image.Save(f"{output_folder}Image-{i+1}.png", ImageFormat.get_Png())

    doc.Close()

# 调用函数实现从PDF指定页面提取图片
file_path = "测试.pdf"
page_num = 0  # 指定从中提取图像的页码（注意页码索引从0开始）
output_folder = "页面图片/"
extract_images_from_pdf_page(file_path, page_num, output_folder)
</code></pre> 
<p style="margin-left:0;">希望以上关于使用Python实现PDF文本和图片提取的内容能对你有所帮助。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ae9de8c1d6870a2d5989f3cfa6e7c730/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">推荐一个重量级的APP软件——聚合集网站整合APP=海阔视界小程序</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5bd8981aedec6f589c5a4c22e6a8c40a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">是时候将javax替换为Jakarta了</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>