<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【C&#43;&#43;】类和对象（一） - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/26cfd80062bd435712c723faf5c4ad4f/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【C&#43;&#43;】类和对象（一）">
  <meta property="og:description" content="文章目录 一、类的引入二、类的定义语法 三、类的访问限定符及封装访问限定符`public ``private``protected`访问限定符说明 面试题:question:C&#43;&#43;中struct和class的区别是什么？ 四、类的两种定义方式五、类的作用域六、面向对象三大特性之一：封装七、类的实例化八、类对象模型如何计算类对象的大小回顾：结构体内存对齐规则 类对象的存储方式 一、类的引入 C语言，结构体中只能定义变量。C&#43;&#43;中，结构体内可以定义变量也可以定义函数。
🌰C语言方式实现的栈，结构体中只能定义变量。现在以C&#43;&#43;的方式实现，结构体中也可以定义函数。
typedef int DataType; struct Stack { void Init(size_t capacity) { _array = (DataType*)malloc(sizeof(DataType) * capacity); if (nullptr == _array) { perror(&#34;malloc申请空间失败&#34;); return; } _capacity = capacity; _size = 0; } void Push(const DataType&amp; data) { // 扩容 _array[_size] = data; &#43;&#43;_size; } DataType Top() { return _array[_size - 1]; } void Destroy() { if (_array) { free(_array); _array = nullptr; _capacity = 0; _size = 0; } } DataType* _array; size_t _capacity; size_t _size; }; int main() { //我们可以直接用stack来定义一个结构体s。 //C&#43;&#43;中s也可以称作一个对象。 Stack s; s.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-12T16:06:01+08:00">
    <meta property="article:modified_time" content="2024-06-12T16:06:01+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【C&#43;&#43;】类和对象（一）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atelier-sulphurpool-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_2" rel="nofollow">一、类的引入</a></li><li><a href="#_64" rel="nofollow">二、类的定义</a></li><li><ul><li><a href="#_65" rel="nofollow">语法</a></li></ul> 
  </li><li><a href="#_144" rel="nofollow">三、类的访问限定符及封装</a></li><li><ul><li><a href="#_146" rel="nofollow">访问限定符</a></li><li><ul><li><a href="#public__153" rel="nofollow">`public `</a></li><li><a href="#private_158" rel="nofollow">`private`</a></li><li><a href="#protected_163" rel="nofollow">`protected`</a></li><li><a href="#_168" rel="nofollow">访问限定符说明</a></li></ul> 
   </li><li><a href="#_176" rel="nofollow">面试题</a></li><li><ul><li><a href="#questionCstructclass_178" rel="nofollow">:question:C++中struct和class的区别是什么？</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_182" rel="nofollow">四、类的两种定义方式</a></li><li><a href="#_245" rel="nofollow">五、类的作用域</a></li><li><a href="#_265" rel="nofollow">六、面向对象三大特性之一：封装</a></li><li><a href="#_277" rel="nofollow">七、类的实例化</a></li><li><a href="#_337" rel="nofollow">八、类对象模型</a></li><li><ul><li><a href="#_341" rel="nofollow">如何计算类对象的大小</a></li><li><ul><li><a href="#_367" rel="nofollow">回顾：结构体内存对齐规则</a></li></ul> 
   </li><li><a href="#_417" rel="nofollow">类对象的存储方式</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_2"></a>一、类的引入</h2> 
<p>C语言，结构体中<font color="#7F72F7">只能定义变量</font>。C++中，结构体内<font color="#7F72F7">可以定义变量也可以定义函数。</font></p> 
<p>🌰C语言方式实现的栈，结构体中只能定义变量。现在以C++的方式实现，结构体中也可以定义函数。</p> 
<pre><code class="prism language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">int</span> DataType<span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">Stack</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">void</span> <span class="token function">Init</span><span class="token punctuation">(</span>size_t capacity<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_array <span class="token operator">=</span> <span class="token punctuation">(</span>DataType<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>DataType<span class="token punctuation">)</span> <span class="token operator">*</span> capacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">nullptr</span> <span class="token operator">==</span> _array<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"malloc申请空间失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		_capacity <span class="token operator">=</span> capacity<span class="token punctuation">;</span>
		_size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">Push</span><span class="token punctuation">(</span><span class="token keyword">const</span> DataType<span class="token operator">&amp;</span> data<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 扩容</span>
		_array<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">;</span>
		<span class="token operator">++</span>_size<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	DataType <span class="token function">Top</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> _array<span class="token punctuation">[</span>_size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">Destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>_array<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">free</span><span class="token punctuation">(</span>_array<span class="token punctuation">)</span><span class="token punctuation">;</span>
			_array <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
			_capacity <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			_size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	DataType<span class="token operator">*</span> _array<span class="token punctuation">;</span>
	size_t _capacity<span class="token punctuation">;</span>
	size_t _size<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//我们可以直接用stack来定义一个结构体s。</span>
    <span class="token comment">//C++中s也可以称作一个对象。</span>
	Stack s<span class="token punctuation">;</span>
	s<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	s<span class="token punctuation">.</span><span class="token function">Push</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	s<span class="token punctuation">.</span><span class="token function">Push</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	s<span class="token punctuation">.</span><span class="token function">Push</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">.</span><span class="token function">Top</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	s<span class="token punctuation">.</span><span class="token function">Destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>c语言中，我们通过这种方式来建立一个栈的结构，c++将结构体升级为了类，<strong>类提供了一种封装数据成员（属性或变量）和成员函数</strong><font color="#7F72F7"><strong>上面结构体的定义，在C++中更喜欢用class来代替</strong></font>。</p> 
<h2><a id="_64"></a>二、类的定义</h2> 
<h3><a id="_65"></a>语法</h3> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">className</span>
<span class="token punctuation">{<!-- --></span>
 <span class="token comment">// 类体：由成员函数和成员变量组成</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>  
<span class="token comment">// 一定要注意后面的分号</span>
</code></pre> 
<p><strong>class</strong>为定义<strong>类的关键字</strong>，ClassName为类的名字，{}中为类的主体，注意<font color="#7F72F7"><strong>类定义结束时后面分号不能省略</strong>。</font></p> 
<p>类体中内容称为<strong>类的成员</strong>：类中的变量称为<strong>类的属性</strong>或<strong>成员变量</strong>; 类中的函数称为<strong>类的方法</strong>或者<strong>成员函数</strong>。</p> 
<p>我们可以简单定义一个日期类：</p> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> year<span class="token punctuation">;</span>
	<span class="token keyword">int</span> month<span class="token punctuation">;</span>
	<span class="token keyword">int</span> day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>C++习惯定义成员变量时在其前面加上符号_,比如以下情况：</p> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span> 
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">void</span> <span class="token function">Init</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">,</span> <span class="token keyword">int</span> day<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		year <span class="token operator">=</span> year<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">int</span> year<span class="token punctuation">;</span>
	<span class="token keyword">int</span> month<span class="token punctuation">;</span>
	<span class="token keyword">int</span> day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p><mark>为了防止成员变量和成员函数的形参混淆</mark>，我们可以这样定义:</p> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span> 
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">void</span> <span class="token function">Init</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">,</span> <span class="token keyword">int</span> day<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
        _year <span class="token operator">=</span> year<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">int</span> _year<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _month<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>现在我们来调用这个函数：</p> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">void</span> <span class="token function">Init</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">,</span> <span class="token keyword">int</span> day<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_year <span class="token operator">=</span> year<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">int</span> _year<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _month<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Date d1<span class="token punctuation">;</span>
	d1<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token number">2005</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>发现无法调用该成员函数<br> <img src="https://images2.imgbox.com/7d/61/DhqzMh1M_o.png" alt="在这里插入图片描述"></p> 
<p>这就引出我们接下来要讲的内容，类的访问限定符</p> 
<h2><a id="_144"></a>三、类的访问限定符及封装</h2> 
<h3><a id="_146"></a>访问限定符</h3> 
<p>C++实现封装的方式：用类将对象的属性与方法结合在一块，让对象更加完善，通过访问权限选 择性的将其接口提供给外部的用户使用。</p> 
<p>在 C++ 中，访问限定符（Access Specifiers）定义了类成员（即变量和函数）的访问权限。这些限定符有助于实现封装和抽象，是面向对象编程的核心概念之一。主要的访问限定符有三种：<code>public</code>、<code>private</code> 和 <code>protected</code><br> <img src="https://images2.imgbox.com/ba/cd/zbLzdj8N_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="public__153"></a><code>public </code></h4> 
<ul><li><code>public</code>成员在任何地方都可以被访问，<strong>类的内部、外部都<font color="red">可访问</font>&gt;</strong></li><li>使用<code>public</code>限定符可以提高代码的使用率，但是会降低封装性，因为外部代码可以直接读写公开的数据成员</li></ul> 
<h4><a id="private_158"></a><code>private</code></h4> 
<ul><li><code>private</code>成员只能被类的成员函数和友元函数访问，<strong><font color="red">不能</font>被类的外部访问</strong>。</li><li>使用 <code>private</code> 限定符是封装的一种体现。通过限制对成员的直接访问，你可以保护类内部成员的状态，避免外部代码随意修改，从而维护对象的完整性</li></ul> 
<h4><a id="protected_163"></a><code>protected</code></h4> 
<ul><li><code>protected</code> 成员可以被其<strong>所在类</strong>的成员函数、<strong>派生类</strong>的成员函数访问，但是**<font color="red">不能</font>被类的外部<strong>直接</strong>访问**</li><li><code>protected</code> 在处理继承时尤其有用，它允许<strong>派生类</strong>访问<strong>基类</strong>中的成员，同时防止了类的外部直接访问这些成员</li></ul> 
<h4><a id="_168"></a>访问限定符说明</h4> 
<blockquote> 
 <p><font color="black">1. 访问权限作用域从该访问限定符出现的位置开始直到下一个访问限定符出现时为止<br> 2. 如果后面没有访问限定符，作用域就到}即类结束。<br> 3. <strong>class的默认访问权限为private</strong>，<strong>struct为public(因为struct要兼容C)</strong></font></p> 
</blockquote> 
<p>注意：访问限定符只在编译时有用，当数据映射到内存后，没有任何访问限定符上的区别</p> 
<h3><a id="_176"></a>面试题</h3> 
<h4><a id="questionCstructclass_178"></a>❓C++中struct和class的区别是什么？</h4> 
<p>答：C++兼容C语言，C++中struct可以当作结构体使用，也可以当作类去使用。在struct当类使用的时候，跟class关键字的<font color="red"><strong>区别是默认访问限定符不同</strong></font>。struct的默认访问限定符是public,class的默认访问限定符是private。在继承和模板参数列表位置，struct和class也存在区别。</p> 
<h2><a id="_182"></a>四、类的两种定义方式</h2> 
<ol><li>声明和定义全部放在类体中，需注意：<font color="blue"><strong>成员函数在类中定义</strong>，编译器<strong>可能</strong>会将其当成<strong>内联函数处理</strong></font></li></ol> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">stack</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">int</span><span class="token operator">*</span> a<span class="token punctuation">;</span>
	<span class="token keyword">int</span> size<span class="token punctuation">;</span>
	<span class="token keyword">int</span> capacity<span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">Init</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token operator">*</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">nullptr</span> <span class="token operator">==</span> a<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"malloc申请空间失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		capacity <span class="token operator">=</span> n<span class="token punctuation">;</span>
		size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="2"><li>类声明放在.h文件中，成员函数定义放在.cpp文件中，注意：成员函数名前需要加类名::</li></ol> 
<p><mark>stack.h文件</mark></p> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">stack</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">int</span><span class="token operator">*</span> a<span class="token punctuation">;</span>
	<span class="token keyword">int</span> size<span class="token punctuation">;</span>
	<span class="token keyword">int</span> capacity<span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p><mark>stack.cpp文件</mark>，如果我们直接定义该成员函数则会报错</p> 
<p><img src="https://images2.imgbox.com/e4/a4/27Lcwrke_o.png" alt="在这里插入图片描述"><br> <mark>报错原因</mark>是：<code>Init()</code>函数被编译器当作全局函数，<code>Init()</code>函数操作<code>Stack</code>类的成员变量被编译器认定是访问未定义的标识符。</p> 
<p>这说明，如果程序员不加指定，编译器则无法找到该函数的出处，根据搜索规则，只会先去局部域找然后去全局域搜索这些变量是否被定义过。所以我们要使用<strong>访问限定符<code>::</code><strong>告诉编译器</strong>该函数操作的成员变量 属于 哪一个类域</strong>。</p> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> stack<span class="token double-colon punctuation">::</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token operator">*</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">nullptr</span> <span class="token operator">==</span> a<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"malloc申请空间失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		capacity <span class="token operator">=</span> n<span class="token punctuation">;</span>
		size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="_245"></a>五、类的作用域</h2> 
<p>由此我们可知，除了全局域、局部域类作用域也会影响编译器的搜索规则 ，比如下面两个类，栈和队列都有init和push函数：</p> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">stack</span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">queue</span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre> 
<p>如果没有域，则会有冲突。所以，<font color="#7F72F7"><strong>类本身就是一个域</strong>。</font></p> 
<h2><a id="_265"></a>六、面向对象三大特性之一：封装</h2> 
<p><strong>面向对象的三大特性：封装、继承、多态</strong></p> 
<p>在类和对象阶段，主要是研究类的封装特性，那<mark>什么是封装呢</mark>？</p> 
<blockquote> 
 <p>封装（Encapsulation）是面向对象编程（OOP）中的一个核心概念，它指的是将对象的数据（属性）和操作这些数据的方法（行为）捆绑在一起的做法。这种机制可以防止外部代码随意访问对象内部的状态，从而保护对象的完整性和安全性。封装的关键在于提供了一个抽象层，使得对象的使用者不需要知道对象内部的复杂逻辑，只需要通过对象提供的接口（公共方法）来与对象进行交互</p> 
</blockquote> 
<blockquote> 
 <p>封装本质上是一种管理，让用户更方便使用类。比如：对于电脑这样一个复杂的设备，提供给用户的就只有开关机键、通过键盘输入，显示器，USB插孔等，让用户和计算机进行交互，完成日常事务。但实际上电脑真正工作的却是CPU、显卡、内存等一些硬件元件</p> 
</blockquote> 
<blockquote> 
 <p>对于计算机使用者而言，不用关心内部核心部件，比如主板上线路是如何布局的，CPU内部是如何设计的等，用户只需要知道，怎么开机、怎么通过键盘和鼠标与计算机进行交互即可。因此计算机厂商在出厂时，在外部套上壳子，将内部实现细节隐藏起来，仅仅对外提供开关机、鼠标以及键盘插孔等，让用户可以与计算机进行交互即可。</p> 
</blockquote> 
<h2><a id="_277"></a>七、类的实例化</h2> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">Init</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">,</span> <span class="token keyword">int</span> day<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_year <span class="token operator">=</span> year<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">int</span> _year<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _month<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>思考</strong>：这里的<code>int _year</code>、<code>int _month</code>、<code>int _day</code>是声明还是定义？<strong>它是声明</strong></p> 
<blockquote> 
 <p><strong>声明和定义的本质区别是是否开辟一块空间</strong></p> 
</blockquote> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">Init</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">,</span> <span class="token keyword">int</span> day<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_year <span class="token operator">=</span> year<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">int</span> _year<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _month<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Date d1<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <p><code>Date d1</code>通过实例化对象，为该对象的所有成员变量开辟空间，整体<strong>定义了该对象的所有成员变量</strong>。</p> 
</blockquote> 
<p>我们可以通过对象，对该对象的成员变量进行访问。</p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    Date d1<span class="token punctuation">;</span>
    d1<span class="token punctuation">.</span>_year<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token comment">//Date::_year++//不能通过类域限定访问，因为他只是声明，没有开辟一块空间</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>类是对对象进行描述的，是一个模型一样的东西，限定了类有哪些成员，定义出一个类并没有分配实际的内存空间来存储它</strong></p> 
<p><strong>类实例化出对象就像现实中使用建筑设计图建造出房子，类就像是设计图，只设计出需要什么东西，但是并没有实体的建筑存在，同样类也只是一个设计，实例化出的对象才能实际存储数据，占用物理空间</strong></p> 
<p><img src="https://images2.imgbox.com/cf/d3/NRHXPlpv_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_337"></a>八、类对象模型</h2> 
<p><strong>类中既可以有成员变量，又可以有成员函数，那么一个类的对象中包含了什么？如何计算一个类的大小？</strong></p> 
<h3><a id="_341"></a>如何计算类对象的大小</h3> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">Init</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">,</span> <span class="token keyword">int</span> day<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_year <span class="token operator">=</span> year<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">int</span> _year<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _month<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>d1<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	Date d1<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>思考：上面Date类的大小是多少字节？</p> 
<p>先来回顾以下结构体内存对齐规则</p> 
<h4><a id="_367"></a>回顾：结构体内存对齐规则</h4> 
<blockquote> 
 <ol><li> <p>第一个成员在与结构体变量偏移量为0的地址处。</p> </li><li> <p>其他成员变量要对齐到<strong>对齐数的整数倍</strong>的地址处。</p> <p>对齐数 = min（编译器默认的对齐数, 该成员大小）</p> <p>VS中默认的值为8</p> </li><li> <p>结构体<strong>总大小</strong>为<strong>最大对齐数（每个成员变量都有一个对齐数）的整数倍</strong>。</p> </li><li> <p>如果嵌套了结构体的情况，<strong>嵌套的结构体</strong>对齐到<strong>自己的最大对齐数的整数倍</strong>处，结构体的整体大小就是所有最大对齐数（含嵌套结构体的对齐数）的整数倍。</p> </li></ol> 
</blockquote> 
<p>这里存在成员函数的情况下，类所占字节大小依然是12，验证测试如下：</p> 
<p><img src="https://images2.imgbox.com/05/39/C7t38pHW_o.png" alt="在这里插入图片描述"></p> 
<p>我们尝试调用以下不同对象的成员函数</p> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">Init</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">,</span> <span class="token keyword">int</span> day<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_year <span class="token operator">=</span> year<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">int</span> _year<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _month<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Date d1<span class="token punctuation">;</span>
	Date d2<span class="token punctuation">;</span>
	d1<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token number">2024</span><span class="token punctuation">,</span> <span class="token number">01</span><span class="token punctuation">,</span> <span class="token number">01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	d2<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token number">2025</span><span class="token punctuation">,</span> <span class="token number">01</span><span class="token punctuation">,</span> <span class="token number">01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/57/43/aOGJJ5qu_o.png" alt="在这里插入图片描述"></p> 
<p>从反汇编代码中，我们发现两个对象分别调用的成员函数地址是相同的。</p> 
<p>所以<strong>类的成员变量、成员函数到底是如何存储的呢？</strong></p> 
<h3><a id="_417"></a>类对象的存储方式</h3> 
<p><strong>每个对象中存储各自的成员变量</strong>，成员函数因为要反复被不同的对象调用，所以<strong>成员函数存储在一段公共的区域</strong>。</p> 
<p><img src="https://images2.imgbox.com/7e/2e/3DrolxYS_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">A2</span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
   <span class="token keyword">void</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>这个类的大小是多少呢？</p> 
<p><img src="https://images2.imgbox.com/b6/fc/oVB5IYZp_o.png" alt="在这里插入图片描述"></p> 
<p><strong>在C++中，没有成员变量的类对象大小占位1字节，不实际存储任何数据，是为了标识该对象已经被实例化了。</strong></p> 
<p>对于给出的A2类，因为它只含有一个成员函数，<strong>它所占用的内存大小应该是1字节</strong></p> 
<p>再看下面的<font color="blue"><strong>代码示例：将p设为空指针，p还能调用函数吗？</strong></font></p> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">fun</span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"被调用"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	fun a1<span class="token punctuation">;</span>
	fun<span class="token operator">*</span> p1 <span class="token operator">=</span> <span class="token operator">&amp;</span>a1<span class="token punctuation">;</span>
	p1<span class="token operator">-&gt;</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	fun<span class="token operator">*</span> p <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
	p<span class="token operator">-&gt;</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>测试：</p> 
<p><img src="https://images2.imgbox.com/5a/0f/xRShMtGe_o.png" alt="在这里插入图片描述"><br> 可以调用的原因：</p> 
<p><strong>这里的<code>Print</code>函数并不在指针指向的空间里面，既不在p1指向的空间里面，也不再p指向的空间里面</strong>，p1，p指向的是对象，对象里面没有函数的地址，虽然有箭头，但是并没有进行解引用。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/74a9a32a609c9118206bf7313b9233e9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">iphone无线调试（通过wifi无线来调试真机）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/13d0b3933a46f0554d8e97443a82398c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【AI智能体】零代码构建AI应用《情感伴侣》情感倾听，温暖陪伴，快来体验吧。</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>