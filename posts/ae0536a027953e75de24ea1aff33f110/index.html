<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用SQLite - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/ae0536a027953e75de24ea1aff33f110/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="使用SQLite">
  <meta property="og:description" content="自学python如何成为大佬(目录):https://blog.csdn.net/weixin_67859959/article/details/139049996?spm=1001.2014.3001.5501
与许多其他数据库管理系统不同，SQLite不是一个客户端/服务器结构的数据库引擎，而是一种嵌入式数据库，它的数据库就是一个文件。SQLite将整个数据库，包括定义、表、索引以及数据本身，作为一个单独的、可跨平台使用的文件存储在主机中。由于SQLite本身是C写的，而且体积很小，所以，经常被集成到各种应用程序中。Python就内置了SQLite3，所以在Python中使用SQLite，不需要安装任何模块，直接使用。
1 创建数据库文件
由于Python中已经内置了SQLite3，所以可以直接使用import语句导入SQLite3模块。Python操作数据库的通用的流程如图1所示。
图1 操作数据库流程
实例01 创建SQLite数据库文件
创建一个mrsoft.db的数据库文件，然后执行SQL语句创建一个user（用户表），user表包含id和name两个字段。具体代码如下：
import sqlite3
# 连接到SQLite数据库
# 数据库文件是mrsoft.db，如果文件不存在，会自动在当前目录创建
conn = sqlite3.connect(&#39;mrsoft.db&#39;)
# 创建一个Cursor
cursor = conn.cursor()
# 执行一条SQL语句，创建user表 cursor.execute(&#39;create table user (id int(10) primary key, name varchar(20))&#39;)
# 关闭游标
cursor.close()
# 关闭Connection
conn.close()
上述代码中，使用sqlite3.connect()方法连接SQLite数据库文件mrsoft.db，由于mrsoft.db文件并不存在，所以会在本实例Python代码同级目录下创建mrsoft.db文件，该文件包含了user表的相关信息。mrsoft.db文件所在目录如图2所示。
图2 mrsoft.db文件所在目录
说明：再次运行实例01时，会提示错误信息：sqlite3.OperationalError:table user alread exists，这是因为user表已经存在。
2 操作SQLite
（1）新增用户数据信息
为了向数据表中新增数据，可以使用如下SQL语句：
insert into 表名(字段名1,字段名2,…,字段名n) values (字段值1,字段值2,…,字段值n)
在user表中，有2个字段，字段名分别为id和name。而字段值需要根据字段的数据类型来赋值，如id是一个长度为10的整型，name是长度为20的字符串型数据。向user表中插入3条用户信息记录，则SQL语句如下：
cursor.execute(&#39;insert into user (id, name) values (&#34;1&#34;, &#34;MRSOFT&#34;)&#39;)
cursor.execute(&#39;insert into user (id, name) values (&#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-11T21:14:21+08:00">
    <meta property="article:modified_time" content="2024-06-11T21:14:21+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">使用SQLite</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>自学python如何成为大佬(目录):<a href="https://blog.csdn.net/weixin_67859959/article/details/139049996?spm=1001.2014.3001.5501" title="https://blog.csdn.net/weixin_67859959/article/details/139049996?spm=1001.2014.3001.5501">https://blog.csdn.net/weixin_67859959/article/details/139049996?spm=1001.2014.3001.5501</a></p> 
<p>与许多其他数据库管理系统不同，SQLite不是一个客户端/服务器结构的数据库引擎，而是一种嵌入式数据库，它的数据库就是一个文件。SQLite将整个数据库，包括定义、表、索引以及数据本身，作为一个单独的、可跨平台使用的文件存储在主机中。由于SQLite本身是C写的，而且体积很小，所以，经常被集成到各种应用程序中。Python就内置了SQLite3，所以在Python中使用SQLite，不需要安装任何模块，直接使用。</p> 
<p>1  创建数据库文件</p> 
<p>由于Python中已经内置了SQLite3，所以可以直接使用import语句导入SQLite3模块。Python操作数据库的通用的流程如图1所示。</p> 
<p></p> 
<p class="img-center"><img alt="" height="191" src="https://images2.imgbox.com/71/b9/2IPzY4Ab_o.png" width="606"></p> 
<p>图1  操作数据库流程</p> 
<p></p> 
<p class="img-center"><img alt="图标 (35)" height="16" src="https://images2.imgbox.com/ab/cd/YD397xGN_o.png" width="16"></p> 
<p>  实例01  创建SQLite数据库文件</p> 
<p>创建一个mrsoft.db的数据库文件，然后执行SQL语句创建一个user（用户表），user表包含id和name两个字段。具体代码如下：</p> 
<p>import sqlite3</p> 
<p># 连接到SQLite数据库</p> 
<p># 数据库文件是mrsoft.db，如果文件不存在，会自动在当前目录创建</p> 
<p>conn = sqlite3.connect('mrsoft.db')</p> 
<p># 创建一个Cursor</p> 
<p>cursor = conn.cursor()</p> 
<p># 执行一条SQL语句，创建user表                   </p> 
<p>cursor.execute('create  table  user (id int(10)  primary key, name varchar(20))')</p> 
<p># 关闭游标</p> 
<p>cursor.close()</p> 
<p># 关闭Connection</p> 
<p>conn.close()</p> 
<p>上述代码中，使用sqlite3.connect()方法连接SQLite数据库文件mrsoft.db，由于mrsoft.db文件并不存在，所以会在本实例Python代码同级目录下创建mrsoft.db文件，该文件包含了user表的相关信息。mrsoft.db文件所在目录如图2所示。</p> 
<p></p> 
<p class="img-center"><img alt="" height="236" src="https://images2.imgbox.com/21/f7/ymoVXU4g_o.png" width="462"></p> 
<p>图2  mrsoft.db文件所在目录</p> 
<p>说明：再次运行实例01时，会提示错误信息：sqlite3.OperationalError:table user alread exists，这是因为user表已经存在。</p> 
<p>2  操作SQLite</p> 
<p>（1）新增用户数据信息</p> 
<p>为了向数据表中新增数据，可以使用如下SQL语句：</p> 
<p>insert into 表名(字段名1,字段名2,…,字段名n)  values (字段值1,字段值2,…,字段值n)</p> 
<p>在user表中，有2个字段，字段名分别为id和name。而字段值需要根据字段的数据类型来赋值，如id是一个长度为10的整型，name是长度为20的字符串型数据。向user表中插入3条用户信息记录，则SQL语句如下：</p> 
<p>cursor.execute('insert into user (id, name) values ("1", "MRSOFT")')</p> 
<p>cursor.execute('insert into user (id, name) values ("2", "Andy")')</p> 
<p>cursor.execute('insert into user (id, name) values ("3", "明日科技小助手")')</p> 
<p>下面通过一个实例介绍向SQLite数据库中插入数据的流程。</p> 
<p></p> 
<p class="img-center"><img alt="图标 (35)" height="16" src="https://images2.imgbox.com/f9/60/4z7GQQ6o_o.png" width="16"></p> 
<p>  实例02  新增用户数据信息</p> 
<p>由于在实例01中已经创建了user表，所以本实例可以直接操作user表，向user表中插入3条用户信息。此外，由于是新增数据，需要使用commit()方法提交事务。因为对于增加、修改和删除操作，使用commit()方法提交事务后，如果相应操作失败，可以使用rollback()方法回滚到操作之前的状态。新增用户数据信息具体代码如下：</p> 
<p>import sqlite3</p> 
<p># 连接到SQLite数据库</p> 
<p># 数据库文件是mrsoft.db</p> 
<p># 如果文件不存在，会自动在当前目录创建</p> 
<p>conn = sqlite3.connect('mrsoft.db')</p> 
<p># 创建一个Cursor</p> 
<p>cursor = conn.cursor()</p> 
<p># 执行一条SQL语句，插入一条记录</p> 
<p>cursor.execute('insert into user (id, name) values ("1", "MRSOFT")')</p> 
<p>cursor.execute('insert into user (id, name) values ("2", "Andy")')</p> 
<p>cursor.execute('insert into user (id, name) values ("3", "明日科技小助手")')</p> 
<p># 关闭游标</p> 
<p>cursor.close()</p> 
<p># 提交事务</p> 
<p>conn.commit()</p> 
<p># 关闭Connection</p> 
<p>conn.close()</p> 
<p>运行该实例，会向user表中插入3条记录。为验证程序是否正常运行，可以再次运行，如果提示如下信息，说明插入成功（因为user表中已经保存了上一次插入的记录，所以再次插入会报错）。</p> 
<p>sqlite3.IntegrityError: UNIQUE constraint failed: user.id</p> 
<p>（2）查看用户数据信息</p> 
<p>查找user表中的数据可以使用如下SQL语句：</p> 
<p>select  字段名1,字段名2,字段名3,… from 表名  where 查询条件</p> 
<p>查看用户信息的代码与插入数据信息大致相同，不同点在于使用的SQL语句不同。此外，查询数据时通常使用如下3种方式：</p> 
<p>l  fetchone()：获取查询结果集中的下一条记录。</p> 
<p>l  fetchmany(size)：获取指定数量的记录。</p> 
<p>l  fetchall()：获取结果集的所有记录。</p> 
<p>下面通过一个实例来学习这3种查询方式的区别。</p> 
<p></p> 
<p class="img-center"><img alt="图标 (35)" height="16" src="https://images2.imgbox.com/bd/c7/HbIrPp8Y_o.png" width="16"></p> 
<p>  实例03  使用3种方式查询用户数据信息</p> 
<p>分别使用fetchone、fetchmany和fetchall这3种方式查询用户信息，具体代码如下：</p> 
<p>import sqlite3</p> 
<p># 连接到SQLite数据库,数据库文件是mrsoft.db</p> 
<p>conn = sqlite3.connect('mrsoft.db')</p> 
<p># 创建一个Cursor</p> 
<p>cursor = conn.cursor()</p> 
<p># 执行查询语句</p> 
<p>cursor.execute('select * from user')</p> 
<p># 获取查询结果</p> 
<p>result1 = cursor.fetchone()</p> 
<p>print(result1)</p> 
<p></p> 
<p># 关闭游标</p> 
<p>cursor.close()</p> 
<p># 关闭Connection</p> 
<p>conn.close()</p> 
<p>使用fetchone()方法返回的result1为一个元组，执行结果如下：</p> 
<p>(1,'MRSOFT')</p> 
<p>（1）修改实例03代码，将获取查询结果的语句块代码修改为：</p> 
<p>result2 = cursor.fetchmany(2)     # 使用fetchmany方法查询多条数据</p> 
<p>print(result2)</p> 
<p>使用fetchmany()方法传递一个参数，其值为2，默认为1。返回的result2为一个列表，列表中包含2个元组，运行结果如下：</p> 
<p>[(1,'MRSOFT'),(2,'Andy')]</p> 
<p>（2）修改实例03代码，将获取查询结果的语句块代码修改为：</p> 
<p>result3 = cursor.fetchall()         # 使用fetchmany方法查询多条数据</p> 
<p>print(result3)</p> 
<p>使用fetchall()方法返回的result3为一个列表，列表中包含所有user表中数据组成的元组，运行结果如下：</p> 
<p> [(1,'MRSOFT'),(2,'Andy'),(3,'明日科技小助手')]</p> 
<p>（3）修改实例03代码，将获取查询结果的语句块代码修改为：</p> 
<p>cursor.execute('select * from user where id &gt; ?',(1,))</p> 
<p>result3 = cursor.fetchall()</p> 
<p>print(result3)</p> 
<p>在select查询语句中，使用问号作为占位符代替具体的数值，然后使用一个元组来替换问号（注意，不要忽略元组中最后的逗号）。上述查询语句等价于：</p> 
<p>cursor.execute('select * from user where id &gt; 1')</p> 
<p>执行结果如下：</p> 
<p>[(2,'Andy'),(3,'明日科技小助手')]</p> 
<p></p> 
<p>说明：使用占位符的方式可以避免SQL注入的风险，推荐使用这种方式。</p> 
<p>（3）修改用户数据信息</p> 
<p>修改user表中的数据可以使用如下SQL语句：</p> 
<p>update  表名  set 字段名 = 字段值  where 查询条件</p> 
<p>下面通过一个实例来学习一下如何修改表中数据。</p> 
<p></p> 
<p class="img-center"><img alt="图标 (35)" height="16" src="https://images2.imgbox.com/98/dc/xgsrN5eB_o.png" width="16"></p> 
<p>  实例04  修改用户数据信息</p> 
<p>将SQLite数据库中user表ID为1的数据name字段值“mrsoft”修改为“MR”，并使用fetchAll获取表中的所有数据。具体代码如下：</p> 
<p>import sqlite3</p> 
<p># 连接到SQLite数据库，数据库文件是mrsoft.db</p> 
<p>conn = sqlite3.connect('mrsoft.db')</p> 
<p># 创建一个Cursor:</p> 
<p>cursor = conn.cursor()</p> 
<p>cursor.execute('update user set name = ? where id = ?',('MR',1))</p> 
<p>cursor.execute('select * from user')</p> 
<p>result = cursor.fetchall()</p> 
<p>print(result)</p> 
<p># 关闭游标</p> 
<p>cursor.close()</p> 
<p># 提交事务</p> 
<p>conn.commit()</p> 
<p># 关闭Connection:</p> 
<p>conn.close()</p> 
<p>执行结果如下：</p> 
<p>[(1, 'MR'), (2, 'Andy'), (3, '明日科技小助手')]</p> 
<p>（4）删除用户数据信息</p> 
<p>删除user表中的数据可以使用如下SQL语句：</p> 
<p>delete  from 表名  where 查询条件</p> 
<p>下面通过一个实例来学习如何删除表中数据。</p> 
<p></p> 
<p class="img-center"><img alt="图标 (35)" height="16" src="https://images2.imgbox.com/58/75/O49LZlUL_o.png" width="16"></p> 
<p>  实例05  删除用户数据信息</p> 
<p>将SQLite数据库中user表ID为1的数据删除，并使用fetchAll获取表中的所有数据，查看删除后的结果。具体代码如下：</p> 
<p>import sqlite3</p> 
<p># 连接到SQLite数据库，数据库文件是mrsoft.db</p> 
<p>conn = sqlite3.connect('mrsoft.db')</p> 
<p># 创建一个Cursor:</p> 
<p>cursor = conn.cursor()</p> 
<p>cursor.execute('delete from user where id = ?',(1,))</p> 
<p>cursor.execute('select * from user')</p> 
<p>result = cursor.fetchall()</p> 
<p>print(result)</p> 
<p># 关闭游标</p> 
<p>cursor.close()</p> 
<p># 提交事务</p> 
<p>conn.commit()</p> 
<p># 关闭Connection:</p> 
<p>conn.close()</p> 
<p>执行上述代码后，user表中ID为1的数据将被删除。运行结果如下：</p> 
<p> [(2, 'Andy'), (3, '明日科技小助手')]</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/88/93/jvJcqxD7_o.gif"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c4752193c989970e6299cd9f6d7ba568/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">2024年最佳AI大模型-LLM排名（非常详细）零基础入门到精通，收藏这一篇就够了</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3d7110e32b67bd83b4a46a3afcbce620/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【深度学习】使用 LSTM 网络预测水位数据</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>