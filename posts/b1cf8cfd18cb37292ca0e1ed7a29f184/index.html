<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【算法/训练】：前缀和&amp;&amp;差分 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/b1cf8cfd18cb37292ca0e1ed7a29f184/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【算法/训练】：前缀和&&差分">
  <meta property="og:description" content="✨ 海压竹枝低复举，风吹山角晦还明 🌏 📃个人主页：island1314
🔥个人专栏：算法训练
🚀 欢迎关注：👍点赞 👂🏽留言 😍收藏 💞 💞 💞
目录
目录
🚀 前言：
1. 校门外的树
2. 值周
3. [CQOI2009]中位数图
4. [HNOI2003]激光炸弹
5. 二分
6. 货仓选址
🚀 前言： 前面我们已经通过 【算法/学习】前缀和&amp;&amp;差分-CSDN博客 学习了前缀和&amp;&amp;差分的效相关知识，现在我们开始进行相关题目的练习吧
1. 校门外的树 思路：给[0, n]的数组都标记为1，然后输出m行范围，[l, r]都标记为0。
AC代码如下：
#include &lt;iostream&gt; using namespace std; const int N = 1e5 &#43; 10; int a[N]; int main() { int n, m; cin&gt;&gt;n&gt;&gt;m; for(int i = 0; i &lt;= n; i&#43;&#43;) a[i] = 1; int l, r; for(int i = 1; i &lt;= m; i&#43;&#43;) { cin&gt;&gt;l&gt;&gt;r; for(int j = l; j &lt;= r; j&#43;&#43;) a[j] = 0; } int cnt = 0; for(int i = 0; i &lt;= n; i&#43;&#43;) { if(a[i] == 1) cnt&#43;&#43;; } cout&lt;&lt;cnt&lt;&lt;endl; return 0; } 2.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-26T14:20:50+08:00">
    <meta property="article:modified_time" content="2024-07-26T14:20:50+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【算法/训练】：前缀和&amp;&amp;差分</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>✨                                                      <span style="color:#4da8ee;"><strong> 海压竹枝低复举，风吹山角晦还明 </strong></span>     🌏 </p> 
<p>📃<a href="https://so.csdn.net/so/search?q=%E4%B8%AA%E4%BA%BA%E4%B8%BB%E9%A1%B5&amp;spm=1001.2101.3001.7020" title="个人主页">个人主页</a>：<a href="https://blog.csdn.net/island1314?spm=1011.2266.3001.5343" title="island1314">island1314</a></p> 
<p>🔥个人专栏：<a href="https://blog.csdn.net/island1314/category_12727921.html" title="算法训练">算法训练</a></p> 
<p>🚀 欢迎关注：👍点赞 👂🏽留言 😍收藏  💞 💞 💞</p> 
<p></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/46/ef/pcoqk7fv_o.gif"></p> 
<hr> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="%F0%9F%9A%80%C2%A0%E5%89%8D%E8%A8%80%EF%BC%9A-toc" style="margin-left:40px;"><a href="#%F0%9F%9A%80%C2%A0%E5%89%8D%E8%A8%80%EF%BC%9A" rel="nofollow">🚀 前言：</a></p> 
<p id="1.%C2%A0%E6%A0%A1%E9%97%A8%E5%A4%96%E7%9A%84%E6%A0%91-toc" style="margin-left:40px;"><a href="#1.%C2%A0%E6%A0%A1%E9%97%A8%E5%A4%96%E7%9A%84%E6%A0%91" rel="nofollow">1. 校门外的树</a></p> 
<p id="2.%C2%A0%E5%80%BC%E5%91%A8-toc" style="margin-left:40px;"><a href="#2.%C2%A0%E5%80%BC%E5%91%A8" rel="nofollow">2. 值周</a></p> 
<p id="3.%C2%A0%5BCQOI2009%5D%E4%B8%AD%E4%BD%8D%E6%95%B0%E5%9B%BE-toc" style="margin-left:40px;"><a href="#3.%C2%A0%5BCQOI2009%5D%E4%B8%AD%E4%BD%8D%E6%95%B0%E5%9B%BE" rel="nofollow">3. [CQOI2009]中位数图</a></p> 
<p id="4.%C2%A0%5BHNOI2003%5D%E6%BF%80%E5%85%89%E7%82%B8%E5%BC%B9-toc" style="margin-left:40px;"><a href="#4.%C2%A0%5BHNOI2003%5D%E6%BF%80%E5%85%89%E7%82%B8%E5%BC%B9" rel="nofollow">4. [HNOI2003]激光炸弹</a></p> 
<p id="5.%C2%A0%E4%BA%8C%E5%88%86-toc" style="margin-left:40px;"><a href="#5.%C2%A0%E4%BA%8C%E5%88%86" rel="nofollow">5. 二分</a></p> 
<p id="6.%C2%A0%E8%B4%A7%E4%BB%93%E9%80%89%E5%9D%80-toc" style="margin-left:40px;"><a href="#6.%C2%A0%E8%B4%A7%E4%BB%93%E9%80%89%E5%9D%80" rel="nofollow">6. 货仓选址</a></p> 
<hr id="hr-toc"> 
<p></p> 
<hr> 
<p></p> 
<h3 id="%F0%9F%9A%80%C2%A0%E5%89%8D%E8%A8%80%EF%BC%9A">🚀 前言：</h3> 
<p>前面我们已经通过  <a href="https://blog.csdn.net/island1314/article/details/140610205?spm=1001.2014.3001.5501" title="【算法/学习】前缀和&amp;&amp;差分-CSDN博客">【算法/学习】前缀和&amp;&amp;差分-CSDN博客</a>  学习了前缀和&amp;&amp;差分的效相关知识，现在我们开始进行相关题目的练习吧</p> 
<h3></h3> 
<h3 id="1.%C2%A0%E6%A0%A1%E9%97%A8%E5%A4%96%E7%9A%84%E6%A0%91">1. <a href="https://ac.nowcoder.com/acm/problem/16649" rel="nofollow" title="校门外的树">校门外的树</a></h3> 
<p><img alt="" height="1021" src="https://images2.imgbox.com/ad/0a/XSj2py85_o.png" width="1187"></p> 
<blockquote> 
 <p><strong>思路：</strong>给[0, n]的数组都标记为1，然后输出m行范围，[l, r]都标记为0。</p> 
</blockquote> 
<p><span style="color:#a2e043;"><strong>AC代码</strong></span>如下：</p> 
<pre><code class="language-cpp">#include &lt;iostream&gt;
using namespace std;
const int N = 1e5 + 10;
int a[N];
int main()
{
    int n, m;
    cin&gt;&gt;n&gt;&gt;m;
    for(int i = 0; i &lt;= n; i++) a[i] = 1;
    int l, r;
    for(int i = 1; i &lt;= m; i++)
    {
        cin&gt;&gt;l&gt;&gt;r;
        for(int j = l; j &lt;= r; j++) a[j] = 0;
    }
    int cnt = 0;
    for(int i = 0; i &lt;= n; i++) {
        if(a[i] == 1) cnt++;
    }
    cout&lt;&lt;cnt&lt;&lt;endl;
    return 0;
}</code></pre> 
<hr> 
<h3 id="2.%C2%A0%E5%80%BC%E5%91%A8">2. <a href="https://ac.nowcoder.com/acm/problem/24636" rel="nofollow" title="值周">值周</a></h3> 
<p><img alt="" height="1063" src="https://images2.imgbox.com/75/24/qnk7sqFg_o.png" width="1197"></p> 
<blockquote> 
 <p><strong>思路：</strong></p> 
 <p>该题与上题意思相同，但是数据范围更大，因此我们不能使用上面的方法，我们可以使用前缀和，使让数组a内的数据先初始化为0，然后对[ l, r ]进行操作，a[l]--, a[r + 1]++，然后操作M次后，再 a[i] += a[i - 1];这样可以使得每个区域内的数都小于0.</p> 
</blockquote> 
<p><span style="color:#a2e043;"><strong>AC代码</strong></span>如下：</p> 
<pre><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;algorithm&gt;
using namespace std;
const int N = 1e7 + 10;

int a[N];

int main()
{
    int n, m;
    cin &gt;&gt; n &gt;&gt; m;
    int l, r;
    for (int i = 0; i &lt; m; i++){
        cin &gt;&gt; l &gt;&gt; r;
        a[l]--, a[r + 1]++;  //前缀和，l-r标记为-1，r + 1又标记为1
    }
    for (int i = 1; i &lt;= n; i++)
    {
        a[i] += a[i - 1];
    }
    int ans = 0;
    for (int i = 0; i &lt;= n; i++)
    {
        if (a[i] &gt;= 0) ans++;
    }
    cout &lt;&lt; ans &lt;&lt; endl;
    return 0;
}</code></pre> 
<hr> 
<h3 id="3.%C2%A0%5BCQOI2009%5D%E4%B8%AD%E4%BD%8D%E6%95%B0%E5%9B%BE">3. <a href="https://ac.nowcoder.com/acm/problem/19913" rel="nofollow" title="[CQOI2009]中位数图">[CQOI2009]中位数图</a></h3> 
<p><img alt="" height="1171" src="https://images2.imgbox.com/e1/c4/3HP5bVRo_o.png" width="1185"></p> 
<blockquote> 
 <p>思路：</p> 
 <p>🔥1.由于是求中位数是b的连续子序列，那么我们只要找到一串连续的数，里面包含数b，且大于b的数的数目与小于b的数的数目相等，才是我们要找的序列。<br> 🔥2.由于数据范围给的比较大，我们可以简化一下，<strong>把比b大的数直接赋值为1，小的就赋值为-1.</strong><br> 同时，我们再用一个sum来求和，sum往一边统计的时候，当sum==0的时候说明大于b的数的数目与小于b的数的数目相等，也就是我们找到了一个序列。<br> 🔥3.那么两边都有的情况怎么考虑呢？我们可以往一边记录，用一个num数组来记录sum的加减情况。<br> 我们可以来看一下题目的样例：<br> {5，7，2，4，3，1，6}-&gt;{1，1，-1，4，-1，-1，1}<br> 🔥往左遍历：<br><strong>      1</strong>.sum+=-1--&gt;sum==-1,可以这样，num[n+sum]+=1,也就是左边有一个比b小的情况加1.<br><strong>       2.</strong>sum+=1-&gt;sum==0,num[n+sum]+=1，左边刚好找到一个成功的序列，ans++.<br><strong>      3.</strong>sum+=1--&gt;sum==1,num[n+sum]+=1,左边有一个比b大的情况加一。<br> 🔥现在往右遍历：<br>       先初始化sum=0.<br><strong>      然后</strong>sum+=-1-&gt;sum==-1,右边找到了一个比b小的数，而num[n+1]表示左边有一个比b小的情况的数目，也就是num[n-sum],我们可以用ans+=num[n-sum]。<br> 后面同理，最后ans==4.<strong>（ans初始值为1，因为自己本身也是一个序列）</strong></p> 
</blockquote> 
<pre><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;vector&gt;
using namespace std;

typedef long long ll;

const int N = 1e6 + 10;
ll a[N], s[N];

int main()
{
	int n, b;
	cin &gt;&gt; n &gt;&gt; b;
	int pos, x;
	for (int i = 1; i &lt;= n; i++)
	{
		cin &gt;&gt; a[i];
		if (a[i] &gt; b)a[i] = 1;
		else if (a[i] &lt; b) a[i] = -1;
		else pos = i;//标记中位数的位置
	}

	ll sum = 0, ans = 1; //自己也算一个
	for (int i = pos - 1; i &gt;= 1; i--) {
		sum += a[i];
		s[n + sum]++; //记录左边和为sum的数量
		if (!sum) ans++; //sum为零就说明小于b的数的数量于大于b的数量相同
	}
	sum = 0; //再往右遍历，同时与左边比较
	for (int i = pos + 1; i &lt;= n; i++) {
		sum += a[i];
		ans += s[n - sum]; //加上左边与其互补的数量
		if (!sum) ans++;
	}
	cout &lt;&lt; ans &lt;&lt; endl;
}</code></pre> 
<h3 id="4.%C2%A0%5BHNOI2003%5D%E6%BF%80%E5%85%89%E7%82%B8%E5%BC%B9" style="background-color:transparent;">4. <a href="https://ac.nowcoder.com/acm/problem/20032" rel="nofollow" title="[HNOI2003]激光炸弹">[HNOI2003]激光炸弹</a></h3> 
<h3 id="%E2%80%8B%E7%BC%96%E8%BE%91"><img alt="" height="936" src="https://images2.imgbox.com/a3/9b/WEV3IlTs_o.png" width="1146"></h3> 
<blockquote> 
 <p>思路：</p> 
 <p>先用二维前缀和的公式，求出g[x][y]的矩阵内的价值，然后就开始记录哪个正方形内的价值最大即可</p> 
</blockquote> 
<pre><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;vector&gt;
#include &lt;cstring&gt;
using namespace std;

typedef long long ll;
int n, R;
int g[5005][5005];

int main()
{
	cin &gt;&gt; n &gt;&gt; R;
	memset(g, 0, sizeof g);
	int xx = R, yy = R; //xx和yy表示边界，初始化为最小的R
	for (int i = 0; i &lt; n; i++)
	{
		int x, y, v;
		cin &gt;&gt; x &gt;&gt; y &gt;&gt; v;
		g[x][y] = v;
		xx = max(xx, x); //记录输入的最大边
		yy = max(yy, y); 
	}

	for (int i = 1; i &lt;= xx; i++){
		for (int j = 1; j &lt;= yy; j++){
			g[i][j] = g[i - 1][j] + g[i][j - 1] - g[i - 1][j - 1] + g[i][j];
		}
	}

	int ans = 0;
	for (int i = R; i &lt;= xx; i++){
		for (int j = R; j &lt;= yy; j++) {
			ans = max(ans, g[i][j] - g[i - R][j] - g[i][j - R] + g[i - R][j - R]);
		}
	}
	
	cout &lt;&lt; ans &lt;&lt; endl;
	return 0;
}</code></pre> 
<p></p> 
<h3 id="5.%C2%A0%E4%BA%8C%E5%88%86" style="background-color:transparent;">5. <a href="https://ac.nowcoder.com/acm/problem/207053" rel="nofollow" title="二分">二分</a></h3> 
<h3><img alt="" height="1032" src="https://images2.imgbox.com/35/a3/D0xc8qU0_o.png" width="1184"></h3> 
<blockquote> 
 <p>思路：</p> 
 <p>题意是求裁判最多说对了几次。</p> 
 <p>对于每次猜数，如果猜的数是𝑎a，那么根据题目有三种情况：</p> 
 <ul><li> <p>数大了：说对的范围是(−inf⁡,𝑎](−inf,a]</p> </li><li> <p>数小了：说对的范围是[𝑎,+inf⁡)[a,+inf)</p> </li><li> <p>数相等：说对的范围是[𝑎,𝑎+1)[a,a+1)</p> </li></ul> 
 <p>序列上操作，那么差分可以满足；然后把上面这些区间中，重叠次数最多的区间求出来，就是数所在的区间；这个区间重叠的次数就是我们要的答案。</p> 
 <p>由于数字较大，所以用了map搞离散化。</p> 
</blockquote> 
<pre><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;map&gt;
#include &lt;limits.h&gt;
using namespace std;

const int inf = INT_MAX;//int型数据最大值，因为是对每个数进行统计

const int N = 1e7 + 10;
int a[N];
char s[N];
map&lt;int, int&gt; mp;

int main() {
	int n;
	cin &gt;&gt; n;
	for (int i = 1; i &lt;= n; i++) cin &gt;&gt; a[i] &gt;&gt; s[i];
	for (int i = 1; i &lt;= n; i++){
		if (s[i] == '.') mp[a[i]]++, mp[a[i] + 1]--;
		if (s[i] == '+') mp[a[i]]--, mp[-inf]++;
		if (s[i] == '-')mp[inf]--, mp[a[i] + 1]++;
	}

	int ans = -inf, h = 0;
	for (auto e : mp){
		h += e.second;
		ans = max(h, ans);
	}

	cout &lt;&lt; ans &lt;&lt; endl;
}</code></pre> 
<h3 id="6.%C2%A0%E8%B4%A7%E4%BB%93%E9%80%89%E5%9D%80" style="background-color:transparent;">6. <a href="https://ac.nowcoder.com/acm/problem/50937" rel="nofollow" title="货仓选址">货仓选址</a></h3> 
<p><img alt="" height="829" src="https://images2.imgbox.com/fd/3f/62d1IhiN_o.png" width="1200"></p> 
<blockquote> 
 <p>思路：</p> 
 <p>如下图，选择n个仓库位置得中位数即可，</p> 
 <p>该问题的本质就是求 <img alt="C = \sum_{1}^{n} |a_{i} - p|" class="mathcode" src="https://images2.imgbox.com/80/af/aIBDEnlS_o.png"> 的最小总和即可，当我们以后遇到该类问题时，只要使得p为所有ai的中位数即可</p> 
</blockquote> 
<p><img alt="" height="600" src="https://images2.imgbox.com/37/21/09akcYIb_o.png" width="917"></p> 
<p></p> 
<pre><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;algorithm&gt;
#include &lt;vector&gt;
using namespace std;

int main(){
	int n;
	cin &gt;&gt; n;
	vector&lt;int&gt; a;
	for (int i = 0; i &lt; n; i++){
		int x;
		cin &gt;&gt; x;
		a.push_back(x);
	}
	sort(a.begin(), a.end());
	int p = a[a.size() / 2];
	int ans = 0;
	for (int i = 0; i &lt; n; i++) ans += abs(a[i] - p);
	cout &lt;&lt; ans &lt;&lt; endl;
	return 0;
}</code></pre> 
<p></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/27/46/3LOtfcKK_o.gif"></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b0b675228b46707d34ee1ccf32f0f1b3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Lua 类管理器</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9ff2782c5ec8513f501f02644d0f5864/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">在本地部署Ollama服务接口附加OpenWebUI做测试</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>