<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>机器学习-监督学习6大核心算法技术精讲与代码实战 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/a3851cc32a86fd0dba8a03ce994fb202/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="机器学习-监督学习6大核心算法技术精讲与代码实战">
  <meta property="og:description" content="监督学习线性回归、逻辑回归、决策树、支持向量机、K近邻、朴素贝叶斯算法精讲，模型评估精讲
关注作者，复旦AI博士，分享AI领域与云服务领域全维度开发技术。拥有10&#43;年互联网服务架构、AI产品研发经验、团队管理经验，同济本复旦硕博，复旦机器人智能实验室成员，国家级大学生赛事评审专家，发表多篇SCI核心期刊学术论文，阿里云认证的资深架构师，项目管理专业人士，上亿营收AI产品研发负责人。
目录 1. 介绍1.1 什么是监督学习监督学习的基本流程 1.2 监督学习与其他学习方法的比较无监督学习（Unsupervised Learning）强化学习（Reinforcement Learning） 1.3 监督学习的应用场景1.4 监督学习的挑战 2. 算法精讲2.1 线性回归2.1.1 线性回归简介2.1.2 线性回归的假设2.1.3 最小二乘法2.1.4 代码实现代码解释： 2.2 逻辑回归2.2.1 逻辑回归简介2.2.2 逻辑回归的假设2.2.3 逻辑回归的损失函数2.2.4 代码实现代码解释： 2.3 决策树2.3.1 决策树简介2.3.2 决策树构建过程2.3.3 纯净度指标2.3.4 决策树的优缺点2.3.5 代码实现代码解释：决策树剪枝2.3.6 决策树的应用场景 2.4 支持向量机2.4.1 支持向量机简介2.4.2 支持向量机的优化目标2.4.3 核函数2.4.4 支持向量机的优缺点2.4.5 代码实现代码解释：2.4.6 支持向量机的应用场景 2.5 K近邻2.5.1 K近邻简介2.5.2 距离度量2.5.3 选择K值2.5.4 K近邻的优缺点2.5.5 代码实现代码解释：2.5.6 K近邻的应用场景 监督学习精讲2. 常见算法2.6 朴素贝叶斯2.6.1 朴素贝叶斯简介2.6.2 朴素贝叶斯的类型2.6.3 朴素贝叶斯的优缺点2.6.4 代码实现代码解释：2.6.5 朴素贝叶斯的应用场景 监督学习精讲3. 模型评估与验证3.1 交叉验证3.1.1 K折交叉验证3.1.2 留一法交叉验证 3.2 过拟合与欠拟合3.2.1 过拟合3.2.2 欠拟合 3.3 混淆矩阵与分类报告3.4 ROC曲线与AUC代码示例代码解释： 1.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-12T09:30:00+08:00">
    <meta property="article:modified_time" content="2024-06-12T09:30:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">机器学习-监督学习6大核心算法技术精讲与代码实战</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>监督学习线性回归、逻辑回归、决策树、支持向量机、K近邻、朴素贝叶斯算法精讲，模型评估精讲</p> 
</blockquote> 
<blockquote> 
 <p>关注作者，复旦AI博士，分享AI领域与云服务领域全维度开发技术。拥有10+年互联网服务架构、AI产品研发经验、团队管理经验，同济本复旦硕博，复旦机器人智能实验室成员，国家级大学生赛事评审专家，发表多篇SCI核心期刊学术论文，阿里云认证的资深架构师，项目管理专业人士，上亿营收AI产品研发负责人。</p> 
</blockquote> 
<p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><ul><li><a href="#1__7" rel="nofollow">1. 介绍</a></li><li><ul><li><a href="#11__9" rel="nofollow">1.1 什么是监督学习</a></li><li><ul><li><a href="#_20" rel="nofollow">监督学习的基本流程</a></li></ul> 
    </li><li><a href="#12__30" rel="nofollow">1.2 监督学习与其他学习方法的比较</a></li><li><ul><li><a href="#Unsupervised_Learning_34" rel="nofollow">无监督学习（Unsupervised Learning）</a></li><li><a href="#Reinforcement_Learning_38" rel="nofollow">强化学习（Reinforcement Learning）</a></li></ul> 
    </li><li><a href="#13__42" rel="nofollow">1.3 监督学习的应用场景</a></li><li><a href="#14__52" rel="nofollow">1.4 监督学习的挑战</a></li></ul> 
   </li><li><a href="#2__61" rel="nofollow">2. 算法精讲</a></li><li><ul><li><a href="#21__63" rel="nofollow">2.1 线性回归</a></li><li><ul><li><a href="#211__67" rel="nofollow">2.1.1 线性回归简介</a></li><li><a href="#212__75" rel="nofollow">2.1.2 线性回归的假设</a></li><li><a href="#213__84" rel="nofollow">2.1.3 最小二乘法</a></li><li><a href="#214__90" rel="nofollow">2.1.4 代码实现</a></li><li><a href="#_152" rel="nofollow">代码解释：</a></li></ul> 
    </li><li><a href="#22__165" rel="nofollow">2.2 逻辑回归</a></li><li><ul><li><a href="#221__169" rel="nofollow">2.2.1 逻辑回归简介</a></li><li><a href="#222__175" rel="nofollow">2.2.2 逻辑回归的假设</a></li><li><a href="#223__181" rel="nofollow">2.2.3 逻辑回归的损失函数</a></li><li><a href="#224__187" rel="nofollow">2.2.4 代码实现</a></li><li><a href="#_257" rel="nofollow">代码解释：</a></li></ul> 
    </li><li><a href="#23__270" rel="nofollow">2.3 决策树</a></li><li><ul><li><a href="#231__274" rel="nofollow">2.3.1 决策树简介</a></li><li><a href="#232__278" rel="nofollow">2.3.2 决策树构建过程</a></li><li><a href="#233__286" rel="nofollow">2.3.3 纯净度指标</a></li><li><a href="#234__294" rel="nofollow">2.3.4 决策树的优缺点</a></li><li><a href="#235__306" rel="nofollow">2.3.5 代码实现</a></li><li><a href="#_345" rel="nofollow">代码解释：</a></li><li><a href="#_354" rel="nofollow">决策树剪枝</a></li><li><a href="#236__363" rel="nofollow">2.3.6 决策树的应用场景</a></li></ul> 
    </li><li><a href="#24__373" rel="nofollow">2.4 支持向量机</a></li><li><ul><li><a href="#241__377" rel="nofollow">2.4.1 支持向量机简介</a></li><li><a href="#242__383" rel="nofollow">2.4.2 支持向量机的优化目标</a></li><li><a href="#243__389" rel="nofollow">2.4.3 核函数</a></li><li><a href="#244__395" rel="nofollow">2.4.4 支持向量机的优缺点</a></li><li><a href="#245__407" rel="nofollow">2.4.5 代码实现</a></li><li><a href="#_462" rel="nofollow">代码解释：</a></li><li><a href="#246__472" rel="nofollow">2.4.6 支持向量机的应用场景</a></li></ul> 
    </li><li><a href="#25_K_482" rel="nofollow">2.5 K近邻</a></li><li><ul><li><a href="#251_K_486" rel="nofollow">2.5.1 K近邻简介</a></li><li><a href="#252__490" rel="nofollow">2.5.2 距离度量</a></li><li><a href="#253_K_496" rel="nofollow">2.5.3 选择K值</a></li><li><a href="#254_K_503" rel="nofollow">2.5.4 K近邻的优缺点</a></li><li><a href="#255__515" rel="nofollow">2.5.5 代码实现</a></li><li><a href="#_574" rel="nofollow">代码解释：</a></li><li><a href="#256_K_584" rel="nofollow">2.5.6 K近邻的应用场景</a></li></ul> 
   </li></ul> 
  </li></ul> 
  </li><li><a href="#_594" rel="nofollow">监督学习精讲</a></li><li><ul><li><a href="#2__596" rel="nofollow">2. 常见算法</a></li><li><ul><li><a href="#26__598" rel="nofollow">2.6 朴素贝叶斯</a></li><li><ul><li><a href="#261__602" rel="nofollow">2.6.1 朴素贝叶斯简介</a></li><li><a href="#262__608" rel="nofollow">2.6.2 朴素贝叶斯的类型</a></li><li><a href="#263__616" rel="nofollow">2.6.3 朴素贝叶斯的优缺点</a></li><li><a href="#264__627" rel="nofollow">2.6.4 代码实现</a></li><li><a href="#_666" rel="nofollow">代码解释：</a></li><li><a href="#265__675" rel="nofollow">2.6.5 朴素贝叶斯的应用场景</a></li></ul> 
   </li></ul> 
  </li></ul> 
  </li><li><a href="#_685" rel="nofollow">监督学习精讲</a></li><li><ul><li><a href="#3__687" rel="nofollow">3. 模型评估与验证</a></li><li><ul><li><a href="#31__691" rel="nofollow">3.1 交叉验证</a></li><li><ul><li><a href="#311_K_695" rel="nofollow">3.1.1 K折交叉验证</a></li><li><a href="#312__707" rel="nofollow">3.1.2 留一法交叉验证</a></li></ul> 
    </li><li><a href="#32__711" rel="nofollow">3.2 过拟合与欠拟合</a></li><li><ul><li><a href="#321__715" rel="nofollow">3.2.1 过拟合</a></li><li><a href="#322__730" rel="nofollow">3.2.2 欠拟合</a></li></ul> 
    </li><li><a href="#33__744" rel="nofollow">3.3 混淆矩阵与分类报告</a></li><li><a href="#34_ROCAUC_759" rel="nofollow">3.4 ROC曲线与AUC</a></li><li><ul><li><a href="#_769" rel="nofollow">代码示例</a></li><li><a href="#_825" rel="nofollow">代码解释：</a></li></ul> 
   </li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<p><img src="https://images2.imgbox.com/25/0b/EVlHgMVF_o.png" alt="file"></p> 
<h3><a id="1__7"></a>1. 介绍</h3> 
<h4><a id="11__9"></a>1.1 什么是监督学习</h4> 
<p><img src="https://images2.imgbox.com/ca/d0/GLeUHtUd_o.png" alt="file"><br> 监督学习（Supervised Learning）是机器学习的一个重要分支，其核心目标是通过已知的训练数据（包括输入和对应的输出）来学习一个映射函数，使其能够对未知的数据进行有效的预测。在监督学习的过程中，算法通过观察大量的示例数据，逐步调整其内部参数，使得预测结果尽可能接近真实值。</p> 
<p>具体而言，监督学习的任务可以分为两类：</p> 
<ul><li><strong>回归（Regression）</strong>：预测连续数值。例如，根据历史房价数据预测未来房价。</li><li><strong>分类（Classification）</strong>：预测离散标签。例如，根据邮件内容预测其是否为垃圾邮件。</li></ul> 
<p>在监督学习中，训练数据通常以特征-标签对（Feature-Label Pair）的形式存在。特征是用来描述数据点的属性，标签是我们希望预测的目标变量。例如，在垃圾邮件分类问题中，特征可以是邮件的词频，标签则是“垃圾邮件”或“非垃圾邮件”。</p> 
<h5><a id="_20"></a>监督学习的基本流程</h5> 
<ol><li><strong>数据收集</strong>：收集大量的已标注数据。标注数据包括输入特征和对应的输出标签。</li><li><strong>数据预处理</strong>：对数据进行清洗、处理和转换，以便于模型处理。包括处理缺失值、特征选择和特征工程等。</li><li><strong>模型选择</strong>：选择适合的算法，如线性回归、逻辑回归、决策树等。</li><li><strong>模型训练</strong>：使用训练数据来训练模型。模型通过不断调整其参数，使得预测结果尽可能接近真实标签。</li><li><strong>模型评估</strong>：使用独立的验证数据集评估模型性能。常见的评估指标有准确率、精确率、召回率等。</li><li><strong>模型优化</strong>：根据评估结果对模型进行调整和优化。</li><li><strong>模型部署</strong>：将训练好的模型应用到实际场景中进行预测。</li></ol> 
<h4><a id="12__30"></a>1.2 监督学习与其他学习方法的比较</h4> 
<p>为了更好地理解监督学习，有必要将其与其他常见的机器学习方法进行比较，主要包括无监督学习和强化学习。</p> 
<h5><a id="Unsupervised_Learning_34"></a>无监督学习（Unsupervised Learning）</h5> 
<p>无监督学习与监督学习的主要区别在于训练数据没有标签。在无监督学习中，算法需要自行发现数据的内在结构和模式。常见的无监督学习任务包括聚类（Clustering）和降维（Dimensionality Reduction）。例如，K-means算法用于将数据点聚类到不同的组中，而PCA（Principal Component Analysis）用于减少数据的维度。</p> 
<h5><a id="Reinforcement_Learning_38"></a>强化学习（Reinforcement Learning）</h5> 
<p>强化学习与监督学习的区别在于它关注的是如何在动态环境中通过试错来获得最大化的累积奖励。强化学习算法通过与环境不断交互，根据反馈奖励调整策略，以实现长期目标。例如，AlphaGo通过不断与自己对弈来提高棋艺，最终战胜了人类顶尖棋手。</p> 
<h4><a id="13__42"></a>1.3 监督学习的应用场景</h4> 
<p>监督学习在众多领域有广泛应用，以下是几个典型的应用场景：</p> 
<ul><li><strong>自然语言处理（NLP）</strong>：文本分类、情感分析、机器翻译等。</li><li><strong>计算机视觉</strong>：图像分类、人脸识别、目标检测等。</li><li><strong>金融科技</strong>：信用评分、股票价格预测、欺诈检测等。</li><li><strong>医疗健康</strong>：疾病预测、医学图像分析、基因组学数据分析等。</li><li><strong>推荐系统</strong>：根据用户历史行为推荐商品、电影、音乐等。</li></ul> 
<h4><a id="14__52"></a>1.4 监督学习的挑战</h4> 
<p>尽管监督学习在许多应用中表现出色，但它也面临一些挑战：</p> 
<ul><li><strong>数据标注成本高</strong>：获取大量高质量的标注数据通常需要耗费大量的人力和时间。</li><li><strong>模型泛化能力</strong>：训练模型如何在未见过的数据上表现良好，即避免过拟合。</li><li><strong>数据偏差和公平性</strong>：训练数据中的偏差可能导致模型在实际应用中表现不公平。</li><li><strong>计算资源需求</strong>：复杂模型的训练和预测过程需要大量的计算资源和时间。</li></ul> 
<h3><a id="2__61"></a>2. 算法精讲</h3> 
<h4><a id="21__63"></a>2.1 线性回归</h4> 
<p>线性回归（Linear Regression）是一种用于回归任务的基本且广泛应用的监督学习算法。它通过找到一条最佳拟合直线来预测目标变量（标签）的值。线性回归模型假设目标变量与输入特征之间存在线性关系，即目标变量可以表示为输入特征的线性组合。</p> 
<h5><a id="211__67"></a>2.1.1 线性回归简介</h5> 
<p>线性回归模型的形式可以表示为：</p> 
<p><img src="https://images2.imgbox.com/12/7a/E4nmgOP2_o.png" alt="file"></p> 
<p>线性回归的目标是通过最小化误差项来找到最佳的系数和截距项，从而使模型对训练数据的预测尽可能准确。</p> 
<h5><a id="212__75"></a>2.1.2 线性回归的假设</h5> 
<p>在应用线性回归时，需要满足以下几个基本假设：</p> 
<ol><li><strong>线性关系</strong>：目标变量与输入特征之间存在线性关系。</li><li><strong>独立性</strong>：误差项彼此独立。</li><li><strong>同方差性</strong>：误差项的方差恒定（即误差的分布不随输入特征的变化而变化）。</li><li><strong>正态分布</strong>：误差项服从正态分布。</li></ol> 
<h5><a id="213__84"></a>2.1.3 最小二乘法</h5> 
<p>线性回归中常用的参数估计方法是最小二乘法（Ordinary Least Squares, OLS），其目标是最小化残差平方和（Residual Sum of Squares, RSS）：</p> 
<p><img src="https://images2.imgbox.com/ea/ca/JoL7QCAd_o.png" alt="file"></p> 
<h5><a id="214__90"></a>2.1.4 代码实现</h5> 
<p>下面是使用Python和PyTorch实现线性回归的示例代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> torch
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>optim <span class="token keyword">as</span> optim
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token comment"># 生成样本数据</span>
np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
X <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> X <span class="token operator">+</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment"># 将数据转换为PyTorch张量</span>
X_tensor <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>X<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
y_tensor <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>y<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>

<span class="token comment"># 定义线性回归模型</span>
<span class="token keyword">class</span> <span class="token class-name">LinearRegressionModel</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>LinearRegressionModel<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>linear <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>linear<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

<span class="token comment"># 创建模型实例</span>
model <span class="token operator">=</span> LinearRegressionModel<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 定义损失函数和优化器</span>
criterion <span class="token operator">=</span> nn<span class="token punctuation">.</span>MSELoss<span class="token punctuation">(</span><span class="token punctuation">)</span>
optimizer <span class="token operator">=</span> optim<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">)</span>

<span class="token comment"># 训练模型</span>
num_epochs <span class="token operator">=</span> <span class="token number">1000</span>
<span class="token keyword">for</span> epoch <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    model<span class="token punctuation">.</span>train<span class="token punctuation">(</span><span class="token punctuation">)</span>
    optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>
    outputs <span class="token operator">=</span> model<span class="token punctuation">(</span>X_tensor<span class="token punctuation">)</span>
    loss <span class="token operator">=</span> criterion<span class="token punctuation">(</span>outputs<span class="token punctuation">,</span> y_tensor<span class="token punctuation">)</span>
    loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>
    optimizer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span>epoch<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">100</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'Epoch [</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>epoch<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>num_epochs<span class="token punctuation">}</span></span><span class="token string">], Loss: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>

<span class="token comment"># 打印模型参数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'Intercept (b0): </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>model<span class="token punctuation">.</span>linear<span class="token punctuation">.</span>bias<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'Coefficient (b1): </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>model<span class="token punctuation">.</span>linear<span class="token punctuation">.</span>weight<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>

<span class="token comment"># 可视化结果</span>
model<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
predicted <span class="token operator">=</span> model<span class="token punctuation">(</span>X_tensor<span class="token punctuation">)</span><span class="token punctuation">.</span>detach<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token string">'ro'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Original data'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span> predicted<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Fitted line'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="_152"></a>代码解释：</h5> 
<ol><li><strong>数据生成</strong>：使用随机数生成器生成输入特征 ( X ) 和目标变量 ( y )。</li><li><strong>数据转换</strong>：将numpy数组转换为PyTorch张量，以便进行模型训练。</li><li><strong>模型定义</strong>：定义一个简单的线性回归模型，包含一个线性层。</li><li><strong>模型实例化</strong>：创建模型实例。</li><li><strong>损失函数和优化器</strong>：使用均方误差（MSE）作为损失函数，随机梯度下降（SGD）作为优化器。</li><li><strong>模型训练</strong>：进行1000次迭代，每次迭代中计算预测值、损失，反向传播并更新模型参数。</li><li><strong>模型参数输出</strong>：输出训练好的模型的截距和系数。</li><li><strong>结果可视化</strong>：将原始数据和模型拟合的直线进行绘制。</li></ol> 
<p>通过上述过程，我们可以得到一个简单的线性回归模型，并可视化其拟合效果。这种模型在实际应用中具有广泛的用途，如预测房价、分析市场趋势等。尽管线性回归模型相对简单，但其背后的原理和方法为更复杂的模型奠定了基础，因此深入理解线性回归对学习其他机器学习算法具有重要意义。</p> 
<h4><a id="22__165"></a>2.2 逻辑回归</h4> 
<p>逻辑回归（Logistic Regression）是一种常用于二分类问题的监督学习算法。尽管名字中带有“回归”，逻辑回归实际是一种分类方法。它通过学习数据特征与目标变量之间的关系，预测目标变量属于某个类别的概率。</p> 
<h5><a id="221__169"></a>2.2.1 逻辑回归简介</h5> 
<p>逻辑回归的核心思想是使用逻辑函数（Logistic Function），又称为Sigmoid函数，将线性回归的输出映射到0和1之间的概率值。逻辑函数的数学表达式为：</p> 
<p><img src="https://images2.imgbox.com/a0/9b/6cdroIhy_o.png" alt="file"></p> 
<h5><a id="222__175"></a>2.2.2 逻辑回归的假设</h5> 
<ol><li><strong>线性可分性</strong>：逻辑回归假设特征与对数几率（log-odds）之间存在线性关系。</li><li><strong>独立性</strong>：样本彼此独立。</li><li><strong>同方差性</strong>：输入特征对目标变量的影响是恒定的。</li></ol> 
<h5><a id="223__181"></a>2.2.3 逻辑回归的损失函数</h5> 
<p>逻辑回归使用对数损失函数（Log Loss）来衡量预测值与真实值之间的差异，其形式为：</p> 
<p><img src="https://images2.imgbox.com/1b/d5/Vj0DDUoC_o.png" alt="file"></p> 
<h5><a id="224__187"></a>2.2.4 代码实现</h5> 
<p>以下是使用Python和PyTorch实现逻辑回归的示例代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> torch
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>optim <span class="token keyword">as</span> optim
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token comment"># 生成样本数据</span>
np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
X <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> <span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment"># 将数据转换为PyTorch张量</span>
X_tensor <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>X<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
y_tensor <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>y<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>

<span class="token comment"># 定义逻辑回归模型</span>
<span class="token keyword">class</span> <span class="token class-name">LogisticRegressionModel</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>LogisticRegressionModel<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>linear <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> torch<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>self<span class="token punctuation">.</span>linear<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 创建模型实例</span>
model <span class="token operator">=</span> LogisticRegressionModel<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 定义损失函数和优化器</span>
criterion <span class="token operator">=</span> nn<span class="token punctuation">.</span>BCELoss<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 二分类交叉熵损失</span>
optimizer <span class="token operator">=</span> optim<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span>

<span class="token comment"># 训练模型</span>
num_epochs <span class="token operator">=</span> <span class="token number">1000</span>
<span class="token keyword">for</span> epoch <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    model<span class="token punctuation">.</span>train<span class="token punctuation">(</span><span class="token punctuation">)</span>
    optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>
    outputs <span class="token operator">=</span> model<span class="token punctuation">(</span>X_tensor<span class="token punctuation">)</span>
    loss <span class="token operator">=</span> criterion<span class="token punctuation">(</span>outputs<span class="token punctuation">,</span> y_tensor<span class="token punctuation">)</span>
    loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>
    optimizer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span>epoch<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">100</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'Epoch [</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>epoch<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>num_epochs<span class="token punctuation">}</span></span><span class="token string">], Loss: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>

<span class="token comment"># 打印模型参数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'Intercept (b0): </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>model<span class="token punctuation">.</span>linear<span class="token punctuation">.</span>bias<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'Coefficients (b1, b2): </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>model<span class="token punctuation">.</span>linear<span class="token punctuation">.</span>weight<span class="token punctuation">.</span>data<span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>

<span class="token comment"># 可视化结果</span>
model<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">[</span>y<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span>y<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Class 0'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">[</span>y<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span>y<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Class 1'</span><span class="token punctuation">)</span>
    x1_min<span class="token punctuation">,</span> x1_max <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    x2_min<span class="token punctuation">,</span> x2_max <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    xx1<span class="token punctuation">,</span> xx2 <span class="token operator">=</span> np<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span>np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span>x1_min<span class="token punctuation">,</span> x1_max<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span>x2_min<span class="token punctuation">,</span> x2_max<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    grid <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>np<span class="token punctuation">.</span>c_<span class="token punctuation">[</span>xx1<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> xx2<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
    probs <span class="token operator">=</span> model<span class="token punctuation">(</span>grid<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>xx1<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>contour<span class="token punctuation">(</span>xx1<span class="token punctuation">,</span> xx2<span class="token punctuation">,</span> probs<span class="token punctuation">,</span> levels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">"Greys"</span><span class="token punctuation">,</span> vmin<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> vmax<span class="token operator">=</span><span class="token number">.6</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Feature 1'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Feature 2'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="_257"></a>代码解释：</h5> 
<ol><li><strong>数据生成</strong>：生成两个特征，目标变量根据特征和设定的条件生成二分类标签。</li><li><strong>数据转换</strong>：将生成的numpy数组转换为PyTorch张量，便于后续处理。</li><li><strong>模型定义</strong>：定义一个包含线性层和Sigmoid激活函数的逻辑回归模型。</li><li><strong>模型实例化</strong>：创建模型实例。</li><li><strong>损失函数和优化器</strong>：使用二分类交叉熵损失函数（BCELoss）和随机梯度下降（SGD）优化器。</li><li><strong>模型训练</strong>：进行1000次迭代，每次迭代中计算预测值、损失，反向传播并更新模型参数。</li><li><strong>模型参数输出</strong>：输出训练好的模型的截距和系数。</li><li><strong>结果可视化</strong>：将原始数据和模型的决策边界进行绘制。</li></ol> 
<p>通过上述过程，我们可以得到一个简单的逻辑回归模型，并可视化其决策边界。逻辑回归模型在二分类任务中具有广泛的应用，如垃圾邮件检测、癌症诊断等。尽管逻辑回归模型相对简单，但其在很多实际问题中仍然表现出色，并且为理解更复杂的分类算法奠定了基础。</p> 
<h4><a id="23__270"></a>2.3 决策树</h4> 
<p>决策树（Decision Tree）是一种常用的监督学习算法，可以用于回归和分类任务。决策树模型通过学习数据中的决策规则，将数据分割成不同的分支和叶子节点，从而实现预测目标变量的目的。决策树的结构类似于树状图，由根节点、内部节点和叶子节点组成，每个节点代表一个特征的决策。</p> 
<h5><a id="231__274"></a>2.3.1 决策树简介</h5> 
<p>决策树模型通过一系列的“是/否”问题将数据逐步分割，直至每个叶子节点包含相对纯净的数据。这种分割方式使得决策树具有很强的解释性，因为每个分割步骤都可以用简单的规则描述。</p> 
<h5><a id="232__278"></a>2.3.2 决策树构建过程</h5> 
<p>决策树的构建过程主要包括以下几个步骤：</p> 
<ol><li><strong>选择最佳分割点</strong>：在当前节点上选择一个特征及其分割点，使得数据按照该特征分割后，目标变量的纯净度最大化。</li><li><strong>递归分割数据</strong>：将数据按照选择的分割点分割成两部分，并对每部分数据重复上述步骤，直到满足停止条件（如达到最大深度或叶子节点纯净度足够高）。</li><li><strong>生成叶子节点</strong>：当无法进一步分割数据时，生成叶子节点，并将该节点的输出设为其包含数据的多数类（分类任务）或均值（回归任务）。</li></ol> 
<h5><a id="233__286"></a>2.3.3 纯净度指标</h5> 
<p>在选择最佳分割点时，通常使用纯净度指标来衡量分割效果。常见的纯净度指标包括：</p> 
<ul><li><strong>信息增益（Information Gain）</strong>：基于熵（Entropy）的变化量来衡量分割前后数据纯净度的变化。熵越小，数据越纯净。</li><li><strong>基尼指数（Gini Index）</strong>：基于概率的平方和来衡量数据的纯净度。基尼指数越小，数据越纯净。</li><li><strong>均方误差（Mean Squared Error, MSE）</strong>：用于回归任务，衡量预测值与真实值之间的均方差。</li></ul> 
<h5><a id="234__294"></a>2.3.4 决策树的优缺点</h5> 
<p><strong>优点</strong>：</p> 
<ul><li><strong>易于理解和解释</strong>：决策树模型可以通过图形化的树状结构直观展示决策过程。</li><li><strong>无需特征缩放</strong>：决策树对数据的缩放不敏感，适用于原始数据。</li><li><strong>处理多类别问题</strong>：决策树可以同时处理多类别分类问题。</li></ul> 
<p><strong>缺点</strong>：</p> 
<ul><li><strong>容易过拟合</strong>：决策树在训练过程中容易过拟合，特别是当树的深度很大时。</li><li><strong>对数据变化敏感</strong>：决策树对数据中的噪声和变化非常敏感，可能导致树结构的不稳定。</li><li><strong>计算复杂度高</strong>：当特征和样本数量较大时，决策树的构建和预测速度较慢。</li></ul> 
<h5><a id="235__306"></a>2.3.5 代码实现</h5> 
<p>以下是使用Python和Scikit-learn库实现决策树分类器的示例代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_iris
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> DecisionTreeClassifier
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> tree

<span class="token comment"># 加载数据集</span>
iris <span class="token operator">=</span> load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span>
X <span class="token operator">=</span> iris<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span>  <span class="token comment"># 选择花瓣长度和宽度两个特征</span>
y <span class="token operator">=</span> iris<span class="token punctuation">.</span>target

<span class="token comment"># 拆分数据集为训练集和测试集</span>
X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>

<span class="token comment"># 创建决策树分类器</span>
clf <span class="token operator">=</span> DecisionTreeClassifier<span class="token punctuation">(</span>criterion<span class="token operator">=</span><span class="token string">'gini'</span><span class="token punctuation">,</span> max_depth<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>

<span class="token comment"># 训练模型</span>
clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>

<span class="token comment"># 预测测试集</span>
y_pred <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>

<span class="token comment"># 输出模型准确率</span>
accuracy <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>y_pred <span class="token operator">==</span> y_test<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'Accuracy: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>accuracy<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>

<span class="token comment"># 可视化决策树</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
tree<span class="token punctuation">.</span>plot_tree<span class="token punctuation">(</span>clf<span class="token punctuation">,</span> filled<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> feature_names<span class="token operator">=</span>iris<span class="token punctuation">.</span>feature_names<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> class_names<span class="token operator">=</span>iris<span class="token punctuation">.</span>target_names<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="_345"></a>代码解释：</h5> 
<ol><li><strong>数据加载</strong>：加载Iris数据集，并选择花瓣长度和宽度作为特征。</li><li><strong>数据拆分</strong>：将数据集拆分为训练集和测试集。</li><li><strong>模型创建</strong>：创建决策树分类器，并设置纯净度指标为基尼指数，最大深度为4。</li><li><strong>模型训练</strong>：使用训练集数据训练模型。</li><li><strong>模型预测</strong>：使用测试集数据进行预测，并计算模型的准确率。</li><li><strong>决策树可视化</strong>：使用Matplotlib和Scikit-learn中的plot_tree函数可视化决策树结构。</li></ol> 
<h5><a id="_354"></a>决策树剪枝</h5> 
<p>为了减少过拟合问题，可以对决策树进行剪枝（Pruning）。剪枝分为预剪枝（Pre-pruning）和后剪枝（Post-pruning）两种方法：</p> 
<ul><li><strong>预剪枝</strong>：在构建决策树的过程中，通过设置参数（如最大深度、最小样本分割数等）提前停止分割。</li><li><strong>后剪枝</strong>：在构建完整决策树后，通过移除不重要的节点来简化树结构。</li></ul> 
<p>在实际应用中，合理设置剪枝参数可以显著提高决策树模型的泛化能力。</p> 
<h5><a id="236__363"></a>2.3.6 决策树的应用场景</h5> 
<p>决策树在许多实际应用中表现出色，以下是几个典型的应用场景：</p> 
<ul><li><strong>医疗诊断</strong>：通过分析患者的症状和体征，决策树可以辅助医生进行疾病诊断。</li><li><strong>客户细分</strong>：在市场营销中，通过客户行为和特征进行细分，帮助制定针对性的营销策略。</li><li><strong>金融风险管理</strong>：在信用评分和风险评估中，通过客户的历史数据预测违约风险。</li></ul> 
<p>决策树模型凭借其直观性和强大的分类能力，在多个领域都得到了广泛应用。虽然决策树有一些局限性，但通过适当的优化和剪枝技术，决策树仍然是一个非常有效的机器学习工具。</p> 
<h4><a id="24__373"></a>2.4 支持向量机</h4> 
<p>支持向量机（Support Vector Machine, SVM）是一种强大的监督学习算法，广泛应用于分类和回归任务。SVM的核心思想是通过寻找一个最优超平面来将数据点划分到不同的类别中，从而实现分类的目的。支持向量机在高维特征空间中表现优异，特别适合处理线性不可分的数据集。</p> 
<h5><a id="241__377"></a>2.4.1 支持向量机简介</h5> 
<p>支持向量机旨在找到一个能够最大化类间间隔（margin）的决策边界。决策边界可以是线性的，也可以通过核函数（Kernel Function）映射到高维空间，从而处理非线性分类问题。SVM通过以下公式定义决策超平面：</p> 
<p><img src="https://images2.imgbox.com/65/a3/lTgw1Bzz_o.png" alt="file"></p> 
<h5><a id="242__383"></a>2.4.2 支持向量机的优化目标</h5> 
<p>支持向量机的优化目标是最大化类间间隔（margin），即最小化以下损失函数：</p> 
<p><img src="https://images2.imgbox.com/62/ee/Jn1kUbgy_o.png" alt="file"></p> 
<h5><a id="243__389"></a>2.4.3 核函数</h5> 
<p>为了处理线性不可分的数据，支持向量机引入了核函数，将原始数据映射到高维特征空间。在高维空间中，数据有更高的概率可以被线性分割。常见的核函数包括：</p> 
<p><img src="https://images2.imgbox.com/ff/ac/pppUYbax_o.png" alt="file"></p> 
<h5><a id="244__395"></a>2.4.4 支持向量机的优缺点</h5> 
<p><strong>优点</strong>：</p> 
<ul><li><strong>有效处理高维数据</strong>：SVM在高维特征空间中表现优异，适用于维度较高的数据集。</li><li><strong>鲁棒性强</strong>：在少量样本的情况下，SVM依然能够表现出色。</li><li><strong>明确的几何解释</strong>：SVM通过最大化类间间隔，具有明确的几何解释。</li></ul> 
<p><strong>缺点</strong>：</p> 
<ul><li><strong>计算复杂度高</strong>：SVM的训练过程涉及二次规划问题，对计算资源要求较高。</li><li><strong>对参数敏感</strong>：SVM的性能对核函数和超参数（如 ( C ) 和 ( \gamma )）较为敏感，需要仔细调参。</li><li><strong>难以处理大规模数据集</strong>：在大规模数据集上，SVM的训练时间较长。</li></ul> 
<h5><a id="245__407"></a>2.4.5 代码实现</h5> 
<p>以下是使用Python和Scikit-learn库实现支持向量机分类器的示例代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> datasets
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>svm <span class="token keyword">import</span> SVC

<span class="token comment"># 加载数据集</span>
iris <span class="token operator">=</span> datasets<span class="token punctuation">.</span>load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span>
X <span class="token operator">=</span> iris<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>  <span class="token comment"># 选择前两个特征</span>
y <span class="token operator">=</span> iris<span class="token punctuation">.</span>target

<span class="token comment"># 将数据集分为二分类问题</span>
X <span class="token operator">=</span> X<span class="token punctuation">[</span>y <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">]</span>
y <span class="token operator">=</span> y<span class="token punctuation">[</span>y <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">]</span>

<span class="token comment"># 拆分数据集为训练集和测试集</span>
X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>

<span class="token comment"># 创建SVM分类器</span>
clf <span class="token operator">=</span> SVC<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">'linear'</span><span class="token punctuation">,</span> C<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>

<span class="token comment"># 训练模型</span>
clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>

<span class="token comment"># 预测测试集</span>
y_pred <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>

<span class="token comment"># 输出模型准确率</span>
accuracy <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>y_pred <span class="token operator">==</span> y_test<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'Accuracy: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>accuracy<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>

<span class="token comment"># 可视化决策边界</span>
<span class="token keyword">def</span> <span class="token function">plot_decision_boundary</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    h <span class="token operator">=</span> <span class="token number">.02</span>  <span class="token comment"># 网格步长</span>
    x_min<span class="token punctuation">,</span> x_max <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    y_min<span class="token punctuation">,</span> y_max <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    xx<span class="token punctuation">,</span> yy <span class="token operator">=</span> np<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>x_min<span class="token punctuation">,</span> x_max<span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">,</span>
                         np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>y_min<span class="token punctuation">,</span> y_max<span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">)</span>
    Z <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>np<span class="token punctuation">.</span>c_<span class="token punctuation">[</span>xx<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> yy<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    Z <span class="token operator">=</span> Z<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>xx<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>contourf<span class="token punctuation">(</span>xx<span class="token punctuation">,</span> yy<span class="token punctuation">,</span> Z<span class="token punctuation">,</span> cmap<span class="token operator">=</span>plt<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>Paired<span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span>y<span class="token punctuation">,</span> cmap<span class="token operator">=</span>plt<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>Paired<span class="token punctuation">,</span> edgecolors<span class="token operator">=</span><span class="token string">'k'</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Feature 1'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Feature 2'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'SVM Decision Boundary'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

plot_decision_boundary<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> clf<span class="token punctuation">)</span>
</code></pre> 
<h5><a id="_462"></a>代码解释：</h5> 
<ol><li><strong>数据加载</strong>：加载Iris数据集，并选择前两个特征用于分类。</li><li><strong>数据处理</strong>：将数据集转化为二分类问题，以便于SVM处理。</li><li><strong>数据拆分</strong>：将数据集拆分为训练集和测试集。</li><li><strong>模型创建</strong>：创建线性核SVM分类器，并设置正则化参数 ( C ) 为1.0。</li><li><strong>模型训练</strong>：使用训练集数据训练模型。</li><li><strong>模型预测</strong>：使用测试集数据进行预测，并计算模型的准确率。</li><li><strong>决策边界可视化</strong>：通过绘制决策边界和数据点，直观展示SVM分类器的效果。</li></ol> 
<h5><a id="246__472"></a>2.4.6 支持向量机的应用场景</h5> 
<p>支持向量机在许多实际应用中表现出色，以下是几个典型的应用场景：</p> 
<ul><li><strong>文本分类</strong>：SVM在垃圾邮件检测、情感分析等文本分类任务中广泛应用。</li><li><strong>图像识别</strong>：在手写数字识别、面部识别等图像分类任务中，SVM表现优异。</li><li><strong>生物信息学</strong>：SVM用于基因表达数据分析、蛋白质分类等生物信息学任务。</li></ul> 
<p>支持向量机模型凭借其高效的分类能力和坚实的理论基础，在多个领域得到了广泛应用。虽然SVM在处理大规模数据集时面临挑战，但通过适当的优化和核函数选择，SVM仍然是一个非常强大的机器学习工具。</p> 
<h4><a id="25_K_482"></a>2.5 K近邻</h4> 
<p>K近邻（K-Nearest Neighbors, KNN）是一种简单而有效的非参数监督学习算法，广泛应用于分类和回归任务。KNN算法通过计算新样本与训练集样本之间的距离，找到距离最近的K个邻居，基于这些邻居的标签来预测新样本的标签。</p> 
<h5><a id="251_K_486"></a>2.5.1 K近邻简介</h5> 
<p>K近邻算法的核心思想是“物以类聚，人以群分”，即相似的数据点更可能属于同一类。在分类任务中，KNN通过统计K个最近邻居中各类别的频率，选择出现次数最多的类别作为预测结果；在回归任务中，KNN通过计算K个最近邻居的平均值来进行预测。</p> 
<h5><a id="252__490"></a>2.5.2 距离度量</h5> 
<p>K近邻算法的关键在于如何度量数据点之间的距离。常见的距离度量方法包括：</p> 
<p><img src="https://images2.imgbox.com/6c/4e/2OfY6QYS_o.png" alt="file"></p> 
<h5><a id="253_K_496"></a>2.5.3 选择K值</h5> 
<p>选择合适的K值是KNN算法的重要步骤。K值过小可能导致模型对噪声敏感，从而导致过拟合；K值过大则可能导致模型过于平滑，忽略数据的局部结构，从而导致欠拟合。常见的选择K值的方法包括：</p> 
<ul><li><strong>经验法则</strong>：根据经验选择一个合适的K值，通常在3到10之间。</li><li><strong>交叉验证</strong>：通过交叉验证来选择最优的K值，保证模型在验证集上表现最佳。</li></ul> 
<h5><a id="254_K_503"></a>2.5.4 K近邻的优缺点</h5> 
<p><strong>优点</strong>：</p> 
<ul><li><strong>简单易懂</strong>：KNN算法直观且易于理解。</li><li><strong>无参数学习</strong>：KNN是无参数模型，不需要训练阶段，仅需保存训练数据。</li><li><strong>适用于多类别分类</strong>：KNN可以处理多类别分类问题。</li></ul> 
<p><strong>缺点</strong>：</p> 
<ul><li><strong>计算复杂度高</strong>：每次预测都需要计算与所有训练样本的距离，计算复杂度较高。</li><li><strong>对数据规模敏感</strong>：大规模数据集上，KNN的计算和存储开销较大。</li><li><strong>对特征缩放敏感</strong>：不同量纲的特征会影响距离计算结果，需要进行特征缩放。</li></ul> 
<h5><a id="255__515"></a>2.5.5 代码实现</h5> 
<p>以下是使用Python和Scikit-learn库实现K近邻分类器的示例代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> datasets
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>neighbors <span class="token keyword">import</span> KNeighborsClassifier
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> accuracy_score

<span class="token comment"># 加载数据集</span>
iris <span class="token operator">=</span> datasets<span class="token punctuation">.</span>load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span>
X <span class="token operator">=</span> iris<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>  <span class="token comment"># 选择前两个特征</span>
y <span class="token operator">=</span> iris<span class="token punctuation">.</span>target

<span class="token comment"># 拆分数据集为训练集和测试集</span>
X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>

<span class="token comment"># 特征缩放</span>
scaler <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>
X_train <span class="token operator">=</span> scaler<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>
X_test <span class="token operator">=</span> scaler<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>

<span class="token comment"># 创建KNN分类器</span>
k <span class="token operator">=</span> <span class="token number">5</span>  <span class="token comment"># 选择K值</span>
knn <span class="token operator">=</span> KNeighborsClassifier<span class="token punctuation">(</span>n_neighbors<span class="token operator">=</span>k<span class="token punctuation">)</span>

<span class="token comment"># 训练模型</span>
knn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>

<span class="token comment"># 预测测试集</span>
y_pred <span class="token operator">=</span> knn<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>

<span class="token comment"># 输出模型准确率</span>
accuracy <span class="token operator">=</span> accuracy_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'Accuracy: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>accuracy<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>

<span class="token comment"># 可视化决策边界</span>
<span class="token keyword">def</span> <span class="token function">plot_decision_boundary</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    h <span class="token operator">=</span> <span class="token number">.02</span>  <span class="token comment"># 网格步长</span>
    x_min<span class="token punctuation">,</span> x_max <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    y_min<span class="token punctuation">,</span> y_max <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    xx<span class="token punctuation">,</span> yy <span class="token operator">=</span> np<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>x_min<span class="token punctuation">,</span> x_max<span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">,</span>
                         np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>y_min<span class="token punctuation">,</span> y_max<span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">)</span>
    Z <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>np<span class="token punctuation">.</span>c_<span class="token punctuation">[</span>xx<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> yy<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    Z <span class="token operator">=</span> Z<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>xx<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>contourf<span class="token punctuation">(</span>xx<span class="token punctuation">,</span> yy<span class="token punctuation">,</span> Z<span class="token punctuation">,</span> cmap<span class="token operator">=</span>plt<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>Paired<span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span>y<span class="token punctuation">,</span> cmap<span class="token operator">=</span>plt<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>Paired<span class="token punctuation">,</span> edgecolors<span class="token operator">=</span><span class="token string">'k'</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Feature 1'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Feature 2'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'KNN Decision Boundary (k=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>k<span class="token punctuation">}</span></span><span class="token string">)'</span></span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

plot_decision_boundary<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">,</span> knn<span class="token punctuation">)</span>
</code></pre> 
<h5><a id="_574"></a>代码解释：</h5> 
<ol><li><strong>数据加载</strong>：加载Iris数据集，并选择前两个特征用于分类。</li><li><strong>数据拆分</strong>：将数据集拆分为训练集和测试集。</li><li><strong>特征缩放</strong>：对数据进行标准化处理，以消除不同特征量纲的影响。</li><li><strong>模型创建</strong>：创建K近邻分类器，并选择K值为5。</li><li><strong>模型训练</strong>：使用训练集数据训练模型。</li><li><strong>模型预测</strong>：使用测试集数据进行预测，并计算模型的准确率。</li><li><strong>决策边界可视化</strong>：通过绘制决策边界和数据点，直观展示KNN分类器的效果。</li></ol> 
<h5><a id="256_K_584"></a>2.5.6 K近邻的应用场景</h5> 
<p>K近邻算法在许多实际应用中表现出色，以下是几个典型的应用场景：</p> 
<ul><li><strong>推荐系统</strong>：通过计算用户的相似度，为用户推荐相似的商品或内容。</li><li><strong>图像识别</strong>：在手写数字识别、面部识别等图像分类任务中，KNN表现良好。</li><li><strong>文本分类</strong>：在垃圾邮件检测、情感分析等文本分类任务中，KNN广泛应用。</li></ul> 
<p>K近邻算法凭借其简单直观和有效性，在多个领域得到了广泛应用。虽然KNN在处理大规模数据集时面临挑战，但通过优化和合适的距离度量方法，KNN仍然是一个非常有用的机器学习工具。</p> 
<h2><a id="_594"></a>监督学习精讲</h2> 
<h3><a id="2__596"></a>2. 常见算法</h3> 
<h4><a id="26__598"></a>2.6 朴素贝叶斯</h4> 
<p>朴素贝叶斯（Naive Bayes）是一种基于贝叶斯定理的监督学习算法，广泛应用于分类任务。尽管其假设各特征之间相互独立且同等重要，这一“朴素”假设在很多实际问题中并不成立，但朴素贝叶斯仍然在许多应用中表现出色，尤其是文本分类问题。</p> 
<h5><a id="261__602"></a>2.6.1 朴素贝叶斯简介</h5> 
<p>朴素贝叶斯算法基于贝叶斯定理进行分类预测。贝叶斯定理的数学表达式为：</p> 
<p><img src="https://images2.imgbox.com/78/8c/MlwG75wS_o.png" alt="file"></p> 
<h5><a id="262__608"></a>2.6.2 朴素贝叶斯的类型</h5> 
<p>朴素贝叶斯分类器有多种类型，主要根据特征值的不同分布假设进行分类：</p> 
<ul><li><strong>高斯朴素贝叶斯（Gaussian Naive Bayes）</strong>：假设特征值服从高斯分布，适用于连续数据。</li><li><strong>多项式朴素贝叶斯（Multinomial Naive Bayes）</strong>：假设特征值服从多项式分布，适用于离散数据，特别是文本分类中的词频统计。</li><li><strong>伯努利朴素贝叶斯（Bernoulli Naive Bayes）</strong>：假设特征值服从伯努利分布，适用于二元数据，特别是文本分类中的词是否出现。</li></ul> 
<h5><a id="263__616"></a>2.6.3 朴素贝叶斯的优缺点</h5> 
<p><strong>优点</strong>：</p> 
<ul><li><strong>简单高效</strong>：朴素贝叶斯算法计算复杂度低，易于实现，适用于大规模数据集。</li><li><strong>处理缺失数据</strong>：朴素贝叶斯能够处理部分特征缺失的数据。</li><li><strong>适用于多类别分类</strong>：朴素贝叶斯能够自然处理多类别分类问题。</li></ul> 
<p><strong>缺点</strong>：</p> 
<ul><li><strong>独立性假设</strong>：朴素贝叶斯假设特征之间相互独立，这在许多实际问题中并不成立。</li><li><strong>零概率问题</strong>：如果某个特征值在训练集中未出现，可能导致零概率问题，需要拉普拉斯平滑（Laplace Smoothing）来处理。</li></ul> 
<h5><a id="264__627"></a>2.6.4 代码实现</h5> 
<p>以下是使用Python和Scikit-learn库实现朴素贝叶斯分类器的示例代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> datasets
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>naive_bayes <span class="token keyword">import</span> GaussianNB
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> accuracy_score<span class="token punctuation">,</span> confusion_matrix<span class="token punctuation">,</span> classification_report

<span class="token comment"># 加载数据集</span>
iris <span class="token operator">=</span> datasets<span class="token punctuation">.</span>load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span>
X <span class="token operator">=</span> iris<span class="token punctuation">.</span>data
y <span class="token operator">=</span> iris<span class="token punctuation">.</span>target

<span class="token comment"># 拆分数据集为训练集和测试集</span>
X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>

<span class="token comment"># 创建高斯朴素贝叶斯分类器</span>
gnb <span class="token operator">=</span> GaussianNB<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 训练模型</span>
gnb<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>

<span class="token comment"># 预测测试集</span>
y_pred <span class="token operator">=</span> gnb<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>

<span class="token comment"># 输出模型准确率</span>
accuracy <span class="token operator">=</span> accuracy_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'Accuracy: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>accuracy<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>

<span class="token comment"># 输出混淆矩阵和分类报告</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Confusion Matrix:"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nClassification Report:"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>classification_report<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="_666"></a>代码解释：</h5> 
<ol><li><strong>数据加载</strong>：加载Iris数据集，包括所有四个特征。</li><li><strong>数据拆分</strong>：将数据集拆分为训练集和测试集。</li><li><strong>模型创建</strong>：创建高斯朴素贝叶斯分类器实例。</li><li><strong>模型训练</strong>：使用训练集数据训练模型。</li><li><strong>模型预测</strong>：使用测试集数据进行预测，并计算模型的准确率。</li><li><strong>评估模型</strong>：输出混淆矩阵和分类报告，以详细评估模型性能。</li></ol> 
<h5><a id="265__675"></a>2.6.5 朴素贝叶斯的应用场景</h5> 
<p>朴素贝叶斯在许多实际应用中表现出色，以下是几个典型的应用场景：</p> 
<ul><li><strong>文本分类</strong>：朴素贝叶斯广泛应用于垃圾邮件检测、情感分析、新闻分类等文本分类任务。</li><li><strong>医学诊断</strong>：在疾病诊断和风险预测中，朴素贝叶斯可以根据症状和体征进行分类。</li><li><strong>推荐系统</strong>：朴素贝叶斯用于推荐系统中，基于用户行为和特征进行个性化推荐。</li></ul> 
<p>朴素贝叶斯算法凭借其简单高效和适用广泛，在多个领域得到了广泛应用。尽管其假设存在一定局限性，但通过适当的改进和优化，朴素贝叶斯仍然是一个非常有用的机器学习工具。</p> 
<h2><a id="_685"></a>监督学习精讲</h2> 
<h3><a id="3__687"></a>3. 模型评估与验证</h3> 
<p>在机器学习过程中，模型评估与验证是至关重要的环节。通过评估，我们能够了解模型的性能，判断其是否适合解决特定的问题；通过验证，我们能够检测模型是否泛化良好，是否能够在未见过的数据上表现出色。有效的模型评估与验证能够帮助我们选择最优模型并防止过拟合和欠拟合。</p> 
<h4><a id="31__691"></a>3.1 交叉验证</h4> 
<p>交叉验证（Cross-Validation）是一种评估模型性能的技术，它通过将数据集分成多个子集，并多次训练和验证模型来评估模型的性能。最常用的交叉验证方法是K折交叉验证（K-Fold Cross-Validation）。</p> 
<h5><a id="311_K_695"></a>3.1.1 K折交叉验证</h5> 
<p>K折交叉验证将数据集分成K个大小相等的子集，每次选择一个子集作为验证集，其余K-1个子集作为训练集，重复K次，最终计算K次验证的平均性能作为模型的评估结果。K折交叉验证的具体步骤如下：</p> 
<ol><li>将数据集随机分成K个大小相等的子集。</li><li>对于每个子集： 
  <ul><li>将该子集作为验证集，其余子集作为训练集。</li><li>训练模型并在验证集上评估模型性能。</li></ul> </li><li>计算所有K次评估的平均性能。</li></ol> 
<p>K折交叉验证能够有效缓解由于数据集划分带来的偶然性影响，提高评估结果的可靠性。常用的K值有5和10。</p> 
<h5><a id="312__707"></a>3.1.2 留一法交叉验证</h5> 
<p>留一法交叉验证（Leave-One-Out Cross-Validation, LOOCV）是一种极端的交叉验证方法，每次只用一个样本作为验证集，剩余样本作为训练集，重复N次（N为样本数量），最终计算N次评估的平均性能。尽管LOOCV的评估结果较为稳定，但计算开销较大，通常在小数据集上使用。</p> 
<h4><a id="32__711"></a>3.2 过拟合与欠拟合</h4> 
<p>过拟合（Overfitting）和欠拟合（Underfitting）是机器学习中的常见问题，直接影响模型的泛化能力。</p> 
<h5><a id="321__715"></a>3.2.1 过拟合</h5> 
<p>过拟合是指模型在训练数据上表现很好，但在验证数据上表现较差。这是因为模型过于复杂，捕捉到了训练数据中的噪声和细节，而没有学到数据的普遍规律。过拟合的常见原因包括：</p> 
<ul><li>模型复杂度过高</li><li>训练数据量不足</li><li>过度训练（训练次数过多）</li></ul> 
<p>解决过拟合的方法包括：</p> 
<ul><li>降低模型复杂度（如减少特征数量或使用正则化）</li><li>增加训练数据量</li><li>使用交叉验证选择合适的超参数</li><li>早停（Early Stopping）</li></ul> 
<h5><a id="322__730"></a>3.2.2 欠拟合</h5> 
<p>欠拟合是指模型在训练数据和验证数据上都表现较差。这是因为模型过于简单，无法捕捉数据的内在规律。欠拟合的常见原因包括：</p> 
<ul><li>模型复杂度过低</li><li>特征数量不足</li><li>训练时间不足</li></ul> 
<p>解决欠拟合的方法包括：</p> 
<ul><li>增加模型复杂度（如增加特征数量或使用更复杂的模型）</li><li>提高特征质量</li><li>延长训练时间</li></ul> 
<h4><a id="33__744"></a>3.3 混淆矩阵与分类报告</h4> 
<p>混淆矩阵（Confusion Matrix）是评估分类模型性能的重要工具，它能够直观地展示模型在各个类别上的分类情况。混淆矩阵的结构如下：</p> 
<table><thead><tr><th>实际\预测</th><th>正类（Positive）</th><th>负类（Negative）</th></tr></thead><tbody><tr><td>正类（Positive）</td><td>真阳性（TP）</td><td>假阴性（FN）</td></tr><tr><td>负类（Negative）</td><td>假阳性（FP）</td><td>真阴性（TN）</td></tr></tbody></table> 
<p>通过混淆矩阵，我们可以计算多个评价指标，包括：</p> 
<p><img src="https://images2.imgbox.com/ed/33/pAAj2iUF_o.png" alt="file"></p> 
<p>分类报告（Classification Report）通常包含上述指标，可以全面评估分类模型的性能。</p> 
<h4><a id="34_ROCAUC_759"></a>3.4 ROC曲线与AUC</h4> 
<p>ROC曲线（Receiver Operating Characteristic Curve）是评估二分类模型性能的工具，通过绘制真阳性率（TPR）和假阳性率（FPR）之间的关系，展示模型的区分能力。真阳性率和假阳性率的计算公式为：</p> 
<p><img src="https://images2.imgbox.com/0e/56/YkCRAclN_o.png" alt="file"></p> 
<p>通过调整分类阈值，可以绘制出不同点的TPR和FPR，形成ROC曲线。理想的ROC曲线接近左上角，表示模型具有较高的区分能力。</p> 
<p>AUC（Area Under Curve）是ROC曲线下的面积，数值在0.5到1之间，越接近1表示模型性能越好。AUC具有阈值独立性，是衡量模型性能的有效指标。</p> 
<h5><a id="_769"></a>代码示例</h5> 
<p>以下是使用Python和Scikit-learn库实现混淆矩阵、分类报告、ROC曲线和AUC的示例代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> datasets
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>naive_bayes <span class="token keyword">import</span> GaussianNB
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> confusion_matrix<span class="token punctuation">,</span> classification_report<span class="token punctuation">,</span> roc_curve<span class="token punctuation">,</span> auc

<span class="token comment"># 加载数据集</span>
iris <span class="token operator">=</span> datasets<span class="token punctuation">.</span>load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span>
X <span class="token operator">=</span> iris<span class="token punctuation">.</span>data
y <span class="token operator">=</span> iris<span class="token punctuation">.</span>target

<span class="token comment"># 将数据集分为二分类问题</span>
X <span class="token operator">=</span> X<span class="token punctuation">[</span>y <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">]</span>
y <span class="token operator">=</span> y<span class="token punctuation">[</span>y <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">]</span>

<span class="token comment"># 拆分数据集为训练集和测试集</span>
X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>

<span class="token comment"># 创建高斯朴素贝叶斯分类器</span>
gnb <span class="token operator">=</span> GaussianNB<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 训练模型</span>
gnb<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>

<span class="token comment"># 预测测试集</span>
y_pred <span class="token operator">=</span> gnb<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
y_prob <span class="token operator">=</span> gnb<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>

<span class="token comment"># 输出混淆矩阵和分类报告</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Confusion Matrix:"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nClassification Report:"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>classification_report<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 绘制ROC曲线</span>
fpr<span class="token punctuation">,</span> tpr<span class="token punctuation">,</span> _ <span class="token operator">=</span> roc_curve<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_prob<span class="token punctuation">)</span>
roc_auc <span class="token operator">=</span> auc<span class="token punctuation">(</span>fpr<span class="token punctuation">,</span> tpr<span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>fpr<span class="token punctuation">,</span> tpr<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'darkorange'</span><span class="token punctuation">,</span> lw<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f'ROC curve (area = </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>roc_auc<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">)'</span></span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'navy'</span><span class="token punctuation">,</span> lw<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> linestyle<span class="token operator">=</span><span class="token string">'--'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.05</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'False Positive Rate'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'True Positive Rate'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Receiver Operating Characteristic (ROC)'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">"lower right"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="_825"></a>代码解释：</h5> 
<ol><li><strong>数据加载和处理</strong>：加载Iris数据集，并将其转化为二分类问题。</li><li><strong>数据拆分</strong>：将数据集拆分为训练集和测试集。</li><li><strong>模型训练和预测</strong>：创建并训练高斯朴素贝叶斯分类器，对测试集进行预测。</li><li><strong>评估模型</strong>：计算并输出混淆矩阵、分类报告、ROC曲线和AUC。</li></ol> 
<p>通过上述过程，我们能够全面评估分类模型的性能，判断其是否适合特定的任务。有效的模型评估与验证是机器学习流程中的重要环节，能够帮助我们选择最优模型并提高模型的泛化能力。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/69877bf78942de7cfac4cf8cb8970880/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【C&#43;&#43;】list 容器的增删改查---模拟实现（图例超详细解析！！！）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9a1af90361de00be940e6a3cfd68358a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C# Web控件与数据感应之模板循环输出</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>