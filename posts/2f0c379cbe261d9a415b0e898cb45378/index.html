<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python pyinstaller打包常见问题（二）：No file找不到文件解决办法 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/2f0c379cbe261d9a415b0e898cb45378/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="python pyinstaller打包常见问题（二）：No file找不到文件解决办法">
  <meta property="og:description" content="项目场景： 我写了python程序，本地环境能正常运行，我打算打包成exe文件
方便发给朋友，让没有python环境也能正常运行
程序调用了wav文件，一个音效资源文件，程序调用的路径如下：
file = &#34;猫咪吃东西.wav&#34; 问题描述： 程序制作完成后，我开始打包
在需要打包的程序的目录上，我进入终端输入以下命令进行打包:
pyinstaller -cF xxx.py --add-data=&#34;猫咪吃东西.wav;猫咪吃东西.wav&#34; -n=&#34;xxx.exe&#34; 完成打包后，我在dist目录中找到生成的exe
运行失败直接闪退，我怀疑是缺少文件导致报错
为了捕捉原因，运行程序添加如下代码：
再次重复上述步骤进行打包，运行生成exe文件报错如下：
原因分析： 根据上面截图，可以看到exe文件运行失败的原因
是在当前目录上运行程序找不到所需资源wav文件
找不到资源文件导致的报错，一般这种情况有两个原因：
第一：打包的命令有问题，没有将资源文件打包进去
第二：运行程序的读取资源文件有问题，路径问题或者是权限问题（可能性小）
解决方案： 根据上述两个原因，制定两个计划：
第一：再运行一次exe文件，查看生成的临时文件夹有没有资源文件
第二：查看临时目录的资源文件的路径，确认路径与程序读取文件路径对应
一、查看临时文件夹 运行exe后，不关闭运行程序窗口就会出现想要的临时文件夹
window系统运行的程序生成的缓存文件，一般都在临时文件Temp中
而pyinstaller打包生成的临时文件在Temp中文件夹里一般是_ME开头的文件，例如：
二、修改打包命令，并打包 根据图片可以发现程序所需资源文件和第三方库的存在
但是路径与与程序读取文件的路径不一样
我们想要的只是wav文件，却多了个目录
了解pyinstaller打包命令后，发现错误原因如下：
附加文件指定的路径，不需要写名称
修改打包命令，终端输入以下命令打包：
pyinstaller -cF xxx.py --add-data=&#34;猫咪吃东西.wav;.&#34; -n=&#34;xxx.exe&#34; 打包生成exe的运行后，依然报错如下：
三、修改运行程序调用文件的路径 打包的exe文件读取资源时的路径需要采用绝对路径
在运行程序中我添加了一些输出，具体原因你可以看截图：
根据截图你会发现
如果你写的是相对路径，那么程序寻找的资源路径与正确路径不一致
运行exe所在的目录就是工作目录，他会在当前目录寻找资源文件
所以说读取文件路径需要先获取临时工作目录加上资源所在路径
修改运行程序的路径，代码如下：
# 获取目录路径对象 SRC_PATH = Path.absolute(Path(__file__)).parent # 吃食物声音路径： path = str(SRC_PATH / &#34;猫咪吃东西.wav&#34;) # 拼接获得文件绝对路径字符串 修改完程序后，终端再次输入命令打包：">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-28T09:29:55+08:00">
    <meta property="article:modified_time" content="2024-03-28T09:29:55+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python pyinstaller打包常见问题（二）：No file找不到文件解决办法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2><a id="_0"></a>项目场景：</h2> 
<p>我写了python程序，本地环境能正常运行，我打算打包成exe文件</p> 
<p>方便发给朋友，让没有python环境也能正常运行</p> 
<p>程序调用了wav文件，一个音效资源文件，程序调用的路径如下：</p> 
<pre><code class="language-python">file = "猫咪吃东西.wav"</code></pre> 
<hr> 
<h2><a id="_7"></a>问题描述：</h2> 
<p>程序制作完成后，我开始打包</p> 
<p>在需要打包的程序的目录上，我进入终端输入以下命令进行打包:</p> 
<pre><code class="language-bash">pyinstaller -cF xxx.py --add-data="猫咪吃东西.wav;猫咪吃东西.wav" -n="xxx.exe"</code></pre> 
<p></p> 
<p>完成打包后，我在dist目录中找到生成的exe</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/2a/b6/d29HCuCS_o.png"></p> 
<p></p> 
<p>运行失败直接闪退，我怀疑是缺少文件导致报错</p> 
<p>为了捕捉原因，运行程序添加如下代码：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/f2/b8/0FEqdToZ_o.png"></p> 
<p></p> 
<p>再次重复上述步骤进行打包，运行生成exe文件报错如下：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/67/9c/TGMbnIfq_o.png"></p> 
<p></p> 
<hr> 
<h2><a id="_23"></a>原因分析：</h2> 
<blockquote> 
 <p>根据上面截图，可以看到exe文件运行失败的原因</p> 
 <p>是在当前目录上运行程序找不到所需资源wav文件</p> 
</blockquote> 
<p>找不到资源文件导致的报错，一般这种情况有两个原因：</p> 
<p><span style="color:#956fe7;">第一：打包的命令有问题，没有将资源文件打包进去</span></p> 
<p><span style="color:#956fe7;">第二：运行程序的读取资源文件有问题，路径问题或者是权限问题（可能性小）</span></p> 
<hr> 
<h2><a id="_30"></a>解决方案：</h2> 
<blockquote> 
 <p>根据上述两个原因，制定两个计划：</p> 
 <p>第一：再运行一次exe文件，查看生成的临时文件夹有没有资源文件</p> 
 <p>第二：查看临时目录的资源文件的路径，确认路径与程序读取文件路径对应</p> 
</blockquote> 
<h3>一、查看临时文件夹</h3> 
<p>运行exe后，<span style="color:#fe2c24;">不关闭运行程序窗口</span>就会出现想要的临时文件夹</p> 
<p><span style="color:#956fe7;">window系统运行的程序生成的缓存文件，一般都在临时文件Temp中</span></p> 
<p><span style="color:#956fe7;">而pyinstaller打包生成的临时文件在Temp中文件夹里一般是_ME开头的文件，例如：</span></p> 
<p style="text-align:center;"></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/40/3a/UJVPRbV2_o.png"></p> 
<p></p> 
<h3>二、修改打包命令，并打包</h3> 
<p>根据图片可以发现程序所需资源文件和第三方库的存在</p> 
<p><span style="color:#956fe7;">但是路径与与程序读取文件的路径不一样</span></p> 
<p><span style="color:#956fe7;">我们想要的只是wav文件，却多了个目录</span></p> 
<p>了解pyinstaller打包命令后，发现错误原因如下：</p> 
<p><span style="color:#956fe7;">附加文件指定的路径，不需要写名称</span></p> 
<p></p> 
<p>修改打包命令，终端输入以下命令打包：</p> 
<pre><code class="language-python">pyinstaller -cF xxx.py --add-data="猫咪吃东西.wav;." -n="xxx.exe"</code></pre> 
<p></p> 
<p>打包生成exe的运行后，依然报错如下：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/45/c4/I9PPrrXa_o.png"></p> 
<h3></h3> 
<h3>三、修改运行程序调用文件的路径</h3> 
<p>打包的exe文件读取资源时的路径需要采用绝对路径</p> 
<p>在运行程序中我添加了一些输出，具体原因你可以看截图：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/2f/29/V2VzKqbu_o.png"></p> 
<p>根据截图你会发现</p> 
<p><span style="color:#956fe7;">如果你写的是相对路径，那么程序寻找的资源路径与正确路径不一致</span></p> 
<p><span style="color:#956fe7;">运行exe所在的目录就是工作目录，他会在当前目录寻找资源文件</span></p> 
<p>所以说读取文件路径需要先获取临时工作目录加上资源所在路径</p> 
<p>修改运行程序的路径，代码如下：</p> 
<pre><code class="language-python"># 获取目录路径对象
SRC_PATH = Path.absolute(Path(__file__)).parent
# 吃食物声音路径：
path = str(SRC_PATH / "猫咪吃东西.wav")  # 拼接获得文件绝对路径字符串</code></pre> 
<p></p> 
<p>修改完程序后，终端再次输入命令打包：</p> 
<pre><code class="language-python">pyinstaller -cF xxx.py --add-data="猫咪吃东西.wav;." -n="xxx.exe"</code></pre> 
<p></p> 
<p><span style="color:#956fe7;">完成打包后，成功运行生成的exe，功能也是完整的</span></p> 
<p></p> 
<h2>总结</h2> 
<p>也许朋友pyinstaller打包的exe报错的原因与我不同，但是朋友也可以根据以下步骤寻找答案：</p> 
<p><span style="color:#956fe7;">1、首先程序中添加异常报错说明</span></p> 
<p><span style="color:#956fe7;">2、确认是无法找到资源文件导致的报错后，查看临时文件夹</span></p> 
<p><span style="color:#956fe7;">3、查看临时文件夹的资源文件跟运行程序读取文件的路径一致吗</span></p> 
<p><span style="color:#956fe7;">4、确认自己的运行程序读取文件路径是绝对路径（临时工作目录加上资源文件的所在的路径）</span></p> 
<p><span style="color:#956fe7;">5、看看临时工作目录与下列代码获取的值一样吗    </span></p> 
<pre><code class="language-python"># 获取目录路径对象
SRC_PATH = Path.absolute(Path(__file__)).parent
# 吃食物声音路径：
path = str(SRC_PATH / "猫咪吃东西.wav")  # 拼接获得文件绝对路径字符串</code></pre> 
<p>如果你是无法生成exe文件，你可以参考我上一篇文章。</p> 
<p>上一篇：<a class="link-info" href="http://t.csdnimg.cn/OCWEE" rel="nofollow" title="python pyinstaller打包常见问题（一）：无法生成exe文件/打包闪退">python pyinstaller打包常见问题（一）：无法生成exe文件/打包闪退</a></p> 
<p></p> 
<p style="text-align:center;"><span style="color:#956fe7;"><strong>        如果还是解决不了问题的话，可以评论区联系我</strong></span></p> 
<p></p> 
<p></p> 
<p></p> 
<p style="text-align:center;"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/457a784809b2591511b7f9cdadb49415/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Android Studio 报错AAPT: error: resource android:attr/lStar not found.解决方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4ad3a6f586900ed2a132761cba34bc38/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Nginx转发代理请求（http）&#43;转发mysql（stream）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>