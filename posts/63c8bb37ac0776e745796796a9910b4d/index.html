<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>R语言绘制相关性热图全总结 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/63c8bb37ac0776e745796796a9910b4d/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="R语言绘制相关性热图全总结">
  <meta property="og:description" content="R语言绘制相关性热图全总结 引言 相关性热图是科研论文中一种常见的可视化手段，而在地学领域，我们常常需要分析一些环境因素之间的相关性，来判断环境生物因素中是否存在相关性情况。
尤其是在进行多变量分析时，分析目标因素和各变量之间的关系，往往需要首先考察变量之间的相关性，再考虑主成分等相关问题。地学环境生态领域常常用相关性热图的形式进行展示。总而言之，往大了说，任何表征相关性的数值都可以用相关性热图来进行绘制。
我们先来看看下面这张图，这是一篇发表在 ISME Journal ( IF = 11) 上的文章图，展示了生物和非生物因素的相关性。之间的相关性，其中红色的颜色代表负相关，蓝色代表正相关。每一格的数字代表相关系数。
Wijaya, W., Suhaimi, Z., Chua, C.X. et al. Frequent pulse disturbances shape resistance and resilience in tropical marine microbial communities. ISME COMMUN. 3, 55 (2023). https://doi.org/10.1038/s43705-023-00260-6
下图是一篇发表在 PLoS Medicine ( IF = 11.048) 上的文章图，展示了 22 种免疫细胞群体之间的相关性：
img 下图是发表在Scientific reports期刊上的一张相关性图，该图展示了微生物参数和土壤理化性质参数的Pearson相关性。
Ozlu, E., Sandhu, S.S., Kumar, S. et al. Soil health indicators impacted by long-term cattle manure and inorganic fertilizer application in a corn-soybean rotation of South Dakota.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-24T11:15:37+08:00">
    <meta property="article:modified_time" content="2024-03-24T11:15:37+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">R语言绘制相关性热图全总结</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <section id="nice" style="padding: 0 10px; word-spacing: 0px; word-wrap: break-word; text-align: left; line-height: 1.6; letter-spacing: .034em; color: rgb(63, 63, 63); font-size: 16px; word-break: all; font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, 'PingFang SC', Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;"> 
 <h2 style="padding: 0px; font-weight: bold; color: black; font-size: 24px; text-align: center; background-image: url(https://files.mdnice.com/mountain_2.png); background-position: center top; background-repeat: no-repeat; background-size: 95px; line-height: 95px; margin-top: 38px; margin-bottom: 10px;"><span class="prefix" style="display: none;"></span><span class="content" style="font-size: 20px; color: rgb(60, 112, 198); border-bottom: 2px solid #3C7076;">R语言绘制相关性热图全总结</span><span class="suffix"></span></h2> 
 <h3 style="padding: 0px; font-weight: bold; color: black; font-size: 22px; display: block; text-align: center; background-image: url(https://files.mdnice.com/mountain_2.png); background-position: center center; background-repeat: no-repeat; background-attachment: initial; background-origin: initial; background-clip: initial; background-size: 63px; margin-top: 38px; margin-bottom: 10px;"><span class="prefix" style="display: none;"></span><span class="content" style="text-align: center; display: inline-block; height: 38px; line-height: 42px; color: rgb(60, 112, 198); background-position: left center; background-repeat: no-repeat; background-attachment: initial; background-origin: initial; background-clip: initial; background-size: 63px; margin-top: 38px; font-size: 18px; margin-bottom: 10px;">引言</span><span class="suffix"></span></h3> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">相关性热图是科研论文中一种常见的可视化手段，而在地学领域，我们常常需要分析一些环境因素之间的相关性，来判断环境生物因素中是否存在相关性情况。</p> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">尤其是在进行多变量分析时，分析目标因素和各变量之间的关系，往往需要首先考察变量之间的相关性，再考虑主成分等相关问题。地学环境生态领域常常用相关性热图的形式进行展示。总而言之，往大了说，任何表征相关性的数值都可以用相关性热图来进行绘制。</p> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">我们先来看看下面这张图，这是一篇发表在 <em style="font-style: italic; color: black;">ISME Journal</em> ( IF = 11) 上的文章图，展示了生物和非生物因素的相关性。之间的相关性，其中红色的颜色代表负相关，蓝色代表正相关。每一格的数字代表相关系数。</p> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/03/57/dCO0wEOI_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
 </figure> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">Wijaya, W., Suhaimi, Z., Chua, C.X. <em style="font-style: italic; color: black;">et al.</em> Frequent pulse disturbances shape resistance and resilience in tropical marine microbial communities. <em style="font-style: italic; color: black;">ISME COMMUN.</em> <strong style="font-weight: bold; line-height: 1.75em; color: rgb(74,74,74);">3</strong>, 55 (2023). https://doi.org/10.1038/s43705-023-00260-6</p> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">下图是一篇发表在 <em style="font-style: italic; color: black;">PLoS Medicine</em> ( IF = 11.048) 上的文章图，展示了 22 种免疫细胞群体之间的相关性：</p> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/4e/e5/m8A7qDSs_o.jpg" alt="img" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
  <figcaption style="margin-top: 5px; text-align: center; color: #888; display: block; font-size: 12px; font-family: PingFangSC-Light;">
    img 
  </figcaption> 
 </figure> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">下图是发表在<em style="font-style: italic; color: black;">Scientific reports</em>期刊上的一张相关性图，该图展示了微生物参数和土壤理化性质参数的Pearson相关性。</p> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/61/3b/HByh61Rb_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
 </figure> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">Ozlu, E., Sandhu, S.S., Kumar, S. <em style="font-style: italic; color: black;">et al.</em> Soil health indicators impacted by long-term cattle manure and inorganic fertilizer application in a corn-soybean rotation of South Dakota. <em style="font-style: italic; color: black;">Sci Rep</em> <strong style="font-weight: bold; line-height: 1.75em; color: rgb(74,74,74);">9</strong>, 11776 (2019). https://doi.org/10.1038/s41598-019-48207-z</p> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">下图是发表在<em style="font-style: italic; color: black;">Science</em>正刊上的一张相关性图，具有很高的颜值，同时是多个图表的组合。</p> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/49/bf/IiEml49l_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
 </figure> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">Sunagawa, S., Coelho, L. P., Chaffron, S., Kultima, J. R., Labadie, K., Salazar, G., ... &amp; Velayoudon, D. (2015). Structure and function of the global ocean microbiome. <em style="font-style: italic; color: black;">Science</em>, <em style="font-style: italic; color: black;">348</em>(6237), 1261359.</p> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">其实这类相关性热图是使用R语言的ggcorrplot或corrplot包绘制的。能调整多种样式，你也能像顶刊一样绘制相关性结果。</p> 
 <h3 style="padding: 0px; font-weight: bold; color: black; font-size: 22px; display: block; text-align: center; background-image: url(https://files.mdnice.com/mountain_2.png); background-position: center center; background-repeat: no-repeat; background-attachment: initial; background-origin: initial; background-clip: initial; background-size: 63px; margin-top: 38px; margin-bottom: 10px;"><span class="prefix" style="display: none;"></span><span class="content" style="text-align: center; display: inline-block; height: 38px; line-height: 42px; color: rgb(60, 112, 198); background-position: left center; background-repeat: no-repeat; background-attachment: initial; background-origin: initial; background-clip: initial; background-size: 63px; margin-top: 38px; font-size: 18px; margin-bottom: 10px;">ggcorrplot包</span><span class="suffix"></span></h3> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">接下来介绍ggcorrplot包，进行一个简单的绘制，ggcorrplot包是2017年开发的，比较早，所以功能也比较简单。</p> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">首先安装ggcorrplot包</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;">install.packages(<span class="hljs-string" style="color: #d14; line-height: 26px;">"ggcorrplot"</span>)<br>devtools::install_github(<span class="hljs-string" style="color: #d14; line-height: 26px;">"kassambara/ggcorrplot"</span>)<br></code></pre> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">以mtcars内置数据为例：</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;"><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;"># Compute a correlation matrix</span><br>data(mtcars)<br>corr &lt;- round(cor(mtcars), <span class="hljs-number" style="color: #008080; line-height: 26px;">1</span>)<br>head(corr[, <span class="hljs-number" style="color: #008080; line-height: 26px;">1</span>:<span class="hljs-number" style="color: #008080; line-height: 26px;">6</span>])<br><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#&gt;       mpg  cyl disp   hp drat   wt</span><br><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#&gt; mpg   1.0 -0.9 -0.8 -0.8  0.7 -0.9</span><br><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#&gt; cyl  -0.9  1.0  0.9  0.8 -0.7  0.8</span><br><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#&gt; disp -0.8  0.9  1.0  0.8 -0.7  0.9</span><br><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#&gt; hp   -0.8  0.8  0.8  1.0 -0.4  0.7</span><br><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#&gt; drat  0.7 -0.7 -0.7 -0.4  1.0 -0.7</span><br><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#&gt; wt   -0.9  0.8  0.9  0.7 -0.7  1.0</span><br><br><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;"># Compute a matrix of correlation p-values</span><br>p.mat &lt;- cor_pmat(mtcars)<br>head(p.mat[, <span class="hljs-number" style="color: #008080; line-height: 26px;">1</span>:<span class="hljs-number" style="color: #008080; line-height: 26px;">4</span>])<br><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#&gt;               mpg          cyl         disp           hp</span><br><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#&gt; mpg  0.000000e+00 6.112687e-10 9.380327e-10 1.787835e-07</span><br><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#&gt; cyl  6.112687e-10 0.000000e+00 1.802838e-12 3.477861e-09</span><br><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#&gt; disp 9.380327e-10 1.802838e-12 0.000000e+00 7.142679e-08</span><br><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#&gt; hp   1.787835e-07 3.477861e-09 7.142679e-08 0.000000e+00</span><br><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#&gt; drat 1.776240e-05 8.244636e-06 5.282022e-06 9.988772e-03</span><br><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#&gt; wt   1.293959e-10 1.217567e-07 1.222320e-11 4.145827e-05</span><br></code></pre> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">首先进行一个简单的绘制：</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;">ggcorrplot(corr)<br></code></pre> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/57/16/yn5tOWQE_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
 </figure> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">将样式改为圆形：</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;"><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;"># method = "circle"</span><br>ggcorrplot(corr, method = <span class="hljs-string" style="color: #d14; line-height: 26px;">"circle"</span>)<br></code></pre> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/9e/e7/hr9eYzaI_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
 </figure> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">接下来使用<code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: rgb(60, 112, 198);">hc.order</code>关键字做层次聚类（hierarchical clustering）结果：</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;">ggcorrplot(corr, hc.order = <span class="hljs-literal" style="color: #008080; line-height: 26px;">TRUE</span>, outline.color = <span class="hljs-string" style="color: #d14; line-height: 26px;">"white"</span>)<br></code></pre> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/ce/30/TecRHLke_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
 </figure> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">通过<code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: rgb(60, 112, 198);">type=="lower"</code>关键字来做下三角效果：</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;">ggcorrplot(corr,<br>           hc.order = <span class="hljs-literal" style="color: #008080; line-height: 26px;">TRUE</span>,<br>           type = <span class="hljs-string" style="color: #d14; line-height: 26px;">"lower"</span>,<br>           outline.color = <span class="hljs-string" style="color: #d14; line-height: 26px;">"white"</span>)<br></code></pre> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/4d/6a/UK7Pv2Kk_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
 </figure> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">同理利用<code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: rgb(60, 112, 198);">type = "upper"</code>关键字做上三角效果：</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;">ggcorrplot(<br>  corr,<br>  hc.order = <span class="hljs-literal" style="color: #008080; line-height: 26px;">TRUE</span>,<br>  type = <span class="hljs-string" style="color: #d14; line-height: 26px;">"upper"</span>,<br>  outline.color = <span class="hljs-string" style="color: #d14; line-height: 26px;">"white"</span>,<br>  ggtheme = ggplot2::theme_gray,<br>  colors = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">"#6D9EC1"</span>, <span class="hljs-string" style="color: #d14; line-height: 26px;">"white"</span>, <span class="hljs-string" style="color: #d14; line-height: 26px;">"#E46726"</span>)<br>)<br></code></pre> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/ea/94/9AtBI2qf_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
 </figure> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">还可以标注显著性，通过<code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: rgb(60, 112, 198);">lab = TRUE</code>关键字：</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;">ggcorrplot(corr,<br>           hc.order = <span class="hljs-literal" style="color: #008080; line-height: 26px;">TRUE</span>,<br>           type = <span class="hljs-string" style="color: #d14; line-height: 26px;">"lower"</span>,<br>           lab = <span class="hljs-literal" style="color: #008080; line-height: 26px;">TRUE</span>)<br></code></pre> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/72/36/P9miIAn2_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
 </figure> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">通过关键字手动标识不显著的地方，画叉号：</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;">ggcorrplot(corr,<br>           hc.order = <span class="hljs-literal" style="color: #008080; line-height: 26px;">TRUE</span>,<br>           type = <span class="hljs-string" style="color: #d14; line-height: 26px;">"lower"</span>,<br>           p.mat = p.mat)<br></code></pre> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/a0/5e/Jr4hlNNu_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
 </figure> 
 <h3 style="padding: 0px; font-weight: bold; color: black; font-size: 22px; display: block; text-align: center; background-image: url(https://files.mdnice.com/mountain_2.png); background-position: center center; background-repeat: no-repeat; background-attachment: initial; background-origin: initial; background-clip: initial; background-size: 63px; margin-top: 38px; margin-bottom: 10px;"><span class="prefix" style="display: none;"></span><span class="content" style="text-align: center; display: inline-block; height: 38px; line-height: 42px; color: rgb(60, 112, 198); background-position: left center; background-repeat: no-repeat; background-attachment: initial; background-origin: initial; background-clip: initial; background-size: 63px; margin-top: 38px; font-size: 18px; margin-bottom: 10px;">corrplot包</span><span class="suffix"></span></h3> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">通过上述的结果，我们能实现顶刊1和2的效果，但是如果对于更复杂的图绘3，需要借助最新的corrplot包。该包是2021年发行的，比较新，能适用于更复杂和美观的效果。</p> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">首先安装corrplot包</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;">install.packages(<span class="hljs-string" style="color: #d14; line-height: 26px;">"corrplot"</span>)<br></code></pre> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">以mtcars内置数据为例（上一节的数据示例）：</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;">data(mtcars)<br>corr &lt;- round(cor(mtcars), <span class="hljs-number" style="color: #008080; line-height: 26px;">1</span>)<br></code></pre> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">首先查看默认的样式：</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;">corrplot(corr)<br></code></pre> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/78/84/EB3SPXpD_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
 </figure> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">corrplot的默认样式就比ggcorrplot美观不少，但其实corrplot还提供了更多的样式：</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;"><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#可选图形样式："circle", "square", "ellipse", "number", "shade", "color", "pie"</span><br><span class="hljs-keyword" style="color: #333; font-weight: bold; line-height: 26px;">library</span>(ggplot2)<br>corrplot(corr, method = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'square'</span>))<br>corrplot(corr, method = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'ellipse'</span>))<br>corrplot(corr, method = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'number'</span>))<br>corrplot(corr, method = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'shade'</span>))<br>corrplot(corr, method = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'color'</span>))<br>corrplot(corr, method = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'pie'</span>))<br></code></pre> 
 <ul style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;"><li> 
   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">
     square 
   </section></li></ul> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/83/4b/4aDeW9PF_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
 </figure> 
 <ul style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;"><li> 
   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">
     ellipse 
   </section></li></ul> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/db/25/FYhHiwx0_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
 </figure> 
 <ul style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;"><li> 
   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">
     number 
   </section></li></ul> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/04/99/ZwS4dUIV_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
 </figure> 
 <ul style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;"><li> 
   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">
     shade 
   </section></li></ul> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/e9/27/pgDA48no_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
 </figure> 
 <ul style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;"><li> 
   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">
     color 
   </section></li></ul> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/45/78/OxujNKl0_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
 </figure> 
 <ul style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;"><li> 
   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">
     pie 
   </section></li></ul> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/c2/05/FjvuRKnP_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
 </figure> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">上述每种样式都很美观，可能有同学想要问了，如果我想要两种样式的组合怎么办？如上三角用圆形，下三角用显著性数字。这里按下不表，后文揭晓~</p> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">接下来介绍corrplot更多的参数：</p> 
 <ul style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;"><li> 
   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;"> 
    <code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: rgb(60, 112, 198);"> outline = 'grey'</code>是否为图形添加外轮廓线，默认FLASE，可直接TRUE或指定颜色向量 
   </section></li><li> 
   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;"> 
    <code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: rgb(60, 112, 198);">col</code>是自己定义的颜色或色卡 
   </section></li><li> 
   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;"> 
    <code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: rgb(60, 112, 198);">order</code>是聚类方式选择："original", "AOE", "FPC", "hclust", "alphabet" 
   </section></li><li> 
   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;"> 
    <code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: rgb(60, 112, 198);">tl.cex</code>是文本标签大小 
   </section></li><li> 
   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;"> 
    <code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: rgb(60, 112, 198);">tl.col</code>文本标签颜色 
   </section></li><li> 
   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;"> 
    <code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: rgb(60, 112, 198);">addgrid.col</code>是文本标签颜色 
   </section></li><li> 
   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;"> 
    <code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: rgb(60, 112, 198);">diag = FALSE</code>是否展示对角线结果，默认TRUE 
   </section></li></ul> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;"><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;"># 参数介绍</span><br>mycol &lt;- colorRampPalette(c(<span class="hljs-string" style="color: #d14; line-height: 26px;">"#06a7cd"</span>, <span class="hljs-string" style="color: #d14; line-height: 26px;">"white"</span>, <span class="hljs-string" style="color: #d14; line-height: 26px;">"#e74a32"</span>), alpha = TRUE)<br>mycol2 &lt;- colorRampPalette(c(<span class="hljs-string" style="color: #d14; line-height: 26px;">"#0AA1FF"</span>,<span class="hljs-string" style="color: #d14; line-height: 26px;">"white"</span>, <span class="hljs-string" style="color: #d14; line-height: 26px;">"#F5CC16"</span>), alpha = TRUE)<br>corrplot(corr, method = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'square'</span>), <span class="hljs-built_in" style="color: #0086b3; line-height: 26px;">type</span> = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'lower'</span>), <br>               col = mycol2(100),<br>               outline = <span class="hljs-string" style="color: #d14; line-height: 26px;">'grey'</span>, <span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#是否为图形添加外轮廓线，默认FLASE，可直接TRUE或指定颜色向量</span><br>               order = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'AOE'</span>), <span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#排序/聚类方式选择："original", "AOE", "FPC", "hclust", "alphabet"</span><br>               diag = FALSE, <span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#是否展示对角线结果，默认TRUE</span><br>               tl.cex = 1.2, <span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#文本标签大小</span><br>               tl.col = <span class="hljs-string" style="color: #d14; line-height: 26px;">'black'</span>, <span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#文本标签颜色</span><br>               addgrid.col= <span class="hljs-string" style="color: #d14; line-height: 26px;">'grey'</span> <span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#格子轮廓颜色</span><br>)<br></code></pre> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/cd/10/1tIvRpaJ_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
 </figure> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">接下来叠加相关性结果：</p> 
 <ul style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;"><li> 
   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;"> 
    <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;"><code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: rgb(60, 112, 198);">addCoef.col = 'black'</code>在现有样式中添加相关性系数数字，并指定颜色</p> 
   </section></li><li> 
   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;"> 
    <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;"><code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: rgb(60, 112, 198);">number.cex = 0.8</code>是相关性系数数字标签大小</p> 
   </section></li></ul> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;"><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;"># 叠加相关性</span><br>corrplot(corr, method = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'ellipse'</span>), <br>               type = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'lower'</span>), <br>               col = mycol(<span class="hljs-number" style="color: #008080; line-height: 26px;">100</span>),<br>               outline = <span class="hljs-string" style="color: #d14; line-height: 26px;">'grey'</span>,<br>               order = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'AOE'</span>),<br>               diag = <span class="hljs-literal" style="color: #008080; line-height: 26px;">TRUE</span>,<br>               tl.cex = <span class="hljs-number" style="color: #008080; line-height: 26px;">1.2</span>, <br>               tl.col = <span class="hljs-string" style="color: #d14; line-height: 26px;">'black'</span>,<br>               addCoef.col = <span class="hljs-string" style="color: #d14; line-height: 26px;">'black'</span>, <span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#在现有样式中添加相关性系数数字，并指定颜色</span><br>               number.cex = <span class="hljs-number" style="color: #008080; line-height: 26px;">0.8</span>, <span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#相关性系数数字标签大小</span><br>)<br></code></pre> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/c7/67/EiLN67Ib_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
 </figure> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">接下来实现不同主题的拼接效果，如半圆形半显著性文字。</p> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">这里我们使用<code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: rgb(60, 112, 198);">add = TRUE</code>关键字，可以在第一张图的基础上叠加第二张图（一般是上三角叠加下三角）</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;"><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;"># 半文字，半图</span><br><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;"># 需要先画上三角，再画下三角，用add关键字表示在第一张图基础上添加第二张</span><br>corrplot(corr, method = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'pie'</span>), <br>        type = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'upper'</span>), <br>        col = mycol(<span class="hljs-number" style="color: #008080; line-height: 26px;">100</span>),<br>        outline = <span class="hljs-string" style="color: #d14; line-height: 26px;">'grey'</span>, <br>        order = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'AOE'</span>), <br>        diag = <span class="hljs-literal" style="color: #008080; line-height: 26px;">TRUE</span>,<br>        tl.cex = <span class="hljs-number" style="color: #008080; line-height: 26px;">1</span>, <span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#对角线文字大小</span><br>        tl.col = <span class="hljs-string" style="color: #d14; line-height: 26px;">'black'</span>, <span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#对角线文字颜色</span><br>        tl.pos = <span class="hljs-string" style="color: #d14; line-height: 26px;">'d'</span> <span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#仅在对角线显示文本标签</span><br>)<br>corrplot(corr, add = <span class="hljs-literal" style="color: #008080; line-height: 26px;">TRUE</span>,<br>               method = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'number'</span>), <br>               type = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'lower'</span>), <br>               col = mycol(<span class="hljs-number" style="color: #008080; line-height: 26px;">100</span>),<br>               order = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'AOE'</span>), <br>               diag = <span class="hljs-literal" style="color: #008080; line-height: 26px;">FALSE</span>, <br>               number.cex = <span class="hljs-number" style="color: #008080; line-height: 26px;">0.9</span>,<br>               tl.pos = <span class="hljs-string" style="color: #d14; line-height: 26px;">'n'</span>, <span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#不显示文本标签</span><br>               cl.pos = <span class="hljs-string" style="color: #d14; line-height: 26px;">'n'</span> <span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#不显示颜色图例</span><br>)<br></code></pre> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/59/4d/dEp3Tsbm_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
 </figure> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">也可也选择其它样式：</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;"><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#也可以选择在左方和上方添加文本标签：</span><br>corrplot(corr, method = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'square'</span>), <br>              type = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'upper'</span>), <br>              col = mycol(<span class="hljs-number" style="color: #008080; line-height: 26px;">100</span>),<br>              outline = <span class="hljs-string" style="color: #d14; line-height: 26px;">'grey'</span>, <br>              order = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'AOE'</span>), <br>              diag = <span class="hljs-literal" style="color: #008080; line-height: 26px;">TRUE</span>,<br>              tl.cex = <span class="hljs-number" style="color: #008080; line-height: 26px;">1.2</span>, <br>              tl.col = <span class="hljs-string" style="color: #d14; line-height: 26px;">"black"</span>,<br>              tl.pos = <span class="hljs-string" style="color: #d14; line-height: 26px;">"tp"</span><br>)<br>corrplot(corr, add = <span class="hljs-literal" style="color: #008080; line-height: 26px;">TRUE</span>,<br>              method = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'number'</span>), <br>              type = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'lower'</span>), <br>              col = mycol(<span class="hljs-number" style="color: #008080; line-height: 26px;">100</span>),<br>              order = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'AOE'</span>), <br>              diag = <span class="hljs-literal" style="color: #008080; line-height: 26px;">FALSE</span>, <br>              number.cex = <span class="hljs-number" style="color: #008080; line-height: 26px;">1.3</span>,<br>              tl.pos = <span class="hljs-string" style="color: #d14; line-height: 26px;">'n'</span>, <br>              cl.pos = <span class="hljs-string" style="color: #d14; line-height: 26px;">'n'</span><br>)<br></code></pre> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/dc/1a/5XfG9fXm_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
 </figure> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">接下来使用<code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: rgb(60, 112, 198);">p.mat = p</code>关键字添加显著性星号和不显著叉号，在这之前我们要先计算p值：</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;"><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;"># 显著性添加</span><br><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;"># 显著性计算：</span><br>res &lt;- cor.mtest(mtcars, conf.level = <span class="hljs-number" style="color: #008080; line-height: 26px;">.95</span>)<br>p &lt;- res$p<br><br><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#上三角图添加显著性水平星号：</span><br>corrplot(corr, method = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'pie'</span>), <br>              type = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'upper'</span>), <br>              col = mycol(<span class="hljs-number" style="color: #008080; line-height: 26px;">100</span>),<br>              outline = <span class="hljs-string" style="color: #d14; line-height: 26px;">'grey'</span>, <br>              order = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'AOE'</span>), <br>              diag = <span class="hljs-literal" style="color: #008080; line-height: 26px;">TRUE</span>,<br>              tl.cex = <span class="hljs-number" style="color: #008080; line-height: 26px;">1</span>, <br>              tl.col = <span class="hljs-string" style="color: #d14; line-height: 26px;">'black'</span>,<br>              tl.pos = <span class="hljs-string" style="color: #d14; line-height: 26px;">'d'</span>,<br>              p.mat = p,<br>              sig.level = c(<span class="hljs-number" style="color: #008080; line-height: 26px;">.001</span>, <span class="hljs-number" style="color: #008080; line-height: 26px;">.01</span>, <span class="hljs-number" style="color: #008080; line-height: 26px;">.05</span>),<br>              insig = <span class="hljs-string" style="color: #d14; line-height: 26px;">"label_sig"</span>, <span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#显著性标注样式："pch", "p-value", "blank", "n", "label_sig"</span><br>              pch.cex = <span class="hljs-number" style="color: #008080; line-height: 26px;">1.2</span>, <span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#显著性标记大小</span><br>              pch.col = <span class="hljs-string" style="color: #d14; line-height: 26px;">'black'</span> <span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#显著性标记颜色</span><br>)<br><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#下三角图添加不显著叉号：</span><br>corrplot(corr, add = <span class="hljs-literal" style="color: #008080; line-height: 26px;">TRUE</span>,<br>              method = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'number'</span>), <br>              type = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'lower'</span>),<br>              col = mycol(<span class="hljs-number" style="color: #008080; line-height: 26px;">100</span>),<br>              order = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">'AOE'</span>), <br>              diag = <span class="hljs-literal" style="color: #008080; line-height: 26px;">FALSE</span>, <br>              number.cex = <span class="hljs-number" style="color: #008080; line-height: 26px;">0.9</span>,<br>              tl.pos = <span class="hljs-string" style="color: #d14; line-height: 26px;">'n'</span>, <br>              cl.pos = <span class="hljs-string" style="color: #d14; line-height: 26px;">'n'</span>,<br>              p.mat = p,<br>              insig = <span class="hljs-string" style="color: #d14; line-height: 26px;">"pch"</span><br>)<br></code></pre> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/d2/9c/VqFpnPCH_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
 </figure> 
 <h3 style="padding: 0px; font-weight: bold; color: black; font-size: 22px; display: block; text-align: center; background-image: url(https://files.mdnice.com/mountain_2.png); background-position: center center; background-repeat: no-repeat; background-attachment: initial; background-origin: initial; background-clip: initial; background-size: 63px; margin-top: 38px; margin-bottom: 10px;"><span class="prefix" style="display: none;"></span><span class="content" style="text-align: center; display: inline-block; height: 38px; line-height: 42px; color: rgb(60, 112, 198); background-position: left center; background-repeat: no-repeat; background-attachment: initial; background-origin: initial; background-clip: initial; background-size: 63px; margin-top: 38px; font-size: 18px; margin-bottom: 10px;">ggcor包</span><span class="suffix"></span></h3> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">ggcor包是2021年最新开发的包，最新，实现了更多美观地绘制，当然corrplot已经足够使用了，这里做一个简单的介绍</p> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">ggcor和ggplot一样，是更方便的图层语言，在基础上叠加不同图层：</p> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">先安装ggcor包</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;">devtools::install_github(<span class="hljs-string" style="color: #d14; line-height: 26px;">"Github-Yilei/ggcor"</span>)<br></code></pre> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">先进行一个简单的绘制：</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;"><span class="hljs-keyword" style="color: #333; font-weight: bold; line-height: 26px;">library</span>(ggplot2)<br><span class="hljs-keyword" style="color: #333; font-weight: bold; line-height: 26px;">library</span>(ggcor)<br>set_scale()<br>quickcor(mtcars) + geom_square()<br></code></pre> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/46/cf/dNLDVpy0_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
 </figure> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">由于这是图层语言，可以直接叠加<code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: rgb(60, 112, 198);">geom_circle2</code>函数：</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;">quickcor(mtcars, type = <span class="hljs-string" style="color: #d14; line-height: 26px;">"upper"</span>) + geom_circle2()<br></code></pre> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/53/3d/QC1FKjMB_o.png" alt="image-20230717234330899" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
  <figcaption style="margin-top: 5px; text-align: center; color: #888; display: block; font-size: 12px; font-family: PingFangSC-Light;">
    image-20230717234330899 
  </figcaption> 
 </figure> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">通过叠加不同的图层：</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;">quickcor(mtcars, cor.test = <span class="hljs-literal" style="color: #008080; line-height: 26px;">TRUE</span>) +<br>  geom_square(data = get_data(type = <span class="hljs-string" style="color: #d14; line-height: 26px;">"lower"</span>, show.diag = <span class="hljs-literal" style="color: #008080; line-height: 26px;">FALSE</span>)) +<br>  geom_mark(data = get_data(type = <span class="hljs-string" style="color: #d14; line-height: 26px;">"upper"</span>, show.diag = <span class="hljs-literal" style="color: #008080; line-height: 26px;">FALSE</span>), size = <span class="hljs-number" style="color: #008080; line-height: 26px;">2.5</span>) +<br>  geom_abline(slope = -<span class="hljs-number" style="color: #008080; line-height: 26px;">1</span>, intercept = <span class="hljs-number" style="color: #008080; line-height: 26px;">12</span>)<br></code></pre> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/52/20/Eg0dUoQx_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
 </figure> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">接下来通过ggcor实现Mantel test可视化分析</p> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">Mantel test是一个分析两个矩阵相关关系的方法，这种分析方法可用在植物微生物群落与生态环境之间相关性的检验等等</p> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">下面的代码直接复现上文Science正刊的内容：</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;"><span class="hljs-keyword" style="color: #333; font-weight: bold; line-height: 26px;">library</span>(dplyr)<br><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#&gt; Warning: package 'dplyr' was built under R version 3.6.2</span><br>data(<span class="hljs-string" style="color: #d14; line-height: 26px;">"varechem"</span>, package = <span class="hljs-string" style="color: #d14; line-height: 26px;">"vegan"</span>)<br>data(<span class="hljs-string" style="color: #d14; line-height: 26px;">"varespec"</span>, package = <span class="hljs-string" style="color: #d14; line-height: 26px;">"vegan"</span>)<br><br>mantel &lt;- mantel_test(varespec, varechem,<br>                      spec.select = list(Spec01 = <span class="hljs-number" style="color: #008080; line-height: 26px;">1</span>:<span class="hljs-number" style="color: #008080; line-height: 26px;">7</span>,<br>                                         Spec02 = <span class="hljs-number" style="color: #008080; line-height: 26px;">8</span>:<span class="hljs-number" style="color: #008080; line-height: 26px;">18</span>,<br>                                         Spec03 = <span class="hljs-number" style="color: #008080; line-height: 26px;">19</span>:<span class="hljs-number" style="color: #008080; line-height: 26px;">37</span>,<br>                                         Spec04 = <span class="hljs-number" style="color: #008080; line-height: 26px;">38</span>:<span class="hljs-number" style="color: #008080; line-height: 26px;">44</span>)) %&gt;% <br>  mutate(rd = cut(r, breaks = c(-<span class="hljs-literal" style="color: #008080; line-height: 26px;">Inf</span>, <span class="hljs-number" style="color: #008080; line-height: 26px;">0.2</span>, <span class="hljs-number" style="color: #008080; line-height: 26px;">0.4</span>, <span class="hljs-literal" style="color: #008080; line-height: 26px;">Inf</span>),<br>                  labels = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">"&lt; 0.2"</span>, <span class="hljs-string" style="color: #d14; line-height: 26px;">"0.2 - 0.4"</span>, <span class="hljs-string" style="color: #d14; line-height: 26px;">"&gt;= 0.4"</span>)),<br>         pd = cut(p.value, breaks = c(-<span class="hljs-literal" style="color: #008080; line-height: 26px;">Inf</span>, <span class="hljs-number" style="color: #008080; line-height: 26px;">0.01</span>, <span class="hljs-number" style="color: #008080; line-height: 26px;">0.05</span>, <span class="hljs-literal" style="color: #008080; line-height: 26px;">Inf</span>),<br>                  labels = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">"&lt; 0.01"</span>, <span class="hljs-string" style="color: #d14; line-height: 26px;">"0.01 - 0.05"</span>, <span class="hljs-string" style="color: #d14; line-height: 26px;">"&gt;= 0.05"</span>)))<br><br>quickcor(varechem, type = <span class="hljs-string" style="color: #d14; line-height: 26px;">"upper"</span>) +<br>  geom_square() +<br>  anno_link(aes(colour = pd, size = rd), data = mantel) +<br>  scale_size_manual(values = c(<span class="hljs-number" style="color: #008080; line-height: 26px;">0.5</span>, <span class="hljs-number" style="color: #008080; line-height: 26px;">1</span>, <span class="hljs-number" style="color: #008080; line-height: 26px;">2</span>)) +<br>  scale_colour_manual(values = c(<span class="hljs-string" style="color: #d14; line-height: 26px;">"#D95F02"</span>, <span class="hljs-string" style="color: #d14; line-height: 26px;">"#1B9E77"</span>, <span class="hljs-string" style="color: #d14; line-height: 26px;">"#A2A2A288"</span>)) +<br>  guides(size = guide_legend(title = <span class="hljs-string" style="color: #d14; line-height: 26px;">"Mantel's r"</span>,<br>                             override.aes = list(colour = <span class="hljs-string" style="color: #d14; line-height: 26px;">"grey35"</span>), <br>                             order = <span class="hljs-number" style="color: #008080; line-height: 26px;">2</span>),<br>         colour = guide_legend(title = <span class="hljs-string" style="color: #d14; line-height: 26px;">"Mantel's p"</span>, <br>                               override.aes = list(size = <span class="hljs-number" style="color: #008080; line-height: 26px;">3</span>), <br>                               order = <span class="hljs-number" style="color: #008080; line-height: 26px;">1</span>),<br>         fill = guide_colorbar(title = <span class="hljs-string" style="color: #d14; line-height: 26px;">"Pearson's r"</span>, order = <span class="hljs-number" style="color: #008080; line-height: 26px;">3</span>))<br></code></pre> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/f4/85/npXIkZpI_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
 </figure> 
 <p style="font-size: 16px; padding-bottom: 8px; margin: 0; padding-top: 23px; color: rgb(74,74,74); line-height: 1.75em;">ggcor包还可以绘制环状热图Circular heatmap</p> 
 <pre class="custom" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;">rand_correlate(<span class="hljs-number" style="color: #008080; line-height: 26px;">100</span>, <span class="hljs-number" style="color: #008080; line-height: 26px;">8</span>) %&gt;% <span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">## require ambient packages</span><br>  quickcor(circular = <span class="hljs-literal" style="color: #008080; line-height: 26px;">TRUE</span>, cluster = <span class="hljs-literal" style="color: #008080; line-height: 26px;">TRUE</span>, open = <span class="hljs-number" style="color: #008080; line-height: 26px;">45</span>) +<br>  geom_colour(colour = <span class="hljs-string" style="color: #d14; line-height: 26px;">"white"</span>, size = <span class="hljs-number" style="color: #008080; line-height: 26px;">0.125</span>) +<br>  anno_row_tree() +<br>  anno_col_tree() +<br>  set_p_xaxis() +<br>  set_p_yaxis()<br><span class="hljs-comment" style="color: #998; font-style: italic; line-height: 26px;">#&gt; Warning: Removed 8 rows containing missing values (geom_text).</span><br></code></pre> 
 <figure style="margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;"> 
  <img src="https://images2.imgbox.com/78/14/KSLG2Fhn_o.png" alt="alt" style="display: block; margin: 0 auto; max-width: 100%; border-radius: 4px; margin-bottom: 25px;"> 
 </figure> 
 <h3 style="padding: 0px; font-weight: bold; color: black; font-size: 22px; display: block; text-align: center; background-image: url(https://files.mdnice.com/mountain_2.png); background-position: center center; background-repeat: no-repeat; background-attachment: initial; background-origin: initial; background-clip: initial; background-size: 63px; margin-top: 38px; margin-bottom: 10px;"><span class="prefix" style="display: none;"></span><span class="content" style="text-align: center; display: inline-block; height: 38px; line-height: 42px; color: rgb(60, 112, 198); background-position: left center; background-repeat: no-repeat; background-attachment: initial; background-origin: initial; background-clip: initial; background-size: 63px; margin-top: 38px; font-size: 18px; margin-bottom: 10px;">参考</span><span class="suffix"></span></h3> 
 <ul style="margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;"><li> 
   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">
     https://github.com/ixxmu/mp_duty/issues/3521,相关性热图还能玩出什么新花样 
   </section></li><li> 
   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">
     https://github.com/kassambara/ggcorrplot ggcorrplot开发者文档 
   </section></li><li> 
   <section style="margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;">
     https://github.com/Github-Yilei/ggcor ggcor开发者文档 
   </section></li></ul> 
</section> 
<p>本文由<a href="https://mdnice.com/?platform=4" rel="nofollow"> mdnice </a>多平台发布</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/60f185a4f2870472795aaf801b476603/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">基于Hive的招聘网站的大数据分析系统</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a16c189e2e47c4e5ccd1d3cd5aec8964/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">微软Copilot 将如何改变你的办公方式？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>