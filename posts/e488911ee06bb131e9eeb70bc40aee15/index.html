<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>tongweb 部署软航流版签一体化应用示例 提示跨域错误CORS ERROR - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/e488911ee06bb131e9eeb70bc40aee15/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="tongweb 部署软航流版签一体化应用示例 提示跨域错误CORS ERROR">
  <meta property="og:description" content="目录
问题现象与描述
解决办法
原理解析
什么是CORS
浏览器跨域请求限制
跨域问题解决方法
跨域请求流程
浏览器请求分类解析
http请求方法简介
问题现象与描述 重庆软航科技有限公司提供了一套针对针对word、excel等流式文件转换成PDF版式文件并进行版式文件在线签章的一个方案，给方案做了一个应用示例，该示例在完成流式文件转成PDF版式文件之后展示了一个在线阅读转换后PDF文件并在线签章的相关功能。
但是在tongweb上部署之后发现该示例完成word转PDF功能后的在线查看PDF时功能异常，浏览器中F12调试 发现状态信息不为200而是 CORS error，如下图所示：
该功能对应的请求 已配置请求头信息：Access-Control-Allow-Origin为*
查看详细的信息时发现：Referrer Policy为same-origin：
且 该应用在tomcat中 部署时并未出现此类异常，因此可以断定示例本身是没有问题的。
猜想可能是由于tongweb的配置影响了。
说一下示例所需要的资源部署情况：将其需要的软航电子签章系统、软航版式文档签批系统、软航文档转换系统以及软航提供的结合这几个一体化应用示例都部署到了同一台服务器的tongweb上了。
解决办法 打开tongweb 管理控制台，在【WEB容器配置】中选择【HTTP通道管理】选择【tong-http-listener】：
下拉到【其他设置】：
在其他设置这里有一个：禁用HTTP请求方法
将禁用的OPTIONS方法放开（勾选取消掉）：
之后 重启tongweb ，再试就可以解决 CORS error 问题了。
原理解析 什么是CORS CORS：即跨域（Cross-Origin Resource Sharing, CORS）是一种安全策略，由浏览器 enforced，限制跨域 HTTP 请求，指在一个域下的网页尝试访问另一个域下的资源。在web应用中服务器地址、端口、项目但凡有一个不同，访问的资源不是自己的，那就属于跨域。例如部署在A服务器上的appA项目，那么 在appA中访问 B服务器上的appB ,或者访问服务器A上的其他应用appx 都属于跨域。
跨域问题主要发生在浏览器端，服务器端由于协议设计的原因，不存在跨域问题。浏览器端跨域请求主要涉及到同源策略（Same-Origin Policy），同源策略限制了从一个源加载的文档或脚本与另一个源的资源进行交互。
浏览器跨域请求限制 浏览器默认是禁用跨域请求的，主要体现在以下方面：
（1）HTTP 请求方法：通常只允许 GET、POST 和 HEAD 请求。
（2）HTTP 头信息：无法发送 Cookie、HTTP 认证信息（如 Basic Auth）等。
（3）HTTP 响应：无法读取非简单响应内容，如 JSONP 只支持 JSON 格式。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-05T16:11:13+08:00">
    <meta property="article:modified_time" content="2024-07-05T16:11:13+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">tongweb 部署软航流版签一体化应用示例 提示跨域错误CORS ERROR</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E9%97%AE%E9%A2%98%E7%8E%B0%E8%B1%A1%E4%B8%8E%E6%8F%8F%E8%BF%B0-toc" style="margin-left:0px;"><a href="#%E9%97%AE%E9%A2%98%E7%8E%B0%E8%B1%A1%E4%B8%8E%E6%8F%8F%E8%BF%B0" rel="nofollow">问题现象与描述</a></p> 
<p id="%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95-toc" style="margin-left:0px;"><a href="#%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95" rel="nofollow">解决办法</a></p> 
<p id="%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90-toc" style="margin-left:0px;"><a href="#%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90" rel="nofollow">原理解析</a></p> 
<p id="%E4%BB%80%E4%B9%88%E6%98%AFCORS-toc" style="margin-left:40px;"><a href="#%E4%BB%80%E4%B9%88%E6%98%AFCORS" rel="nofollow">什么是CORS</a></p> 
<p id="%E6%B5%8F%E8%A7%88%E5%99%A8%E8%B7%A8%E5%9F%9F%E8%AF%B7%E6%B1%82%E9%99%90%E5%88%B6-toc" style="margin-left:40px;"><a href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E8%B7%A8%E5%9F%9F%E8%AF%B7%E6%B1%82%E9%99%90%E5%88%B6" rel="nofollow">浏览器跨域请求限制</a></p> 
<p id="%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95-toc" style="margin-left:40px;"><a href="#%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95" rel="nofollow">跨域问题解决方法</a></p> 
<p id="%E8%B7%A8%E5%9F%9F%E8%AF%B7%E6%B1%82%E6%B5%81%E7%A8%8B-toc" style="margin-left:40px;"><a href="#%E8%B7%A8%E5%9F%9F%E8%AF%B7%E6%B1%82%E6%B5%81%E7%A8%8B" rel="nofollow">跨域请求流程</a></p> 
<p id="%E6%B5%8F%E8%A7%88%E5%99%A8%E8%AF%B7%E6%B1%82%E5%88%86%E7%B1%BB%E8%A7%A3%E6%9E%90-toc" style="margin-left:40px;"><a href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E8%AF%B7%E6%B1%82%E5%88%86%E7%B1%BB%E8%A7%A3%E6%9E%90" rel="nofollow">浏览器请求分类解析</a></p> 
<p id="http%E8%AF%B7%E6%B1%82%E6%96%B9%E6%B3%95%E7%AE%80%E4%BB%8B-toc" style="margin-left:40px;"><a href="#http%E8%AF%B7%E6%B1%82%E6%96%B9%E6%B3%95%E7%AE%80%E4%BB%8B" rel="nofollow">http请求方法简介</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="%E9%97%AE%E9%A2%98%E7%8E%B0%E8%B1%A1%E4%B8%8E%E6%8F%8F%E8%BF%B0">问题现象与描述</h2> 
<p>重庆软航科技有限公司提供了一套针对针对word、excel等流式文件转换成PDF版式文件并进行版式文件在线签章的一个方案，给方案做了一个应用示例，该示例在完成流式文件转成PDF版式文件之后展示了一个在线阅读转换后PDF文件并在线签章的相关功能。</p> 
<p>但是在tongweb上部署之后发现该示例完成word转PDF功能后的在线查看PDF时功能异常，浏览器中F12调试 发现状态信息不为200而是 CORS error，如下图所示：</p> 
<p><img alt="" height="82" src="https://images2.imgbox.com/a3/ce/a75hnmMX_o.png" width="671"></p> 
<p>该功能对应的请求 已配置请求头信息：Access-Control-Allow-Origin为*</p> 
<p><img alt="" height="85" src="https://images2.imgbox.com/36/09/V0xZxjze_o.png" width="1045"></p> 
<p>查看详细的信息时发现：Referrer Policy为same-origin：</p> 
<p><img alt="" height="315" src="https://images2.imgbox.com/d2/2a/mYXlEShI_o.png" width="924"></p> 
<p>且 该应用在tomcat中 部署时并未出现此类异常，因此可以断定示例本身是没有问题的。</p> 
<p>猜想可能是由于tongweb的配置影响了。</p> 
<p>说一下示例所需要的资源部署情况：将其需要的软航电子签章系统、软航版式文档签批系统、软航文档转换系统以及软航提供的结合这几个一体化应用示例都部署到了同一台服务器的tongweb上了。</p> 
<p></p> 
<h2 id="%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95">解决办法</h2> 
<p>打开tongweb 管理控制台，在【WEB容器配置】中选择【HTTP通道管理】选择【tong-http-listener】：<br><img alt="" height="147" src="https://images2.imgbox.com/2c/e1/7G4a27Tv_o.png" width="568"></p> 
<p>下拉到【其他设置】：</p> 
<p>在其他设置这里有一个：禁用HTTP请求方法</p> 
<p><img alt="" height="61" src="https://images2.imgbox.com/67/21/dyj8QrVs_o.png" width="491"></p> 
<p>将禁用的OPTIONS方法放开（勾选取消掉）：</p> 
<p><img alt="" height="619" src="https://images2.imgbox.com/49/26/2TLTYtYC_o.png" width="950"></p> 
<p>之后 <strong>重启tongweb</strong> ，再试就可以解决 CORS error 问题了。</p> 
<h2 id="%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90">原理解析</h2> 
<h3 id="%E4%BB%80%E4%B9%88%E6%98%AFCORS">什么是CORS</h3> 
<p>CORS：即跨域（Cross-Origin Resource Sharing, CORS）是一种安全策略，由浏览器 enforced，限制跨域 HTTP 请求，指在一个域下的网页尝试访问另一个域下的资源。在web应用中服务器地址、端口、项目但凡有一个不同，访问的资源不是自己的，那就属于跨域。例如部署在A服务器上的appA项目，那么 在appA中访问 B服务器上的appB ,或者访问服务器A上的其他应用appx 都属于跨域。</p> 
<p>跨域问题主要发生在浏览器端，服务器端由于协议设计的原因，不存在跨域问题。浏览器端跨域请求主要涉及到<strong>同源策略（Same-Origin Policy），</strong>同源策略限制了从一个源加载的文档或脚本与另一个源的资源进行交互。</p> 
<h3 id="%E6%B5%8F%E8%A7%88%E5%99%A8%E8%B7%A8%E5%9F%9F%E8%AF%B7%E6%B1%82%E9%99%90%E5%88%B6">浏览器跨域请求限制</h3> 
<p>浏览器默认是禁用跨域请求的，主要体现在以下方面：</p> 
<blockquote> 
 <p>（1）HTTP 请求方法：通常只允许 GET、POST 和 HEAD 请求。</p> 
 <p>（2）HTTP 头信息：无法发送 Cookie、HTTP 认证信息（如 Basic Auth）等。</p> 
 <p>（3）HTTP 响应：无法读取非简单响应内容，如 JSONP 只支持 JSON 格式。</p> 
</blockquote> 
<h3 id="%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95">跨域问题解决方法</h3> 
<blockquote> 
 <p>（1）同源策略：通过 HTML5 的 window.postMessage 方法实现跨域通信。</p> 
 <p>（2）CORS：服务器设置 Access-Control-Allow-Origin 等响应头，允许特定域访问资源。</p> 
 <p>（3）JSONP：通过动态创建 script 标签，利用其不受同源策略限制的特性实现跨域请求。</p> 
 <p>（4）代理服务器：通过设置一个代理服务器，实现请求转发和响应返回。</p> 
</blockquote> 
<h3 id="%E8%B7%A8%E5%9F%9F%E8%AF%B7%E6%B1%82%E6%B5%81%E7%A8%8B">跨域请求流程</h3> 
<blockquote> 
 <p>（1）浏览器发送预检请求（Preflight Request）：询问服务器是否允许该跨域请求。</p> 
 <p>（2）服务器响应预检请求：如果允许，返回相应的 CORS 响应头。</p> 
 <p>（3）浏览器发送实际请求：携带 CORS 响应头信息，如 Access-Control-Allow-Origin。</p> 
</blockquote> 
<h3 id="%E6%B5%8F%E8%A7%88%E5%99%A8%E8%AF%B7%E6%B1%82%E5%88%86%E7%B1%BB%E8%A7%A3%E6%9E%90">浏览器请求分类解析</h3> 
<p>浏览器发送预检请求以及实际发送请求时就需要对浏览器请求做分类。 浏览器请求使用的是HTTP协议时，请求分类主要有：</p> 
<blockquote> 
 <p>HTTP 1.0: GET、POST、HEAD</p> 
 <p>HTTP 1.1: GET、POST、HEAD、[OPTIONS、PUT、PATCH、DELETE、TRACE、CONNECT]</p> 
</blockquote> 
<p>在本次遇到的问题中已经设置好了 携带 CORS 响应头信息，如 Access-Control-Allow-Origin ，且tomcat中异常，可以肯定应用本身是设定好的。而服务器响应预检请求的时候实际是由 tomcat、tongweb这种应用服务器中间件来处理的。那么也就是说但凡<span style="color:#fe2c24;"><strong>浏览器发送的请求类型被应用服务器本身拦截了，那么必然是会出现跨域问题的，这时就需要让应用服务器允许对应的请求才行。</strong></span></p> 
<h3 id="http%E8%AF%B7%E6%B1%82%E6%96%B9%E6%B3%95%E7%AE%80%E4%BB%8B">http请求方法简介</h3> 
<p>上述提到的浏览器请求分类，实际就是常说的http请求方法。主要http 请求方法介绍如下：</p> 
<blockquote> 
 <ul><li><strong>get</strong>：用于从服务器获取资源，例如请求一个网页或图片。这是最常见的请求方法，用于读取或下载数据。</li><li><strong>head</strong>：与GET方法类似，但服务器在响应中只返回HTTP头部信息，不返回实际数据。这通常用于检索资源的元信息。</li><li><strong>post</strong>：用于向服务器提交数据以供处理，例如表单提交或文件上传。POST请求通常用于添加新资源或更新现有资源。</li><li><strong>put</strong>：用于更新服务器上的现有资源。客户端发送PUT请求时，会包含一个指定资源的新表示，服务器将用这个新表示替换原有资源。</li><li><strong>delete</strong>：用于请求服务器删除指定的资源。</li><li><strong>connect</strong>：用于建立到服务器的隧道化连接，通常用于代理服务器。</li><li><strong>options</strong>：用于获取关于资源所支持通信选项的信息。服务器在响应中会包含一个Allow头，列出支持的所有请求方法。</li><li><strong>trace</strong>：用于追踪请求-响应的传输路径，通常用于调试目的。</li></ul> 
</blockquote> 
<p>根据浏览器调试的信息可以看到当前问题的网络信息里 确实是有<strong>两次请求</strong> ：<strong>第一次请求时 http请求的方法类型为：options 也就是前文提到的 </strong>浏览器发送预检请求（Preflight Request）：询问服务器是否允许该跨域请求。</p> 
<p><img alt="" height="173" src="https://images2.imgbox.com/fc/28/RFiTmeY3_o.png" width="1200"></p> 
<p>第二次才是 实际请求：</p> 
<p><img alt="" height="348" src="https://images2.imgbox.com/b4/e3/sDw10TvA_o.png" width="1200"></p> 
<p> 所以在tongweb 管理控制台里 设置 【WEB容器配置】中选择【HTTP通道管理】选择【tong-http-listener】里<strong>开放Options方法</strong> 就可以解决当下遇到的问题了。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e1feea56d899fed490f849ec3d99cf48/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">数学建模----滑翔伞伞翼面积的设计及运动状态描述</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ca04a8dfa2d851cc5c6025a0c6541ec8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Vue iview-ui 被tooltip包裹的标题，点击跳转后，提示框不消失</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>