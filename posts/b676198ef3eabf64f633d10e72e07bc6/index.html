<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【GPT】Coze使用开放平台接口-【5】API 调用 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/b676198ef3eabf64f633d10e72e07bc6/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【GPT】Coze使用开放平台接口-【5】API 调用">
  <meta property="og:description" content="我们在机器人里面引用工作流，当然也可以通过 API 直接调用工作流，coze 也提供了这一套的 API 接口。coze 的 API 接口肯定也不只是接入工作流，Bots，文件，知识库等，都有相关接口。这个文档我们也只专注在工作流的 API 接口调用上，我们之后也会补充其他形式的 API 接口调用，尤其是对话的。
1. 创建授权 https://www.coze.cn/open/oauth/pats
所有的 API 请求都必须在请求头的 Authorization 参数中包含你的访问令牌（Access Token）。
我们这边只用来测试和调试，所以选择个人访问令牌，如果是生产的那种还是要选择 OAuth 令牌。个人访问令牌需要设置：
名称过期时间开通的权限：了每个模块里面有具体的细的权限，比如创建 bot 这种。 注意：创建好的令牌，会以弹窗形式展示，且只展示一次，要保存好。
2. 调用工作流参数 调用工作流有 3 个，执行工作流，执行工作流(流失响应)，恢复运行工作流。后面 2 个明显是对话型的，跟我们之前的不符，所以我们用第一种的就可以了。
调用条件 已经发布的工作流
令牌开启工作流 run 的权限
不支持通过此 API 执行包括以下节点的工作流
消息节点开启了流式输出的结束节点问答节点 请求地址 POST：https://api.coze.cn/v1/workflow/run
Header 参数取值说明AuthorizationBearer $Access_Token用于验证客户端身份的访问令牌，根据步骤 1 就可以生成了Content-Typeapplication/json解释请求正文的方式。 Body 我就列出来需要用到的字段，详细的见 https://www.coze.cn/docs/developer_guides/workflow_run#7232055f
workflow_id
类型：String
是否可选：必选
说明：
已发布的工作流 ID，此 ID 在工作流编译页面的 URL 可以看到。如下图，workflow id 就是 73***47
parameters">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-30T16:10:50+08:00">
    <meta property="article:modified_time" content="2024-08-30T16:10:50+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【GPT】Coze使用开放平台接口-【5】API 调用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>我们在机器人里面引用工作流，当然也可以通过 API 直接调用工作流，coze 也提供了这一套的 API 接口。coze 的 API 接口肯定也不只是接入工作流，Bots，文件，知识库等，都有相关接口。这个文档我们也只专注在工作流的 API 接口调用上，我们之后也会补充其他形式的 API 接口调用，尤其是对话的。</p> 
<hr> 
<h5><a id="1__4"></a>1. 创建授权</h5> 
<p>https://www.coze.cn/open/oauth/pats</p> 
<p><img src="https://images2.imgbox.com/82/3c/0pgqRCCq_o.png" alt="在这里插入图片描述"></p> 
<p>所有的 API 请求都必须在请求头的 <strong>Authorization</strong> 参数中包含你的访问令牌（Access Token）。</p> 
<p>我们这边只用来测试和调试，所以选择个人访问令牌，如果是生产的那种还是要选择 OAuth 令牌。个人访问令牌需要设置：</p> 
<ul><li>名称</li><li>过期时间</li><li>开通的权限：了每个模块里面有具体的细的权限，比如创建 bot 这种。</li></ul> 
<p><img src="https://images2.imgbox.com/b5/6d/tORvFSfq_o.png" alt="在这里插入图片描述"></p> 
<p><strong>注意</strong>：创建好的令牌，会以弹窗形式展示，<strong><u>且只展示一次</u></strong>，要保存好。</p> 
<h5><a id="2__24"></a>2. 调用工作流参数</h5> 
<p>调用工作流有 3 个，执行工作流，执行工作流(流失响应)，恢复运行工作流。后面 2 个明显是对话型的，跟我们之前的不符，所以我们用第一种的就可以了。</p> 
<h6><a id="_28"></a>调用条件</h6> 
<ul><li> <p>已经发布的工作流</p> </li><li> <p>令牌开启工作流 run 的权限</p> </li><li> <p>不支持通过此 API 执行包括以下节点的工作流</p> 
  <ul><li>消息节点</li><li>开启了流式输出的结束节点</li><li>问答节点</li></ul> </li></ul> 
<h6><a id="_38"></a>请求地址</h6> 
<p>POST：https://api.coze.cn/v1/workflow/run</p> 
<h6><a id="Header_42"></a>Header</h6> 
<table><thead><tr><th><strong>参数</strong></th><th><strong>取值</strong></th><th><strong>说明</strong></th></tr></thead><tbody><tr><td>Authorization</td><td>Bearer <em>$Access_Token</em></td><td>用于验证客户端身份的访问令牌，根据步骤 1 就可以生成了</td></tr><tr><td>Content-Type</td><td>application/json</td><td>解释请求正文的方式。</td></tr></tbody></table> 
<h6><a id="Body_49"></a>Body</h6> 
<blockquote> 
 <p>我就列出来需要用到的字段，详细的见 https://www.coze.cn/docs/developer_guides/workflow_run#7232055f</p> 
</blockquote> 
<p><strong>workflow_id</strong></p> 
<p>类型：String</p> 
<p>是否可选：必选</p> 
<p>说明：</p> 
<p>已发布的工作流 ID，此 ID 在工作流编译页面的 URL 可以看到。如下图，workflow id 就是 73***47</p> 
<p><img src="https://images2.imgbox.com/15/6f/XYKZVsv3_o.png" alt="在这里插入图片描述"></p> 
<p><strong>parameters</strong></p> 
<p>类型：json object</p> 
<p>是否可选：可选</p> 
<p>说明：</p> 
<p>就是工作流开始节点的传参，如果有必填的参数，这个 parameters 就必须要传</p> 
<p><img src="https://images2.imgbox.com/8e/fd/LpSKdB9E_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="_79"></a>响应字段</h6> 
<table><thead><tr><th><strong>参数</strong></th><th><strong>类型</strong></th><th><strong>说明</strong></th></tr></thead><tbody><tr><td>code</td><td>Integer</td><td>调用状态码。 0 表示调用成功。 其他值表示调用失败。你可以通过 msg 字段判断详细的错误原因。</td></tr><tr><td>msg</td><td>String</td><td>状态信息。API 调用失败时可通过此字段查看详细错误信息。</td></tr><tr><td>data</td><td>String</td><td>工作流执行结果，通常为 JSON 序列化字符串，部分场景下可能返回非 JSON 结构的字符串。</td></tr><tr><td>debug_url</td><td>String</td><td>就是工作流试运行的结果页面，可以在这里，看每个节点的输入和输出</td></tr><tr><td>token</td><td>Integer</td><td>预留字段，无需关注。</td></tr><tr><td>cost</td><td>String</td><td>预留字段，无需关注。</td></tr></tbody></table> 
<h5><a id="3__90"></a>3. 示例</h5> 
<p><img src="https://images2.imgbox.com/72/54/3ITvlPnK_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-curl">curl --location 'https://api.coze.cn/v1/workflow/run' \
--header 'Authorization: Bearer pat_wnYsF9b8yptspzZgRiRNdNo' \
--header 'Content-Type: application/json' \
--data '{
    "workflow_id":"7398147",
    "parameters": {
        "app_id":"fd3a68cb4",
        "app_secret": "8cd697584",
        "file_url":"https://nan.mp3?q-sign-algorithm=sha1&amp;q-ak=AKIDK0KlmmalwSAkmJBRT_erx-b_BryIgsYPxmTm0HvmhuXQu9EamTIHS0eWuMn5TSg3&amp;q-sign-time=1724914917;1724918517&amp;q-key-time=1724914917;1724918517&amp;q-header-list=host&amp;q-url-param-list=&amp;q-signature=236c79445ebc243c9aac40d9763f4baed2d52dfa&amp;x-cos-security-token=DJtmN5Jcau4LZJ4a0pSQsH5NmjXBupGa039e275dfbdb83cd8e9a8c21c54e5f83USChUjnaEEk2jFkZgo3fmVskxICCOi36fGTmC3zsFdTTjrcwERxVFoApbMStOVgKhkOj6uD_OGHjAkMpo_PCY90em7XWIymODi4EpDcc410u8ZHDEKBJmEqjAbrTGZ0-Wpp9VtuSl2G4kMamp4L0hmfJyz2PcZf3osSsOU8MrYXSmedGh79wpjcLVIJbOlrZ",
        "ext": "wav"
    }
}'
</code></pre> 
<blockquote> 
 <p>返回的 data 里面是一个 json 格式的结构，这个似乎没有标准输出，只能看每个工作流输出什么东西，再去做修改。</p> 
</blockquote> 
<hr> 
<p>到这里 Coze 的部分就结束了，下面我们就看看在 Dify 里面是怎么创建插件，工作流，API 调用的，<a href="https://blog.csdn.net/weixin_40242845/article/details/141719901">Coze使用开放平台接口-【6】Dify 也来一遍</a>。</p> 
<hr> 
<p>上一篇：<a href="https://blog.csdn.net/weixin_40242845/article/details/141719730">Coze使用开放平台接口-【4】创建机器人</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/702bb5ccce6e29f9279124d8219b80fe/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【GPT】Coze使用开放平台接口-【2】创建工作流-语音伪造检测工作流</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5fb7f727c4428f18daab29411bc9d444/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【GPT】Coze使用开放平台接口-【7】Dify 比较篇</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>