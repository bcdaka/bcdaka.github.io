<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Web自动化测试—webdriver的环境配置 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/77b625e3ada59637e0fca66227dcc0a9/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Web自动化测试—webdriver的环境配置">
  <meta property="og:description" content="🔥 交流讨论：欢迎加入我们一起学习！
🔥 资源分享：耗时200&#43;小时精选的「软件测试」资料包
🔥 教程推荐：火遍全网的《软件测试》教程 📢欢迎点赞 👍 收藏 ⭐留言 📝 如有错误敬请指正！
环境： win10 &#43;
想要Python通过selenium操作浏览器搞些事情，就必须有两个前提条件：
下载selenium模块安装selenium的浏览器驱动 webdriver selenium模块下载
pip install selenium pip install -i https://pypi.doubanio.com/simple/ selenium pip install -i https://pypi.doubanio.com/simple/ selenium==3.141.0
浏览器驱下载
浏览器驱动的安装时新手阶段遇到较多问题之一，因为可选择的浏览器较多，我们先来聊聊各种场景的浏览器：
网页浏览器，也就是我们现在经常用到的浏览器，打开浏览器有个可视化的界面供我们操作，常见的有： GoogleFirefoxSafariIE/edgeOpera无头浏览器(Headless Browser)，无头，这里是说无界面的，这种浏览器的运行是不可见的，selenium中常用的无头浏览器有： PhantomJS无头浏览器Google无头浏览器Firefox无头浏览器 关于无头浏览器：无头浏览器指的是没有图形用户界面的浏览器。无头浏览器在类似于流行网络浏览器的环境中提供对网页的自动控制，但是通过命令行界面或使用网络通信来执行。 它们对于测试网页特别有用，因为它们能够像浏览器一样呈现和理解超文本标记语言，包括页面布局、颜色、字体选择以及JavaScript和AJAX的执行等样式元素，这些元素在使用其他测试方法时通常是不可用的。
无头浏览器常用于：
Web应用程序中的测试自动化。拍摄网页截图对JavaScript库运行自动化测试收集网站数据自动化网页交互 使用无头浏览器的优势：
对于UI自动化测试，少了真实浏览器加载css，js以及渲染页面的工作。无头测试要比真实浏览器快的多。可以在无界面的服务器或CI上运行测试，减少了外界的干扰，使自动化测试更稳定。在一台机器上可以模拟运行多个无头浏览器，方便进行并发测试。 关于PhantomJS无头浏览器：PhantomJS是一个可以用JavaScript编写脚本的无头web浏览器。它在Windows、macOS、Linux和FreeBSD上运行。使用QtWebKit作为后端，它为各种web标准提供了快速的本地支持：DOM处理、CSS选择器、JSON、Canvas和SVG。
另外，说一个比较悲痛的消息：PhantomJS暂停维护(可能的原因是内部问题和外部压力(Google和Firefox无头带来的压力))，所以，我们现在使用PhantomJS的话，你会看到提示：
UserWarning: Selenium support for PhantomJS has been deprecated, please use headless versions of Chrome or Firefox instead warnings.warn(&#39;Selenium support for PhantomJS has been deprecated, please use headless &#39;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-07T22:22:25+08:00">
    <meta property="article:modified_time" content="2024-03-07T22:22:25+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Web自动化测试—webdriver的环境配置</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <blockquote> 
 <p><strong> 🔥 交流讨论：</strong><a href="https://mp.weixin.qq.com/s/xSOmHjKbrsQ1poOPgHB5dA" rel="nofollow" title="欢迎加入我们一起学习！">欢迎加入我们一起学习！</a></p> 
 <p><strong>🔥 资源分享</strong><strong>：</strong><a href="https://mp.weixin.qq.com/s/MOoUFxcQg38bnkm6Lvq69g" rel="nofollow" title="耗时200+小时精选的「软件测试」资料包">耗时200+小时精选的「软件测试」资料包</a></p> 
 <p><strong>🔥 </strong><strong>教程推荐：</strong><a href="https://www.bilibili.com/video/BV1ZG411i7iW/?spm_id_from=333.999.0.0" rel="nofollow" title="火遍全网的《软件测试》教程">火遍全网的《软件测试》教程</a>  </p> 
 <p>📢<strong>欢迎点赞 👍 收藏 ⭐留言 📝 如有错误敬请指正！</strong></p> 
</blockquote> 
<blockquote> 
 <p>环境： win10 +</p> 
</blockquote> 
<p>想要Python通过selenium操作浏览器搞些事情，就必须有两个前提条件：</p> 
<ol><li>下载selenium模块</li><li>安装selenium的浏览器驱动 webdriver</li></ol> 
<p><strong>selenium模块下载</strong></p> 
<p></p> 
<pre id="pre-txGXDf"></pre> 
<p>pip install selenium pip install -i https://pypi.doubanio.com/simple/ selenium pip install -i https://pypi.doubanio.com/simple/ selenium==3.141.0</p> 
<p><strong>浏览器驱下载</strong><br> 浏览器驱动的安装时新手阶段遇到较多问题之一，因为可选择的浏览器较多，我们先来聊聊各种场景的浏览器：</p> 
<ul><li>网页浏览器，也就是我们现在经常用到的浏览器，打开浏览器有个可视化的界面供我们操作，常见的有： 
  <ul><li>Google</li><li>Firefox</li><li>Safari</li><li>IE/edge</li><li>Opera</li></ul></li><li>无头浏览器(Headless Browser)，无头，这里是说无界面的，这种浏览器的运行是不可见的，selenium中常用的无头浏览器有： 
  <ul><li>PhantomJS无头浏览器</li><li>Google无头浏览器</li><li>Firefox无头浏览器</li></ul></li></ul> 
<p>关于无头浏览器：无头浏览器指的是没有图形用户界面的浏览器。无头浏览器在类似于流行网络浏览器的环境中提供对网页的自动控制，但是通过命令行界面或使用网络通信来执行。 它们对于测试网页特别有用，因为它们能够像浏览器一样呈现和理解超文本标记语言，包括页面布局、颜色、字体选择以及JavaScript和AJAX的执行等样式元素，这些元素在使用其他测试方法时通常是不可用的。<br> 无头浏览器常用于：</p> 
<ul><li>Web应用程序中的测试自动化。</li><li>拍摄网页截图</li><li>对JavaScript库运行自动化测试</li><li>收集网站数据</li><li>自动化网页交互</li></ul> 
<p>使用无头浏览器的优势：</p> 
<ul><li>对于UI自动化测试，少了真实浏览器加载css，js以及渲染页面的工作。无头测试要比真实浏览器快的多。</li><li>可以在无界面的服务器或CI上运行测试，减少了外界的干扰，使自动化测试更稳定。</li><li>在一台机器上可以模拟运行多个无头浏览器，方便进行并发测试。</li></ul> 
<p>关于PhantomJS无头浏览器：PhantomJS是一个可以用JavaScript编写脚本的无头web浏览器。它在Windows、macOS、Linux和FreeBSD上运行。使用QtWebKit作为后端，它为各种web标准提供了快速的本地支持：DOM处理、CSS选择器、JSON、Canvas和SVG。<br> 另外，说一个比较悲痛的消息：PhantomJS暂停维护(可能的原因是内部问题和外部压力(Google和Firefox无头带来的压力))，所以，我们现在使用PhantomJS的话，你会看到提示：</p> 
<p></p> 
<pre id="pre-M7TRGk"></pre> 
<p>UserWarning: Selenium support for PhantomJS has been deprecated, please use headless versions of Chrome or Firefox instead warnings.warn('Selenium support for PhantomJS has been deprecated, please use headless '</p> 
<p>闲话少叙，先来看具体怎么安装和使用！</p> 
<h2 id="网页浏览器"><strong><em>3</em></strong>|<strong><em>0</em></strong><strong>网页浏览器回到顶部</strong></h2> 
<p>相对于无头浏览器来说，网页浏览器有以下优势：</p> 
<ol><li>配置相对简单</li><li>执行过程可视化，便于调试</li><li>模拟真实的用户操作</li></ol> 
<h3 id="chrome"><strong><em>3</em></strong>|<strong><em>1</em></strong><strong>Chrome回到顶部</strong></h3> 
<p>Chrome的驱动下载地址：</p> 
<ol><li><a href="https://npm.taobao.org/mirrors/chromedriver" rel="nofollow" title="https://npm.taobao.org/mirrors/chromedriver">https://npm.taobao.org/mirrors/chromedriver</a></li><li><a href="http://chromedriver.storage.googleapis.com/index.html" rel="nofollow" title="http://chromedriver.storage.googleapis.com/index.html">http://chromedriver.storage.googleapis.com/index.html</a></li></ol> 
<p>这里以淘宝镜像为例。</p> 
<ol><li>查看你的Chrome浏览器的版本。打开你的Chrome浏览器的<code>设置</code>▶<code>帮助</code>▶<code>关于Google Chrome(G)</code>，这里我的Chrome的版本是<code>81.0.4044.129</code></li></ol> 
<p></p> 
<p class="img-center"><a href="https://img2020.cnblogs.com/blog/1168165/202005/1168165-20200504230247502-1532028960.png" rel="nofollow"><img alt="" height="207" src="https://images2.imgbox.com/fa/ed/WfWK94w8_o.png" width="844"></a></p> 
<p><br> 2. 打开淘宝镜像链接：<a href="https://npm.taobao.org/mirrors/chromedriver" rel="nofollow" title="https://npm.taobao.org/mirrors/chromedriver">https://npm.taobao.org/mirrors/chromedriver</a>，如下图，可以看到，有两个81版本的驱动，我们选择一个最贴近浏览器版本的驱动版本<code>81.0.4044.69</code></p> 
<p></p> 
<p class="img-center"><a href="https://img2020.cnblogs.com/blog/1168165/202005/1168165-20200504230547716-2064269397.png" rel="nofollow"><img alt="" height="314" src="https://images2.imgbox.com/82/ef/JBQ9L85F_o.png" width="1200"></a></p> 
<ol><li>那我们选择的对吗？现在点击<code>81.0.4044.69/</code>这个驱动下载链接中，查看<code>notes.txt</code>文件。可以看到，<code>notes.txt</code>文件中说了三件事，浏览器驱动的版本、依赖浏览器的版本、该版本的驱动解决了哪些问题。通过依赖的浏览器驱动版本我们可以知道，这个就是我们想要的那个驱动。</li></ol> 
<p></p> 
<p class="img-center"><a href="https://img2020.cnblogs.com/blog/1168165/202005/1168165-20200504231054852-945255033.png" rel="nofollow"><img alt="" height="621" src="https://images2.imgbox.com/e8/dd/mfB8Zijw_o.png" width="1200"></a></p> 
<ol><li>回到之前的驱动下载页面，根据系统选择不同的安装包，这里我选择<code>chromedriver_win32.zip</code>。点击链接立即下载到本地。</li></ol> 
<p></p> 
<p class="img-center"><a href="https://img2020.cnblogs.com/blog/1168165/202005/1168165-20200504231456387-1104645064.png" rel="nofollow"><img alt="" height="83" src="https://images2.imgbox.com/4c/3c/CdgTU1TK_o.png" width="936"></a></p> 
<ol><li>压缩包内就一个<code>chromedriver.exe</code>可执行文件，将该文件移动到Python的安装目录中的<code>Scripts</code>目录(因为该目录已经添加到了系统Path中，你移动到别的目录也行，只要将目录添加到系统的Path中)</li></ol> 
<p></p> 
<p class="img-center"><a href="https://img2020.cnblogs.com/blog/1168165/202005/1168165-20200504232100389-1476438237.png" rel="nofollow"><img alt="" height="275" src="https://images2.imgbox.com/0a/c1/yqTczCwC_o.png" width="1200"></a></p> 
<ol><li>可以尝试测试一下了：</li></ol> 
<p></p> 
<pre id="pre-JnXptr"></pre> 
<p>from selenium import webdriver def foo(): """ 如果报如下错误： selenium.common.exceptions.WebDriverException: Message: 'chromedriver' executable needs to be in PATH. Please see https://sites.google.com/a/chromium.org/chromedriver/home 原因是在执行时，没有在path中找到驱动，这里的解决办法是实例化driver对象时，添加executable_path参数，引用驱动的绝对路径 """&lt;/span&gt; &lt;span class="hljs-comment"&gt;# driver = webdriver.Chrome(executable_path="C:\Python36\Scripts\chromedriver.exe") # 解决如上报错&lt;/span&gt; driver = webdriver.Chrome() driver.implicitly_wait(time_to_wait=&lt;span class="hljs-number"&gt;10&lt;/span&gt;) driver.get(&lt;span class="hljs-string"&gt;'https://www.baidu.com'&lt;/span&gt;) print(driver.title) &lt;span class="hljs-comment"&gt;# 百度一下，你就知道&lt;/span&gt; driver.quit() 原因是在执行时，没有在path中找到驱动，这里的解决办法是实例化driver对象时，添加executable_path参数，引用驱动的绝对路径 """&lt;/span&gt; &lt;span class="hljs-comment"&gt;# driver = webdriver.Chrome(executable_path="C:\Python36\Scripts\chromedriver.exe") # 解决如上报错&lt;/span&gt; driver = webdriver.Chrome() driver.implicitly_wait(time_to_wait=&lt;span class="hljs-number"&gt;10&lt;/span&gt;) driver.get(&lt;span class="hljs-string"&gt;'https://www.baidu.com'&lt;/span&gt;) print(driver.title) &lt;span class="hljs-comment"&gt;# 百度一下，你就知道&lt;/span&gt; driver.quit() if name == 'main': foo()</p> 
<p></p> 
<p>效果就是打开一个浏览器，然后代码获取了百度主页的title，然后关闭浏览器。</p> 
<h3 id="firefox"><strong><em>3</em></strong>|<strong><em>2</em></strong><strong>Firefox回到顶部</strong></h3> 
<ol><li>还是要先查看Firefox的浏览器版本，<code>设置</code>▶<code>帮助</code>▶<code>关于 Firefox</code>，可以看我的Firefox版本是74。</li></ol> 
<p></p> 
<p class="img-center"><a href="https://img2020.cnblogs.com/blog/1168165/202005/1168165-20200505093125996-1877478332.png" rel="nofollow"><img alt="" height="444" src="https://images2.imgbox.com/43/87/zREBBn4Y_o.png" width="769"></a></p> 
<ol><li>打开Firefox的驱动下载地址：<a href="https://github.com/mozilla/geckodriver/releases" title="Releases · mozilla/geckodriver · GitHub">Releases · mozilla/geckodriver · GitHub</a>，在最新的<code>v0.26.0</code>版本的描述中，推荐Firefox的版本≥60，而我们的Firefox版本正符合；下拉根据系统选择不同的压缩包，这里我选择<code>geckodriver-v0.26.0-win64.zip</code>。</li></ol> 
<p></p> 
<p class="img-center"><a href="https://img2020.cnblogs.com/blog/1168165/202005/1168165-20200504233628125-263124220.png" rel="nofollow"><img alt="" height="809" src="https://images2.imgbox.com/be/af/E83v8rSn_o.png" width="938"></a></p> 
<ol><li>下载到本地是一个<code>geckodriver.exe</code>可执行文件，同样的，你将该文件移动到Python安装目录中的<code>Scripts</code>目录(跟Google的驱动放一起，不会放的，参考Google驱动的第5步)。</li></ol> 
<p></p> 
<p class="img-center"><a href="https://img2020.cnblogs.com/blog/1168165/202005/1168165-20200505093223655-1779521527.png" rel="nofollow"><img alt="" height="229" src="https://images2.imgbox.com/9a/82/Bzmzy3RO_o.png" width="1200"></a></p> 
<ol><li>测试：</li></ol> 
<p></p> 
<pre id="pre-A2ycd4"></pre> 
<p>from selenium import webdriver def foo(): """ 如果报如下错误： selenium.common.exceptions.WebDriverException: Message: 'geckodriver' executable needs to be in PATH. 原因是在执行时，没有在path中找到驱动，这里的解决办法是实例化driver对象时，添加executable_path参数，引用驱动的绝对路径 """ &lt;span class="hljs-comment"&gt;# driver = webdriver.Firefox(executable_path="C:\Python36\Scripts\geckodriver.exe") # 解决如上报错&lt;/span&gt; driver = webdriver.Firefox() &lt;span class="hljs-comment"&gt;# 解决如上报错&lt;/span&gt; driver.implicitly_wait(time_to_wait=&lt;span class="hljs-number"&gt;10&lt;/span&gt;) driver.get(&lt;span class="hljs-string"&gt;'https://www.baidu.com'&lt;/span&gt;) print(driver.title) &lt;span class="hljs-comment"&gt;# 百度一下，你就知道&lt;/span&gt; driver.quit() &lt;span class="hljs-comment"&gt;# driver = webdriver.Firefox(executable_path="C:\Python36\Scripts\geckodriver.exe") # 解决如上报错&lt;/span&gt; driver = webdriver.Firefox() &lt;span class="hljs-comment"&gt;# 解决如上报错&lt;/span&gt; driver.implicitly_wait(time_to_wait=&lt;span class="hljs-number"&gt;10&lt;/span&gt;) driver.get(&lt;span class="hljs-string"&gt;'https://www.baidu.com'&lt;/span&gt;) print(driver.title) &lt;span class="hljs-comment"&gt;# 百度一下，你就知道&lt;/span&gt; driver.quit() if name == 'main': foo()</p> 
<p></p> 
<p>这里在再补充一个错误，我之前的Firefox的版本是最新版，但我本机运行有问题，所以在使用selenium操作的时候，报了这个错误：</p> 
<p></p> 
<pre id="pre-Mj2BJR"></pre> 
<p>selenium.common.exceptions.TimeoutException: Message: connection refused</p> 
<p>经过查询是我的Firefox浏览器有问题，我就降级装了个74版本的。但这只是个例。</p> 
<h3 id="safari"><strong><em>3</em></strong>|<strong><em>3</em></strong><strong>Safari回到顶部</strong></h3> 
<p>首先保证你的Python和selenium模块安装完成：</p> 
<p></p> 
<pre id="pre-QTBjjW"></pre> 
<p># 使用brew命令安装python3.7 brew install python3 # 安装selenium模块 pip3 install selenium==3.141.0</p> 
<p>来看如何配置Safari。<br> 从macOS El Capitan和Sierra上的Safari 10开始，每个版本的浏览器都包含WebDriver支持。要启用支持：</p> 
<p></p> 
<pre id="pre-KPSK7H"></pre> 
<p>Enable the Developer menu from Safari preferences # 从Safari首选项中启用“开发人员”菜单 Check the Allow Remote Automation option from with the Develop menu # 从“开发”菜单中选中“允许远程自动化”选项</p> 
<p class="img-center"><a href="https://img2020.cnblogs.com/blog/1168165/202005/1168165-20200505104425502-1477271790.png" rel="nofollow"><img alt="" height="299" src="https://images2.imgbox.com/2b/f7/VXoDgrNo_o.png" width="534"></a></p> 
<p><br>  </p> 
<p class="img-center"><a href="https://img2020.cnblogs.com/blog/1168165/202005/1168165-20200505104454698-1349411948.png" rel="nofollow"><img alt="" height="684" src="https://images2.imgbox.com/f8/60/rl3vPAhY_o.png" width="317"></a></p> 
<p><br> 然后，在首次启动之前，终端输入：</p> 
<p></p> 
<pre id="pre-RJjkds"></pre> 
<p>/usr/bin/safaridriver -p 1337</p> 
<p>然后按照提示输入密码，使webdriver获得授权。<br> 现在可以执行测试了：</p> 
<p></p> 
<pre id="pre-A4PZbQ"></pre> 
<p>from selenium import webdriver def foo(): driver = webdriver.Safari() driver.implicitly_wait(time_to_wait=&lt;span class="hljs-number"&gt;10&lt;/span&gt;) driver.get(&lt;span class="hljs-string"&gt;'https://www.baidu.com'&lt;/span&gt;) print(driver.title) &lt;span class="hljs-comment"&gt;# 百度一下，你就知道&lt;/span&gt; driver.quit() driver = webdriver.Safari() driver.implicitly_wait(time_to_wait=&lt;span class="hljs-number"&gt;10&lt;/span&gt;) driver.get(&lt;span class="hljs-string"&gt;'https://www.baidu.com'&lt;/span&gt;) print(driver.title) &lt;span class="hljs-comment"&gt;# 百度一下，你就知道&lt;/span&gt; driver.quit() if name == 'main': foo()</p> 
<p></p> 
<p>如下报错是提示你没有勾选</p> 
<p></p> 
<pre id="pre-AXR5zA"></pre> 
<p>selenium.common.exceptions.SessionNotCreatedException: Message: Could not create a session: You must enable the 'Allow Remote Automation' option in Safari's Develop menu to control Safari via WebDriver.</p> 
<p>意思是：必须在Safari的“开发”菜单中启用“允许远程自动化”选项，才能通过WebDriver控制Safari。如果你之前设置了，这里以不会报错了。</p> 
<h3 id="ie"><strong><em>3</em></strong>|<strong><em>4</em></strong><strong>IE回到顶部</strong></h3> 
<p><strong>必要的配置</strong></p> 
<ol><li>在<code>设置</code>▶<code>缩放</code>中，将比例调整为100%。</li><li>在<code>设置</code>▶<code>Internet 选项</code>▶<code>安全</code>选项，如下图，将四个选项都勾选<code>启用保护模式</code>。</li></ol> 
<p></p> 
<p class="img-center"><a href="https://img2020.cnblogs.com/blog/1168165/202005/1168165-20200505110845004-568114021.png" rel="nofollow"><img alt="" height="592" src="https://images2.imgbox.com/d4/df/UEAhOJzB_o.png" width="1200"></a></p> 
<p><br> 3. 针对IE10和更高的版本，必须在IE选项设置中的高级页中，取消增强保护模式。</p> 
<p></p> 
<p class="img-center"><a href="https://img2020.cnblogs.com/blog/1168165/202005/1168165-20200505111208176-1781748733.png" rel="nofollow"><img alt="" height="804" src="https://images2.imgbox.com/ac/6c/bVudWuaW_o.png" width="611"></a></p> 
<p>重启IE浏览器。<br><strong>webdriver驱动安装</strong></p> 
<ol><li>由于IE的webdriver驱动依赖selenium模块的版本，所以，我们先来查看selenium模块的版本，这里我的selenium模块的版本是<code>Version: 3.141.0</code>：</li></ol> 
<p></p> 
<pre id="pre-AJMCaM"></pre> 
<p>C:\Users\Anthony&gt;pip36 show selenium WARNING: pip is being invoked by an old script wrapper. This will fail in a future version of pip. Please see https://github.com/pypa/pip/issues/5599 for advice on fixing the underlying issue. To avoid this problem you can invoke Python with '-m pip' instead of running pip directly. Name: selenium Version: 3.141.0 Summary: Python bindings for Selenium Home-page: https://github.com/SeleniumHQ/selenium/ Author: UNKNOWN Author-email: UNKNOWN License: Apache 2.0 Location: c:\python36\lib\site-packages Requires: urllib3 Required-by: Appium-Python-Client</p> 
<ol><li>下载IE浏览器的webdriver驱动，访问<a href="http://selenium-release.storage.googleapis.com/index.html" rel="nofollow" title="http://selenium-release.storage.googleapis.com/index.html">http://selenium-release.storage.googleapis.com/index.html</a>定位到跟selenium版本一致的链接并且进入该链接内。</li></ol> 
<p></p> 
<p class="img-center"><a href="https://img2020.cnblogs.com/blog/1168165/202005/1168165-20200505105646989-1018134935.png" rel="nofollow"><img alt="" height="176" src="https://images2.imgbox.com/d6/cb/D5NMs5nZ_o.png" width="1200"></a></p> 
<ol><li>这里一定要选择跟你的selenium版本一致的压缩包；另外，我的系统是64位的，但这里我选择32位的压缩包，原因是据不可靠消息，32位相对于64位性能更好！</li></ol> 
<p></p> 
<p class="img-center"><a href="https://img2020.cnblogs.com/blog/1168165/202005/1168165-20200505105903643-1415002273.png" rel="nofollow"><img alt="" height="814" src="https://images2.imgbox.com/05/ee/eDSP12Vg_o.png" width="1200"></a></p> 
<ol><li>将<code>IEDriverServer.exe</code>可执行文件拷贝到Python的安装目录中的<code>Scripts</code>目录内。</li></ol> 
<p></p> 
<p class="img-center"><a href="https://img2020.cnblogs.com/blog/1168165/202005/1168165-20200505111327626-1866455787.png" rel="nofollow"><img alt="" height="148" src="https://images2.imgbox.com/6d/33/rCQfmDD6_o.png" width="867"></a></p> 
<ol><li>现在，可以测试了。</li></ol> 
<p></p> 
<pre id="pre-z38P2s"></pre> 
<p>from selenium import webdriver def foo(): """ 如果报如下错误： selenium.common.exceptions.WebDriverException: Message: 'IEDriverServer.exe' executable needs to be in PATH. Please download from http://selenium-release.storage.googleapis.com/index.html and read up at https://github.com/SeleniumHQ/selenium/wiki/InternetExplorerDriver 原因是在执行时，没有在 path中找到驱动，这里的解决办法是实例化driver对象时，添加executable_path参数，引用驱动的绝对路径 """ &lt;span class="hljs-comment"&gt;# driver = webdriver.Ie(executable_path="C:\Python36\Scripts\IEDriverServer.exe") # 解决如上报错&lt;/span&gt; driver = webdriver.Ie() &lt;span class="hljs-comment"&gt;# 解决如上报错&lt;/span&gt; &lt;span class="hljs-comment"&gt;# driver = webdriver.Firefox()&lt;/span&gt; driver.implicitly_wait(time_to_wait=&lt;span class="hljs-number"&gt;10&lt;/span&gt;) driver.get(&lt;span class="hljs-string"&gt;'https://www.baidu.com'&lt;/span&gt;) print(driver.title) &lt;span class="hljs-comment"&gt;# 百度一下，你就知道&lt;/span&gt; driver.quit() &lt;span class="hljs-comment"&gt;# driver = webdriver.Ie(executable_path="C:\Python36\Scripts\IEDriverServer.exe") # 解决如上报错&lt;/span&gt; driver = webdriver.Ie() &lt;span class="hljs-comment"&gt;# 解决如上报错&lt;/span&gt; &lt;span class="hljs-comment"&gt;# driver = webdriver.Firefox()&lt;/span&gt; driver.implicitly_wait(time_to_wait=&lt;span class="hljs-number"&gt;10&lt;/span&gt;) driver.get(&lt;span class="hljs-string"&gt;'https://www.baidu.com'&lt;/span&gt;) print(driver.title) &lt;span class="hljs-comment"&gt;# 百度一下，你就知道&lt;/span&gt; driver.quit() if name == 'main': foo()</p> 
<p></p> 
<h2 id="无头浏览器"><strong><em>4</em></strong>|<strong><em>0</em></strong><strong>无头浏览器回到顶部</strong></h2> 
<p>我们日常使用浏览器的步骤为：启动浏览器、打开一个网页、进行交互。而无头浏览器指的是我们使用脚本来执行以上过程的浏览器，能模拟真实的浏览器使用场景。</p> 
<p>有了无头浏览器，我们就能做包括但不限于以下事情：</p> 
<ul><li>对网页进行截图保存为图片或 pdf。</li><li>抓取单页应用(SPA)执行并渲染(解决传统 HTTP 爬虫抓取单页应用难以处理异步请求的问题)。</li><li>做表单的自动提交、UI的自动化测试、模拟键盘输入等。</li><li>用浏览器自带的一些调试工具和性能分析工具帮助我们分析问题。</li><li>在最新的无头浏览器环境里做测试、使用最新浏览器特性。</li><li>写爬虫做你想做的事情。</li></ul> 
<p>无头浏览器很多，包括但不限于：</p> 
<ul><li>PhantomJS, 基于 Webkit</li><li>SlimerJS, 基于 Gecko</li><li>HtmlUnit, 基于 Rhnio</li><li>TrifleJS, 基于 Trident</li><li>Splash, 基于 Webkit</li></ul> 
<p>这里我们简单来说，在selenium中使用无头浏览器。</p> 
<h3 id="phantomjs"><strong><em>4</em></strong>|<strong><em>1</em></strong><strong>PhantomJS回到顶部</strong></h3> 
<p>PhantomJS是一个无界面的、可脚本编程的WebKit浏览器引擎，其快速，原生支持各种Web标准： DOM 处理, CSS 选择器, JSON, Canvas, 和 SVG。</p> 
<ul><li>PhantomJS是一个基于webkit内核、无界面的浏览器，即它就是一个浏览器，只是其内的点击、翻页等人为相关操作需要程序设计实现；</li><li>PhantomJS提供Javascript API接口，可以通过编写JS程序直接与webkit内核交互；</li><li>PhantomJS的应用：无需浏览器的 Web 测试、网页截屏、页面访问自动化、网络监测。</li></ul> 
<blockquote> 
 <p>官网：<a href="https://phantomjs.org/" rel="nofollow" title="PhantomJS - Scriptable Headless Browser">PhantomJS - Scriptable Headless Browser</a><br> github：<a href="https://github.com/ariya/phantomjs/" title="GitHub - ariya/phantomjs: Scriptable Headless Browser">GitHub - ariya/phantomjs: Scriptable Headless Browser</a></p> 
</blockquote> 
<p><strong>下载安装</strong></p> 
<ol><li>打开下载链接：<a href="https://phantomjs.org/download.html" rel="nofollow" title="Download PhantomJS">Download PhantomJS</a>，根据自己的系统平台，下载相应的包，我这里是Windows 64位系统，所以，我选择下载windows版本的，phantomjs-2.1.1版本下载地址：</li></ol> 
<p></p> 
<p class="img-center"><a href="https://img2020.cnblogs.com/blog/1168165/202005/1168165-20200505112322871-680246260.png" rel="nofollow"><img alt="" height="615" src="https://images2.imgbox.com/19/13/PhuKxodC_o.png" width="952"></a></p> 
<ol><li>将压缩包解压到没有中文、空格的目录，我这里解压到Python的安装目录中的<code>Scripts</code>目录。</li></ol> 
<p></p> 
<p class="img-center"><a href="https://img2020.cnblogs.com/blog/1168165/202005/1168165-20200505112742461-1047175318.png" rel="nofollow"><img alt="" height="138" src="https://images2.imgbox.com/b9/f6/QUHp24QW_o.png" width="879"></a></p> 
<ol><li>将<code>phantomjs-2.1.1-windows</code>的bin目录添加到系统path中。</li></ol> 
<p></p> 
<p class="img-center"><a href="https://img2020.cnblogs.com/blog/1168165/202005/1168165-20200505112930287-794291485.png" rel="nofollow"><img alt="" height="646" src="https://images2.imgbox.com/05/f0/TcWfsITZ_o.png" width="665"></a></p> 
<ol><li>测试。</li></ol> 
<p></p> 
<pre id="pre-tZbsWf"></pre> 
<p>from selenium import webdriver def foo(): """ 如果报如下错误： selenium.common.exceptions.WebDriverException: Message: 'phantomjs' executable needs to be in PATH. 原因是在执行时，没有在 path中找到驱动，这里的解决办法是实例化driver对象时，添加executable_path参数，引用驱动的绝对路径 """ driver = webdriver.PhantomJS(executable_path=&lt;span class="hljs-string"&gt;r"C:\Python36\Scripts\phantomjs-2.1.1-windows\bin\phantomjs.exe"&lt;/span&gt;) &lt;span class="hljs-comment"&gt;# 解决如上报错&lt;/span&gt; driver.implicitly_wait(time_to_wait=&lt;span class="hljs-number"&gt;10&lt;/span&gt;) driver.get(&lt;span class="hljs-string"&gt;'https://www.baidu.com'&lt;/span&gt;) print(driver.title) &lt;span class="hljs-comment"&gt;# 百度一下，你就知道&lt;/span&gt; driver.quit() driver = webdriver.PhantomJS(executable_path=&lt;span class="hljs-string"&gt;r"C:\Python36\Scripts\phantomjs-2.1.1-windows\bin\phantomjs.exe"&lt;/span&gt;) &lt;span class="hljs-comment"&gt;# 解决如上报错&lt;/span&gt; driver.implicitly_wait(time_to_wait=&lt;span class="hljs-number"&gt;10&lt;/span&gt;) driver.get(&lt;span class="hljs-string"&gt;'https://www.baidu.com'&lt;/span&gt;) print(driver.title) &lt;span class="hljs-comment"&gt;# 百度一下，你就知道&lt;/span&gt; driver.quit() if name == 'main': foo()</p> 
<p></p> 
<p>之前说 PhantomJS 和新版的selenium已经分手，所以你在使用的时候，会有这提示，注意，这是提示，不是报错！</p> 
<p class="img-center"><a href="https://img2020.cnblogs.com/blog/1168165/202005/1168165-20200505113307822-1925480287.png" rel="nofollow"><img alt="" height="164" src="https://images2.imgbox.com/12/ed/DNE2nhlB_o.png" width="1200"></a></p> 
<p>解决办法！要么视而不见，要么按照提示去使用Google或者Firefox的无头浏览器吧。</p> 
<h3 id="google无头"><strong><em>4</em></strong>|<strong><em>2</em></strong><strong>Google无头回到顶部</strong></h3> 
<p>自2017年中以来，Chrome用户可以选择以headless模式运行浏览器(chrome 59.0)。此功能非常适合运行前端浏览器测试，而无需在屏幕上显示操作过程。在此之前，这主要是PhantomJS的领地，但Headless Chrome正在迅速取代这个由JavaScript驱动的WebKit方法。Headless Chrome浏览器的测试运行速度要快得多，而且行为上更像一个真正的浏览器，虽然我们的团队发现它比PhantomJS使用更多的内存。有了这些优势，用于前端测试的Headless Chrome很可能成为事实上的标准。</p> 
<p>所以，我们来看Google无头浏览器怎么玩的吧！毕竟这是以后无头浏览器阵营的扛把子！<br> 说起来，Google的无头浏览器配置倒也简单，只需要要在实例化driver对象的时候，添加参数即可。</p> 
<p></p> 
<pre id="pre-Se2FQe"></pre> 
<p>from selenium import webdriver from selenium.webdriver.chrome.options import Options # 创建一个参数对象，用来控制chrome以无界面模式打开 chrome_options = Options() chrome_options.add_argument('--headless') chrome_options.add_argument('--disable-gpu') # 创建浏览器对象 driver = webdriver.Chrome(chrome_options=chrome_options) # driver = webdriver.Chrome() # 不加 chrome_options 参数就是正常的打开一个浏览器，进行操作 driver.implicitly_wait(10) # 访问URL driver.get('https://www.baidu.com') print(driver.title) # 百度一下，你就知道 driver.quit()</p> 
<p></p> 
<h3 id="firefox无头"><strong><em>4</em></strong>|<strong><em>3</em></strong><strong>Firefox无头回到顶部</strong></h3> 
<p>Google搞了无头浏览器之后(2017年5月)，小老弟Firefox也不甘落后，从 55.0 开始也支持了HEADLESS模式（2017年9月）。<br> 配置也相当的简单。</p> 
<p></p> 
<pre id="pre-ahfe8x"></pre> 
<p>from selenium import webdriver from selenium.webdriver.firefox.options import Options # 创建浏览器对象 options = Options() options.add_argument("-headless") driver = webdriver.Firefox(firefox_options=options) # driver = webdriver.Firefox() # # 不加 firefox_options 参数就是正常的打开一个浏览器，进行操作 driver.implicitly_wait(10) # 访问URL driver.get('https://www.baidu.com') print(driver.title) # 百度一下，你就知道 driver.quit()</p> 
<p></p> 
<p>不得不说，大厂就是大厂，Google和Firefox的联手打压下，再加上PhantomJS的内部矛盾，导致在短短的几个月后(2018年4月)，PhantomJS的核心开发者团队宣布不再维护该项目，老大哥终将落幕了啊！</p> 
<p>哦，忘了说了，据不可靠消息说：</p> 
<ul><li>Google无头相对于UI的浏览器节省30%左右的时间。</li><li>Firefox无头相对于UI的浏览器节省3%左右的时间。</li></ul> 
<p>这话不是我说的，是：<a href="http://www.suchcode.com/topic/592/WebDriver%E6%B5%8B%E8%AF%95%E7%9A%84%E6%97%A0%E5%A4%B4%E6%89%A7%E8%A1%8C%20-%20%20Firefox%E6%B5%8F%E8%A7%88%E5%99%A8" rel="nofollow" title="http://www.suchcode.com/topic/592/WebDriver测试的无头执行 - Firefox浏览器">http://www.suchcode.com/topic/592/WebDriver测试的无头执行 - Firefox浏览器</a>。</p> 
<p>哦，还有，phantomjs 都不维护了，还讲它干嘛？那是因为我们可以在截网页长图的时候使用。暂时我还没有找到使用Chrome和Firefox截长图的办法！只能使用 phantomjs 了啊！</p> 
<blockquote> 
 <p>最后我邀请你进入我们的【<strong>软件测试学习交流群：785128166】</strong>， 大家可以一起探讨交流软件测试，共同学习软件测试技术、面试等软件测试方方面面，还会有免费直播课，收获更多测试技巧，我们一起进阶Python自动化测试/测试开发，走向高薪之路</p> 
</blockquote> 
<p><strong>作为一个软件测试的过来人，我想尽自己最大的努力，帮助每一个伙伴都能顺利找到工作。所以我整理了下面这份资源，现在免费分享给大家，有需要的小伙伴可以关注【公众号：程序员二黑】自提！</strong></p> 
<p><img alt="" height="757" src="https://images2.imgbox.com/77/09/ldXYL56t_o.png" width="955"></p> 
<p><img alt="" height="131" src="https://images2.imgbox.com/f0/64/ukNOqrW3_o.jpg" width="700"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fbad2de0d9d88bfa0f85f2586f2bb580/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">详解Spring中@RequestMapping、@PostMapping、@GetMapping三个注解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d8e50fdb28b318f4a53e4532411568a1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">python 安装库pycrypto失败的一系列问题[已解决]</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>