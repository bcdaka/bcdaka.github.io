<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Spring高手之路18——从XML配置角度理解Spring AOP - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/f68d6443605c99c4f4047c16be9a6461/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Spring高手之路18——从XML配置角度理解Spring AOP">
  <meta property="og:description" content="文章目录 1. Spring AOP与动态代理1.1 Spring AOP和动态代理的关系1.2 AOP基本术语 2. 通过XML配置实现Spring AOP2.1 添加Spring依赖2.2 定义业务接口和实现类2.3 定义切面类2.4 配置XML 1. Spring AOP与动态代理 1.1 Spring AOP和动态代理的关系 Spring AOP使用动态代理作为其主要机制来实现面向切面的编程。这种机制允许Spring在运行时动态地创建代理对象，这些代理对象包装了目标对象（即业务组件），以便在调用目标对象的方法前后插入额外的行为（如安全检查、事务管理、日志记录等）。
JDK动态代理：当目标对象实现了一个或多个接口时，Spring AOP默认使用JDK的动态代理。JDK动态代理通过反射机制，为接口创建一个代理对象，这个代理对象会拦截对目标接口方法的所有调用。
CGLIB代理：如果目标对象没有实现任何接口，Spring AOP会退回到使用CGLIB库生成目标类的子类。CGLIB（Code Generation Library）是一个强大的高性能代码生成库，它在运行时扩展了Java类，并在子类中覆盖了方法来实现方法拦截。
无论使用哪种代理方式，目的都是在不改变原有业务逻辑代码的基础上，通过切面定义的通知在方法执行的不同阶段插入附加行为。
1.2 AOP基本术语 切面（Aspect）：切面是面向切面编程的核心，它是将横跨多个类的关注点（如日志记录、事务管理等）模块化的构造。一个切面可以包含多种类型的通知（Advice）和一个或多个切点（Pointcut），用于定义在何处以及何时执行这些通知。
连接点（Join Point）：连接点代表程序执行过程中的某个特定位置，Spring AOP限定这些位置为方法的调用。简而言之，连接点就是能够插入切面通知的点。
通知（Advice）：通知定义了切面在连接点上要执行的动作。根据通知类型的不同，这些动作可以在方法调用之前、之后、返回结果后或抛出异常时执行。通知类型包括：
前置通知（Before advice）：在方法执行之前执行。后置通知（After advice）：在方法执行后执行，无论其结果如何。返回后通知（After-returning advice）：在方法成功执行之后执行。异常后通知（After-throwing advice）：在方法抛出异常后执行。环绕通知（Around advice）：在方法执行之前和之后执行，提供对方法调用的全面控制。 切点（Pointcut）：切点是一个表达式，切点表达式允许通过方法名称、访问修饰符等条件来匹配连接点，决定了通知应该在哪些方法执行时触发。
目标对象（Target Object）：被一个或多个切面所通知的对象。也被称为被代理对象。
AOP代理（AOP Proxy）：AOP框架创建的对象，用于实现切面契约（由通知和切点定义）。在Spring AOP中，AOP代理可以是JDK动态代理或CGLIB代理。
引入（Introduction）：引入允许向现有的类添加新的方法或属性。这是通过定义一个或多个附加接口（Introduction interfaces）实现的，AOP框架会为目标对象创建一个代理，该代理实现这些接口。
如果还是觉得抽象，我们再举一个电影制作的例子来类比
🎭 切面（Aspect）
想象一下，有人正在拍摄一部电影，而电影中的特效（比如爆炸和特殊光效）就像是应用程序中需要处理的横切关注点（比如日志记录或事务管理）。这些特效会在电影的许多不同场景中出现，而不仅仅局限于某一个特定场景。在AOP中，这些“特效”就是切面，它们可以被应用到程序的多个部分，而不需要改变实际的场景（或代码）。
📍 连接点（Join Point）
继续使用电影的比喻，每个场景中的特定时刻，比如一个爆炸发生的瞬间，可以看作是一个连接点。在编程中，这通常对应于方法的调用。
📣 通知（Advice）
通知就像是导演对特效团队的具体指令，比如“在这个场景开始之前加入一个爆炸效果”或“场景结束后显示烟雾渐散的效果”。这些指令告诉特效团队在电影的哪个具体时刻应该添加特定的效果。在AOP中，这些“指令”就是通知，指定了切面（特效）应该在连接点（特定的代码执行时刻）之前、之后或周围执行。
🎯 切点（Pointcut）
如果说通知是导演对特效团队的指令，那么切点就是指令中包含的具体条件，比如“所有夜晚的外景戏”。切点定义了哪些连接点（比如哪些具体的方法调用）应该接收通知（特效指令）。
🎬 目标对象（Target Object）
目标对象就是那些需要添加特效的场景。在我们的编程比喻中，它们是那些被切面逻辑影响的对象（比如需要日志记录的类）。
🕵️‍♂️ AOP代理（AOP Proxy）">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-12T17:59:27+08:00">
    <meta property="article:modified_time" content="2024-05-12T17:59:27+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Spring高手之路18——从XML配置角度理解Spring AOP</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#1_Spring_AOP_7" rel="nofollow">1. Spring AOP与动态代理</a></li><li><ul><li><a href="#11_Spring_AOP_8" rel="nofollow">1.1 Spring AOP和动态代理的关系</a></li><li><a href="#12_AOP_19" rel="nofollow">1.2 AOP基本术语</a></li></ul> 
  </li><li><a href="#2_XMLSpring_AOP_67" rel="nofollow">2. 通过XML配置实现Spring AOP</a></li><li><ul><li><a href="#21_Spring_84" rel="nofollow">2.1 添加Spring依赖</a></li><li><a href="#22__111" rel="nofollow">2.2 定义业务接口和实现类</a></li><li><a href="#23__146" rel="nofollow">2.3 定义切面类</a></li><li><a href="#24_XML_196" rel="nofollow">2.4 配置XML</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="1_Spring_AOP_7"></a>1. Spring AOP与动态代理</h2> 
<h3><a id="11_Spring_AOP_8"></a>1.1 Spring AOP和动态代理的关系</h3> 
<p>  <code>Spring AOP</code>使用动态代理作为其主要机制来实现面向切面的编程。这种机制允许<code>Spring</code>在运行时动态地创建代理对象，这些代理对象包装了目标对象（即业务组件），以便在调用目标对象的方法前后插入额外的行为（如安全检查、事务管理、日志记录等）。</p> 
<ul><li> <p><strong>JDK动态代理</strong>：当目标对象实现了一个或多个接口时，<code>Spring AOP</code>默认使用<code>JDK</code>的动态代理。<code>JDK</code>动态代理通过反射机制，为接口创建一个代理对象，这个代理对象会拦截对目标接口方法的所有调用。</p> </li><li> <p><strong>CGLIB代理</strong>：如果目标对象没有实现任何接口，<code>Spring AOP</code>会退回到使用<code>CGLIB</code>库生成目标类的子类。<code>CGLIB</code>（<code>Code Generation Library</code>）是一个强大的高性能代码生成库，它在运行时扩展了<code>Java</code>类，并在子类中覆盖了方法来实现方法拦截。</p> </li></ul> 
<p>无论使用哪种代理方式，目的都是在不改变原有业务逻辑代码的基础上，通过切面定义的通知在方法执行的不同阶段插入附加行为。</p> 
<h3><a id="12_AOP_19"></a>1.2 AOP基本术语</h3> 
<ol><li> <p><strong>切面（Aspect）</strong>：切面是面向切面编程的核心，它是将横跨多个类的关注点（如日志记录、事务管理等）模块化的构造。一个切面可以包含多种类型的通知（<code>Advice</code>）和一个或多个切点（<code>Pointcut</code>），用于定义在何处以及何时执行这些通知。</p> </li><li> <p><strong>连接点（Join Point）</strong>：连接点代表程序执行过程中的某个特定位置，<code>Spring AOP</code>限定这些位置为方法的调用。简而言之，连接点就是能够插入切面通知的点。</p> </li><li> <p><strong>通知（Advice）</strong>：通知定义了切面在连接点上要执行的动作。根据通知类型的不同，这些动作可以在方法调用之前、之后、返回结果后或抛出异常时执行。通知类型包括：</p> </li></ol> 
<ul><li>前置通知（<code>Before advice</code>）：在方法执行之前执行。</li><li>后置通知（<code>After advice</code>）：在方法执行后执行，无论其结果如何。</li><li>返回后通知（<code>After-returning advice</code>）：在方法成功执行之后执行。</li><li>异常后通知（<code>After-throwing advice</code>）：在方法抛出异常后执行。</li><li>环绕通知（<code>Around advice</code>）：在方法执行之前和之后执行，提供对方法调用的全面控制。</li></ul> 
<ol start="4"><li> <p><strong>切点（Pointcut）</strong>：切点是一个表达式，切点表达式允许通过方法名称、访问修饰符等条件来匹配连接点，决定了通知应该在哪些方法执行时触发。</p> </li><li> <p><strong>目标对象（Target Object）</strong>：被一个或多个切面所通知的对象。也被称为被代理对象。</p> </li><li> <p><strong>AOP代理（AOP Proxy）</strong>：<code>AOP</code>框架创建的对象，用于实现切面契约（由通知和切点定义）。在<code>Spring AOP</code>中，<code>AOP</code>代理可以是<code>JDK</code>动态代理或<code>CGLIB</code>代理。</p> </li><li> <p><strong>引入（Introduction）</strong>：引入允许向现有的类添加新的方法或属性。这是通过定义一个或多个附加接口（<code>Introduction interfaces</code>）实现的，<code>AOP</code>框架会为目标对象创建一个代理，该代理实现这些接口。</p> </li></ol> 
<p>如果还是觉得抽象，我们再举一个电影制作的例子来类比</p> 
<ul><li> <p>🎭 <strong>切面（Aspect）</strong><br>   想象一下，有人正在拍摄一部电影，而电影中的特效（比如爆炸和特殊光效）就像是应用程序中需要处理的横切关注点（比如日志记录或事务管理）。这些特效会在电影的许多不同场景中出现，而不仅仅局限于某一个特定场景。在<code>AOP</code>中，这些“特效”就是切面，它们可以被应用到程序的多个部分，而不需要改变实际的场景（或代码）。</p> </li><li> <p>📍 <strong>连接点（Join Point）</strong><br>   继续使用电影的比喻，每个场景中的特定时刻，比如一个爆炸发生的瞬间，可以看作是一个连接点。在编程中，这通常对应于方法的调用。</p> </li><li> <p>📣 <strong>通知（Advice）</strong><br>   通知就像是导演对特效团队的具体指令，比如“在这个场景开始之前加入一个爆炸效果”或“场景结束后显示烟雾渐散的效果”。这些指令告诉特效团队在电影的哪个具体时刻应该添加特定的效果。在<code>AOP</code>中，这些“指令”就是通知，指定了切面（特效）应该在连接点（特定的代码执行时刻）之前、之后或周围执行。</p> </li><li> <p>🎯 <strong>切点（Pointcut）</strong><br>   如果说通知是导演对特效团队的指令，那么切点就是指令中包含的具体条件，比如“所有夜晚的外景戏”。切点定义了哪些连接点（比如哪些具体的方法调用）应该接收通知（特效指令）。</p> </li><li> <p>🎬 <strong>目标对象（Target Object）</strong><br>   目标对象就是那些需要添加特效的场景。在我们的编程比喻中，它们是那些被切面逻辑影响的对象（比如需要日志记录的类）。</p> </li><li> <p>🕵️‍♂️ <strong>AOP代理（AOP Proxy）</strong><br>   <code>AOP</code>代理就像是特效团队提供的一个虚拟的、可控制特效的场景副本。这个副本在观众看来与原场景无异，但实际上它能在导演需要的时刻自动添加特效。在编程中，代理是一个被<code>AOP</code>框架自动创建的对象，它包装了目标对象，确保了通知（特效指令）在正确的时间被执行。</p> </li><li> <p>🎁 <strong>引入（Introduction）</strong><br>   引入就好比是在电影中加入一个全新的角色或者场景，这在原本的脚本中并不存在。在<code>AOP</code>中，引入允许我们向现有的类添加新的方法或属性，这就像是在不改变原始脚本的情况下扩展电影的内容。</p> </li></ul> 
<h2><a id="2_XMLSpring_AOP_67"></a>2. 通过XML配置实现Spring AOP</h2> 
<p>  <code>Spring</code>提供了丰富的<code>AOP</code>支持，可以通过<code>XML</code>配置来定义切面、通知（<code>advice</code>）和切点（<code>pointcuts</code>）。这样可以在不修改源代码的情况下增加额外的行为（如日志、事务管理等）</p> 
<p>实现步骤：</p> 
<ol><li> <p><strong>添加Spring依赖</strong>：在项目的<code>pom.xml</code>中添加<code>Spring</code>框架和<code>AOP</code>相关的依赖。</p> </li><li> <p><strong>定义业务接口和实现类</strong>：创建业务逻辑接口及其实现，比如一个简单的服务类。</p> </li><li> <p><strong>定义切面类</strong>：创建一个切面类，用于定义前置、后置、环绕等通知。</p> </li><li> <p><strong>配置XML</strong>：在<code>applicationContext.xml</code>中配置切面和业务<code>bean</code>，以及<code>AOP</code>相关的标签。</p> </li></ol> 
<h3><a id="21_Spring_84"></a>2.1 添加Spring依赖</h3> 
<p>在<code>pom.xml</code>文件中，添加以下依赖</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-context<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.3.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-aop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.3.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.aspectj<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>aspectjweaver<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.9.6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h3><a id="22__111"></a>2.2 定义业务接口和实现类</h3> 
<p>首先，我们定义一个业务逻辑接口<code>MyService</code>和它的实现<code>MyServiceImpl</code>。</p> 
<p><strong>MyService.java:</strong></p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>aop</span><span class="token punctuation">;</span>


<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">MyService</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">String</span> <span class="token function">performAction</span><span class="token punctuation">(</span><span class="token class-name">String</span> input<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>MyServiceImpl.java:</strong></p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>aop</span><span class="token punctuation">;</span>


<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">MyService</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">performAction</span><span class="token punctuation">(</span><span class="token class-name">String</span> action<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Performing action in MyService: "</span> <span class="token operator">+</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"throw"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"Exception from MyService"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token string">"Action performed: "</span> <span class="token operator">+</span> action<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="23__146"></a>2.3 定义切面类</h3> 
<p>接下来，我们定义一个切面类<code>MyAspect</code>，这个类将包含一个前置通知（<code>advice</code>），它在<code>MyService</code>的<code>performAction</code>方法执行之前执行。</p> 
<p><strong>MyAspect.java:</strong></p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>aop</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>aspectj<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span><span class="token class-name">ProceedingJoinPoint</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyAspect</span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">// 前置通知</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">beforeAdvice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Before advice is running!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 后置通知</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterAdvice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"After advice is running!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 返回后通知</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterReturningAdvice</span><span class="token punctuation">(</span><span class="token class-name">Object</span> retVal<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"After returning advice is running! Return value: "</span> <span class="token operator">+</span> retVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 异常后通知</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterThrowingAdvice</span><span class="token punctuation">(</span><span class="token class-name">Throwable</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"After throwing advice is running! Exception: "</span> <span class="token operator">+</span> ex<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 环绕通知</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">aroundAdvice</span><span class="token punctuation">(</span><span class="token class-name">ProceedingJoinPoint</span> joinPoint<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Around advice: Before method execution"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Object</span> result <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            result <span class="token operator">=</span> joinPoint<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Around advice: After method execution"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="24_XML_196"></a>2.4 配置XML</h3> 
<p>最后，我们需要在<code>Spring</code>的配置文件<code>applicationContext.xml</code>中配置上述<code>bean</code>以及<code>AOP</code>的相关内容。</p> 
<p><strong>applicationContext.xml:</strong></p> 
<pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>aop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/aop<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans.xsd
                           http://www.springframework.org/schema/aop
                           http://www.springframework.org/schema/aop/spring-aop.xsd<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 
上面这是XML文件的头部声明，它定义了文件的版本和编码类型，同时引入了Spring beans 和 AOP 的命名空间。
通过这些命名空间，我们可以在XML中使用&lt;bean&gt;和&lt;aop:*&gt;标签。 
--&gt;</span>


    <span class="token comment">&lt;!-- Bean definitions --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myService<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.example.demo.aop.MyServiceImpl<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myAspect<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.example.demo.aop.MyAspect<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>


	<span class="token comment">&lt;!-- AOP配置 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>config</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 定义切面及其通知 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>aspect</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myAspectRef<span class="token punctuation">"</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myAspect<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- 定义切点，指定通知应该在哪些方法执行时触发 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>pointcut</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>serviceOperation<span class="token punctuation">"</span></span> <span class="token attr-name">expression</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>execution(* com.example.demo.aop.MyService.performAction(..))<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token comment">&lt;!-- 应用前置通知，指定方法执行前的操作 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>before</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>beforeAdvice<span class="token punctuation">"</span></span> <span class="token attr-name">pointcut-ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>serviceOperation<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token comment">&lt;!-- 应用后置通知，指定方法执行后的操作，不论方法执行成功还是抛出异常 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>after</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>afterAdvice<span class="token punctuation">"</span></span> <span class="token attr-name">pointcut-ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>serviceOperation<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token comment">&lt;!-- 应用返回后通知，指定方法成功执行并返回后的操作 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>after-returning</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>afterReturningAdvice<span class="token punctuation">"</span></span> <span class="token attr-name">pointcut-ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>serviceOperation<span class="token punctuation">"</span></span> <span class="token attr-name">returning</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>retVal<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token comment">&lt;!-- 应用异常后通知，指定方法抛出异常后的操作 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>after-throwing</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>afterThrowingAdvice<span class="token punctuation">"</span></span> <span class="token attr-name">pointcut-ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>serviceOperation<span class="token punctuation">"</span></span> <span class="token attr-name">throwing</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ex<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token comment">&lt;!-- 应用环绕通知，提供方法执行前后的完全控制 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>around</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>aroundAdvice<span class="token punctuation">"</span></span> <span class="token attr-name">pointcut-ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>serviceOperation<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>aspect</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>config</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<ul><li> <p><strong>myService</strong>：这是业务逻辑的<code>bean</code>，指向<code>MyServiceImpl</code>类的实例。</p> </li><li> <p><strong>myAspect</strong>：这是切面的<code>bean</code>，指向<code>MyAspect</code>类的实例。</p> </li><li> <p><strong><code>&lt;aop:config&gt;</code></strong>：这是<code>AOP</code>配置的根元素，所有的<code>AOP</code>配置，包括切面定义、切点和通知方法等，都需要在此元素内部定义。</p> </li><li> <p><strong>切面（Aspect）</strong>：通过<code>&lt;aop:aspect&gt;</code>元素定义，它包含了一系列通知（<code>advice</code>）和一个或多个切点（<code>pointcut</code>）。这个元素将切面类（包含通知逻辑的类）与具体的操作（如何、何时对目标对象进行增强）关联起来。</p> </li><li> <p><strong>切点（Pointcut）</strong>：通过<code>&lt;aop:pointcut&gt;</code>元素定义，切点通过表达式来指定，当需要精确控制哪些方法执行时会触发通知时，就需要定义切点。切点表达式可以非常精确地指定方法，例如通过方法名称、参数类型、注解等。<code>expression</code>定义了切点的表达式，指明了切点的匹配规则。这里的表达式<code>execution(* com.example.demo.aop.MyService.performAction(..))</code>意味着切点匹配<code>MyService</code>接口中<code>performAction</code>方法的执行，切点用于指定在哪些连接点（<code>Join Point</code>，例如方法调用）上应用通知。</p> </li></ul> 
<p><strong>关于解析表达式<code>execution(* com.example.demo.aop.MyService.performAction(..))</code></strong></p> 
<ol><li> <p><strong>execution</strong>：是最常用的切点函数，用于匹配方法执行的连接点。</p> </li><li> <p>*：表示方法的返回类型是任意的。</p> </li><li> <p><strong>com.example.demo.aop.MyService.performAction</strong>：指定了全路径的接口名和方法名。</p> </li><li> <p><strong>(…)</strong>：表示方法参数是任意的，无论方法有多少个参数都匹配。</p> </li></ol> 
<ul><li> <p><strong>连接点（Join Point）</strong>：<strong>连接点是指在程序执行过程中的某一点，比如方法的调用。</strong> 连接点是通过切点（<code>Pointcut</code>）的表达式来识别和匹配的，<code>execution(* com.example.demo.aop.MyService.performAction(..))</code>表达式定义了一个切点，它指定了一个明确的连接点集合——即<code>MyService</code>接口的<code>performAction</code>方法的所有调用。这个例子中，<code>MyService</code>接口的<code>performAction</code>方法的调用就是潜在的连接点。每次<code>performAction</code><strong>方法被调用时，就达到了一个连接点</strong>。这个连接点就是这里通知应用的时机。</p> </li><li> <p><strong>通知（Advice）</strong>：这是<code>AOP</code>通过在特定时机执行的操作来增强方法的执行。<code>method</code>属性指明当切点匹配时应该执行的切面的方法名，<code>pointcut-ref</code>引用了上面定义的切点。比如这里的<code>beforeAdvice</code>是在目标方法<code>performAction</code>执行之前被调用的方法。这意味着每当<code>MyService.performAction(..)</code>方法被调用时，<code>beforeAdvice</code>方法将首先被执行。</p> </li></ul> 
<p>  总结为一句话：<code>Spring AOP</code>通过在切面中定义规则（切点）来指定何时（连接点）以及如何（通知）增强特定方法，实现代码的模块化和关注点分离，无需修改原有业务逻辑。</p> 
<p>  通过这种方式，<code>Spring AOP</code> 允许定义在特定方法执行前、执行后、环绕执行等时机插入自定义逻辑，而无需修改原有业务逻辑代码。这是实现关注点分离的一种强大机制，特别是对于跨越应用程序多个部分的横切关注点（如日志、事务管理等）。</p> 
<p>注意，如果<code>&lt;aop:config&gt;</code>设置为</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>config</span> <span class="token attr-name">proxy-target-class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 其他配置不变 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>config</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>设置<code>proxy-target-class="true"</code>会使<code>Spring AOP</code>优先使用<code>CGLIB</code>代理，即使目标对象实现了接口。默认情况下，不需要设置<code>proxy-target-class</code>属性，或者将其设置为<code>false</code>，则是使用<code>JDK</code>动态代理。</p> 
<p>主程序：</p> 
<p><strong>DemoApplication.java:</strong></p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>aop<span class="token punctuation">.</span></span><span class="token class-name">MyService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">ClassPathXmlApplicationContext</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoApplication</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">ClassPathXmlApplicationContext</span> context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token string">"applicationContext.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">MyService</span> myService <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">MyService</span><span class="token punctuation">)</span> context<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">"myService"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>myService<span class="token punctuation">.</span><span class="token function">performAction</span><span class="token punctuation">(</span><span class="token string">"normal"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"======================="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>myService<span class="token punctuation">.</span><span class="token function">performAction</span><span class="token punctuation">(</span><span class="token string">"throw"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Exception caught in main: "</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        context<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>运行结果：</p> 
<p><img src="https://images2.imgbox.com/8d/1f/Xdp0pCdo_o.png" alt="在这里插入图片描述"></p> 
<p>  通过结合动态代理技术和这些<code>AOP</code>概念，<code>Spring AOP</code>能够以非侵入式的方式为应用程序提供横切关注点的支持，这样开发者就可以将这些关注点模块化，并保持业务逻辑组件的聚焦和简洁。</p> 
<p>  如果对动态代理感兴趣可以再调试看看，这里是<code>JDK</code>动态代理是因为<code>public class MyServiceImpl implements MyService</code> 实现了接口，调试如下：</p> 
<p><img src="https://images2.imgbox.com/66/f0/6kH8908J_o.png" alt="在这里插入图片描述"></p> 
<p>简单说一下这里能看到的关键类和接口</p> 
<ul><li> <p><strong>ProxyFactory</strong>: 这是<code>Spring AOP</code>用来创建代理对象的工厂类。它可以根据目标对象是否实现接口来决定使用<code>JDK</code>动态代理还是<code>CGLIB</code>代理。</p> </li><li> <p><strong>AopProxy</strong>: 这个接口定义了获取代理对象的方法。它有两个主要实现：<code>JdkDynamicAopProxy</code>（用于<code>JDK</code>动态代理）和<code>CglibAopProxy</code>（用于<code>CGLIB</code>代理）。</p> </li><li> <p><strong>JdkDynamicAopProxy</strong>: 实现了<code>AopProxy</code>接口，使用<code>JDK</code>动态代理技术创建代理。它实现了<code>InvocationHandler</code>接口，拦截对代理对象的所有方法调用。</p> </li><li> <p><strong>CglibAopProxy</strong>: 同样实现了<code>AopProxy</code>接口，但使用<code>CGLIB</code>库来创建代理对象。对于没有实现接口的类，<code>Spring</code>会选择这种方式来创建代理。</p> </li></ul> 
<p>如果大家想深入了解<code>Spring AOP</code>的源码，可以直接查看<code>JdkDynamicAopProxy</code>和<code>CglibAopProxy</code>这两个类的实现。这里不是本篇重点，简单提一下：</p> 
<p>比如在<code>JdkDynamicAopProxy</code>中看到动态代理的实现：</p> 
<ol><li> <p><code>JdkDynamicAopProxy</code>类实现了<code>InvocationHandler</code>接口，这是<code>JDK</code>动态代理的核心。在其<code>invoke</code>方法中，会有逻辑判断是否需要对调用进行拦截，并在调用前后应用相应的通知。</p> </li><li> <p>创建代理的过程主要是在<code>ProxyFactory</code>通过调用<code>createAopProxy()</code>方法时完成的，这个方法会根据配置返回<code>JdkDynamicAopProxy</code>或<code>CglibAopProxy</code>的实例。</p> </li><li> <p>代理的使用：客户端代码通过<code>ProxyFactory</code>获取代理对象，并通过这个代理对象调用目标方法。代理对象在内部使用<code>JdkDynamicAopProxy</code>或<code>CglibAopProxy</code>来拦截这些调用，并根据<code>AOP</code>配置执行通知。通过<code>ProxyFactory</code>获取代理对象的过程，通常在<code>Spring</code>的配置和使用中是隐式完成的，特别是在使用<code>Spring</code>容器管理<code>AOP</code>时。这一过程不需要开发者直接调用<code>ProxyFactory</code>类。当<code>Spring</code>配置中定义了一个<code>bean</code>，并对其应用了切面，<code>Spring</code>容器会自动处理代理的创建和应用通知的过程。这是通过<code>Spring</code>的后处理器和<code>AOP</code>命名空间的支持实现的，开发者通常只需声明式地配置切面和通知即可。</p> </li></ol> 
<p>如果想看到<code>CGLIB</code>代理，这里有<code>2</code>种方法</p> 
<p>第<code>1</code>种方法是去掉<code>MyServiceImpl</code>实现的<code>MyService</code>接口，然后把主程序和<code>expression</code>表达式对应的地方改成<code>MyServiceImpl</code>。<br> 第<code>2</code>种方法就是<code>Spring</code>配置文件中显式设置<code>&lt;aop:config&gt;</code>标签的<code>proxy-target-class="true"</code>属性来实现这一点。如下：</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>config</span> <span class="token attr-name">proxy-target-class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 其他配置保持不变 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>config</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>调试如下：<br> <img src="https://images2.imgbox.com/fb/f4/1aEW2lDG_o.png" alt="在这里插入图片描述"></p> 
<br> 欢迎一键三连~ 
<br> 
<br> 有问题请留言，大家一起探讨学习 
<br> 
<br> ----------------------Talk is cheap, show me the code-----------------------
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/23c09433bffb9158484136d84caea2e5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">大学生体质测试|基于Springboot＋vue的大学生体质测试管理系统设计与实现(源码&#43;数据库&#43;文档)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/eb8e13ce968a398d36039571529c8e0d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">录制第一个jmeter性能测试脚本2(http协议)——webtour</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>