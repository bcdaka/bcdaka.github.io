<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Transmission的容器化部署与webui增强、权限设置 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/3ca42bb13fdfb44e649cdb2ccfc5f106/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Transmission的容器化部署与webui增强、权限设置">
  <meta property="og:description" content="Transmission是一款流行的BitTorrent客户端，也是很多PT站推荐的客户端，和qBittorrent相比两者各有特色。本文介绍在armbian上容器化安装部署transmission的方法，并将保存目录映射为外置硬盘、增强/美化webui界面等配置方法一并进行说明。本文是盒子/NAS党主题博文的其中一篇，示例平台为大街货S905l3a方案盒子，更多相关内容敬请关注「」。
安装与使用 基于ophub非官方armbian，使用armbian-software脚本，可以很方便的安装、卸载、升级相关的软件包docker镜像。
armbian-software armbian-software脚本加载后，输入104以选择transmission。
脚本自动拉取transmission镜像并创建、加载容器，在拉取前，需要指定transmission的管理员用户名、密码。默认管理员用户名为admin，可保持，密码建议自行设定，而不是使用系统随机生成的。
正常情况下，脚本会启动transmission容器并成功加载运行。
这时就可以使用http://ip:9091打开transmission web，在其中点击左上角的图标，即可添加p2p种子文件，可以手动指定下载保存目录，点击『Add』就可以开启pt下载了。
默认保存目录配置为外置硬盘挂载点 使用以下命令查看目录映射关系，在上面的图示中可以看到剩余空间为11.88GB，这是老E的m401a盒子根文件系统下剩余的全部存储空间。因此，嵌入式设备上务必在使用前进行编辑修改，否则默认的保存目录会导致设备空间迅速耗尽。
docker inspect transmission | grep Mounts -A 30 armbian-software脚本默认配置的映射关系如下，“亮点”是&#34;/opt/downloads&#34;，完全没有考虑 TVBox 的设备状况和需求。新手上来就用，一不留神就会“中招”，表现为下载个几分钟盒子空间就100%使用率了。通常情况下，不会有人将外置存储的挂载点设置为/opt/downloads，4K乃至8K内容的转移也非常耗时。
​编辑
我们需要先停止、删除容器，配置好外置硬盘挂载点，使用正确的映射关系重新创建、加载transmission容器。
docker stop transmission docker rm -f transmission docker run -d --name transmission \ -e USER=admin \ -e PASS=pass1234 \ -e TZ=Asia/Shanghai \ -p 9091:9091 \ -p 51413:51413 \ -p 51413:51413/udp \ -v /opt/docker/transmission/config:/config \ -v /media/sda1/downloads:/downloads \ -v /opt/docker/transmission/watch/folder:/watch \ --restart unless-stopped linuxserver/transmission:arm64v8-latest 上述命令中的/mnt/sda1是我们创建的外置硬盘挂载点，参见上期博文「Armbian下挂载多硬盘」。重新创建、运行transmission容器后，再打开web页可以看到默认的下载保存目录剩余空间的变化，新手很难理解变化背后的原因，甚至也不会去修改保存目录。
​编辑">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-13T12:29:52+08:00">
    <meta property="article:modified_time" content="2024-03-13T12:29:52+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Transmission的容器化部署与webui增强、权限设置</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>Transmission是一款流行的BitTorrent客户端，也是很多PT站推荐的客户端，和qBittorrent相比两者各有特色。本文介绍在armbian上容器化安装部署transmission的方法，并将保存目录映射为外置硬盘、增强/美化webui界面等配置方法一并进行说明。本文是盒子/NAS党主题博文的其中一篇，示例平台为大街货S905l3a方案盒子，更多相关内容敬请关注「<a class="link-info" href="https://appscross.com" rel="nofollow" title="我的个人博客"></a>」。</p> 
<h3><strong>安装与使用</strong></h3> 
<p>基于ophub非官方armbian，使用armbian-software脚本，可以很方便的安装、卸载、升级相关的软件包docker镜像。</p> 
<pre>armbian-software</pre> 
<p>armbian-software脚本加载后，输入104以选择transmission。</p> 
<p></p> 
<p class="img-center"><img alt="select 104 to pull and start transmission" height="439" src="https://images2.imgbox.com/e2/9a/N7qSYLkN_o.png" width="848"></p> 
<p>脚本自动拉取transmission镜像并创建、加载容器，在拉取前，需要指定transmission的管理员用户名、密码。默认管理员用户名为admin，可保持，密码建议自行设定，而不是使用系统随机生成的。</p> 
<p></p> 
<p class="img-center"><img alt="" height="392" src="https://images2.imgbox.com/6d/d1/FDxbXZRJ_o.png" width="893"></p> 
<p>正常情况下，脚本会启动transmission容器并成功加载运行。</p> 
<p></p> 
<p class="img-center"><img alt="transmission docker" height="137" src="https://images2.imgbox.com/88/b5/ndQKB0zs_o.png" width="1200"></p> 
<p></p> 
<p>这时就可以使用http://ip:9091打开transmission web，在其中点击左上角的图标，即可添加p2p种子文件，可以手动指定下载保存目录，点击『Add』就可以开启pt下载了。</p> 
<p></p> 
<p class="img-center"><img alt="web ui of transmission" height="701" src="https://images2.imgbox.com/de/cf/9dvCwsxm_o.png" width="1200"></p> 
<p></p> 
<h3><strong>默认保存目录配置为外置硬盘挂载点</strong></h3> 
<p>使用以下命令查看目录映射关系，在上面的图示中可以看到剩余空间为11.88GB，这是老E的m401a盒子根文件系统下剩余的全部存储空间。因此，嵌入式设备上务必在使用前进行编辑修改，否则默认的保存目录会导致设备空间迅速耗尽。</p> 
<pre>docker inspect transmission | grep Mounts -A 30</pre> 
<p>armbian-software脚本默认配置的映射关系如下，“亮点”是"/opt/downloads"，完全没有考虑 TVBox 的设备状况和需求。新手上来就用，一不留神就会“中招”，表现为下载个几分钟盒子空间就100%使用率了。通常情况下，不会有人将外置存储的挂载点设置为/opt/downloads，4K乃至8K内容的转移也非常耗时。</p> 
<p><a href="https://appscross.com/wp-content/uploads/2024/02/transmission-env.png" rel="nofollow" title="​编辑">​编辑</a></p> 
<p>我们需要先停止、删除容器，配置好外置硬盘挂载点，使用正确的映射关系重新创建、加载transmission容器。</p> 
<pre>docker stop transmission
docker rm -f transmission

docker run -d --name transmission \
-e USER=admin \
-e PASS=pass1234 \
-e TZ=Asia/Shanghai \
-p 9091:9091 \
-p 51413:51413 \
-p 51413:51413/udp \
-v /opt/docker/transmission/config:/config \
-v /media/sda1/downloads:/downloads \
-v /opt/docker/transmission/watch/folder:/watch \
--restart unless-stopped linuxserver/transmission:arm64v8-latest</pre> 
<p>上述命令中的/mnt/sda1是我们创建的外置硬盘挂载点，参见上期博文「<a href="https://appscross.com/2024/02/armbian-mount-multiple-hard-disks/" rel="nofollow" title="Armbian下挂载多硬盘">Armbian下挂载多硬盘</a>」。重新创建、运行transmission容器后，再打开web页可以看到默认的下载保存目录剩余空间的变化，新手很难理解变化背后的原因，甚至也不会去修改保存目录。</p> 
<p><a href="https://appscross.com/wp-content/uploads/2024/02/aftermod-trans.png" rel="nofollow" title="​编辑">​编辑</a></p> 
<h3><strong>Web control增强</strong></h3> 
<p>默认的 transmission web control 界面比较简陋，虽然够用，但可以使用增强版的 html/css 项目进行替换以获得更好的体验。增强版 Web UI 的 github 仓库地址如下：</p> 
<p><a href="https://github.com/ronggang/transmission-web-control" title="ronggang/transmission-web-control: 一个 Transmission 浏览器管理界面">ronggang/transmission-web-control: 一个 Transmission 浏览器管理界面</a></p> 
<p>git 仓库后，我们将 src 整个目录上传至 armbian 服务器目录，本文指定的目录为/ opt/docker/transmission，并将 src 更名为 enhance-webui。需要单独的 src 压缩包可点「<a href="https://appscross.com/Sharetools/Tools%20Share/transmission/enhance-webui.7z" rel="nofollow" title="此处">此处</a>」直接下载。</p> 
<p></p> 
<p class="img-center"><img alt="files of transmission web control" height="166" src="https://images2.imgbox.com/fd/4f/uI3M236L_o.png" width="537"></p> 
<p></p> 
<p>停止、删除容器后，使用以下命令重新创建、加载即可。重点在于制定了环境变量 TRANSMISSION_WEB_HOME 为/webui，而  /webui 映射为宿主机中的 /opt/docker/transmission/enhance-webui 目录。很多有关NAS下配置tr的文档“朦朦胧胧”，根本上是完全不懂linux的人在写linux。</p> 
<pre>docker run -d --name transmission \
-e TRANSMISSION_WEB_HOME=/webui \
-e USER=admin \
-e PASS=pass1234 \
-e TZ=Asia/Shanghai \
-p 9091:9091 \
-p 51413:51413 \
-p 51413:51413/udp \
-v /opt/docker/transmission/enhance-webui:/webui \
-v /opt/docker/transmission/config:/config \
-v /media/sda1/downloads:/downloads \
-v /opt/docker/transmission/watch/folder:/watch \
--restart unless-stopped linuxserver/transmission:arm64v8-latest</pre> 
<p>这样就可以使用transmission web control了。其实原版也不错，也有汉化的版本可以使用。</p> 
<p><a href="https://appscross.com/wp-content/uploads/2024/02/webcontrol.png" rel="nofollow" title="​编辑">​编辑</a></p> 
<p>至此，armbian下transmission容器化部署任务就完成了。需要注意以下几点：</p> 
<ul><li>docker命令直接拷贝、粘贴，手动输入出现错误应首先检查是否有多余空格或TAB，其次检查环境变量名称是否正确</li><li>镜像完整名称为linuxserver/transmission:arm64v8-latest，使用“linuxserver/transmission"等价于“linuxserver/transmission:latest"。因此，不添加版本tag会自动下载latest镜像，可能导致意外的兼容性问题</li><li>TRANSMISSION_WEB_HOME为web主目录，没有额外的文件/目录关系需要考虑</li></ul> 
<p>默认情况下，非官方armbian上的ufw都是禁用的，因此在初始配置jellyfin、transmission等服务时无需进行端口放行。建议在完成所有软件配置后，激活ufw，并放行所有需要的端口，对于transmission还需要额外在路由器中打开uPNP以及放行udp 51343端口转发。</p> 
<h3><strong>Permission denied假红种问题的解决</strong></h3> 
<p>按照本文docker方式部署的transmission正常工作毫无问题，有可能会出现权限错误导致假红种问题。所谓假红种，表现为红种（种子为红色、进度条等也均为红色），但下载、分享、保种等功能均正常，报错为“Permission denied”。出现此类情况，我们只需要进入宿主机的映射目录，查看并修补权限。</p> 
<p></p> 
<p class="img-center"><img alt="fix permission denied" height="290" src="https://images2.imgbox.com/8c/5d/FfZrJklq_o.png" width="746"></p> 
<p>“Permission denied”导致的假红种，不涉及下载保存目录的权限设置，需要修补的是其他映射目录的权限配置。例如，上图中的resume、torrents、blocklists目录均需要写入权限，911是用户和组名。如果出现假性红种问题，将相应目录的属主修改为911即可，请勿采用“chmod -R 777”方法。</p> 
<pre>#将/opt/docker/transmission/config/resume替换为自己的映射目录
chown 911:911 /opt/docker/transmission/config/resume</pre> 
<p>正确的权限配置，可以确保不会出现假红种问题。</p> 
<p></p> 
<p class="img-center"><img alt="permission ok" height="433" src="https://images2.imgbox.com/8f/4a/1yXJEFGq_o.png" width="1200"></p> 
<p>因加载种子数量导致的红种，和映射目录的权限配置无关，报错一般为"Too many open files"，该问题在容器化部署时不会出现，因为“linuxserver/transmission”镜像的ulimit设置了超大值。</p> 
<p>「<a class="link-info" href="https://appscross.com/2024/02/armbian-mount-multiple-hard-disks/" rel="nofollow" title="Armbian下挂载多硬盘"></a>」​​​​​​​、「<a class="link-info" href="https://appscross.com/2024/02/jellyfin-cover-and-subtitles-garbled/" rel="nofollow" title="Jellyfin封面与字幕乱码解决方法"></a>」​​​​​​​等更多盒子党、NAS关注的内容，敬请关注gangkeji ...</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/749431d953826bdea97d37711cfc26b3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">最详细的Keycloak教程（建议收藏）：Keycloak实现手机号、验证码登陆——（三）基于springboot&amp;keycloak&#43;vue的前后端分离项目</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0bd0416d561e1fb2f6e3ba825e513232/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">深入了解Kafka的数据持久化机制</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>