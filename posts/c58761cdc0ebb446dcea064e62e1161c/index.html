<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>å­Ÿå¾·å°”éšæœºåŒ–ï¼ˆä¸‰ï¼‰â€”â€” å†ä¹Ÿä¸ç”¨æ‹…å¿ƒç½‘ç»œæˆ–å…¶ä»–å„ç§æŠ¥é”™å•¦ | ä»æ•°æ®åº“ä¸‹è½½æ•°æ®åˆ°æœ¬åœ°çš„æ•°æ®å¤„ç†æ–¹æ³• - ç¼–ç¨‹å¤§å’–</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/c58761cdc0ebb446dcea064e62e1161c/">
  <meta property="og:site_name" content="ç¼–ç¨‹å¤§å’–">
  <meta property="og:title" content="å­Ÿå¾·å°”éšæœºåŒ–ï¼ˆä¸‰ï¼‰â€”â€” å†ä¹Ÿä¸ç”¨æ‹…å¿ƒç½‘ç»œæˆ–å…¶ä»–å„ç§æŠ¥é”™å•¦ | ä»æ•°æ®åº“ä¸‹è½½æ•°æ®åˆ°æœ¬åœ°çš„æ•°æ®å¤„ç†æ–¹æ³•">
  <meta property="og:description" content="å‰å‡ å¤©å’±ä»¬åˆ†äº«äº†çœ‹å®Œä¸ä¼šæ¥ææˆ‘ | å­Ÿå¾·å°”éšæœºåŒ–ä¸‡å­—é•¿æ–‡è¯¦è§£ï¼ˆäºŒï¼‰â€”â€” ä»£ç å®æ“ | é™„ä»£ç æ³¨é‡Š &#43; ç»“æœè§£è¯»ï¼Œå¾ˆå¤šå°ä¼™ä¼´ä»¬åæ˜ åœ¨ä½¿ç”¨ä»£ç ä¸‹è½½æ•°æ®æ—¶ä¼šé‡åˆ°å„ç§ç½‘ç»œæˆ–å…¶ä»–æŠ¥é”™é—®é¢˜ï¼Œä»¤äººå¤´å¤§çš„é‚£ç§ï¼ä¸è¦æ…Œï¼ä»æ•°æ®åº“ä¸‹è½½æ•°æ®åˆ°æœ¬åœ°çš„æ•°æ®å¤„ç†æ–¹æ³•è¿™å°±æ¥å•¦ï¼
å¦‚æœå°ä¼™ä¼´ä»¬æœ‰éœ€æ±‚çš„è¯ï¼Œå¯ä»¥åŠ å…¥æˆ‘ä»¬çš„äº¤æµç¾¤ï¼šä¸€å®šè¦çŸ¥é“ | æ°¸ä¹…å…è´¹çš„ç¯å¢ƒå‹å¥½å‹ç”Ÿä¿¡å­¦ä¹ äº¤æµç¾¤åˆåŒå’å•æ¥å•¦ï¼| ä¼´éšä¸å®šæœŸç¾¤å‹å¥½ç‰©åˆ†äº«ï¼åœ¨è¿™é‡Œï¼Œä½ å¯ä»¥ç¨æœ‰å…‹åˆ¶åœ°ç•…æ‰€æ¬²è¨€ï¼
è¶…çº§å»ºè®®å¤§å®¶åœ¨å…¥ç¾¤å‰æˆ–å…¥ç¾¤åå¯ä»¥çœ‹ä¸€ä¸‹è¿™ä¸ªï¼šå¹²è´§æ»¡æ»¡ | ç»™ç”Ÿä¿¡å°ç™½çš„å…¥é—¨å°å»ºè®® | æå¿ƒæè‚ºç‰ˆï¼ç»å¯¹å¹²è´§æ»¡æ»¡ï¼è®©ä½ ä¸è™šæ­¤çœ‹ï¼
å¦‚æœæœ‰éœ€è¦ä¸ªæ€§åŒ–å®šåˆ¶åˆ†ææœåŠ¡çš„å°ä¼™ä¼´ï¼Œå¯ä»¥çœ‹çœ‹è¿™é‡Œï¼šä½ è¦çš„ä¸ªæ€§åŒ–ç”Ÿä¿¡åˆ†ææœåŠ¡ä»Šå¤©æ­£å¼å¼€å¯å•¦ï¼å®šåˆ¶ä½ çš„ä¸“å±è§£å†³æ–¹æ¡ˆï¼å…¨ç¨‹1v1ç­”ç–‘ï¼ï¼ç»å¯¹åŒ…ä½ æ»¡æ„ï¼
ç›´æ¥å¼€å§‹ï¼
æ•°æ®è¦æ±‚ åœ¨è¿›è¡Œ**å­Ÿå¾·å°”éšæœºåŒ–ï¼ˆMendelian Randomizationï¼ŒMRï¼‰**åˆ†ææ—¶ï¼Œå…³äºæ›éœ²å› å­çš„ GWAS æ•°æ®ï¼ŒTwoSampleMRéœ€è¦ä¸€ä¸ªå·¥å…·å˜é‡æ•°æ®æ¡†ï¼Œè¦æ±‚æ¯è¡Œå¯¹åº”ä¸€ä¸ª SNPï¼Œè‡³å°‘éœ€è¦ 4 åˆ—æœ€åŸºæœ¬ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼š
SNP - rsIDï¼ŒrsID æ˜¯ SNP çš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚beta - æ•ˆåº”å¤§å°ã€‚å¦‚æœæ˜¯åˆ†ç±»å˜é‡ï¼Œæˆ‘ä»¬å°±è¦ä½¿ç”¨log(OR)ï¼Œè¯¦è§ï¼šçœ‹å®Œä¸ä¼šæ¥ææˆ‘ | å­Ÿå¾·å°”éšæœºåŒ–ä¸‡å­—é•¿æ–‡è¯¦è§£ï¼ˆäºŒï¼‰â€”â€” ä»£ç å®æ“ | é™„ä»£ç æ³¨é‡Š &#43; ç»“æœè§£è¯»ã€‚se - æ•ˆåº”å¤§å°çš„æ ‡å‡†è¯¯å·®effect_allele - æ•ˆåº”ç­‰ä½åŸºå›  æˆ‘ä»¬ä¹Ÿå¯ä»¥æä¾›ä»¥ä¸‹å¯¹ MR æœ‰ç”¨çš„å…¶ä»–ä¿¡æ¯ï¼š
other_allele - éæ•ˆåº”ç­‰ä½åŸºå› eaf - æ•ˆåº”ç­‰ä½åŸºå› é¢‘ç‡Phenotype - SNPå…·æœ‰æ•ˆåº”çš„è¡¨å‹åç§° æˆ‘ä»¬è¿˜å¯ä»¥æä¾›ä»¥ä¸‹é¢å¤–ä¿¡æ¯ï¼ˆéå¿…é¡»ï¼‰ï¼š
chr - SNP æ‰€åœ¨çš„æŸ“è‰²ä½“position - SNP åœ¨æŸ“è‰²ä½“ä¸Šçš„ä½ç½®samplesize - ç”¨äºä¼°è®¡æ•ˆåº”å¤§å°çš„æ ·æœ¬å¤§å°ncase - ç—…ä¾‹æ•°é‡ncontrol - å¯¹ç…§ç»„æ•°é‡pval - SNP ä¸æ›éœ²å› å­å…³è”çš„ P å€¼units - ä»¥å“ªç§å•ä½å‘ˆç°æ•ˆåº”gene - SNP çš„åŸºå› æˆ–å…¶ä»–æ³¨é‡Š æ³¨æ„æ³¨æ„ï¼šä¸åŒæ¥æºçš„æ•°æ®å¯èƒ½åˆ—åä¼šæœ‰äº›è®¸å·®å¼‚ï¼Œå¤§å®¶è¦æ³¨æ„å“ˆï¼">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-19T15:03:25+08:00">
    <meta property="article:modified_time" content="2024-04-19T15:03:25+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§å’–" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§å’–</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">å­Ÿå¾·å°”éšæœºåŒ–ï¼ˆä¸‰ï¼‰â€”â€” å†ä¹Ÿä¸ç”¨æ‹…å¿ƒç½‘ç»œæˆ–å…¶ä»–å„ç§æŠ¥é”™å•¦ | ä»æ•°æ®åº“ä¸‹è½½æ•°æ®åˆ°æœ¬åœ°çš„æ•°æ®å¤„ç†æ–¹æ³•</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>å‰å‡ å¤©å’±ä»¬åˆ†äº«äº†<a href="https://mp.weixin.qq.com/s/ikBZvr3ivKcm1yrT-R5Q9g" rel="nofollow">çœ‹å®Œä¸ä¼šæ¥ææˆ‘ | å­Ÿå¾·å°”éšæœºåŒ–ä¸‡å­—é•¿æ–‡è¯¦è§£ï¼ˆäºŒï¼‰â€”â€” ä»£ç å®æ“ | é™„ä»£ç æ³¨é‡Š + ç»“æœè§£è¯»</a>ï¼Œå¾ˆå¤šå°ä¼™ä¼´ä»¬åæ˜ åœ¨ä½¿ç”¨ä»£ç ä¸‹è½½æ•°æ®æ—¶ä¼šé‡åˆ°å„ç§ç½‘ç»œæˆ–å…¶ä»–æŠ¥é”™é—®é¢˜ï¼Œä»¤äººå¤´å¤§çš„é‚£ç§ï¼ä¸è¦æ…Œï¼ä»æ•°æ®åº“ä¸‹è½½æ•°æ®åˆ°æœ¬åœ°çš„æ•°æ®å¤„ç†æ–¹æ³•è¿™å°±æ¥å•¦ï¼</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/e8/c0/VMyPx7TF_o.png" alt="" width="480" height="500"></p> 
<hr> 
<ul><li> <p>å¦‚æœå°ä¼™ä¼´ä»¬æœ‰éœ€æ±‚çš„è¯ï¼Œå¯ä»¥åŠ å…¥æˆ‘ä»¬çš„äº¤æµç¾¤ï¼š<a href="https://mp.weixin.qq.com/s/ZMtinXdk5ZL8MypocjwRwg" rel="nofollow">ä¸€å®šè¦çŸ¥é“ | æ°¸ä¹…å…è´¹çš„ç¯å¢ƒå‹å¥½å‹ç”Ÿä¿¡å­¦ä¹ äº¤æµç¾¤åˆåŒå’å•æ¥å•¦ï¼| ä¼´éšä¸å®šæœŸç¾¤å‹å¥½ç‰©åˆ†äº«</a>ï¼åœ¨è¿™é‡Œï¼Œä½ å¯ä»¥ç¨æœ‰å…‹åˆ¶åœ°ç•…æ‰€æ¬²è¨€ï¼</p> </li><li> <p>è¶…çº§å»ºè®®å¤§å®¶åœ¨å…¥ç¾¤å‰æˆ–å…¥ç¾¤åå¯ä»¥çœ‹ä¸€ä¸‹è¿™ä¸ªï¼š<a href="https://mp.weixin.qq.com/s/QVcB9fXxbEwApPHkBZVAjg" rel="nofollow">å¹²è´§æ»¡æ»¡ | ç»™ç”Ÿä¿¡å°ç™½çš„å…¥é—¨å°å»ºè®® | æå¿ƒæè‚ºç‰ˆ</a>ï¼ç»å¯¹å¹²è´§æ»¡æ»¡ï¼è®©ä½ ä¸è™šæ­¤çœ‹ï¼</p> </li><li> <p>å¦‚æœæœ‰éœ€è¦ä¸ªæ€§åŒ–å®šåˆ¶åˆ†ææœåŠ¡çš„å°ä¼™ä¼´ï¼Œå¯ä»¥çœ‹çœ‹è¿™é‡Œï¼š<a href="https://mp.weixin.qq.com/s/5NsIqPzJr2JosUvWc1JrOQ" rel="nofollow">ä½ è¦çš„ä¸ªæ€§åŒ–ç”Ÿä¿¡åˆ†ææœåŠ¡ä»Šå¤©æ­£å¼å¼€å¯å•¦ï¼å®šåˆ¶ä½ çš„ä¸“å±è§£å†³æ–¹æ¡ˆï¼å…¨ç¨‹1v1ç­”ç–‘ï¼</a>ï¼ç»å¯¹åŒ…ä½ æ»¡æ„ï¼</p> </li></ul> 
<hr> 
<p>ç›´æ¥å¼€å§‹ï¼</p> 
<h3><a id="_15"></a>æ•°æ®è¦æ±‚</h3> 
<p>åœ¨è¿›è¡Œ**å­Ÿå¾·å°”éšæœºåŒ–ï¼ˆMendelian Randomizationï¼ŒMRï¼‰**åˆ†ææ—¶ï¼Œå…³äºæ›éœ²å› å­çš„ GWAS æ•°æ®ï¼Œ<code>TwoSampleMR</code>éœ€è¦ä¸€ä¸ªå·¥å…·å˜é‡æ•°æ®æ¡†ï¼Œè¦æ±‚æ¯è¡Œå¯¹åº”ä¸€ä¸ª SNPï¼Œè‡³å°‘éœ€è¦ 4 åˆ—æœ€åŸºæœ¬ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼š</p> 
<ul><li><strong>SNP</strong> - rsIDï¼ŒrsID æ˜¯ SNP çš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚</li><li><strong>beta</strong> - æ•ˆåº”å¤§å°ã€‚å¦‚æœæ˜¯åˆ†ç±»å˜é‡ï¼Œæˆ‘ä»¬å°±è¦ä½¿ç”¨log(OR)ï¼Œè¯¦è§ï¼š<a href="https://mp.weixin.qq.com/s/ikBZvr3ivKcm1yrT-R5Q9g" rel="nofollow">çœ‹å®Œä¸ä¼šæ¥ææˆ‘ | å­Ÿå¾·å°”éšæœºåŒ–ä¸‡å­—é•¿æ–‡è¯¦è§£ï¼ˆäºŒï¼‰â€”â€” ä»£ç å®æ“ | é™„ä»£ç æ³¨é‡Š + ç»“æœè§£è¯»</a>ã€‚</li><li><strong>se</strong> - æ•ˆåº”å¤§å°çš„æ ‡å‡†è¯¯å·®</li><li><strong>effect_allele</strong> - æ•ˆåº”ç­‰ä½åŸºå› </li></ul> 
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥æä¾›ä»¥ä¸‹å¯¹ MR æœ‰ç”¨çš„å…¶ä»–ä¿¡æ¯ï¼š</p> 
<ul><li><strong>other_allele</strong> - éæ•ˆåº”ç­‰ä½åŸºå› </li><li><strong>eaf</strong> - æ•ˆåº”ç­‰ä½åŸºå› é¢‘ç‡</li><li><strong>Phenotype</strong> - SNPå…·æœ‰æ•ˆåº”çš„è¡¨å‹åç§°</li></ul> 
<p>æˆ‘ä»¬è¿˜å¯ä»¥æä¾›ä»¥ä¸‹é¢å¤–ä¿¡æ¯ï¼ˆéå¿…é¡»ï¼‰ï¼š</p> 
<ul><li><strong>chr</strong> - SNP æ‰€åœ¨çš„æŸ“è‰²ä½“</li><li><strong>position</strong> - SNP åœ¨æŸ“è‰²ä½“ä¸Šçš„ä½ç½®</li><li><strong>samplesize</strong> - ç”¨äºä¼°è®¡æ•ˆåº”å¤§å°çš„æ ·æœ¬å¤§å°</li><li><strong>ncase</strong> - ç—…ä¾‹æ•°é‡</li><li><strong>ncontrol</strong> - å¯¹ç…§ç»„æ•°é‡</li><li><strong>pval</strong> - SNP ä¸æ›éœ²å› å­å…³è”çš„ P å€¼</li><li><strong>units</strong> - ä»¥å“ªç§å•ä½å‘ˆç°æ•ˆåº”</li><li><strong>gene</strong> - SNP çš„åŸºå› æˆ–å…¶ä»–æ³¨é‡Š</li></ul> 
<blockquote> 
 <p>æ³¨æ„æ³¨æ„ï¼šä¸åŒæ¥æºçš„æ•°æ®å¯èƒ½åˆ—åä¼šæœ‰äº›è®¸å·®å¼‚ï¼Œå¤§å®¶è¦æ³¨æ„å“ˆï¼</p> 
</blockquote> 
<p>å¤§å®¶åœ¨ä¸‹è½½å®Œæˆåå¯ä»¥æ£€æŸ¥ä¸€ä¸‹æ•°æ®æ˜¯å¦ç¬¦åˆè¦æ±‚ï¼Œä»æ•°æ®åº“ä¸‹è½½çš„è¿˜å¥½ï¼Œä¸€èˆ¬ä¸ä¼šæœ‰é—®é¢˜ï¼Œä¸»è¦æ˜¯å¤§å®¶ä»ç›¸å…³æ–‡çŒ®è·å–æ•°æ®çš„æ—¶å€™è¦æ³¨æ„è¿™ä¸ªé—®é¢˜ã€‚</p> 
<h3><a id="_IEU__46"></a>ä» IEU æ•°æ®åº“è·å–æ•°æ®</h3> 
<h4><a id="_48"></a>æ•°æ®ä¸‹è½½</h4> 
<p>IEU æ•°æ®åº“å®˜ç½‘ï¼š<a href="https://gwas.mrcieu.ac.uk/" rel="nofollow">https://gwas.mrcieu.ac.uk/</a></p> 
<p><img src="https://images2.imgbox.com/e3/3f/qdIua2Us_o.png" alt="" width="500" height="280"></p> 
<p>æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨ä¸­é—´çš„å¤§æ¡†æ¡†é‡Œè¾“å…¥å…³é”®è¯ï¼Œä¹Ÿå¯ä»¥ç‚¹å‡»å³ä¸Šè§’çš„<code>datasets</code>è¿›å…¥æ–°çš„é¡µé¢ï¼Œåœ¨<code>Trait contains</code>çš„æ¡†æ¡†é‡Œè¾“å…¥å…³é”®è¯ã€‚æ¯”å¦‚æˆ‘ä»¬è¿™é‡Œå°±ä»¥<code>body mass index</code>ï¼ˆèº«ä½“è´¨é‡æŒ‡æ•°ï¼Œä¹Ÿå°±æ˜¯å’±ä»¬å¸¸è¯´çš„ BMIï¼‰ä½œä¸ºå…³é”®è¯è¿›è¡Œè¾“å…¥ï¼Œç„¶åç‚¹å‡»<code>ğŸ”</code>æˆ–è€…<code>Filter</code>ï¼Œå°±ä¼šçœ‹åˆ°æœ‰å¾ˆå¤šæ•°æ®è¢«ç­›é€‰å‡ºæ¥å•¦ï¼</p> 
<blockquote> 
 <p>æˆ‘ä»¬ä»Šå¤©å°±ä»¥æ¢ç©¶ BMIï¼ˆæš´éœ²ï¼‰å’Œä¹³è…ºç™Œï¼ˆç»“å±€ï¼‰ä¹‹é—´çš„å…³ç³»ä¸ºä¾‹å§ï¼</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/78/1a/bPlN7V8b_o.png" alt="" width="500" height="280"></p> 
<p>æˆ‘ä»¬é€‰æ‹©<a href="https://gwas.mrcieu.ac.uk/datasets/ieu-a-2/" rel="nofollow"><code>ieu-a-2</code></a>è¿™ä¸ªæ•°æ®å§ï¼ç‚¹è¿›å»ï¼</p> 
<p><img src="https://images2.imgbox.com/a5/17/iGHxu3BP_o.png" alt="" width="500" height="280"></p> 
<p>ç‚¹å‡»<code>Download VCF</code>ï¼ˆä¹Ÿå¯ä»¥ç”¨<code>wget</code>ç­‰å‘½ä»¤ç›´æ¥ä¸‹è½½ï¼Œå¤§å®¶æŒ‰è‡ªå·±ä¹ æƒ¯è‡ªç”±å‘æŒ¥ï¼ï¼‰ï¼Œå³å¯ä¸‹è½½å®Œæ•´çš„ GWAS æ•°æ®ã€‚</p> 
<p>ç»“å±€æ•°æ®ä¹Ÿæ˜¯ä¸€æ ·çš„ä¸‹è½½æ–¹å¼ï¼Œæˆ‘è¿™é‡Œå°±ä¸æ¼”ç¤ºäº†å“ˆï¼æˆ‘é€‰æ‹©äº†<code>ukb-b-16890</code>ï¼ˆä¹³è…ºç™Œç›¸å…³ï¼‰è¿™ä¸ªæ•°æ®ã€‚</p> 
<p>ä¸‹è½½å®Œåé•¿è¿™æ ·ï¼š</p> 
<p><img src="https://images2.imgbox.com/92/00/UOnohaCx_o.png" alt="" width="600" height="50"></p> 
<h4><a id="_76"></a>æ•°æ®ä¸‹è½½ä¸å¤„ç†</h4> 
<p>å’±ä»¬å¼€å§‹è¯»å–å®ƒä»¬ï¼Œé¡ºä¾¿å¤„ç†ï¼</p> 
<pre><code class="prism language-r"><span class="token comment"># åŠ è½½åŒ…ï¼Œæ²¡æœ‰çš„å°ä¼™ä¼´è®°å¾—å®‰è£…ä¸€ä¸‹å“Ÿï¼</span>
<span class="token comment"># BiocManager::install("VariantAnnotation")</span>
library<span class="token punctuation">(</span>VariantAnnotation<span class="token punctuation">)</span>
<span class="token comment"># remotes::install_github("mrcieu/gwasvcf")</span>
library<span class="token punctuation">(</span>gwasvcf<span class="token punctuation">)</span>
<span class="token comment"># devtools::install_github("mrcieu/gwasglue")</span>
library<span class="token punctuation">(</span>gwasglue<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>TwoSampleMR<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>ieugwasr<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>dplyr<span class="token punctuation">)</span>

<span class="token comment"># è¯»å–æš´éœ²æ•°æ®ï¼Œè¯»å–å¯èƒ½ä¼šæœ‰ç‚¹æ…¢ï¼Œæ¯•ç«Ÿæ–‡ä»¶è›®å¤§å˜›ï¼Œå¤§å®¶ä¸è¦ç€æ€¥å“ˆï¼Œè¿™æ˜¯æ­£å¸¸æ»´ï¼</span>
exposure_vcf <span class="token operator">&lt;-</span> readVcf<span class="token punctuation">(</span><span class="token string">"./ieu-a-2.vcf.gz"</span><span class="token punctuation">)</span>

<span class="token comment"># æˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªæ–‡ä»¶é‡Œé¢éƒ½æ˜¯ä»€ä¹ˆ</span>
exposure_vcf
<span class="token comment"># class: CollapsedVCF </span>
<span class="token comment"># dim: 2554285 1 </span>
<span class="token comment"># rowRanges(vcf):</span>
<span class="token comment">#   GRanges with 5 metadata columns: paramRangeID, REF, ALT, QUAL, FILTER</span>
<span class="token comment"># info(vcf):</span>
<span class="token comment">#   DataFrame with 1 column: AF</span>
<span class="token comment"># info(header(vcf)):</span>
<span class="token comment">#   Number Type  Description     </span>
<span class="token comment"># AF A      Float Allele Frequency</span>
<span class="token comment"># geno(vcf):</span>
<span class="token comment">#   List of length 9: ES, SE, LP, AF, SS, EZ, SI, NC, ID</span>
<span class="token comment"># geno(header(vcf)):</span>
<span class="token comment">#   Number Type   Description                                                       </span>
<span class="token comment"># ES A      Float  Effect size estimate relative to the alternative allele           </span>
<span class="token comment"># SE A      Float  Standard error of effect size estimate                            </span>
<span class="token comment"># LP A      Float  -log10 p-value for effect estimate                                </span>
<span class="token comment"># AF A      Float  Alternate allele frequency in the association study               </span>
<span class="token comment"># SS A      Float  Sample size used to estimate genetic effect                       </span>
<span class="token comment"># EZ A      Float  Z-score provided if it was used to derive the EFFECT and SE fields</span>
<span class="token comment"># SI A      Float  Accuracy score of summary data imputation                         </span>
<span class="token comment"># NC A      Float  Number of cases used to estimate genetic effect                   </span>
<span class="token comment"># ID 1      String Study variant identifier  </span>
</code></pre> 
<p>å°å°è§£è¯»ä¸€ä¸‹ä¸‹ï¼š</p> 
<ul><li><strong>class</strong>: <code>CollapsedVCF</code> è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ª VCF æ–‡ä»¶çš„å‹ç¼©ç‰ˆæœ¬ã€‚</li><li><strong>dim</strong>: <code>2554285 1</code> è¡¨ç¤ºè¯¥ VCF æ–‡ä»¶åŒ…å« 2336260 ä¸ªè¡Œï¼ˆå³ SNPï¼‰å’Œ 1 ä¸ªæ ·æœ¬ã€‚ 
  <ul><li><strong>rowRanges(vcf)</strong>: è¯¥éƒ¨åˆ†åŒ…å« 5 ä¸ªå…ƒæ•°æ®åˆ—ï¼Œåˆ†åˆ«æ˜¯<code>paramRangeID</code>, <code>REF</code>, <code>ALT</code>, <code>QUAL</code>, <code>FILTER</code>ã€‚è¿™äº›åˆ—æä¾›äº†å…³äºæ¯ä¸ª SNP çš„åŸºæœ¬ä¿¡æ¯ã€‚</li></ul> </li><li><strong>info(vcf)</strong>: åŒ…å«ä¸€ä¸ª DataFrameï¼Œåˆ—åä¸º<code>AF</code>ï¼Œè¡¨ç¤º<code>Allele Frequency</code>ï¼ˆç­‰ä½åŸºå› é¢‘ç‡ï¼‰ã€‚</li><li><strong>info(header(vcf))</strong>: æä¾›äº†<code>AF</code>åˆ—çš„æè¿°ï¼Œå®ƒæ˜¯ä¸€ä¸ªæµ®ç‚¹æ•°ï¼Œä»£è¡¨ç­‰ä½åŸºå› çš„é¢‘ç‡ã€‚</li><li><strong>geno(vcf)</strong>: è¿™æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º 9 çš„åˆ—è¡¨ï¼ŒåŒ…å«å„ç§é—ä¼ æ•ˆåº”å’Œç»Ÿè®¡é‡çš„ä¼°è®¡å€¼ã€‚ 
  <ul><li><strong>ES</strong>: æ•ˆåº”å¤§å°ç›¸å¯¹äºæ›¿ä»£ç­‰ä½åŸºå› çš„ä¼°è®¡å€¼ã€‚</li><li><strong>SE</strong>: æ•ˆåº”å¤§å°ä¼°è®¡çš„æ ‡å‡†è¯¯å·®ã€‚</li><li><strong>LP</strong>: æ•ˆåº”ä¼°è®¡çš„-log10 På€¼ã€‚</li><li><strong>AF</strong>: å…³è”ç ”ç©¶ä¸­çš„æ›¿ä»£ç­‰ä½åŸºå› é¢‘ç‡ã€‚</li><li><strong>SS</strong>: ç”¨äºä¼°è®¡é—ä¼ æ•ˆåº”çš„æ ·æœ¬å¤§å°ã€‚</li><li><strong>EZ</strong>: å¦‚æœç”¨äºæ¨å¯¼<code>EFFECT</code>å’Œ<code>SE</code>å­—æ®µï¼Œåˆ™æä¾›çš„Zåˆ†æ•°ã€‚</li><li><strong>SI</strong>: æ‘˜è¦æ•°æ®æ’è¡¥çš„å‡†ç¡®åº¦åˆ†æ•°ã€‚</li><li><strong>NC</strong>: ç”¨äºä¼°è®¡é—ä¼ æ•ˆåº”çš„ç—…ä¾‹æ•°é‡ã€‚</li><li><strong>ID</strong>: SNP æ ‡è¯†ç¬¦ã€‚</li></ul> </li></ul> 
<p>æ¥ä¸‹æ¥æˆ‘ä»¬ä¾æ® P å€¼è¿›è¡Œè¿‡æ»¤ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸º<code>TwoSampleMR</code>éœ€è¦çš„æ ¼å¼ï¼Œé¡ºä¾¿å»é™¤ä¸€ä¸‹è¿é”ä¸å¹³è¡¡ã€‚</p> 
<pre><code class="prism language-r"><span class="token comment"># è¿‡æ»¤ P å€¼ â€”â€” è¯´å®è¯ï¼Œè¿‡æ»¤ P å€¼è¿™ä¸ªæ­¥éª¤å‘ï¼Œæ”¾åœ¨å“ªä¸€æ­¥éƒ½å¯ä»¥ï¼Œå¤§å®¶éšæ„ï¼</span>
exposure_vcf_p_filter <span class="token operator">&lt;-</span> query_gwas<span class="token punctuation">(</span>vcf <span class="token operator">=</span> exposure_vcf<span class="token punctuation">,</span> pval <span class="token operator">=</span> <span class="token number">5e-08</span><span class="token punctuation">)</span>

<span class="token comment"># è½¬æ¢ä¸º TwoSampleMR éœ€è¦çš„æ ¼å¼</span>
exposure_data <span class="token operator">&lt;-</span> gwasvcf_to_TwoSampleMR<span class="token punctuation">(</span>exposure_vcf_p_filter<span class="token punctuation">)</span>
head<span class="token punctuation">(</span>exposure_data<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token punctuation">]</span>
<span class="token comment">#   chr.exposure pos.exposure other_allele.exposure effect_allele.exposure beta.exposure</span>
<span class="token comment"># 1            1     47684677                     T                      G       -0.0168</span>
<span class="token comment"># 2            1     47690438                     G                      T        0.0165</span>
<span class="token comment"># 3            1     49376820                     T                      C        0.0209</span>
<span class="token comment"># 4            1     49438005                     G                      A       -0.0225</span>
<span class="token comment">#   se.exposure pval.exposure eaf.exposure samplesize.exposure ncase.exposure       SNP</span>
<span class="token comment"># 1      0.0030  2.181976e-08       0.5333              339152             NA  rs977747</span>
<span class="token comment"># 2      0.0030  3.416017e-08       0.4746              338820             NA rs2984618</span>
<span class="token comment"># 3      0.0035  2.371974e-09       0.2250              339110             NA rs1343424</span>
<span class="token comment"># 4      0.0031  3.773115e-13       0.6333              338453             NA rs3127553</span>
<span class="token comment">#   ncontrol.exposure exposure mr_keep.exposure pval_origin.exposure id.exposure</span>
<span class="token comment"># 1                NA  ieu-a-2             TRUE             reported      FkMOXE</span>
<span class="token comment"># 2                NA  ieu-a-2             TRUE             reported      FkMOXE</span>
<span class="token comment"># 3                NA  ieu-a-2             TRUE             reported      FkMOXE</span>
<span class="token comment"># 4                NA  ieu-a-2             TRUE             reported      FkMOXE</span>

<span class="token comment"># å¯ä»¥çœ‹åˆ°å’Œå’±ä»¬ä¹‹å‰ç”¨ extract_instruments() ä¸‹è½½çš„æ•°æ®æ ¼å¼æ˜¯ä¸€è‡´çš„ï¼æ£’æ£’å“’ï¼</span>

<span class="token comment"># å»é™¤è¿é”ä¸å¹³è¡¡ï¼ˆæœ‰äº›å°ä¼™ä¼´æ˜¯ä¸æ˜¯ç½‘ä¸å¥½ï¼ä¸æ­¢æœåŠ¡å™¨å´©æºƒï¼è‡ªå·±ä¹Ÿå´©æºƒï¼ä¸è¦æ…Œï¼ï¼‰</span>
exposure_data_clumped <span class="token operator">&lt;-</span> clump_data<span class="token punctuation">(</span>exposure_data<span class="token punctuation">,</span>       <span class="token comment"># æš´éœ²æ•°æ®</span>
                                    clump_kb <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">,</span>    <span class="token comment"># clumping çš„çª—å£å¤§å°</span>
                                    clump_r2 <span class="token operator">=</span> <span class="token number">0.001</span><span class="token punctuation">,</span>    <span class="token comment"># clumping çš„ r^2 é˜ˆå€¼</span>
                                    pop <span class="token operator">=</span> <span class="token string">"EUR"</span><span class="token punctuation">)</span>         <span class="token comment"># ç”¨äºå‚è€ƒçš„äººç§ï¼ˆé»˜è®¤ä¸ºâ€œEUR/æ¬§æ´²äººâ€ï¼Œå…·ä½“å¤§å®¶å¯ä»¥å»é—®å·ä¸€ä¸‹å‡½æ•°ï¼‰</span>
<span class="token comment"># Please look at vignettes for options on running this locally if you need to run many instances of this command.</span>
<span class="token comment"># Clumping 6UhrjN, 2041 variants, using EUR population reference</span>
<span class="token comment"># Error in api_query("ld/clump", query = list(rsid = dat[["rsid"]], pval = dat[["pval"]],  : </span>
<span class="token comment">#   The query to MR-Base exceeded 300 seconds and timed out. Please simplify the query</span>
</code></pre> 
<p>å“ï¼æŠ¥é”™å•¦ï¼è¶…æ—¶å•¦ï¼</p> 
<p>æ˜¯ä¸æ˜¯å¾ˆå¤šå°ä¼™ä¼´å¥½ä¸å®¹æ˜“æå®šäº†ç¬¬ä¸€æ­¥ï¼Œåœ¨è¿™é‡Œåˆå¡åœ¨äº†è¿™ä¸€æ­¥ï¼ä¸è¦æ…Œï¼å’±ä»¬å°±çº¯çº¯æœ¬åœ°æ¥ï¼</p> 
<blockquote> 
 <p>ä¸çŸ¥é“ä¸ºå•¥ï¼Œä¹Ÿæ˜¯è›®å·§çš„ï¼Œæˆ‘ä¹‹å‰è·‘å°±æ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼Œä¸çŸ¥é“ä¸ºå•¥ä»Šå¤©ä¸€ç›´æ˜¯è¿™æ ·ï¼Œä¸€å®šæ˜¯æœåŠ¡å™¨ä¸ºäº†æ–¹ä¾¿æˆ‘ç»™å¤§å®¶å±•ç¤ºç‰¹åœ°æŠŠè‡ªå·±ææˆè¿™æ ·çš„å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆï¼</p> 
 <p>è¯´çœŸçš„ï¼Œæˆ‘åœ¨ä¸€å¼€å§‹è¿è¡Œè¿™æ­¥çš„æ—¶å€™è¿˜æ²¡æœ‰è¿™ä¸ªæŠ¥é”™ï¼Œä½†æ˜¯æœ‰æ›´ç„å¹»æ›´ç¦»è°±çš„äº‹æƒ…å‘ç”Ÿï¼Œå°±æ˜¯å°±æ˜¯ï¼Œå®ƒå±…ç„¶ç»™æˆ‘ç­›é€‰çš„åªå‰©0ä¸ªSNPäº†ï¼Œç‰¹è¯¡å¼‚ï¼æœ¬æ¥ä»¥ä¸ºæ˜¯æˆ‘çš„æ•°æ®é—®é¢˜ï¼Œç„¶åéšä¾¿æ‰¾ä¸ªåˆ«äººçš„æ•™ç¨‹ï¼Œç”¨äº†å’Œå®ƒä¸€æ ·çš„æ•°æ®ï¼Œå…·ä½“æˆ‘è¿˜æ˜¯0ï¼å®Œå…¨æ— æ³•ç†è§£ï¼Œåæ¥æˆ‘åˆå»å„ç§æ£€æŸ¥æºä»£ç å„ç§ä¿®æ”¹å„ç§æŠ˜è…¾ï¼Œå±…ç„¶è¿˜æ˜¯ä¸è¡Œï¼ç„å­¦ï¼ç¦»è°±ï¼ç»™æˆ‘æ°”äº†ä¸€å¤©ï¼å“ï¼ä¸çŸ¥é“ä½ ä»¬å¦‚æœæˆåŠŸè¿è¡Œçš„è¯ï¼Œä¼šä¸ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œå“ï¼æ²¡æœ‰æ›´å¥½ï¼å’±å°±æ–¹ä¾¿å¤šäº†ï¼Œå¦‚æœé‡åˆ°å’Œæˆ‘ä¸€æ ·ç¦»è°±çš„æƒ…å†µçš„è¯ï¼Œå°±åªèƒ½æŒ‰ç…§æˆ‘ä¸‹é¢ä»‹ç»çš„æ–¹æ³•å•¦ï¼ä¹Ÿä¸ç®—ç‰¹åˆ«éº»çƒ¦ï¼Œå°±æ˜¯éœ€è¦è¾›è‹¦å¤§å®¶ä¸‹è½½ä¸€ä¸‹é‚£ä¸ªå·¨å¤§çš„æ•°æ®ç½¢äº†ï¼åŠ æ²¹ï¼ç¥å¤§å®¶å„ç§é¡ºåˆ©ï¼</p> 
</blockquote> 
<p>é¦–å…ˆï¼Œå’±ä»¬è¦ä¸‹è½½è¿é”ä¸å¹³è¡¡çš„å‚è€ƒæ•°æ®é›†åˆ°æœ¬åœ°ï¼Œä¸‹è½½åœ°å€ä¸ºï¼šhttp://fileserve.mrcieu.ac.uk/ld/1kg.v3.tgzï¼ˆæœ‰ç‚¹å¤§ï¼Œå¤§å®¶æ…¢æ…¢æ¥ï¼Œå“ï¼‰</p> 
<p>ä¸‹è½½åè§£å‹ï¼Œè§£å‹å‘½ä»¤å‚è€ƒï¼ˆå¤§å®¶å¯ä»¥è‡ªè¡Œé€‰æ‹©è‡ªå·±æœ€æœ€æœ€å–œæ¬¢çš„è§£å‹æ–¹å¼ï¼‰ï¼š</p> 
<pre><code class="prism language-bash"><span class="token function">tar</span> zxvf 1kg.v3.tgz
</code></pre> 
<p>é‡Œé¢åŒ…å«è¿™äº›æ•°æ®ï¼š</p> 
<p><img src="https://images2.imgbox.com/3f/42/xZRTTpv9_o.png" alt="" width="800" height="60"></p> 
<p>å¥½å¤šäººç§ï¼Œå’±ä»¬ä»Šå¤©çš„æ•°æ®é›†æ˜¯æ¬§æ´²äººï¼Œæ‰€ä»¥å’±ä»¬é€‰æ‹©å‚è€ƒäººç§ä¸ºæ¬§æ´²äººï¼Œé‚£å°±ä¼šç”¨åˆ°<code>EUR.bed</code>ã€<code>EUR.bim</code>ã€<code>EUR.fam</code>è¿™ä¸‰ä¸ªæ–‡ä»¶ã€‚</p> 
<p>å…¶æ¬¡ï¼Œå’±ä»¬è¿˜è¦ä¸‹è½½ä¸€ä¸ªå«<code>plink</code>çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸‹è½½åœ°å€ä¸ºï¼š<a href="https://github.com/MRCIEU/genetics.binaRies/tree/master/binaries">https://github.com/MRCIEU/genetics.binaRies/tree/master/binaries</a></p> 
<p><img src="https://images2.imgbox.com/87/8e/fBeNZCmt_o.png" alt="" width="600" height="130"></p> 
<p>å¯ä»¥çœ‹åˆ°æœ‰Linuxç‰ˆæœ¬ï¼Œä¹Ÿæœ‰Windowsç‰ˆæœ¬ï¼Œå¤§å®¶ç‚¹è¿›å»ç›´æ¥ä¸‹è½½é€‚åˆè‡ªå·±çš„å°±å¥½å•¦ï¼æ¯”å¦‚æˆ‘éœ€è¦Linuxç‰ˆæœ¬çš„ï¼Œé‚£æˆ‘å°±è¿™æ ·è¿™æ ·é‚£æ ·é‚£æ ·å“ˆå“ˆå“ˆï¼ŒæŒ‰ç…§ä¸‹å›¾æ‰€ç¤ºæŒ¨ä¸ªç‚¹å‡»ç®­å¤´åŒºåŸŸå³å¯ï¼ˆç®€å•ç²—æš´ï¼‰ï¼š</p> 
<p><img src="https://images2.imgbox.com/62/bb/hRygzamy_o.png" alt="" width="600" height="130"><br> <img src="https://images2.imgbox.com/9d/d4/2AF2LI0Y_o.png" alt="" width="600" height="130"><br> <img src="https://images2.imgbox.com/54/55/yjoufJFW_o.png" alt="" width="600" height="100"></p> 
<p>å¥½ï¼Œä¸‹è½½å®Œ<code>plink</code> æ‰§è¡Œæ–‡ä»¶åï¼Œå’±ä»¬å°±å¯ä»¥å¼€å§‹è¿›è¡Œæœ¬åœ°å»é™¤è¿é”ä¸å¹³è¡¡æ“ä½œå•¦ï¼</p> 
<pre><code class="prism language-bash"><span class="token comment"># ä½¿ç”¨ ld_clump() å‡½æ•°è¿›è¡Œ clumpingï¼Œä¹Ÿå°±æ˜¯å»é™¤è¿é”ä¸å¹³è¡¡ï¼ˆæœ¬åœ°æœ¬åœ°æœ¬åœ°ï¼‰</span>
exposure_data_clumped <span class="token operator">&lt;</span>- ld_clump<span class="token punctuation">(</span>
  <span class="token comment"># æŒ‡å®šåŒ…å«`rsid`ã€`pval`å’Œ`id`çš„æ•°æ®æ¡†</span>
  dat <span class="token operator">=</span> tibble<span class="token punctuation">(</span>rsid <span class="token operator">=</span> exposure_data<span class="token variable">$SNP</span>,  <span class="token comment"># ä» exposure_data ä¸­æå– SNP æ ‡è¯†ç¬¦</span>
               pval <span class="token operator">=</span> exposure_data<span class="token variable">$pval</span>.exposure,  <span class="token comment"># ä» exposure_data ä¸­æå–å…³è” p å€¼</span>
               <span class="token function">id</span> <span class="token operator">=</span> exposure_data<span class="token variable">$exposure</span><span class="token punctuation">)</span>,  <span class="token comment"># ä» exposure_data ä¸­æå– SNP çš„ id</span>
  clump_kb <span class="token operator">=</span> <span class="token number">10000</span>,      <span class="token comment"># è®¾ç½® clumping çª—å£å¤§å°</span>
  clump_r2 <span class="token operator">=</span> <span class="token number">0.001</span>,      <span class="token comment"># æŒ‡å®šç”¨äº LD çš„ r^2 é˜ˆå€¼</span>
  clump_p <span class="token operator">=</span> <span class="token number">1</span>,           <span class="token comment"># è®¾ç½® p å€¼é˜ˆå€¼ä¸º 1ï¼Œè¿™æ ·æ‰€æœ‰çš„ SNP éƒ½ä¼šè¢«çº³å…¥ clumpï¼Œå› ä¸ºå’±ä»¬å‰é¢å·²ç»è¿›è¡Œè¿‡ p å€¼è¿‡æ»¤äº†å˜›</span>
  bfile <span class="token operator">=</span> <span class="token string">"./EUR"</span>,       <span class="token comment"># æŒ‡å®š LD çš„å‚è€ƒæ•°æ®é›†ï¼Œæ³¨æ„ä¿®æ”¹ä½ çš„è·¯å¾„</span>
  plink_bin <span class="token operator">=</span> <span class="token string">"./plink"</span>  <span class="token comment"># ä½¿ç”¨æŒ‡å®šç›®å½•ä¸‹çš„ plink äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ³¨æ„ä¿®æ”¹ä½ çš„è·¯å¾„</span>
<span class="token punctuation">)</span>

<span class="token comment"># å¤§å®¶åœ¨è¿›è¡Œè¿™ä¸€æ­¥çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šé‡åˆ°å¦‚ä¸‹æŠ¥é”™ï¼š</span>
<span class="token comment"># Clumping ieu-a-2, 2041 variants, using EUR population reference</span>
<span class="token comment"># sh: 1: ./plink: Permission denied</span>
<span class="token comment"># Error in file(file, "rt") : cannot open the connection</span>
<span class="token comment"># In addition: Warning message:</span>
<span class="token comment">#   In file(file, "rt") :</span>
<span class="token comment">#   cannot open file '/tmp/RtmpRXcyTx/file25501f4f6efa35.clumped': No such file or directory</span>
</code></pre> 
<p>å“å˜¿ï¼ŒåˆæŠ¥é”™äº†ï¼é‚£è¿™åˆæ˜¯ä¸ºå•¥æï¼</p> 
<p>è¿™æ„å‘³ç€ä½ æ²¡æœ‰è¶³å¤Ÿçš„æƒé™è¿è¡Œ plinkã€‚å’±ä»¬éœ€è¦ç»™ <code>plink</code> æ–‡ä»¶æ·»åŠ æ‰§è¡Œæƒé™ï¼Œåœ¨ç»ˆç«¯ï¼Œä¹Ÿå°±æ˜¯è¾“å…¥ Linux å‘½ä»¤çš„é‚£ä¸ªçª—å£ï¼Œå¯¼èˆªåˆ°<code>plink</code>æ‰€åœ¨ç›®å½•ï¼Œå’±ä»¬è¿è¡Œä¸‹é¢è¿™è¡Œå‘½ä»¤ï¼ˆæ³¨æ„ä¿®æ”¹è·¯å¾„å“ˆï¼‰ï¼š</p> 
<pre><code class="prism language-bash"><span class="token function">chmod</span> +x /è¿™é‡Œæ˜¯/ä½ çš„/plinkæ–‡ä»¶/æ‰€åœ¨è·¯å¾„/MendelianRandomization/plink
</code></pre> 
<p>è¿™æ ·ï¼Œå’±ä»¬å°±ç»™<code>plink</code>æ·»åŠ äº†æ‰§è¡Œæƒé™ã€‚</p> 
<p>ç„¶åè¿˜æ˜¯è¿è¡Œä¸Šé¢é‚£æ®µä»£ç ï¼š</p> 
<pre><code class="prism language-bash"><span class="token comment"># ä½¿ç”¨ ld_clump() å‡½æ•°è¿›è¡Œ clumpingï¼Œä¹Ÿå°±æ˜¯å»é™¤è¿é”ä¸å¹³è¡¡ï¼ˆæœ¬åœ°æœ¬åœ°æœ¬åœ°ï¼‰</span>
exposure_data_clumped <span class="token operator">&lt;</span>- ld_clump<span class="token punctuation">(</span>
  <span class="token comment"># æŒ‡å®šåŒ…å«`rsid`ã€`pval`å’Œ`id`çš„æ•°æ®æ¡†</span>
  dat <span class="token operator">=</span> tibble<span class="token punctuation">(</span>rsid <span class="token operator">=</span> exposure_data<span class="token variable">$SNP</span>,  <span class="token comment"># ä» exposure_data ä¸­æå– SNP æ ‡è¯†ç¬¦</span>
               pval <span class="token operator">=</span> exposure_data<span class="token variable">$pval</span>.exposure,  <span class="token comment"># ä» exposure_data ä¸­æå–å…³è” p å€¼</span>
               <span class="token function">id</span> <span class="token operator">=</span> exposure_data<span class="token variable">$exposure</span><span class="token punctuation">)</span>,  <span class="token comment"># ä» exposure_data ä¸­æå– SNP çš„ id</span>
  clump_kb <span class="token operator">=</span> <span class="token number">10000</span>,      <span class="token comment"># è®¾ç½® clumping çª—å£å¤§å°</span>
  clump_r2 <span class="token operator">=</span> <span class="token number">0.001</span>,      <span class="token comment"># æŒ‡å®šç”¨äº LD çš„ r^2 é˜ˆå€¼</span>
  clump_p <span class="token operator">=</span> <span class="token number">1</span>,           <span class="token comment"># è®¾ç½® p å€¼é˜ˆå€¼ä¸º 1ï¼Œè¿™æ ·æ‰€æœ‰çš„ SNP éƒ½ä¼šè¢«çº³å…¥ clumpï¼Œå› ä¸ºå’±ä»¬å‰é¢å·²ç»è¿›è¡Œè¿‡ p å€¼è¿‡æ»¤äº†å˜›</span>
  bfile <span class="token operator">=</span> <span class="token string">"./EUR"</span>,       <span class="token comment"># æŒ‡å®š LD çš„å‚è€ƒæ•°æ®é›†ï¼Œæ³¨æ„ä¿®æ”¹ä½ çš„è·¯å¾„</span>
  plink_bin <span class="token operator">=</span> <span class="token string">"./plink"</span>  <span class="token comment"># ä½¿ç”¨æŒ‡å®šç›®å½•ä¸‹çš„ plink äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ³¨æ„ä¿®æ”¹ä½ çš„è·¯å¾„</span>
<span class="token punctuation">)</span>
<span class="token comment"># Clumping ieu-a-2, 2041 variants, using EUR population reference</span>
<span class="token comment"># PLINK v1.90b6.21 64-bit (19 Oct 2020)          www.cog-genomics.org/plink/1.9/</span>
<span class="token comment">#   (C) 2005-2020 Shaun Purcell, Christopher Chang   GNU General Public License v3</span>
<span class="token comment"># Logging to /tmp/RtmpRXcyTx/file25501f72c90730.log.</span>
<span class="token comment"># Options in effect:</span>
<span class="token comment">#   --bfile ./EUR</span>
<span class="token comment"># --clump /tmp/RtmpRXcyTx/file25501f72c90730</span>
<span class="token comment"># --clump-kb 10000</span>
<span class="token comment"># --clump-p1 1</span>
<span class="token comment"># --clump-r2 0.001</span>
<span class="token comment"># --out /tmp/RtmpRXcyTx/file25501f72c90730</span>
<span class="token comment"># </span>
<span class="token comment"># 515586 MB RAM detected; reserving 257793 MB for main workspace.</span>
<span class="token comment"># 8550156 variants loaded from .bim file.</span>
<span class="token comment"># 503 people (0 males, 0 females, 503 ambiguous) loaded from .fam.</span>
<span class="token comment"># Ambiguous sex IDs written to /tmp/RtmpRXcyTx/file25501f72c90730.nosex .</span>
<span class="token comment"># Using 1 thread (no multithreaded calculations invoked).</span>
<span class="token comment"># Before main variant filters, 503 founders and 0 nonfounders present.</span>
<span class="token comment"># Calculating allele frequencies... done.</span>
<span class="token comment"># 8550156 variants and 503 people pass filters and QC.</span>
<span class="token comment"># Note: No phenotypes present.</span>
<span class="token comment"># Warning: 'rs9930333' is missing from the main dataset, and is a top variant.</span>
<span class="token comment"># Warning: 'rs8083289' is missing from the main dataset, and is a top variant.</span>
<span class="token comment"># Warning: 'rs2683992' is missing from the main dataset, and is a top variant.</span>
<span class="token comment"># 27 more top variant IDs missing; see log file.</span>
<span class="token comment"># --clump: 78 clumps formed from 2011 top variants.</span>
<span class="token comment"># Results written to /tmp/RtmpRXcyTx/file25501f72c90730.clumped .</span>
<span class="token comment"># Removing 1963 of 2041 variants due to LD with other variants or absence from LD reference panel</span>
</code></pre> 
<p>è¿™æ¬¡è¿è¡ŒæˆåŠŸäº†å§ï¼ï¼ï¼</p> 
<p>è¾“å‡ºåŒ…æ‹¬ PLINK çš„ç‰ˆæœ¬ä¿¡æ¯å’Œç‰ˆæƒä¿¡æ¯ã€logging ä¿¡æ¯ã€è¿è¡Œé€‰é¡¹ã€ç³»ç»Ÿä¿¡æ¯ã€æ•°æ®åŠ è½½ä¿¡æ¯ï¼ˆå…±æœ‰ 8550156 ä¸ªå˜å¼‚å’Œ 503 ä¸ªäººè¢«åŠ è½½ï¼‰ã€è­¦å‘Šä¿¡æ¯ï¼ˆä¸€äº›SNPsåœ¨ä¸»æ•°æ®é›†ä¸­ç¼ºå¤±ï¼‰å’Œ clumping ç»“æœç­‰ï¼Œæˆ‘ä»¬æœ€éœ€è¦å…³æ³¨çš„å°±æ˜¯ï¼šå®ƒè¿˜å‰© 78 ä¸ª SNPï¼</p> 
<pre><code class="prism language-bash"><span class="token comment"># æŸ¥çœ‹å»é™¤è¿é”ä¸å¹³è¡¡åçš„æ•°æ®</span>
head<span class="token punctuation">(</span>exposure_data_clumped<span class="token punctuation">)</span>
<span class="token comment"># # A tibble: 6 Ã— 3</span>
<span class="token comment">#   rsid           pval id     </span>
<span class="token comment">#   &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;  </span>
<span class="token comment"># 1 rs977747   2.18e- 8 ieu-a-2</span>
<span class="token comment"># 2 rs657452   2.12e-13 ieu-a-2</span>
<span class="token comment"># 3 rs7531118  1.88e-28 ieu-a-2</span>
<span class="token comment"># 4 rs17381664 4.57e-11 ieu-a-2</span>
<span class="token comment"># 5 rs11165643 1.43e-13 ieu-a-2</span>
<span class="token comment"># 6 rs7550711  5.06e-14 ieu-a-2</span>

<span class="token comment"># å¯ä»¥çœ‹åˆ°å®ƒåªæœ‰ 3 åˆ—ï¼Œä¸æ…Œï¼å’±æŠŠå®ƒå’Œå‰é¢çš„æ•°æ®æ•´åˆä¸€ä¸‹å°±å¥½ï¼</span>
exposure_data_clumped <span class="token operator">&lt;</span>- exposure_data %<span class="token operator">&gt;</span>% filter<span class="token punctuation">(</span>exposure_data<span class="token variable">$SNP</span> %in% exposure_data_clumped<span class="token variable">$rsid</span><span class="token punctuation">)</span>

<span class="token comment"># å†çœ‹çœ‹æ•°æ®é•¿å•¥æ ·</span>
head<span class="token punctuation">(</span>exposure_data_clumped<span class="token punctuation">)</span>
<span class="token comment">#   chr.exposure pos.exposure other_allele.exposure effect_allele.exposure beta.exposure se.exposure pval.exposure eaf.exposure</span>
<span class="token comment"># 1            1     47684677                     T                      G       -0.0168      0.0030  2.181976e-08       0.5333</span>
<span class="token comment"># 2            1     49589847                     A                      G       -0.0227      0.0031  2.123244e-13       0.5833</span>
<span class="token comment"># 3            1     72837239                     T                      C        0.0331      0.0030  1.880182e-28       0.6083</span>
<span class="token comment"># 4            1     78048331                     T                      C        0.0201      0.0031  4.567726e-11       0.4250</span>
<span class="token comment"># 5            1     96924097                     C                      T        0.0221      0.0030  1.433838e-13       0.5750</span>
<span class="token comment"># 6            1    110082886                     C                      T        0.0659      0.0087  5.059411e-14       0.0339</span>
<span class="token comment">#   samplesize.exposure ncase.exposure        SNP ncontrol.exposure exposure mr_keep.exposure pval_origin.exposure id.exposure</span>
<span class="token comment"># 1              339152             NA   rs977747                NA  ieu-a-2             TRUE             reported      6UhrjN</span>
<span class="token comment"># 2              318585             NA   rs657452                NA  ieu-a-2             TRUE             reported      6UhrjN</span>
<span class="token comment"># 3              338123             NA  rs7531118                NA  ieu-a-2             TRUE             reported      6UhrjN</span>
<span class="token comment"># 4              339065             NA rs17381664                NA  ieu-a-2             TRUE             reported      6UhrjN</span>
<span class="token comment"># 5              337797             NA rs11165643                NA  ieu-a-2             TRUE             reported      6UhrjN</span>
<span class="token comment"># 6              313621             NA  rs7550711                NA  ieu-a-2             TRUE             reported      6UhrjN</span>

<span class="token comment"># å“å˜¿ï¼Œé½æ´»å•¦ï¼</span>
</code></pre> 
<p>é‚£åˆ°ç°åœ¨ä¸ºæ­¢ï¼Œå’±ä»¬æš´éœ²æ•°æ®å°±ç®—æ˜¯æå®šå•¦ï¼æ¥ä¸‹æ¥æ˜¯ç»“å±€æ•°æ®ï¼Œæ­¥éª¤å’Œæš´éœ²æ•°æ®å®Œå…¨ä¸€æ ·ï¼Œæˆ‘ä»¬å°±å¿«å¿«æä¸€ä¸‹ï¼</p> 
<p>åœ¨ä¹‹å‰åœ¨<a href="https://mp.weixin.qq.com/s/ikBZvr3ivKcm1yrT-R5Q9g" rel="nofollow">çœ‹å®Œä¸ä¼šæ¥ææˆ‘ | å­Ÿå¾·å°”éšæœºåŒ–ä¸‡å­—é•¿æ–‡è¯¦è§£ï¼ˆäºŒï¼‰â€”â€” ä»£ç å®æ“ | é™„ä»£ç æ³¨é‡Š + ç»“æœè§£è¯»</a>ä¸­ï¼Œæˆ‘ä»¬æ˜¯ç”¨<code>extract_outcome_data</code>å‡½æ•°ä»æš´éœ²æ•°æ®ä¸­æŒ‘é€‰ç»“å±€ç›¸å…³æ•°æ®ï¼Œå…¶å®å°±æ˜¯å–äº¤é›†è·å–å…±æœ‰çš„ SNPï¼Œé‚£æˆ‘ä»¬è¿™é‡Œï¼Œä¹Ÿå¯¹æš´éœ²æ•°æ®å’Œç»“å±€æ•°æ®å–äº¤é›†ï¼</p> 
<pre><code class="prism language-bash"><span class="token comment"># è¯»å–ç»“å±€æ•°æ®ï¼Œè¯»å–å¯èƒ½ä¼šæœ‰ç‚¹æ…¢ï¼Œæ¯•ç«Ÿæ–‡ä»¶è›®å¤§å˜›ï¼Œå¤§å®¶ä¸è¦ç€æ€¥å“ˆï¼Œè¿™æ˜¯æ­£å¸¸æ»´ï¼</span>
outcome_vcf <span class="token operator">&lt;</span>- readVcf<span class="token punctuation">(</span><span class="token string">"./ukb-b-16890.vcf.gz"</span><span class="token punctuation">)</span>

<span class="token comment"># è½¬æ¢ä¸º TwoSampleMR éœ€è¦çš„æ ¼å¼</span>
outcome_data <span class="token operator">&lt;</span>- gwasvcf_to_TwoSampleMR<span class="token punctuation">(</span>outcome_vcf<span class="token punctuation">)</span>

<span class="token comment"># ç»“å±€æ•°æ®ä¸æš´éœ²æ•°æ®å–äº¤é›†ï¼Œè·å–å…±æœ‰ SNP</span>
data_common <span class="token operator">&lt;</span>- merge<span class="token punctuation">(</span>exposure_data_clumped, outcome_data, by <span class="token operator">=</span> <span class="token string">"SNP"</span><span class="token punctuation">)</span>
dim<span class="token punctuation">(</span>data_common<span class="token punctuation">)</span>
<span class="token comment"># [1] 77 31</span>

<span class="token comment"># å¯ä»¥çœ‹åˆ°æœ€ç»ˆè¿˜å‰© 77 ä¸ª SNP</span>

<span class="token comment"># çœ‹ä¸€ä¸‹æœ‰å“ªäº›åˆ—ï¼Œæ”¾åœ¨è¿™é‡Œä¾¿äºåé¢çš„æ ¼å¼è½¬æ¢ï¼Œä¸»è¦æ˜¯æ–¹ä¾¿çœ‹</span>
colnames<span class="token punctuation">(</span>data_common<span class="token punctuation">)</span>
<span class="token comment">#  [1] "chr.exposure"           "pos.exposure"           "other_allele.exposure" </span>
<span class="token comment">#  [4] "effect_allele.exposure" "beta.exposure"          "se.exposure"           </span>
<span class="token comment">#  [7] "pval.exposure"          "eaf.exposure"           "samplesize.exposure"   </span>
<span class="token comment"># [10] "ncase.exposure"         "SNP"                    "ncontrol.exposure"     </span>
<span class="token comment"># [13] "exposure"               "mr_keep.exposure"       "pval_origin.exposure"  </span>
<span class="token comment"># [16] "id.exposure"</span>

<span class="token comment"># æå–ç»“å±€æ•°æ®ï¼Œå¹¶è¿›è¡Œæ ¼å¼ä¿®æ”¹ï¼Œä»¥ç”¨äºåç»­çš„ MR åˆ†æ</span>
outcome_data <span class="token operator">&lt;</span>- format_data<span class="token punctuation">(</span>outcome_data,
                            <span class="token comment"># è®¾ç½®ç±»å‹ä¸º "outcome"ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªç»“å±€æ•°æ®</span>
                            <span class="token builtin class-name">type</span> <span class="token operator">=</span> <span class="token string">"outcome"</span>,
                            <span class="token comment"># é€‰æ‹©ç”¨äº MR åˆ†æçš„ SNPï¼Œè¿™é‡Œä½¿ç”¨äº† data_common æ•°æ®é›†ä¸­çš„ SNP åˆ—</span>
                            snps <span class="token operator">=</span> data_common<span class="token variable">$SNP</span>,
                            <span class="token comment"># è®¾ç½® SNP åˆ—çš„åç§°</span>
                            snp_col <span class="token operator">=</span> <span class="token string">"SNP"</span>,
                            <span class="token comment"># è®¾ç½®æ•ˆåº”å¤§å° (beta) çš„åˆ—åç§°</span>
                            beta_col <span class="token operator">=</span> <span class="token string">"beta.exposure"</span>,
                            <span class="token comment"># è®¾ç½®æ ‡å‡†è¯¯å·® (SE) çš„åˆ—åç§°</span>
                            se_col <span class="token operator">=</span> <span class="token string">"se.exposure"</span>,
                            <span class="token comment"># è®¾ç½®æ•ˆåº”ç­‰ä½åŸºå› é¢‘ç‡ (EAF) çš„åˆ—åç§°</span>
                            eaf_col <span class="token operator">=</span> <span class="token string">"eaf.exposure"</span>,
                            <span class="token comment"># è®¾ç½®æ•ˆåº”ç­‰ä½åŸºå› çš„åˆ—åç§°</span>
                            effect_allele_col <span class="token operator">=</span> <span class="token string">"effect_allele.exposure"</span>,
                            <span class="token comment"># è®¾ç½®éæ•ˆåº”ç­‰ä½åŸºå› çš„åˆ—åç§°</span>
                            other_allele_col <span class="token operator">=</span> <span class="token string">"other_allele.exposure"</span>,
                            <span class="token comment"># è®¾ç½® p å€¼ (p-value) çš„åˆ—åç§°</span>
                            pval_col <span class="token operator">=</span> <span class="token string">"pval.exposure"</span>,
                            <span class="token comment"># è®¾ç½®æ ·æœ¬å¤§å° (sample size) çš„åˆ—åç§°</span>
                            samplesize_col <span class="token operator">=</span> <span class="token string">"samplesize.exposure"</span>,
                            <span class="token comment"># è®¾ç½®ç—…ä¾‹æ•° (number of cases) çš„åˆ—åç§°</span>
                            ncase_col <span class="token operator">=</span> <span class="token string">"ncase.exposure"</span>,
                            <span class="token comment"># è®¾ç½® id çš„åˆ—åç§°</span>
                            id_col <span class="token operator">=</span> <span class="token string">"id.exposure"</span><span class="token punctuation">)</span>

head<span class="token punctuation">(</span>outcome_data<span class="token punctuation">)</span>
<span class="token comment">#   other_allele.outcome effect_allele.outcome beta.outcome  se.outcome pval.outcome eaf.outcome</span>
<span class="token comment"># 1                    T                     G  2.06895e-04 0.000308588   0.50000000    0.584698</span>
<span class="token comment"># 2                    A                     G  5.98540e-04 0.000312550   0.05499966    0.608716</span>
<span class="token comment"># 3                    T                     C -3.21544e-04 0.000306840   0.29000000    0.531137</span>
<span class="token comment"># 4                    T                     C  8.35377e-05 0.000308980   0.78999983    0.407134</span>
<span class="token comment"># 5                    C                     T  3.08316e-04 0.000308869   0.32000002    0.590060</span>
<span class="token comment"># 6                    A                     G -2.52780e-04 0.000376396   0.50000000    0.205203</span>
<span class="token comment">#   samplesize.outcome ncase.outcome        SNP id.outcome outcome mr_keep.outcome pval_origin.outcome</span>
<span class="token comment"># 1             462933         10303   rs977747     IT2c0O outcome            TRUE            reported</span>
<span class="token comment"># 2             462933         10303   rs657452     IT2c0O outcome            TRUE            reported</span>
<span class="token comment"># 3             462933         10303  rs7531118     IT2c0O outcome            TRUE            reported</span>
<span class="token comment"># 4             462933         10303 rs17381664     IT2c0O outcome            TRUE            reported</span>
<span class="token comment"># 5             462933         10303 rs11165643     IT2c0O outcome            TRUE            reported</span>
<span class="token comment"># 6             462933         10303   rs543874     IT2c0O outcome            TRUE            reported</span>

<span class="token comment"># å¯ä»¥çœ‹åˆ°ä¹Ÿå’Œä¹‹å‰ä»£ç ç›´æ¥ä¸‹è½½çš„æ•°æ®æ˜¯ä¸€æ ·æ»´ï¼</span>
</code></pre> 
<h3><a id="MR__405"></a>MR åˆ†ææ­£å¼å¼€å§‹</h3> 
<p>åé¢çš„åˆ†ææ­¥éª¤å’Œä¹‹å‰ä»‹ç»çš„å®Œå…¨ä¸€æ ·ï¼å’±ä»¬è¿™é‡Œç®€å•å±•ç¤ºä¸€ä¸‹åŸºæœ¬æµç¨‹ï¼Œå…³äºå…·ä½“ç»†èŠ‚ä»‹ç»ã€å‚æ•°è°ƒæ•´ã€ç»“æœè§£è¯»ç­‰ç­‰ï¼Œè¯¦è§ï¼š<a href="https://mp.weixin.qq.com/s/ikBZvr3ivKcm1yrT-R5Q9g" rel="nofollow">çœ‹å®Œä¸ä¼šæ¥ææˆ‘ | å­Ÿå¾·å°”éšæœºåŒ–ä¸‡å­—é•¿æ–‡è¯¦è§£ï¼ˆäºŒï¼‰â€”â€” ä»£ç å®æ“ | é™„ä»£ç æ³¨é‡Š + ç»“æœè§£è¯»</a></p> 
<pre><code class="prism language-bash"><span class="token comment"># MR åˆ†ææ­£å¼å¼€å§‹</span>

<span class="token comment"># æ•´åˆæš´éœ²æ•°æ®å’Œç»“å±€æ•°æ®</span>
data <span class="token operator">&lt;</span>- harmonise_data<span class="token punctuation">(</span>
  exposure_dat <span class="token operator">=</span> exposure_data_clumped,  <span class="token comment"># æŒ‡å®šæš´éœ²æ•°æ®ï¼Œè¿™æ˜¯ä¹‹å‰ä» GWAS æ•°æ®é›†ä¸­æå–çš„å·¥å…·å˜é‡æ•°æ®</span>
  outcome_dat <span class="token operator">=</span> outcome_data      <span class="token comment"># æŒ‡å®šç»“å±€æ•°æ®ï¼Œè¿™æ˜¯ä»å¦ä¸€ä¸ª GWAS æ•°æ®é›†ä¸­æå–çš„å…³è”ç»“å±€æ•°æ®</span>
<span class="token punctuation">)</span>
<span class="token comment"># Harmonising ieu-a-2 (6UhrjN) and outcome (IT2c0O)</span>

<span class="token comment"># å™¢å¯¹ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¿®æ”¹ä¸€ä¸‹æš´éœ²å› ç´ å’Œç»“å±€å› ç´ çš„åç§°ï¼Œæ–¹ä¾¿äººç±»è‚‰çœ¼é˜…è¯»å¤§è„‘ç†è§£</span>
exposure_data_clumped<span class="token variable">$id</span>.exposure <span class="token operator">&lt;</span>- <span class="token string">"BMI"</span>
outcome_data<span class="token variable">$id</span>.outcome <span class="token operator">&lt;</span>- <span class="token string">"BRCA"</span>

<span class="token comment"># å†æ•´åˆ</span>
data <span class="token operator">&lt;</span>- harmonise_data<span class="token punctuation">(</span>
  exposure_dat <span class="token operator">=</span> exposure_data_clumped,  <span class="token comment"># æŒ‡å®šæš´éœ²æ•°æ®ï¼Œè¿™æ˜¯ä¹‹å‰ä» GWAS æ•°æ®é›†ä¸­æå–çš„å·¥å…·å˜é‡æ•°æ®</span>
  outcome_dat <span class="token operator">=</span> outcome_data      <span class="token comment"># æŒ‡å®šç»“å±€æ•°æ®ï¼Œè¿™æ˜¯ä»å¦ä¸€ä¸ª GWAS æ•°æ®é›†ä¸­æå–çš„å…³è”ç»“å±€æ•°æ®</span>
<span class="token punctuation">)</span>
<span class="token comment"># Harmonising ieu-a-2 (BMI) and outcome (BRCA)</span>

<span class="token comment"># MR åˆ†æ</span>
result <span class="token operator">&lt;</span>- mr<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token comment"># å¼‚è´¨æ€§æ£€éªŒ</span>
mr_heterogeneity<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token comment"># æ°´å¹³å¤šæ•ˆæ€§æ£€éªŒ</span>
mr_pleiotropy_test<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token comment"># æ•£ç‚¹å›¾</span>
p1 <span class="token operator">&lt;</span>- mr_scatter_plot<span class="token punctuation">(</span>result, data<span class="token punctuation">)</span>
p1

<span class="token comment"># æ£®æ—å›¾</span>
result_single <span class="token operator">&lt;</span>- mr_singlesnp<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
p2 <span class="token operator">&lt;</span>- mr_forest_plot<span class="token punctuation">(</span>result_single<span class="token punctuation">)</span>
p2

<span class="token comment"># ç•™ä¸€å›¾</span>
result_loo <span class="token operator">&lt;</span>- mr_leaveoneout<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
p3 <span class="token operator">&lt;</span>- mr_leaveoneout_plot<span class="token punctuation">(</span>result_loo<span class="token punctuation">)</span>
p3

<span class="token comment"># æ¼æ–—å›¾</span>
result_single <span class="token operator">&lt;</span>- mr_singlesnp<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
p4 <span class="token operator">&lt;</span>- mr_funnel_plot<span class="token punctuation">(</span>result_single<span class="token punctuation">)</span>
p4
</code></pre> 
<p><img src="https://images2.imgbox.com/b5/be/OV9j35iL_o.png" alt="" width="500" height="500"></p> 
<h3><a id="_461"></a>æ–‡æœ«ç¢ç¢å¿µ</h3> 
<p>é‚£ä»Šå¤©çš„åˆ†äº«å°±åˆ°è¿™é‡Œå•¦ï¼æˆ‘ä»¬ä¸‹æœŸå†è§å“Ÿï¼</p> 
<p>æœ€åé¡ºä¾¿ç»™è‡ªå·±æ¨èä¸€ä¸‹å˜¿å˜¿å˜¿ï¼</p> 
<p>å¦‚æœæˆ‘çš„åˆ†äº«å¯¹ä½ æœ‰ç”¨çš„è¯ï¼Œæ¬¢è¿<strong>å…³æ³¨ç‚¹èµåœ¨çœ‹è½¬å‘åˆ†äº«</strong>é˜¿å·´é˜¿å·´é˜¿å·´é˜¿å·´å·´å·´ï¼è¿™å¯æ˜¯æˆ‘çš„ç¬¬ä¸€åŸåŠ¨åŠ›ï¼</p> 
<p>èŸ¹èŸ¹ä½ ä»¬çš„å–œæ¬¢å’Œæ”¯æŒï¼ï¼ï¼</p> 
<h2><a id="_471"></a>å‚è€ƒèµ„æ–™</h2> 
<ol><li>https://mrcieu.github.io/TwoSampleMR/articles/exposure.html</li><li>https://mrcieu.github.io/TwoSampleMR/articles/outcome.html</li><li>https://github.com/ixxmu/mp_duty/issues/4670</li><li>https://www.bilibili.com/video/BV1LV4y1b7v5</li><li>https://github.com/MRCIEU/gwasvcf</li><li>https://github.com/MRCIEU/gwasglue</li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c82903d7f520f2e85c947ab0349a680e/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">Python-canåº“çš„ä½¿ç”¨ï¼ˆ1ï¼‰â€”â€”ç®€ä»‹ä¸å®‰è£…</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7c82a314083064ae43da6f72f2e08442/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">Android 13 WRITE_EXTERNAL_STORAGE ï¼Œ READ_EXTERNAL_STORAGEä¸å¼¹å‡ºçš„é—®é¢˜</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§å’–.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>