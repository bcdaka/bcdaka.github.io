<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【Perl】与【Excel】 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/64515a5e8f4bd785a7c2b065c2ffd6be/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【Perl】与【Excel】">
  <meta property="og:description" content="引言 perl脚本语言对于文本的处理、转换很强大。对于一些信息量庞大的文本文件，看起来不直观，可以将信息提取至excel表格中，增加数据分析的可视化。perl语言的cpan提供了大量模块。对于excel文件的操作主要用到模块：
Spreadsheet::ParseXLSX
Excel::Writer::XLSX
第一个用于对现有excel 表格的解析，第二个用于创建新的excel文件。如果单纯是将文本信息提取到excel表格中其实第二个模块用的更多。看自己需求吧。
参考 &amp; 鸣谢：
perl处理Excel(跨平台) - 潘高的小站 (pangao.vip)
模块安装 首先确保你的linux系统有perl。
安装模块的指令 sudo perl -MCPAN -e &#34;install &#39;模块名&#39;&#34;
sudo perl -MCPAN -e &#34;install &#39;Spreadsheet::ParseXLSX&#39;&#34;
sudo perl -MCPAN -e &#34;install &#39;Excel::Writer::XLSX&#39;&#34;
安装成功的标志：
示例 纯粹为了练习而写的脚本，统计学生信息，名字是随机生成的字符串。
#!/usr/bin/perl =pod ========================================== Purpose : Excel Witer Example Author : On the way , running Date : 2024-06-16 ========================================== =cut use warnings; use Excel::Writer::XLSX; # -------------------Create a new Excel workbook my $xlsx_file_name = &#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-16T17:46:30+08:00">
    <meta property="article:modified_time" content="2024-06-16T17:46:30+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【Perl】与【Excel】</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/da/f4/SmJg8sBb_o.png"></p> 
<hr> 
<hr> 
<h2>引言</h2> 
<p>perl脚本语言对于文本的处理、转换很强大。对于一些信息量庞大的文本文件，看起来不直观，可以将信息提取至excel表格中，增加数据分析的可视化。perl语言的cpan提供了大量模块。对于excel文件的操作主要用到模块：</p> 
<p><a href="https://metacpan.org/pod/Spreadsheet::ParseXLSX" rel="nofollow" title="Spreadsheet::ParseXLSX">Spreadsheet::ParseXLSX</a></p> 
<p><a href="https://metacpan.org/pod/Excel::Writer::XLSX" rel="nofollow" title="Excel::Writer::XLSX">Excel::Writer::XLSX</a></p> 
<p>第一个用于对现有excel 表格的解析，第二个用于创建新的excel文件。如果单纯是将文本信息提取到excel表格中其实第二个模块用的更多。看自己需求吧。</p> 
<p>参考 &amp; 鸣谢：</p> 
<p><a href="https://blog.pangao.vip/perl%E5%A4%84%E7%90%86Excel%28%E8%B7%A8%E5%B9%B3%E5%8F%B0%29/?_refluxos=a10" rel="nofollow" title="perl处理Excel(跨平台) - 潘高的小站 (pangao.vip)">perl处理Excel(跨平台) - 潘高的小站 (pangao.vip)</a></p> 
<hr> 
<hr> 
<h2>模块安装</h2> 
<p>首先确保你的linux系统有perl。</p> 
<p>安装模块的指令 sudo perl -MCPAN -e "install '模块名'"</p> 
<blockquote> 
 <p>sudo perl -MCPAN -e "install 'Spreadsheet::ParseXLSX'"</p> 
 <p></p> 
 <p>sudo perl -MCPAN -e "install 'Excel::Writer::XLSX'"</p> 
</blockquote> 
<p>安装成功的标志：</p> 
<p class="img-center"><img alt="" height="92" src="https://images2.imgbox.com/50/56/kXGNNuNL_o.png" width="671"></p> 
<h2>示例</h2> 
<p>纯粹为了练习而写的脚本，统计学生信息，名字是随机生成的字符串。</p> 
<pre><code class="language-perl">#!/usr/bin/perl

=pod
==========================================
Purpose : Excel Witer Example
Author  : On the way , running
Date      : 2024-06-16
==========================================
=cut

use warnings;
use Excel::Writer::XLSX;

# -------------------Create a new Excel workbook
my $xlsx_file_name = "Example.xlsx";
my $workbook = Excel::Writer::XLSX-&gt;new( $xlsx_file_name );
print "Create excel file finished!\n";
 
# Add worksheet
$worksheet1 = $workbook-&gt;add_worksheet("Class_1_Information");
$worksheet2 = $workbook-&gt;add_worksheet("Class_2_Information");
$worksheet3 = $workbook-&gt;add_worksheet("Class_3_Information");


# -------------------Add and define format
$format_first_row = $workbook-&gt;add_format();
$format_first_row-&gt;set_bold();
# $format_first_row-&gt;set_italic();
$format_first_row-&gt;set_color( 'white' );
$format_first_row-&gt;set_align( 'center' );
$format_first_row-&gt;set_align( 'vcenter' );
$format_first_row-&gt;set_bg_color( 'blue' );
$format_first_row-&gt;set_border(1);

$format_other_row = $workbook-&gt;add_format();
# $format_other_row-&gt;set_bold();
# $format_other_row-&gt;set_italic();
$format_other_row-&gt;set_color( 'black' );
$format_other_row-&gt;set_align( 'center' );
$format_other_row-&gt;set_align( 'vcenter' );
$format_other_row-&gt;set_bg_color( 'white' );
$format_other_row-&gt;set_border(1);

# -------------------Define functions 
# aim to : generate rand data  
# call format : func_gen_rand_int_data($lower_bound , $upper_bound);
sub func_gen_rand_int_data {
	return int(rand($_[1] - $_[0] + 1)) + $_[0];
}
# function test 
print "The generated rand data is " . func_gen_rand_int_data(0,1) . "\n";

# aim to : generate rand string  
# call format : func_gen_rand_string($lower_bound , $upper_bound , $string_length);
sub func_gen_rand_string {
	my $string_out;
	for (my $i = 0; $i &lt; $_[2]; $i++) {
		$string_out .= chr(func_gen_rand_int_data( $_[0] , $_[1] ));
	}
	return $string_out;
}
# function test 
print "The generated rand string is " . func_gen_rand_string( 65 , 90 , func_gen_rand_int_data(10 , 15)) . "\n";
print "The generated rand string is " . func_gen_rand_string( 65 , 90 , func_gen_rand_int_data(10 , 15)) . "\n";


# -------------------Set information
my $class1_student_num = func_gen_rand_int_data(40 , 50);
my $class2_student_num = func_gen_rand_int_data(40 , 50);
my $class3_student_num = func_gen_rand_int_data(40 , 50);

my @table_head = ("Index" , "Student_Name" , "Gender" , "Age" , "Interest");
my @table_Gender = ("Male" , "Female");
my @table_Interest = ("Ping-Pong" , "Football" , "Basketball" , "Swimming" , "Hiking" , "Climbing" , "Game");

# set cell width/height
$worksheet1-&gt;set_column('A:E',30);$worksheet1-&gt;set_row(0,30);
$worksheet2-&gt;set_column('A:E',30);$worksheet2-&gt;set_row(0,30);
$worksheet3-&gt;set_column('A:E',30);$worksheet3-&gt;set_row(0,30);

#-------------------Write Information to excel file

for (my $col = 0; $col &lt; 5; $col++) {
	for (my $row = 0; $row &lt; $class1_student_num; $row++) {
		if($row == 0){
			$worksheet1-&gt;write( $row, $col, $table_head[$col], $format_first_row );
			}
		else{
			if ($col == 0) {
				$worksheet1-&gt;write( $row, $col, $row , $format_other_row );
			}
			elsif($col == 1) {
				$worksheet1-&gt;write( $row, $col, func_gen_rand_string( 65 , 90 , func_gen_rand_int_data(10 , 15)) , $format_other_row );
			}
			elsif($col == 2) {
				$worksheet1-&gt;write( $row, $col, $table_Gender[func_gen_rand_int_data(0 , 1)], $format_other_row );
			}
			elsif($col == 3) {
				$worksheet1-&gt;write( $row, $col, func_gen_rand_int_data(15, 20), $format_other_row );
			}
			else{
				$worksheet1-&gt;write( $row, $col, $table_Interest[func_gen_rand_int_data(0 , 6)], $format_other_row );
			}
		}
	}
}


for (my $col = 0; $col &lt; 5; $col++) {
	for (my $row = 0; $row &lt; $class2_student_num; $row++) {
		if($row == 0){
			$worksheet2-&gt;write( $row, $col, $table_head[$col], $format_first_row );
			}
		else{
			if ($col == 0) {
				$worksheet2-&gt;write( $row, $col, $row , $format_other_row );
			}
			elsif($col == 1) {
				$worksheet2-&gt;write( $row, $col, func_gen_rand_string( 65 , 90 , func_gen_rand_int_data(10 , 15)) , $format_other_row );
			}
			elsif($col == 2) {
				$worksheet2-&gt;write( $row, $col, $table_Gender[func_gen_rand_int_data(0 , 1)], $format_other_row );
			}
			elsif($col == 3) {
				$worksheet2-&gt;write( $row, $col, func_gen_rand_int_data(15, 20), $format_other_row );
			}
			else{
				$worksheet2-&gt;write( $row, $col, $table_Interest[func_gen_rand_int_data(0 , 6)], $format_other_row );
			}
		}
	}
}

for (my $col = 0; $col &lt; 5; $col++) {
	for (my $row = 0; $row &lt; $class3_student_num; $row++) {
		if($row == 0){
			$worksheet3-&gt;write( $row, $col, $table_head[$col], $format_first_row );
			}
		else{
			if ($col == 0) {
				$worksheet3-&gt;write( $row, $col, $row , $format_other_row );
			}
			elsif($col == 1) {
				$worksheet3-&gt;write( $row, $col, func_gen_rand_string( 65 , 90 , func_gen_rand_int_data(10 , 15)) , $format_other_row );
			}
			elsif($col == 2) {
				$worksheet3-&gt;write( $row, $col, $table_Gender[func_gen_rand_int_data(0 , 1)], $format_other_row );
			}
			elsif($col == 3) {
				$worksheet3-&gt;write( $row, $col, func_gen_rand_int_data(15, 20), $format_other_row );
			}
			else{
				$worksheet3-&gt;write( $row, $col, $table_Interest[func_gen_rand_int_data(0 , 6)], $format_other_row );
			}
		}
	}
}
print "Write Done ! please input &lt; soffice $xlsx_file_name &gt; command in you terminal to open the excel file !\n";

 
$workbook-&gt;close();
</code></pre> 
<p>结果示意：</p> 
<p class="img-center"><img alt="" height="1175" src="https://images2.imgbox.com/69/29/PKJIIZiT_o.png" width="1200"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/301c99bb9517bf29886200a8f841d1f6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">sqlite3模块的使用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6f48ce811cecf7aae729661e2cd68970/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">函数(上)(C语言)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>