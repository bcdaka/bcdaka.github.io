<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python &#43; Playwright（1）：Page 页面操作[详细介绍] - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/bcc9fdcae7d97ee68ca17f51492339f7/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="Python &#43; Playwright（1）：Page 页面操作[详细介绍]">
  <meta property="og:description" content="Python &#43; Playwright（1）：Page 页面操作[详细介绍] Page概述Page类的API类别1. 导航和页面操作API2. 页面元素定位和交互API3. 页面内容获取API4. 页面事件和等待API5. JavaScript 执行和脚本处理API6. 网络请求和拦截处理API7. 期待特定事件或条件发生API8. 其他操作API Page概述 Playwright 提供了丰富的页面操作功能，通过 page 对象可以实现对网页的导航、元素定位、交互、页面事件监测等操作。
Page 对象是 Playwright 中表示页面的核心对象，它允许我们控制和操作浏览器中的页面。
Page类的API类别 Page类的常用方法包括的API类别如下：
导航和页面操作API：控制浏览器的导航行为，如 goto 跳转到新页面，reload 重新加载当前页面，go_back 和 go_forward 在历史记录中前进和后退。
页面元素定位和交互API：提供了 click、fill、type 等方法，模拟用户与页面元素的交互，以及 locator 用于通过 CSS 选择器、XPath 等定位页面元素。
页面内容获取API：通过 content 获取页面的 HTML 内容，title 获取页面标题，screenshot 进行页面截图，以及 pdf 生成页面的 PDF。
页面事件和等待API：使用 wait_for_event 等待页面上的特定事件，wait_for_load_state 等待页面加载到特定状态，以及 expect_event 期待事件的发生。
JavaScript 执行和脚本处理API：evaluate 在页面上下文中执行 JavaScript 并获取结果，evaluate_handle 执行脚本并返回一个 JSHandle 对象，允许进一步操作。
网络请求和拦截处理API：route 拦截网络请求，unroute 取消拦截，以及 request、response 和 websocket 相关的 API 来处理网络交互。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-08T12:27:29+08:00">
    <meta property="article:modified_time" content="2024-08-08T12:27:29+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python &#43; Playwright（1）：Page 页面操作[详细介绍]</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>Python + Playwright（1）：Page 页面操作[详细介绍]</h4> 
 <ul><li><a href="#Page_1" rel="nofollow">Page概述</a></li><li><a href="#PageAPI_7" rel="nofollow">Page类的API类别</a></li><li><a href="#1_API_27" rel="nofollow">1. 导航和页面操作API</a></li><li><a href="#2_API_42" rel="nofollow">2. 页面元素定位和交互API</a></li><li><a href="#3_API_54" rel="nofollow">3. 页面内容获取API</a></li><li><a href="#4_API_63" rel="nofollow">4. 页面事件和等待API</a></li><li><a href="#5_JavaScript_API_72" rel="nofollow">5. JavaScript 执行和脚本处理API</a></li><li><a href="#6_API_124" rel="nofollow">6. 网络请求和拦截处理API</a></li><li><a href="#7_API_166" rel="nofollow">7. 期待特定事件或条件发生API</a></li><li><a href="#8_API_212" rel="nofollow">8. 其他操作API</a></li></ul> 
</div> 
<p></p> 
<h2><a id="Page_1"></a>Page概述</h2> 
<blockquote> 
 <p>Playwright 提供了丰富的页面操作功能，通过 page 对象可以实现对网页的导航、元素定位、交互、页面事件监测等操作。</p> 
</blockquote> 
<p>Page 对象是 Playwright 中表示页面的核心对象，它允许我们控制和操作浏览器中的页面。</p> 
<h2><a id="PageAPI_7"></a>Page类的API类别</h2> 
<p>Page类的常用方法包括的API类别如下：</p> 
<blockquote> 
 <ol><li> <p><strong>导航和页面操作API</strong>：控制浏览器的导航行为，如 <code>goto</code> 跳转到新页面，<code>reload</code> 重新加载当前页面，<code>go_back</code> 和 <code>go_forward</code> 在历史记录中前进和后退。</p> </li><li> <p><strong>页面元素定位和交互API</strong>：提供了 <code>click</code>、<code>fill</code>、<code>type</code> 等方法，模拟用户与页面元素的交互，以及 <code>locator</code> 用于通过 CSS 选择器、XPath 等定位页面元素。</p> </li><li> <p><strong>页面内容获取API</strong>：通过 <code>content</code> 获取页面的 HTML 内容，<code>title</code> 获取页面标题，<code>screenshot</code> 进行页面截图，以及 <code>pdf</code> 生成页面的 PDF。</p> </li><li> <p><strong>页面事件和等待API</strong>：使用 <code>wait_for_event</code> 等待页面上的特定事件，<code>wait_for_load_state</code> 等待页面加载到特定状态，以及 <code>expect_event</code> 期待事件的发生。</p> </li><li> <p><strong>JavaScript 执行和脚本处理API</strong>：<code>evaluate</code> 在页面上下文中执行 JavaScript 并获取结果，<code>evaluate_handle</code> 执行脚本并返回一个 JSHandle 对象，允许进一步操作。</p> </li><li> <p><strong>网络请求和拦截处理API</strong>：<code>route</code> 拦截网络请求，<code>unroute</code> 取消拦截，以及 <code>request</code>、<code>response</code> 和 <code>websocket</code> 相关的 API 来处理网络交互。</p> </li><li> <p><strong>期待特定事件或条件发生API</strong>：<code>expect</code> 系列 API 允许等待页面上特定条件的满足，如 <code>expect_navigation</code>、<code>expect_console_message</code> 等。</p> </li><li> <p><strong>其他操作API</strong>：包括设置页面的 HTTP 头、模拟媒体类型、自定义导航和操作超时等，如 <code>set_extra_http_headers</code>、<code>emulate_media</code>、<code>set_default_navigation_timeout</code>。</p> </li></ol> 
</blockquote> 
<h2><a id="1_API_27"></a>1. 导航和页面操作API</h2> 
<ul><li><code>page.goto(url, **kwargs)</code>: 导航到指定的 URL。</li><li><code>page.go_back()</code>: 后退到浏览器历史记录中的上一页。</li><li><code>page.go_forward()</code>: 前进到浏览器历史记录中的下一页。</li><li><code>page.reload(**kwargs)</code>: 重新加载当前页面。</li><li><code>page.set_content(html, **kwargs)</code>: 设置页面的 HTML 内容。</li><li><code>page.opener()</code>: 返回新的 Page 实例，表示打开当前页面的页面。</li><li><code>page.wait_for_timeout(timeout)</code>: 暂停执行一段时间。</li><li><code>page.bring_to_front()</code>: 将页面置于浏览器前台。</li><li><code>page.set_viewport_size(width, height)</code>: 设置页面视口大小。</li><li><code>page.close()</code>: 关闭页面。</li></ul> 
<p><strong>代码示例如下：</strong><br> <img src="https://images2.imgbox.com/9d/71/bwtopWzf_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="2_API_42"></a>2. 页面元素定位和交互API</h2> 
<ul><li><code>page.locator(selector)</code>: 创建一个定位器，用于查找页面元素。</li><li><code>page.click(selector, **kwargs)</code>: 点击页面元素。</li><li><code>page.fill(selector, value, **kwargs)</code>: 向表单元素填充值。</li><li><code>page.drag_and_drop(source, target, **kwargs)</code>: 拖拽元素从源位置到目标位置。</li><li><code>page.frame(url=None, name=None)</code>: 返回新的 Frame 实例。</li><li><code>page.frame_locator(selector)</code>: 使用选择器返回新的 Frame 实例。</li></ul> 
<p><strong>代码示例如下：</strong><br> <img src="https://images2.imgbox.com/9d/fc/qOxtvnca_o.png" alt="在这里插入图片描述"><br> <em>请注意，上述代码中的选择器（如 ‘button’, ‘#inputField’, ‘.draggable’, ‘.target’, ‘iframe’）是示例选择器，需要根据实际页面的元素来替换它们。</em></p> 
<h2><a id="3_API_54"></a>3. 页面内容获取API</h2> 
<ul><li><code>page.title()</code>: 获取当前页面的标题。</li><li><code>page.content()</code>: 获取当前页面的 HTML 内容。</li><li><code>page.screenshot(**kwargs)</code>: 对页面进行截图。</li><li><code>page.pdf(**kwargs)</code>: 生成页面的 PDF 版本。</li></ul> 
<p><strong>代码示例如下：</strong><br> <img src="https://images2.imgbox.com/28/d6/ZrkkCaDJ_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="4_API_63"></a>4. 页面事件和等待API</h2> 
<ul><li><code>page.wait_for_load_state(state=None, timeout=None)</code>: 等待页面加载状态变为指定状态。</li><li><code>page.wait_for_url(url, timeout=None)</code>: 等待 URL 变为指定值。</li><li><code>page.wait_for_event(event, predicate=None, timeout=None)</code>: 等待特定事件发生。</li><li><code>page.wait_for_function(page_function, *args, timeout=None, force_expr=False, polling=None)</code>: 等待函数执行。</li></ul> 
<p><strong>代码示例如下：</strong><br> <img src="https://images2.imgbox.com/f4/ca/ZqOXnqQn_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="5_JavaScript_API_72"></a>5. JavaScript 执行和脚本处理API</h2> 
<ul><li><code>page.evaluate(page_function, *args, force_expr=False)</code>: 在页面上下文中执行 JavaScript 代码并返回结果。</li><li><code>page.evaluate_handle(page_function, *args, force_expr=False)</code>: 在页面上下文中执行 JavaScript 代码并返回 JSHandle 对象。</li><li><code>page.add_init_script(script, **kwargs)</code>: 添加一个初始化脚本，将在每次新页面加载时执行。</li><li><code>page.add_script_tag(url=None, path=None, content=None)</code>: 向页面添加一个 script 标签，可以是 URL、文件路径或者直接提供脚本内容。</li><li><code>page.add_locator_handler(name, script=None, handler=None)</code>: 添加一个定位器处理程序，允许使用自定义定位器。</li><li><code>page.add_style_tag(url=None, path=None, content=None)</code>: 向页面添加一个 style 标签，可以是 URL、文件路径或者直接提供样式内容。</li><li><code>page.expose_binding(name, callback)</code>: 公开绑定，使得 JavaScript 环境可以调用 Python 中的函数。</li><li><code>page.expose_function(name, callback)</code>: 公开函数，使得 JavaScript 环境可以调用 Python 中的函数。</li></ul> 
<p><strong>代码示例如下：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> playwright<span class="token punctuation">.</span>sync_api <span class="token keyword">import</span> sync_playwright<span class="token punctuation">,</span> Playwright

<span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>playwright<span class="token punctuation">:</span> Playwright<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    browser <span class="token operator">=</span> playwright<span class="token punctuation">.</span>chromium<span class="token punctuation">.</span>launch<span class="token punctuation">(</span>headless<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    page <span class="token operator">=</span> browser<span class="token punctuation">.</span>new_page<span class="token punctuation">(</span><span class="token punctuation">)</span>
  
    page<span class="token punctuation">.</span>add_script_tag<span class="token punctuation">(</span>content<span class="token operator">=</span><span class="token string">"window.addScriptTagTest = true;"</span><span class="token punctuation">)</span>     <span class="token comment"># 向页面添加一个 script 标签</span>
    page<span class="token punctuation">.</span>add_style_tag<span class="token punctuation">(</span>content<span class="token operator">=</span><span class="token string">"body { background-color: #f0f0f0; }"</span><span class="token punctuation">)</span>   <span class="token comment"># 向页面添加一个 style 标签    </span>
    page<span class="token punctuation">.</span>add_init_script<span class="token punctuation">(</span><span class="token string">"console.log('Initialization script loaded');"</span><span class="token punctuation">)</span> <span class="token comment"># 添加一个初始化脚本，将在每次新页面加载时执行</span>
    
    <span class="token comment"># 公开一个 Python 函数到页面的 JavaScript 环境中</span>
    <span class="token keyword">def</span> <span class="token function">greet</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f"Hello, </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>name<span class="token punctuation">}</span></span><span class="token string">!"</span></span>
    page<span class="token punctuation">.</span>expose_binding<span class="token punctuation">(</span><span class="token string">"greet"</span><span class="token punctuation">,</span> greet<span class="token punctuation">)</span>

    <span class="token comment"># 导航到指定的URL</span>
    page<span class="token punctuation">.</span>goto<span class="token punctuation">(</span><span class="token string">"https://example.com"</span><span class="token punctuation">)</span>   
  
    <span class="token comment"># 在页面上下文中执行 JavaScript 代码并返回结果</span>
    result <span class="token operator">=</span> page<span class="token punctuation">.</span>evaluate<span class="token punctuation">(</span><span class="token string">"() =&gt; document.title"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"页面标题是: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>result<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
  
    <span class="token comment"># 在页面上下文中执行 JavaScript 代码并返回 JSHandle 对象</span>
    handle <span class="token operator">=</span> page<span class="token punctuation">.</span>evaluate_handle<span class="token punctuation">(</span><span class="token string">"() =&gt; document.body"</span><span class="token punctuation">)</span>
    body_content <span class="token operator">=</span> handle<span class="token punctuation">.</span>json_value<span class="token punctuation">(</span><span class="token punctuation">)</span>
    handle<span class="token punctuation">.</span>dispose<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 记得释放handle资源</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"页面body内容是: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>body_content<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    
    <span class="token comment"># 使用自定义定位器处理程序</span>
    page<span class="token punctuation">.</span>add_locator_handler<span class="token punctuation">(</span><span class="token string">"myCustomSelector"</span><span class="token punctuation">,</span> script<span class="token operator">=</span><span class="token string">"return document.querySelector('.my-selector')"</span><span class="token punctuation">)</span>
   
    <span class="token comment"># 然后可以使用自定义的定位器来查找元素</span>
    custom_element <span class="token operator">=</span> page<span class="token punctuation">.</span>locator<span class="token punctuation">(</span><span class="token string">"myCustomSelector"</span><span class="token punctuation">)</span>
    custom_element<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">with</span> sync_playwright<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> playwright<span class="token punctuation">:</span>
    run<span class="token punctuation">(</span>playwright<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="6_API_124"></a>6. 网络请求和拦截处理API</h2> 
<ul><li><code>page.route(url, handler)</code>: 拦截并路由给定 URL 的请求。</li><li><code>page.route_from_har(entries)</code>: 使用 HAR（HTTP 归档文件格式）中的条目设置路由规则。</li><li><code>page.unroute(url=None)</code>: 取消对指定 URL 的请求拦截。</li><li><code>page.unroute_all()</code>: 取消所有请求的拦截。</li></ul> 
<p><strong>代码示例如下：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> playwright<span class="token punctuation">.</span>sync_api <span class="token keyword">import</span> sync_playwright<span class="token punctuation">,</span> Playwright

<span class="token keyword">def</span> <span class="token function">handle_request</span><span class="token punctuation">(</span>route<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 可以在这里修改请求头、响应等</span>
    <span class="token comment"># 例如，我们打印请求的 URL 并继续路由</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Intercepted request to </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>request<span class="token punctuation">.</span>url<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    route<span class="token punctuation">.</span>continue_<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 如果你想修改响应，可以使用 route.fulfill 方法</span>
    <span class="token comment"># route.fulfill(method="GET", path=request.url, headers={"Content-Type": "text/plain"}, body="Modified response")</span>

<span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>playwright<span class="token punctuation">:</span> Playwright<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token comment"># 创建浏览器实例，非无头模式</span>
    browser <span class="token operator">=</span> playwright<span class="token punctuation">.</span>chromium<span class="token punctuation">.</span>launch<span class="token punctuation">(</span>headless<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    <span class="token comment"># 创建页面实例</span>
    page <span class="token operator">=</span> browser<span class="token punctuation">.</span>new_page<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 拦截特定的 URL 请求</span>
    page<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">'**'</span><span class="token punctuation">,</span> handle_request<span class="token punctuation">)</span>
    
    <span class="token comment"># 导航到指定的URL</span>
    page<span class="token punctuation">.</span>goto<span class="token punctuation">(</span><span class="token string">"https://example.com"</span><span class="token punctuation">)</span>
    
    <span class="token comment"># ... 其他操作 ...</span>
    
    <span class="token comment"># 取消对指定 URL 的请求拦截</span>
    <span class="token comment"># page.unroute('https://example.com')</span>
    
    <span class="token comment"># 取消所有请求的拦截</span>
    <span class="token comment"># page.unroute_all()</span>

<span class="token keyword">with</span> sync_playwright<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> playwright<span class="token punctuation">:</span>
    run<span class="token punctuation">(</span>playwright<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="7_API_166"></a>7. 期待特定事件或条件发生API</h2> 
<ul><li><code>page.expect_console_message(text=None, predicate=None, timeout=None)</code>: 期待控制台消息。</li><li><code>page.expect_download(**kwargs)</code>: 期待下载。</li><li><code>page.expect_event(event, predicate=None, timeout=None)</code>: 期待特定事件。</li><li><code>page.expect_file_chooser(predicate=None, timeout=None)</code>: 期待文件选择器。</li><li><code>page.expect_popup(**kwargs)</code>: 期待弹出窗口。</li><li><code>page.expect_request(url=None, predicate=None, timeout=None)</code>: 期待特定请求。</li><li><code>page.expect_request_finished(url=None, predicate=None, timeout=None)</code>: 期待特定请求完成。</li><li><code>expect_response(url=None, predicate=None, timeout=None)</code>: 期待特定响应。</li><li><code>page.expect_websocket(url=None, predicate=None, timeout=None)</code>: 期待 WebSocket 连接。</li><li><code>page.expect_worker(url=None, predicate=None, timeout=None)</code>: 期待工作线程。</li></ul> 
<p><strong>代码示例如下：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> playwright<span class="token punctuation">.</span>sync_api <span class="token keyword">import</span> sync_playwright<span class="token punctuation">,</span> Playwright

<span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>playwright<span class="token punctuation">:</span> Playwright<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    browser <span class="token operator">=</span> playwright<span class="token punctuation">.</span>chromium<span class="token punctuation">.</span>launch<span class="token punctuation">(</span>headless<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    page <span class="token operator">=</span> browser<span class="token punctuation">.</span>new_page<span class="token punctuation">(</span><span class="token punctuation">)</span>
    page<span class="token punctuation">.</span>goto<span class="token punctuation">(</span><span class="token string">"https://example.com"</span><span class="token punctuation">)</span>
    <span class="token comment"># 期待控制台消息包含特定的文本</span>
    page<span class="token punctuation">.</span>expect_console_message<span class="token punctuation">(</span><span class="token keyword">lambda</span> message<span class="token punctuation">:</span> <span class="token string">"Error"</span> <span class="token keyword">in</span> message<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
    <span class="token comment"># 期待下载开始</span>
    download <span class="token operator">=</span> page<span class="token punctuation">.</span>expect_download<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 期待特定事件发生，例如 'load'</span>
    page<span class="token punctuation">.</span>expect_event<span class="token punctuation">(</span><span class="token string">"load"</span><span class="token punctuation">)</span>
    <span class="token comment"># 期待文件选择器出现</span>
    file_chooser <span class="token operator">=</span> page<span class="token punctuation">.</span>expect_file_chooser<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 期待弹出窗口</span>
    popup <span class="token operator">=</span> page<span class="token punctuation">.</span>expect_popup<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 期待特定请求</span>
    request <span class="token operator">=</span> page<span class="token punctuation">.</span>expect_request<span class="token punctuation">(</span><span class="token string">"https://example.com/data"</span><span class="token punctuation">)</span>
    <span class="token comment"># 期待请求完成</span>
    response <span class="token operator">=</span> page<span class="token punctuation">.</span>expect_request_finished<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 期待特定响应</span>
    response <span class="token operator">=</span> page<span class="token punctuation">.</span>expect_response<span class="token punctuation">(</span><span class="token keyword">lambda</span> response<span class="token punctuation">:</span> response<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span>
    <span class="token comment"># 期待 WebSocket 连接</span>
    ws <span class="token operator">=</span> page<span class="token punctuation">.</span>expect_websocket<span class="token punctuation">(</span><span class="token string">"wss://example.com/ws"</span><span class="token punctuation">)</span>
    <span class="token comment"># 期待工作线程</span>
    worker <span class="token operator">=</span> page<span class="token punctuation">.</span>expect_worker<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">with</span> sync_playwright<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> playwright<span class="token punctuation">:</span>
    run<span class="token punctuation">(</span>playwright<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="8_API_212"></a>8. 其他操作API</h2> 
<ul><li><code>page.set_default_navigation_timeout(timeout)</code>: 设置默认的页面导航超时时间。</li><li><code>page.set_default_timeout(timeout)</code>: 设置默认的操作超时时间。</li><li><code>page.set_extra_http_headers(headers)</code>: 设置额外的 HTTP 请求头。</li><li><code>page.set_content(html, **kwargs)</code>: 设置页面内容。</li><li><code>page.emulate_media(media=None, **kwargs)</code>: 模拟媒体类型</li></ul> 
<p><strong>代码示例如下：</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> playwright<span class="token punctuation">.</span>sync_api <span class="token keyword">import</span> sync_playwright<span class="token punctuation">,</span> Playwright

<span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>playwright<span class="token punctuation">:</span> Playwright<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    browser <span class="token operator">=</span> playwright<span class="token punctuation">.</span>chromium<span class="token punctuation">.</span>launch<span class="token punctuation">(</span>headless<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    page <span class="token operator">=</span> browser<span class="token punctuation">.</span>new_page<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 设置默认的页面导航超时时间为 60 秒</span>
    page<span class="token punctuation">.</span>set_default_navigation_timeout<span class="token punctuation">(</span><span class="token number">60000</span><span class="token punctuation">)</span>
    <span class="token comment"># 设置默认的操作超时时间为 30 秒</span>
    page<span class="token punctuation">.</span>set_default_timeout<span class="token punctuation">(</span><span class="token number">30000</span><span class="token punctuation">)</span>
    <span class="token comment"># 设置额外的 HTTP 请求头，例如自定义 User-Agent</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Playwright Custom User-Agent"</span>
    <span class="token punctuation">}</span>
    page<span class="token punctuation">.</span>set_extra_http_headers<span class="token punctuation">(</span>headers<span class="token punctuation">)</span>
    <span class="token comment"># 导航到指定的URL</span>
    page<span class="token punctuation">.</span>goto<span class="token punctuation">(</span><span class="token string">"https://example.com"</span><span class="token punctuation">)</span>
    <span class="token comment"># 设置页面内容</span>
    page<span class="token punctuation">.</span>set_content<span class="token punctuation">(</span><span class="token string">"&lt;html&gt;&lt;body&gt;&lt;h1&gt;自定义页面内容&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;"</span><span class="token punctuation">)</span>
    <span class="token comment"># 模拟媒体类型，例如打印</span>
    page<span class="token punctuation">.</span>emulate_media<span class="token punctuation">(</span>media<span class="token operator">=</span><span class="token string">"print"</span><span class="token punctuation">)</span>
    
<span class="token keyword">with</span> sync_playwright<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> playwright<span class="token punctuation">:</span>
    run<span class="token punctuation">(</span>playwright<span class="token punctuation">)</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6e113ff0f98e9cd45aae09f749015479/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">2024年最新MacBook苹果电脑安装JDK8、JDK11、JDK17、JDK22教程，配置环境变量 &#43; 快速切换JDK版本</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bc91eb401d6041ec8421f1ff3ab3020b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java I/O (Input/Output)——文件字节流</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>