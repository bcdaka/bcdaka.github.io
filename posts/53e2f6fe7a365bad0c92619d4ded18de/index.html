<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ã€Pythonæœºå™¨å­¦ä¹ å®æˆ˜ã€‘ | åŸºäºçº¿æ€§å›å½’ä»¥åŠæ”¯æŒå‘é‡æœºå¯¹æ±½è½¦MPGä¸è‡ªé‡è¿›è¡Œå›å½’é¢„æµ‹ - ç¼–ç¨‹å¤§å’–</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/53e2f6fe7a365bad0c92619d4ded18de/">
  <meta property="og:site_name" content="ç¼–ç¨‹å¤§å’–">
  <meta property="og:title" content="ã€Pythonæœºå™¨å­¦ä¹ å®æˆ˜ã€‘ | åŸºäºçº¿æ€§å›å½’ä»¥åŠæ”¯æŒå‘é‡æœºå¯¹æ±½è½¦MPGä¸è‡ªé‡è¿›è¡Œå›å½’é¢„æµ‹">
  <meta property="og:description" content="ğŸ© æ¬¢è¿æ¥åˆ°æŠ€æœ¯æ¢ç´¢çš„å¥‡å¹»ä¸–ç•ŒğŸ‘¨â€ğŸ’»
ğŸ“œ ä¸ªäººä¸»é¡µï¼š@ä¸€ä¼¦æ˜æ‚¦-CSDNåšå®¢
âœğŸ» ä½œè€…ç®€ä»‹ï¼šÂ C&#43;&#43;è½¯ä»¶å¼€å‘ã€Pythonæœºå™¨å­¦ä¹ çˆ±å¥½è€…
ğŸ—£ï¸Â äº’åŠ¨ä¸æ”¯æŒï¼šğŸ’¬è¯„è®ºÂ ğŸ‘ğŸ»ç‚¹èµÂ ğŸ“‚æ”¶è—Â ğŸ‘€å…³æ³¨&#43;
å¦‚æœæ–‡ç« æœ‰æ‰€å¸®åŠ©ï¼Œæ¬¢è¿ç•™ä¸‹æ‚¨å®è´µçš„è¯„è®ºï¼Œ
ç‚¹èµåŠ æ”¶è—æ”¯æŒæˆ‘ï¼Œç‚¹å‡»å…³æ³¨ï¼Œä¸€èµ·è¿›æ­¥ï¼
å¼•è¨€ çº¿æ€§å›å½’å’Œæ”¯æŒå‘é‡æœºï¼ˆSVMï¼‰æ˜¯å¸¸è§çš„æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œç”¨äºå›å½’å’Œåˆ†ç±»ä»»åŠ¡ã€‚ä»¥ä¸‹æ˜¯å®ƒä»¬çš„ä»‹ç»ä¸åŒºåˆ«ï¼š
çº¿æ€§å›å½’ï¼ˆLinear Regressionï¼‰ï¼š
ä»‹ç»ï¼š
çº¿æ€§å›å½’æ˜¯ä¸€ç§ç”¨äºå»ºç«‹è¾“å…¥ç‰¹å¾ä¸è¿ç»­è¾“å‡ºä¹‹é—´å…³ç³»çš„çº¿æ€§æ¨¡å‹ã€‚é€šè¿‡æ‹Ÿåˆä¸€ä¸ªçº¿æ€§å‡½æ•°æ¥é¢„æµ‹ç›®æ ‡å˜é‡çš„æ•°å€¼ã€‚ç›®æ ‡æ˜¯æ‰¾åˆ°ä½¿æ¨¡å‹é¢„æµ‹å€¼ä¸å®é™…å€¼ä¹‹é—´è¯¯å·®çš„å¹³æ–¹å’Œæœ€å°åŒ–çš„æœ€ä¼˜å‚æ•°ã€‚ ç‰¹ç‚¹ï¼š
ç®€å•ä¸”ç›´è§‚ï¼Œæ˜“äºç†è§£å’Œå®ç°ã€‚é€‚ç”¨äºè¿ç»­æ•°å€¼é¢„æµ‹ä»»åŠ¡ã€‚å¯ä»¥è€ƒè™‘å¤šä¸ªç‰¹å¾å¯¹ç›®æ ‡å˜é‡çš„å½±å“ã€‚ é€‚ç”¨åœºæ™¯ï¼š
é¢„æµ‹æˆ¿ä»·ã€é”€å”®é‡ç­‰è¿ç»­å€¼é—®é¢˜ã€‚ç†è§£ç‰¹å¾å¯¹ç›®æ ‡å˜é‡çš„å½±å“ã€‚ æ”¯æŒå‘é‡æœºï¼ˆSupport Vector Machineï¼ŒSVMï¼‰ï¼š
ä»‹ç»ï¼š
SVMæ˜¯ä¸€ç§ç”¨äºåˆ†ç±»å’Œå›å½’çš„ç›‘ç£å­¦ä¹ ç®—æ³•ã€‚åœ¨ç‰¹å¾ç©ºé—´ä¸­æ‰¾åˆ°ä¸€ä¸ªæœ€ä¼˜çš„è¶…å¹³é¢æ¥åˆ†éš”ä¸åŒç±»åˆ«çš„æ ·æœ¬ã€‚å¯ä»¥é€šè¿‡æ ¸æŠ€å·§å¤„ç†éçº¿æ€§åˆ†ç±»ä»»åŠ¡ã€‚ ç‰¹ç‚¹ï¼š
é€‚ç”¨äºå°æ ·æœ¬ã€é«˜ç»´åº¦çš„æ•°æ®é›†ã€‚å…·æœ‰è¾ƒå¥½çš„æ³›åŒ–èƒ½åŠ›ï¼Œé€‚ç”¨äºè§£å†³éçº¿æ€§å¯åˆ†é—®é¢˜ã€‚å¼•å…¥æ ¸å‡½æ•°å¯æ‰©å±•åˆ°å¤„ç†å¤æ‚æ•°æ®é›†ã€‚ é€‚ç”¨åœºæ™¯ï¼š
äºŒåˆ†ç±»ã€å¤šåˆ†ç±»é—®é¢˜ã€‚å¤„ç†éçº¿æ€§åˆ†ç±»é—®é¢˜ã€‚å›¾åƒè¯†åˆ«ã€æ–‡æœ¬åˆ†ç±»ç­‰é¢†åŸŸã€‚ åŒºåˆ«ï¼š
ç›®æ ‡ï¼š
çº¿æ€§å›å½’æ—¨åœ¨å»ºç«‹è¾“å…¥ç‰¹å¾ä¸è¿ç»­è¾“å‡ºä¹‹é—´çš„çº¿æ€§å…³ç³»ã€‚SVMæ—¨åœ¨æ‰¾åˆ°ä¸€ä¸ªæœ€ä¼˜çš„è¶…å¹³é¢æ¥åˆ†éš”ä¸åŒç±»åˆ«çš„æ ·æœ¬ã€‚ ä»»åŠ¡ï¼š
çº¿æ€§å›å½’è§£å†³çš„æ˜¯å›å½’é—®é¢˜ï¼Œé¢„æµ‹è¿ç»­æ•°å€¼ã€‚SVMå¯ç”¨äºåˆ†ç±»å’Œå›å½’ä»»åŠ¡ï¼Œä¸»è¦åº”ç”¨äºåˆ†ç±»é—®é¢˜ã€‚ æ‹Ÿåˆæ–¹å¼ï¼š
çº¿æ€§å›å½’é€šè¿‡æ‹Ÿåˆç›´çº¿æˆ–è¶…å¹³é¢æ¥é€¼è¿‘æ•°æ®ã€‚SVMé€šè¿‡å¯»æ‰¾é—´éš”æœ€å¤§åŒ–çš„è¶…å¹³é¢æ¥åˆ†éš”ä¸åŒç±»åˆ«çš„æ ·æœ¬ã€‚ å¤„ç†éçº¿æ€§é—®é¢˜ï¼š
çº¿æ€§å›å½’é€‚ç”¨äºçº¿æ€§å…³ç³»ï¼Œä¸æ“…é•¿å¤„ç†éçº¿æ€§æ•°æ®ã€‚SVMå¯ä»¥é€šè¿‡æ ¸æŠ€å·§å¤„ç†éçº¿æ€§åˆ†ç±»é—®é¢˜ã€‚ æ­£æ–‡ 01-çº¿æ€§ä¸å¯åˆ†ä¸‹çš„æ”¯æŒå‘é‡æœºæœ€å¤§è¾¹ç•Œè¶…å¹³é¢ è¿™æ®µä»£ç æ˜¯ç”¨äºç”Ÿæˆå’Œç»˜åˆ¶ä¸€ä¸ªæ”¯æŒå‘é‡æœºï¼ˆSVMï¼‰æ¨¡å‹çš„å›¾ç¤ºã€‚å®ƒä½¿ç”¨scikit-learnåº“ä¸­çš„make_circleså‡½æ•°ç”Ÿæˆäº†ä¸€ä¸ªå…·æœ‰ä¸¤ä¸ªç‰¹å¾çš„æ•°æ®é›†ï¼Œè¯¥æ•°æ®é›†ç”±ä¸¤ä¸ªåŒå¿ƒåœ†ç»„æˆï¼Œè¿™ä»£è¡¨äº†ä¸¤ä¸ªç±»åˆ«ã€‚ç„¶åï¼Œå®ƒå°†æ•°æ®é›†åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œå¹¶ä½¿ç”¨æ”¯æŒå‘é‡æœºæ¨¡å‹è¿›è¡Œè®­ç»ƒå’Œé¢„æµ‹ã€‚æœ€åï¼Œå®ƒç»˜åˆ¶äº†è®­ç»ƒé›†ã€æµ‹è¯•é›†ã€æ”¯æŒå‘é‡ä»¥åŠæ¨¡å‹å†³ç­–è¾¹ç•Œçš„å›¾ç¤ºã€‚
ä¸‹é¢æ˜¯è¿™æ®µä»£ç çš„è¯¦ç»†è§£é‡Šï¼š
å¯¼å…¥å¿…è¦çš„æ¨¡å—ï¼š %matplotlib inline import matplotlib.pyplot as plt from mpl_toolkits.mplot3d import Axes3D import numpy as np from sklearn.datasets import make_circles from sklearn.model_selection import train_test_split from sklearn import svm ç”Ÿæˆæ•°æ®é›†ï¼š N = 100 X, Y = make_circles(n_samples=N, noise=0.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-20T10:22:57+08:00">
    <meta property="article:modified_time" content="2024-06-20T10:22:57+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§å’–" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§å’–</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ã€Pythonæœºå™¨å­¦ä¹ å®æˆ˜ã€‘ | åŸºäºçº¿æ€§å›å½’ä»¥åŠæ”¯æŒå‘é‡æœºå¯¹æ±½è½¦MPGä¸è‡ªé‡è¿›è¡Œå›å½’é¢„æµ‹</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><img alt="" height="95" src="https://images2.imgbox.com/52/4f/qdl6Ge2k_o.gif" width="759"></p> 
<blockquote> 
 <p style="text-align:center;"><u>ğŸ© <span style="color:#511b78;"><strong>æ¬¢è¿æ¥åˆ°æŠ€æœ¯æ¢ç´¢çš„å¥‡å¹»ä¸–ç•Œ</strong></span>ğŸ‘¨â€ğŸ’»</u></p> 
 <p style="text-align:center;"><u>ğŸ“œ <strong>ä¸ªäººä¸»é¡µ</strong></u><a href="https://blog.csdn.net/m0_64336780" title="ï¼š">ï¼š</a><a href="https://blog.csdn.net/m0_59951855?type=lately" title="@ä¸€ä¼¦æ˜æ‚¦-CSDNåšå®¢">@ä¸€ä¼¦æ˜æ‚¦-CSDNåšå®¢</a></p> 
 <p style="text-align:center;"><u>âœğŸ» <strong>ä½œè€…ç®€ä»‹</strong></u>ï¼š<span style="color:#1a439c;">Â <strong>C++è½¯ä»¶å¼€å‘ã€Pythonæœºå™¨å­¦ä¹ çˆ±å¥½è€…</strong></span></p> 
 <p style="text-align:center;"><u>ğŸ—£ï¸Â </u><strong><u>äº’åŠ¨ä¸æ”¯æŒ</u>ï¼š</strong><span style="color:#1a439c;">ğŸ’¬<strong>è¯„è®ºÂ </strong>Â  Â  Â ğŸ‘ğŸ»<strong>ç‚¹èµÂ </strong>Â  Â  Â ğŸ“‚<strong>æ”¶è—Â </strong>Â  Â  ğŸ‘€<strong>å…³æ³¨+</strong></span></p> 
 <p style="text-align:center;"><span style="color:#1a439c;"><u><em><strong>å¦‚æœæ–‡ç« æœ‰æ‰€å¸®åŠ©ï¼Œæ¬¢è¿ç•™ä¸‹æ‚¨å®è´µçš„è¯„è®ºï¼Œ</strong></em></u></span></p> 
 <p style="text-align:center;"><span style="color:#1a439c;"><u><em><strong>ç‚¹èµåŠ æ”¶è—æ”¯æŒæˆ‘ï¼Œç‚¹å‡»å…³æ³¨ï¼Œä¸€èµ·è¿›æ­¥ï¼</strong></em></u></span></p> 
</blockquote> 
<h2 id="main-toc">å¼•è¨€</h2> 
<blockquote> 
 <p>çº¿æ€§å›å½’å’Œæ”¯æŒå‘é‡æœºï¼ˆSVMï¼‰æ˜¯å¸¸è§çš„æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œç”¨äºå›å½’å’Œåˆ†ç±»ä»»åŠ¡ã€‚ä»¥ä¸‹æ˜¯å®ƒä»¬çš„ä»‹ç»ä¸åŒºåˆ«ï¼š</p> 
 <p>çº¿æ€§å›å½’ï¼ˆLinear Regressionï¼‰ï¼š</p> 
 <ol><li> <p><strong>ä»‹ç»</strong>ï¼š</p> 
   <ul><li>çº¿æ€§å›å½’æ˜¯ä¸€ç§ç”¨äºå»ºç«‹è¾“å…¥ç‰¹å¾ä¸è¿ç»­è¾“å‡ºä¹‹é—´å…³ç³»çš„çº¿æ€§æ¨¡å‹ã€‚</li><li>é€šè¿‡æ‹Ÿåˆä¸€ä¸ªçº¿æ€§å‡½æ•°æ¥é¢„æµ‹ç›®æ ‡å˜é‡çš„æ•°å€¼ã€‚</li><li>ç›®æ ‡æ˜¯æ‰¾åˆ°ä½¿æ¨¡å‹é¢„æµ‹å€¼ä¸å®é™…å€¼ä¹‹é—´è¯¯å·®çš„å¹³æ–¹å’Œæœ€å°åŒ–çš„æœ€ä¼˜å‚æ•°ã€‚</li></ul></li><li> <p><strong>ç‰¹ç‚¹</strong>ï¼š</p> 
   <ul><li>ç®€å•ä¸”ç›´è§‚ï¼Œæ˜“äºç†è§£å’Œå®ç°ã€‚</li><li>é€‚ç”¨äºè¿ç»­æ•°å€¼é¢„æµ‹ä»»åŠ¡ã€‚</li><li>å¯ä»¥è€ƒè™‘å¤šä¸ªç‰¹å¾å¯¹ç›®æ ‡å˜é‡çš„å½±å“ã€‚</li></ul></li><li> <p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p> 
   <ul><li>é¢„æµ‹æˆ¿ä»·ã€é”€å”®é‡ç­‰è¿ç»­å€¼é—®é¢˜ã€‚</li><li>ç†è§£ç‰¹å¾å¯¹ç›®æ ‡å˜é‡çš„å½±å“ã€‚</li></ul></li></ol> 
 <p>æ”¯æŒå‘é‡æœºï¼ˆSupport Vector Machineï¼ŒSVMï¼‰ï¼š</p> 
 <ol><li> <p><strong>ä»‹ç»</strong>ï¼š</p> 
   <ul><li>SVMæ˜¯ä¸€ç§ç”¨äºåˆ†ç±»å’Œå›å½’çš„ç›‘ç£å­¦ä¹ ç®—æ³•ã€‚</li><li>åœ¨ç‰¹å¾ç©ºé—´ä¸­æ‰¾åˆ°ä¸€ä¸ªæœ€ä¼˜çš„è¶…å¹³é¢æ¥åˆ†éš”ä¸åŒç±»åˆ«çš„æ ·æœ¬ã€‚</li><li>å¯ä»¥é€šè¿‡æ ¸æŠ€å·§å¤„ç†éçº¿æ€§åˆ†ç±»ä»»åŠ¡ã€‚</li></ul></li><li> <p><strong>ç‰¹ç‚¹</strong>ï¼š</p> 
   <ul><li>é€‚ç”¨äºå°æ ·æœ¬ã€é«˜ç»´åº¦çš„æ•°æ®é›†ã€‚</li><li>å…·æœ‰è¾ƒå¥½çš„æ³›åŒ–èƒ½åŠ›ï¼Œé€‚ç”¨äºè§£å†³éçº¿æ€§å¯åˆ†é—®é¢˜ã€‚</li><li>å¼•å…¥æ ¸å‡½æ•°å¯æ‰©å±•åˆ°å¤„ç†å¤æ‚æ•°æ®é›†ã€‚</li></ul></li><li> <p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p> 
   <ul><li>äºŒåˆ†ç±»ã€å¤šåˆ†ç±»é—®é¢˜ã€‚</li><li>å¤„ç†éçº¿æ€§åˆ†ç±»é—®é¢˜ã€‚</li><li>å›¾åƒè¯†åˆ«ã€æ–‡æœ¬åˆ†ç±»ç­‰é¢†åŸŸã€‚</li></ul></li></ol> 
 <p>åŒºåˆ«ï¼š</p> 
 <ol><li> <p><strong>ç›®æ ‡</strong>ï¼š</p> 
   <ul><li>çº¿æ€§å›å½’æ—¨åœ¨å»ºç«‹è¾“å…¥ç‰¹å¾ä¸è¿ç»­è¾“å‡ºä¹‹é—´çš„çº¿æ€§å…³ç³»ã€‚</li><li>SVMæ—¨åœ¨æ‰¾åˆ°ä¸€ä¸ªæœ€ä¼˜çš„è¶…å¹³é¢æ¥åˆ†éš”ä¸åŒç±»åˆ«çš„æ ·æœ¬ã€‚</li></ul></li><li> <p><strong>ä»»åŠ¡</strong>ï¼š</p> 
   <ul><li>çº¿æ€§å›å½’è§£å†³çš„æ˜¯å›å½’é—®é¢˜ï¼Œé¢„æµ‹è¿ç»­æ•°å€¼ã€‚</li><li>SVMå¯ç”¨äºåˆ†ç±»å’Œå›å½’ä»»åŠ¡ï¼Œä¸»è¦åº”ç”¨äºåˆ†ç±»é—®é¢˜ã€‚</li></ul></li><li> <p><strong>æ‹Ÿåˆæ–¹å¼</strong>ï¼š</p> 
   <ul><li>çº¿æ€§å›å½’é€šè¿‡æ‹Ÿåˆç›´çº¿æˆ–è¶…å¹³é¢æ¥é€¼è¿‘æ•°æ®ã€‚</li><li>SVMé€šè¿‡å¯»æ‰¾é—´éš”æœ€å¤§åŒ–çš„è¶…å¹³é¢æ¥åˆ†éš”ä¸åŒç±»åˆ«çš„æ ·æœ¬ã€‚</li></ul></li><li> <p><strong>å¤„ç†éçº¿æ€§é—®é¢˜</strong>ï¼š</p> 
   <ul><li>çº¿æ€§å›å½’é€‚ç”¨äºçº¿æ€§å…³ç³»ï¼Œä¸æ“…é•¿å¤„ç†éçº¿æ€§æ•°æ®ã€‚</li><li>SVMå¯ä»¥é€šè¿‡æ ¸æŠ€å·§å¤„ç†éçº¿æ€§åˆ†ç±»é—®é¢˜ã€‚</li></ul></li></ol> 
</blockquote> 
<h2>æ­£æ–‡</h2> 
<h3>01-çº¿æ€§ä¸å¯åˆ†ä¸‹çš„æ”¯æŒå‘é‡æœºæœ€å¤§è¾¹ç•Œè¶…å¹³é¢</h3> 
<blockquote> 
 <p>è¿™æ®µä»£ç æ˜¯ç”¨äºç”Ÿæˆå’Œç»˜åˆ¶ä¸€ä¸ªæ”¯æŒå‘é‡æœºï¼ˆSVMï¼‰æ¨¡å‹çš„å›¾ç¤ºã€‚å®ƒä½¿ç”¨scikit-learnåº“ä¸­çš„<code>make_circles</code>å‡½æ•°ç”Ÿæˆäº†ä¸€ä¸ªå…·æœ‰ä¸¤ä¸ªç‰¹å¾çš„æ•°æ®é›†ï¼Œè¯¥æ•°æ®é›†ç”±ä¸¤ä¸ªåŒå¿ƒåœ†ç»„æˆï¼Œè¿™ä»£è¡¨äº†ä¸¤ä¸ªç±»åˆ«ã€‚ç„¶åï¼Œå®ƒå°†æ•°æ®é›†åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œå¹¶ä½¿ç”¨æ”¯æŒå‘é‡æœºæ¨¡å‹è¿›è¡Œè®­ç»ƒå’Œé¢„æµ‹ã€‚æœ€åï¼Œå®ƒç»˜åˆ¶äº†è®­ç»ƒé›†ã€æµ‹è¯•é›†ã€æ”¯æŒå‘é‡ä»¥åŠæ¨¡å‹å†³ç­–è¾¹ç•Œçš„å›¾ç¤ºã€‚</p> 
 <p>ä¸‹é¢æ˜¯è¿™æ®µä»£ç çš„è¯¦ç»†è§£é‡Šï¼š</p> 
 <ol><li>å¯¼å…¥å¿…è¦çš„æ¨¡å—ï¼š</li></ol> 
 <pre><code class="language-python">%matplotlib inline
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
import numpy as np
from sklearn.datasets import make_circles
from sklearn.model_selection import train_test_split
from sklearn import svm
</code></pre> 
 <ol><li>ç”Ÿæˆæ•°æ®é›†ï¼š</li></ol> 
 <pre><code class="language-python">N = 100
X, Y = make_circles(n_samples=N, noise=0.2, factor=0.5, random_state=123)
</code></pre> 
 <p><code>make_circles</code>å‡½æ•°ç”Ÿæˆäº†ä¸€ä¸ªå…·æœ‰ä¸¤ä¸ªç‰¹å¾çš„æ•°æ®é›†ï¼Œå…¶ä¸­åŒ…å«ä¸¤ä¸ªåŒå¿ƒåœ†ï¼Œä»£è¡¨ä¸¤ä¸ªç±»åˆ«ã€‚<code>noise</code>å‚æ•°ç”¨äºæ§åˆ¶åœ†ä¸Šçš„ç‚¹ä¸åœ†ä¸­å¿ƒçš„è·ç¦»ï¼Œ<code>factor</code>å‚æ•°ç”¨äºæ§åˆ¶ä¸¤ä¸ªåœ†ä¹‹é—´çš„è·ç¦»ã€‚</p> 
 <ol><li>åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼š</li></ol> 
 <pre><code class="language-python">X_train, X_test, Y_train, Y_test = train_test_split(X, Y, train_size=0.85, random_state=1)
</code></pre> 
 <p><code>train_test_split</code>å‡½æ•°å°†æ•°æ®é›†åˆ†ä¸º85%çš„è®­ç»ƒé›†å’Œ15%çš„æµ‹è¯•é›†ã€‚</p> 
 <ol><li>åˆ›å»ºç½‘æ ¼ä»¥å±•ç¤ºå†³ç­–è¾¹ç•Œï¼š</li></ol> 
 <pre><code class="language-python">X1, X2 = np.meshgrid(np.linspace(X_train[:, 0].min(), X_train[:, 0].max(), 500),
                     np.linspace(X_train[:, 1].min(), X_train[:, 1].max(), 500))
X0 = np.hstack((X1.reshape(len(X1) * len(X))))</code></pre> 
</blockquote> 
<pre><code class="language-python">#æœ¬ç« éœ€å¯¼å…¥çš„æ¨¡å—
import numpy as np
from numpy import random
import pandas as pd
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
import warnings
warnings.filterwarnings(action = 'ignore')
%matplotlib inline
plt.rcParams['font.sans-serif']=['SimHei']  #è§£å†³ä¸­æ–‡æ˜¾ç¤ºä¹±ç é—®é¢˜
plt.rcParams['axes.unicode_minus']=False
from sklearn.datasets import make_classification,make_circles,make_regression
from sklearn.model_selection import train_test_split,KFold
import sklearn.neural_network as net
import sklearn.linear_model as LM
from scipy.stats import multivariate_normal
from sklearn.metrics import r2_score,mean_squared_error,classification_report
from sklearn import svm
import os

N=100
X,Y=make_circles(n_samples=N,noise=0.2,factor=0.5,random_state=123)
X_train, X_test, Y_train, Y_test = train_test_split(X,Y,train_size=0.85, random_state=1)
X1,X2= np.meshgrid(np.linspace(X_train[:,0].min(),X_train[:,0].max(),500),np.linspace(X_train[:,1].min(),X_train[:,1].max(),500))
X0=np.hstack((X1.reshape(len(X1)*len(X2),1),X2.reshape(len(X1)*len(X2),1)))
fig,axes=plt.subplots(nrows=2,ncols=2,figsize=(15,12))
for C,ker,H,L in [(1,'poly',0,0),(1,'rbf',0,1),(1000,'poly',1,0),(1000,'rbf',1,1)]:
    modelSVC=svm.SVC(kernel=ker,random_state=123,C=C) 
    modelSVC.fit(X_train,Y_train)
    Y0=modelSVC.predict(X0)
    axes[H,L].scatter(X0[np.where(Y0==1),0],X0[np.where(Y0==1),1],c='lightgray')
    axes[H,L].scatter(X0[np.where(Y0==0),0],X0[np.where(Y0==0),1],c='mistyrose')
    for k,m in [(1,'^'),(0,'o')]:
        axes[H,L].scatter(X_train[Y_train==k,0],X_train[Y_train==k,1],marker=m,s=40)
        axes[H,L].scatter(X_test[Y_test==k,0],X_test[Y_test==k,1],marker=m,s=40,c='r',edgecolors='g')
        
    axes[H,L].scatter(modelSVC.support_vectors_[:,0],modelSVC.support_vectors_[:,1],marker='o',c='b',s=120,alpha=0.3)
    axes[H,L].set_xlabel("X1")
    axes[H,L].set_ylabel("X2")
    axes[H,L].set_title("çº¿æ€§ä¸å¯åˆ†ä¸‹çš„æ”¯æŒå‘é‡æœºæœ€å¤§è¾¹ç•Œè¶…å¹³é¢(C=%.1f,Kernal=%s,æµ‹è¯•è¯¯å·®=%.2f)"%(C,ker,1-modelSVC.score(X_test,Y_test)))
    axes[H,L].grid(True,linestyle='-.')
plt.savefig("../4.png", dpi=500) </code></pre> 
<p>è¿è¡Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šÂ </p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/0d/d8/uSwOLHFq_o.png" width="1200"></p> 
<h3>02-100ä¸ªæ ·æœ¬è§‚æµ‹ç‚¹çš„SVRå’Œçº¿æ€§å›å½’</h3> 
<blockquote> 
 <p>è¿™æ®µä»£ç æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ•°æ®åˆ†æå’Œå¯è§†åŒ–æµç¨‹ï¼Œä¸»è¦ä½¿ç”¨äº†Pythonä¸­å¸¸ç”¨çš„æ•°æ®ç§‘å­¦å’Œæœºå™¨å­¦ä¹ åº“ã€‚è®©æˆ‘é€æ­¥è§£é‡Šæ¯éƒ¨åˆ†çš„ä½œç”¨å’Œå«ä¹‰ï¼š</p> 
 <ol><li> <p><strong>æ¨¡å—å¯¼å…¥</strong>ï¼š</p> <pre><code class="language-python">import numpy as np
from numpy import random
import pandas as pd
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
import warnings
warnings.filterwarnings(action='ignore')
%matplotlib inline
</code></pre> 
   <ul><li>å¯¼å…¥äº†å¸¸ç”¨çš„ç§‘å­¦è®¡ç®—åº“ï¼ˆå¦‚NumPyã€Pandasã€Matplotlibï¼‰ã€ä¸‰ç»´ç»˜å›¾æ¨¡å—å’Œè­¦å‘Šå¤„ç†ã€‚</li><li><code>%matplotlib inline</code>Â ç”¨äºåœ¨Jupyter Notebookä¸­ç›´æ¥æ˜¾ç¤ºMatplotlibç”Ÿæˆçš„å›¾å½¢ã€‚</li></ul></li><li> <p><strong>ä¸­æ–‡æ˜¾ç¤ºè®¾ç½®</strong>ï¼š</p> <pre><code class="language-python">plt.rcParams['font.sans-serif'] = ['SimHei']  # è§£å†³ä¸­æ–‡æ˜¾ç¤ºä¹±ç é—®é¢˜
plt.rcParams['axes.unicode_minus'] = False    # è§£å†³è´Ÿå·æ˜¾ç¤ºé—®é¢˜
</code></pre> </li><li> <p><strong>æ•°æ®ç”Ÿæˆä¸åˆ’åˆ†</strong>ï¼š</p> <pre><code class="language-python">N = 100
X, Y = make_regression(n_samples=N, n_features=1, random_state=123, noise=50, bias=0)
X_train, X_test, Y_train, Y_test = train_test_split(X, Y, train_size=0.85, random_state=123)
</code></pre> 
   <ul><li>ä½¿ç”¨Â <code>make_regression</code>Â ç”Ÿæˆå…·æœ‰å™ªå£°çš„å›å½’æ•°æ®ï¼Œç„¶åå°†æ•°æ®åˆ’åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ã€‚</li></ul></li><li> <p><strong>ç¬¬ä¸€ä¸ªå›¾å½¢ç»˜åˆ¶</strong>ï¼š</p> <pre><code class="language-python">plt.scatter(X_train, Y_train, s=20)
plt.scatter(X_test, Y_test, s=20, marker='*')
plt.title("100ä¸ªæ ·æœ¬è§‚æµ‹ç‚¹çš„SVRå’Œçº¿æ€§å›å½’")
plt.xlabel("X")
plt.ylabel("Y")
plt.savefig("../3.png", dpi=500)
</code></pre> 
   <ul><li>ç»˜åˆ¶æ•£ç‚¹å›¾ï¼Œå±•ç¤ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†æ•°æ®ç‚¹ã€‚</li><li>è®¾ç½®å›¾æ ‡é¢˜å’Œåæ ‡è½´æ ‡ç­¾ï¼Œå¹¶ä¿å­˜å›¾å½¢ä¸º â€œâ€¦/3.pngâ€ã€‚</li></ul></li><li> <p><strong>çº¿æ€§å›å½’æ¨¡å‹æ‹Ÿåˆ</strong>ï¼š</p> <pre><code class="language-python">modelLM = LM.LinearRegression()
modelLM.fit(X_train, Y_train)
</code></pre> 
   <ul><li>ä½¿ç”¨çº¿æ€§å›å½’æ¨¡å‹æ‹Ÿåˆè®­ç»ƒæ•°æ®ã€‚</li></ul></li><li> <p><strong>å¤šä¸ªSVRæ¨¡å‹ç»˜åˆ¶</strong>ï¼š</p> <pre><code class="language-python">fig, axes = plt.subplots(nrows=2, ncols=2, figsize=(12, 9))
for C, E, H, L in [(1, 0.1, 0, 0), (1, 100, 0, 1), (100, 0.1, 1, 0), (10000, 0.01, 1, 1)]:
    modelSVR = svm.SVR(C=C, epsilon=E)
    modelSVR.fit(X_train, Y_train)
    axes[H, L].scatter(X_train, Y_train, s=20)
    axes[H, L].scatter(X_test, Y_test, s=20, marker='*')
    axes[H, L].scatter(X[modelSVR.support_], Y[modelSVR.support_], marker='o', c='b', s=120, alpha=0.2)
    axes[H, L].plot(X, modelSVR.predict(X), linestyle='-', label="SVR")
    axes[H, L].plot(X, modelLM.predict(X), linestyle='--', label="çº¿æ€§å›å½’", linewidth=1)
    axes[H, L].legend()
    ytrain = modelSVR.predict(X_train)
    ytest = modelSVR.predict(X_test)
    axes[H, L].set_title("SVR(C=%d,epsilon=%.2f,è®­ç»ƒMSE=%.2f,æµ‹è¯•MSE=%.2f)" % (C, E, mean_squared_error(Y_train, ytrain),
                                                                             mean_squared_error(Y_test, ytest)))
    axes[H, L].set_xlabel("X")
    axes[H, L].set_ylabel("Y")
    axes[H, L].grid(True, linestyle='-.')
</code></pre> 
   <ul><li>åˆ›å»ºä¸€ä¸ªåŒ…å«å››ä¸ªå­å›¾çš„å›¾å½¢å¸ƒå±€ã€‚</li><li>å¯¹æ¯ä¸ªå­å›¾ï¼Œä½¿ç”¨ä¸åŒçš„å‚æ•°Cå’Œepsilonè®­ç»ƒSVRæ¨¡å‹ï¼Œå¹¶ç»˜åˆ¶è®­ç»ƒé›†å’Œæµ‹è¯•é›†æ•°æ®ç‚¹ï¼Œæ”¯æŒå‘é‡ï¼ŒSVRå’Œçº¿æ€§å›å½’æ¨¡å‹çš„æ‹Ÿåˆæ›²çº¿ã€‚</li><li>è®¾ç½®å›¾æ ‡é¢˜ï¼Œæ˜¾ç¤ºè®­ç»ƒå’Œæµ‹è¯•é›†çš„å‡æ–¹è¯¯å·®ï¼ˆMSEï¼‰ã€‚</li></ul></li><li> <p><strong>ä¿å­˜ç¬¬äºŒä¸ªå›¾å½¢</strong>ï¼š</p> <pre><code class="language-python">plt.savefig("../4.png", dpi=500)
</code></pre> 
   <ul><li>å°†åŒ…å«å››ä¸ªå­å›¾çš„å›¾å½¢ä¿å­˜ä¸º â€œâ€¦/4.pngâ€ï¼Œåˆ†è¾¨ç‡ä¸º500 dpiã€‚</li></ul></li></ol> 
 <p>è¿™æ®µä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨Pythonè¿›è¡Œå›å½’åˆ†æå’Œå¯è§†åŒ–ï¼Œæ¯”è¾ƒäº†SVRå’Œçº¿æ€§å›å½’æ¨¡å‹åœ¨ä¸åŒå‚æ•°è®¾ç½®ä¸‹çš„æ•ˆæœï¼Œå¹¶é€šè¿‡å›¾å½¢ç›´è§‚åœ°å±•ç¤ºäº†æ•°æ®ç‚¹ã€æ‹Ÿåˆæ›²çº¿ä»¥åŠæ¨¡å‹çš„è¯„ä¼°ç»“æœã€‚</p> 
</blockquote> 
<pre><code class="language-python">#æœ¬ç« éœ€å¯¼å…¥çš„æ¨¡å—
import numpy as np
from numpy import random
import pandas as pd
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
import warnings
warnings.filterwarnings(action = 'ignore')
%matplotlib inline
plt.rcParams['font.sans-serif']=['SimHei']  #è§£å†³ä¸­æ–‡æ˜¾ç¤ºä¹±ç é—®é¢˜
plt.rcParams['axes.unicode_minus']=False
from sklearn.datasets import make_classification,make_circles,make_regression
from sklearn.model_selection import train_test_split,KFold
import sklearn.neural_network as net
import sklearn.linear_model as LM
from scipy.stats import multivariate_normal
from sklearn.metrics import r2_score,mean_squared_error,classification_report
from sklearn import svm
import os

N=100
X,Y=make_regression(n_samples=N,n_features=1,random_state=123,noise=50,bias=0)
X_train, X_test, Y_train, Y_test = train_test_split(X,Y,train_size=0.85, random_state=123)
plt.scatter(X_train,Y_train,s=20)
plt.scatter(X_test,Y_test,s=20,marker='*')
plt.title("100ä¸ªæ ·æœ¬è§‚æµ‹ç‚¹çš„SVRå’Œçº¿æ€§å›å½’")
plt.xlabel("X")
plt.ylabel("Y")
plt.savefig("../3.png", dpi=500)        
modelLM=LM.LinearRegression()
modelLM.fit(X_train,Y_train)
X[:,0].sort()
fig,axes=plt.subplots(nrows=2,ncols=2,figsize=(12,9))
for C,E,H,L in [(1,0.1,0,0),(1,100,0,1),(100,0.1,1,0),(10000,0.01,1,1)]:
    modelSVR=svm.SVR(C=C,epsilon=E)
    modelSVR.fit(X_train,Y_train)
    axes[H,L].scatter(X_train,Y_train,s=20)
    axes[H,L].scatter(X_test,Y_test,s=20,marker='*')    
    axes[H,L].scatter(X[modelSVR.support_],Y[modelSVR.support_],marker='o',c='b',s=120,alpha=0.2)
    axes[H,L].plot(X,modelSVR.predict(X),linestyle='-',label="SVR")
    axes[H,L].plot(X,modelLM.predict(X),linestyle='--',label="çº¿æ€§å›å½’",linewidth=1)
    axes[H,L].legend()
    ytrain=modelSVR.predict(X_train)
    ytest=modelSVR.predict(X_test)
    axes[H,L].set_title("SVR(C=%d,epsilon=%.2f,è®­ç»ƒMSE=%.2f,æµ‹è¯•MSE=%.2f)"%(C,E,mean_squared_error(Y_train,ytrain),
                                                                       mean_squared_error(Y_test,ytest)))
    axes[H,L].set_xlabel("X")
    axes[H,L].set_ylabel("Y")
    axes[H,L].grid(True,linestyle='-.')

plt.savefig("../4.png", dpi=500) </code></pre> 
<p>è¿è¡Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šÂ </p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/d5/b9/Q4AJT8Rg_o.png" width="1200"></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/0b/05/WHNdylUI_o.png" width="1200"></p> 
<h3>03-è€äººçš„æ´»åŠ¨è¿›è¡Œç»Ÿè®¡</h3> 
<blockquote> 
 <p>è¿™æ®µä»£ç ä¸»è¦å®ç°äº†ä»¥ä¸‹åŠŸèƒ½ï¼š</p> 
 <ol><li> <p>å¯¼å…¥å¿…è¦çš„æ¨¡å—ï¼š</p> 
   <ul><li>å¯¼å…¥ numpy åº“ï¼Œå¹¶ä»ä¸­å¯¼å…¥ random æ¨¡å—ã€‚</li><li>å¯¼å…¥ pandas åº“ï¼Œå¹¶é‡å‘½åä¸º pdã€‚</li><li>å¯¼å…¥ matplotlib.pyplot åº“ï¼Œå¹¶é‡å‘½åä¸º pltã€‚</li><li>å¯¼å…¥ mpl_toolkits.mplot3d åº“ä¸­çš„ Axes3D æ¨¡å—ã€‚</li><li>ä½¿ç”¨ warnings åº“æ¥è¿‡æ»¤è­¦å‘Šä¿¡æ¯ã€‚</li><li>è®¾ç½® matplotlib å›¾è¡¨æ˜¾ç¤ºä¸­æ–‡ã€‚</li><li>å¯¼å…¥ sklearn ä¸­çš„ä¸€äº›æ¨¡å—å’Œå‡½æ•°ã€‚</li><li>å¯¼å…¥ scipy.stats ä¸­çš„ multivariate_normal å‡½æ•°ã€‚</li><li>å¯¼å…¥ sklearn.metrics ä¸­çš„ä¸€äº›è¯„ä¼°æŒ‡æ ‡å‡½æ•°ã€‚</li><li>å¯¼å…¥ os æ¨¡å—ã€‚</li></ul></li><li> <p>å®šä¹‰æ–‡ä»¶è·¯å¾„ pathï¼Œå¹¶åˆ—å‡ºè¯¥è·¯å¾„ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åã€‚</p> </li><li> <p>åˆ›å»ºç©ºçš„ DataFrame data ç”¨äºå­˜å‚¨æ•°æ®ï¼ŒåŒ…æ‹¬åˆ—ï¼šâ€˜TimeStampâ€™, â€˜frontalâ€™, â€˜verticalâ€™, â€˜lateralâ€™, â€˜SensorIDâ€™, â€˜RSSIâ€™, â€˜Phaseâ€™, â€˜Frequencyâ€™, â€˜Activityâ€™, â€˜IDâ€™, â€˜Genderâ€™ã€‚</p> </li><li> <p>éå†æ–‡ä»¶ååˆ—è¡¨ï¼Œé€ä¸ªè¯»å–æ–‡ä»¶ä¸­çš„æ•°æ®ï¼Œå¹¶å°†æ¯ä¸ªæ–‡ä»¶çš„æ•°æ®æ·»åŠ åˆ° data ä¸­ï¼ŒåŒæ—¶ä¸ºæ•°æ®æ·»åŠ  â€˜IDâ€™ å’Œ â€˜Genderâ€™ ä¸¤åˆ—ã€‚</p> </li><li> <p>æ ¹æ® â€˜Activityâ€™ åˆ—ä¸­çš„ä¸åŒæ´»åŠ¨ç±»å‹ç»Ÿè®¡æ•°é‡ï¼Œå¹¶ç»˜åˆ¶æŸ±çŠ¶å›¾å±•ç¤ºè€äººçš„ä½“ä½çŠ¶æ€ï¼Œå…¶ä¸­1è¡¨ç¤ºâ€™ååœ¨åºŠä¸Šâ€™ï¼Œ2è¡¨ç¤ºâ€™ååœ¨æ¤…å­ä¸Šâ€™ï¼Œ3è¡¨ç¤ºâ€™èººåœ¨åºŠä¸Šâ€™ï¼Œ4è¡¨ç¤ºâ€™è¡Œèµ°â€™ã€‚</p> </li><li> <p>å°† â€˜Activityâ€™ æ˜ å°„ä¸ºäºŒåˆ†ç±»æ ‡ç­¾ â€˜ActivityNâ€™ï¼Œåˆ†ä¸º0ï¼ˆâ€˜ååœ¨åºŠä¸Šâ€™æˆ–â€™ååœ¨æ¤…å­ä¸Šâ€™ï¼‰å’Œ1ï¼ˆâ€˜èººåœ¨åºŠä¸Šâ€™æˆ–â€™è¡Œèµ°â€™ï¼‰ï¼Œç»Ÿè®¡å¹¶ç»˜åˆ¶ä½“ä½çŠ¶æ€çš„é¥¼çŠ¶å›¾ã€‚</p> </li><li> <p>å°†ç»˜åˆ¶çš„ä½“ä½çŠ¶æ€å›¾ä¿å­˜ä¸ºæ–‡ä»¶â€™4.pngâ€™ï¼Œå¹¶æ˜¾ç¤ºåœ¨è¾“å‡ºä¸­ã€‚</p> </li></ol> 
 <p>ç»¼ä¸Šæ‰€è¿°ï¼Œè¿™æ®µä»£ç çš„ä½œç”¨æ˜¯è¯»å–å¤šä¸ªæ–‡ä»¶ä¸­çš„æ•°æ®ï¼Œå¯¹è€äººçš„æ´»åŠ¨è¿›è¡Œç»Ÿè®¡ï¼Œå¹¶é€šè¿‡å¯è§†åŒ–å±•ç¤ºè€äººä¸åŒä½“ä½çŠ¶æ€çš„æƒ…å†µï¼Œæœ€ç»ˆå°†ç»“æœä¿å­˜ä¸ºä¸€å¹…å›¾ç‰‡ã€‚</p> 
</blockquote> 
<pre><code class="language-python">#æœ¬ç« éœ€å¯¼å…¥çš„æ¨¡å—
import numpy as np
from numpy import random
import pandas as pd
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
import warnings
warnings.filterwarnings(action = 'ignore')
%matplotlib inline
plt.rcParams['font.sans-serif']=['SimHei']  #è§£å†³ä¸­æ–‡æ˜¾ç¤ºä¹±ç é—®é¢˜
plt.rcParams['axes.unicode_minus']=False
from sklearn.datasets import make_classification,make_circles,make_regression
from sklearn.model_selection import train_test_split,KFold
import sklearn.neural_network as net
import sklearn.linear_model as LM
from scipy.stats import multivariate_normal
from sklearn.metrics import r2_score,mean_squared_error,classification_report
from sklearn import svm
import os

#path='C:/Users/xuewe/ã€ŠPythonæœºå™¨å­¦ä¹ ï¼šæ•°æ®å»ºæ¨¡ä¸åˆ†æã€‹ä»£ç /å¥åº·ç‰©è”ç½‘/'
path='D:/ä»£ç ä¸æ•°æ®/å¥åº·ç‰©è”ç½‘/'
#print(os.path.dirname(path)) è¿”å›æ–‡ä»¶è·¯å¾„ 
#cwd=os.getcwd()  å¾—åˆ°å½“å‰ç›®å½•
#os.path.join(dirname, filename)
#os.walk(path) 

filenames=os.listdir(path=path)
data=pd.DataFrame(columns=['TimeStamp', 'frontal', 'vertical', 'lateral', 'SensorID', 'RSSI','Phase', 'Frequency', 'Activity', 'ID', 'Gender'])
i=1
for filename in filenames:
    tmp=pd.read_csv(path+filename)
    tmp['ID']=i
    tmp['Gender']=filename[-5]
    i+=1
    data=data.append(tmp)

label=['ååœ¨åºŠä¸Š','ååœ¨æ¤…å­ä¸Š','èººåœ¨åºŠä¸Š','è¡Œèµ°']
countskey=data['Activity'].value_counts().index
plt.bar(np.unique(data['Activity']),data['Activity'].value_counts())
plt.xticks([1,2,3,4],[label[countskey[0]-1],label[countskey[1]-1],label[countskey[2]-1],label[countskey[3]-1]])
plt.title("è€äººçš„ä½“ä½çŠ¶æ€")
plt.show()
data['ActivityN']=data['Activity'].map({3:0,1:0,2:1,4:1})
plt.bar([1,2],data['ActivityN'].value_counts())
plt.xticks([1,2],['å®‰å…¨ä½“ä½','é£é™©ä½“ä½'])
plt.title("è€äººçš„ä½“ä½çŠ¶æ€")

plt.savefig("../4.png", dpi=500) 
plt.show()
</code></pre> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/c8/82/0xNTRQJY_o.png" width="1200"></p> 
<pre><code class="language-python">Y=data['Activity'].astype(int)
X=data[['frontal', 'vertical', 'lateral', 'RSSI']]
X_train, X_test, Y_train, Y_test = train_test_split(X,Y,train_size=0.70, random_state=1)
for ker in ['poly','rbf']:
    modelSVC=svm.SVC(kernel=ker,random_state=123) 
    modelSVC.fit(X_train,Y_train)
    print("æµ‹è¯•è¯¯å·®=%f(%s)"%(1-modelSVC.score(X_test,Y_test),ker))
    print(classification_report(Y_test,modelSVC.predict(X_test)))</code></pre> 
<blockquote> 
 <pre>æµ‹è¯•è¯¯å·®=0.056962(poly)
              precision    recall  f1-score   support

           1       0.57      0.71      0.63       368
           2       0.00      0.00      0.00       170
           3       0.97      1.00      0.98      6147
           4       0.00      0.00      0.00       109

    accuracy                           0.94      6794
   macro avg       0.38      0.43      0.40      6794
weighted avg       0.91      0.94      0.93      6794

æµ‹è¯•è¯¯å·®=0.095231(rbf)
              precision    recall  f1-score   support

           1       0.00      0.00      0.00       368
           2       0.00      0.00      0.00       170
           3       0.90      1.00      0.95      6147
           4       0.00      0.00      0.00       109

    accuracy                           0.90      6794
   macro avg       0.23      0.25      0.24      6794
weighted avg       0.82      0.90      0.86      6794
</pre> 
</blockquote> 
<h3>04-åŸºäºçº¿æ€§å›å½’ä»¥åŠæ”¯æŒå‘é‡æœºå¯¹æ±½è½¦MPGä¸è‡ªé‡è¿›è¡Œå›å½’é¢„æµ‹</h3> 
<blockquote> 
 <p>è¿™æ®µä»£ç å®ç°äº†ä»¥ä¸‹åŠŸèƒ½ï¼š</p> 
 <ol><li> <p>å¯¼å…¥å¿…è¦çš„æ¨¡å—ï¼š</p> 
   <ul><li>å¯¼å…¥ numpy åº“ï¼Œå¹¶ä»ä¸­å¯¼å…¥ random å’Œ math æ¨¡å—ã€‚</li><li>å¯¼å…¥ pandas åº“ï¼Œå¹¶é‡å‘½åä¸º pdã€‚</li><li>å¯¼å…¥ matplotlib.pyplot åº“ï¼Œå¹¶é‡å‘½åä¸º pltã€‚</li><li>å¯¼å…¥ mpl_toolkits.mplot3d åº“ä¸­çš„ Axes3D æ¨¡å—ã€‚</li><li>ä½¿ç”¨ warnings åº“æ¥è¿‡æ»¤è­¦å‘Šä¿¡æ¯ã€‚</li><li>è®¾ç½® matplotlib å›¾è¡¨æ˜¾ç¤ºä¸­æ–‡ã€‚</li><li>å¯¼å…¥ sklearn ä¸­çš„ä¸€äº›æ¨¡å—å’Œå‡½æ•°ã€‚</li><li>å¯¼å…¥ scipy.stats ä¸­çš„ multivariate_normal å‡½æ•°ã€‚</li><li>å¯¼å…¥ sklearn.metrics ä¸­çš„ä¸€äº›è¯„ä¼°æŒ‡æ ‡å‡½æ•°ã€‚</li><li>å¯¼å…¥ sklearn ä¸­çš„æ”¯æŒå‘é‡å›å½’æ¨¡å‹ svmã€‚</li><li>å¯¼å…¥ os æ¨¡å—ã€‚</li></ul></li><li> <p>è¯»å–åä¸º â€˜æ±½è½¦MPG.csvâ€™ çš„æ•°æ®æ–‡ä»¶ï¼Œå¹¶ä¸¢å¼ƒç¼ºå¤±å€¼ã€‚</p> </li><li> <p>é€‰æ‹©æ•°æ®ä¸­çš„ â€˜weightâ€™ å’Œ â€˜horsepowerâ€™ åˆ—ä½œä¸ºç‰¹å¾ Xï¼Œâ€˜MPGâ€™ åˆ—ä½œä¸ºç›®æ ‡å˜é‡ Yã€‚åˆå§‹åŒ–ä¸€ä¸ªæµ‹è¯•ç‚¹ X0 å’Œå¯¹åº”çš„é¢„æµ‹ç›®æ ‡å€¼ Y0ã€‚</p> </li><li> <p>å»ºç«‹çº¿æ€§å›å½’æ¨¡å‹ modelLM å’Œæ”¯æŒå‘é‡å›å½’æ¨¡å‹ modelSVRã€‚</p> </li><li> <p>åˆ›å»ºç”¨äºç»˜å›¾çš„å­å›¾ï¼Œè®¾ç½®å­å›¾çš„å¤§å°ä¸º 2x2ã€‚</p> </li><li> <p>ä½¿ç”¨ KFold è¿›è¡Œä¸¤æŠ˜äº¤å‰éªŒè¯ï¼Œåˆ†åˆ«åœ¨è®­ç»ƒé›†ä¸Šè®­ç»ƒçº¿æ€§å›å½’æ¨¡å‹å’Œæ”¯æŒå‘é‡å›å½’æ¨¡å‹ï¼Œå¹¶å¯¹æµ‹è¯•ç‚¹è¿›è¡Œé¢„æµ‹ã€‚</p> </li><li> <p>åœ¨æ¯ä¸ªå­å›¾ä¸­ç»˜åˆ¶ï¼š</p> 
   <ul><li>å·¦ä¸Šè§’ï¼šè®­ç»ƒæ•°æ®ç‚¹çš„æ•£ç‚¹å›¾ï¼›</li><li>å³ä¸Šè§’ï¼šçº¿æ€§å›å½’å’Œæ”¯æŒå‘é‡å›å½’çš„é¢„æµ‹ç»“æœï¼›</li><li>å·¦ä¸‹è§’ï¼šåœ¨è®­ç»ƒæ•°æ®ä¸Šçš„ MPG ä¸è‡ªé‡ çš„å…³ç³»æ•£ç‚¹å›¾ä»¥åŠæµ‹è¯•ç‚¹çš„é¢„æµ‹ç»“æœï¼›</li><li>å³ä¸‹è§’ï¼šçº¿æ€§å›å½’å’Œæ”¯æŒå‘é‡å›å½’åœ¨æµ‹è¯•ç‚¹ä¸Šçš„é¢„æµ‹ç»“æœã€‚</li></ul></li><li> <p>ä¿å­˜ç»˜åˆ¶çš„å›¾åƒä¸ºæ–‡ä»¶â€™4.pngâ€™ã€‚</p> </li></ol> 
 <p>ç»¼ä¸Šæ‰€è¿°ï¼Œè¿™æ®µä»£ç çš„ä¸»è¦ä½œç”¨æ˜¯ä½¿ç”¨çº¿æ€§å›å½’å’Œæ”¯æŒå‘é‡å›å½’æ¨¡å‹é¢„æµ‹æ±½è½¦çš„ç‡ƒæ²¹æ•ˆç‡ï¼ˆMPGï¼‰ï¼Œå¹¶é€šè¿‡äº¤å‰éªŒè¯å’Œå¯è§†åŒ–å±•ç¤ºæ¨¡å‹åœ¨è®­ç»ƒé›†ä¸Šçš„æ‹Ÿåˆæƒ…å†µå’Œåœ¨æµ‹è¯•ç‚¹ä¸Šçš„é¢„æµ‹æ•ˆæœã€‚</p> 
</blockquote> 
<pre><code class="language-python">#æœ¬ç« éœ€å¯¼å…¥çš„æ¨¡å—
import numpy as np
from numpy import random,math
import pandas as pd
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
import warnings
warnings.filterwarnings(action = 'ignore')
%matplotlib inline
plt.rcParams['font.sans-serif']=['SimHei']  #è§£å†³ä¸­æ–‡æ˜¾ç¤ºä¹±ç é—®é¢˜
plt.rcParams['axes.unicode_minus']=False
from sklearn.datasets import make_classification,make_circles,make_regression
from sklearn.model_selection import train_test_split,KFold
import sklearn.neural_network as net
import sklearn.linear_model as LM
from scipy.stats import multivariate_normal
from sklearn.metrics import r2_score,mean_squared_error,classification_report
from sklearn import svm
import os

data=pd.read_csv('æ±½è½¦MPG.csv')
data=data.dropna()
data.head()

X=data[['weight','horsepower']]  
X0=[[X.max()[0],X.max()[1]]]
Y0=data['MPG'].mean()
modelLM=LM.LinearRegression()
modelSVR=svm.SVR(C=1000,epsilon=0.01)
yhat1=[]
yhat2=[]
fig,axes=plt.subplots(nrows=2,ncols=2,figsize=(12,10))
kf = KFold(n_splits=2,shuffle=True,random_state=123)  # KæŠ˜äº¤å‰éªŒè¯æ³•
H=0
for train_index, test_index in kf.split(X): 
    sample=data.iloc[train_index,]    
    X=sample[['weight','horsepower']]
    #Y=sample['MPG'].map(lambda x:math.log(x))
    Y=sample['MPG']
    modelLM.fit(X,Y)
    modelSVR.fit(X,Y)
    yhat1.append(modelLM.predict(X0))
    yhat2.append(modelSVR.predict(X0))
    
    axes[H,0].scatter(sample['weight'],sample['MPG'],s=20,label="è®­ç»ƒç‚¹")
    axes[H,0].set_title("MPGä¸è‡ªé‡(è®­ç»ƒé›†%d)"%(H+1))
    axes[H,0].set_xlabel("è‡ªé‡")
    axes[H,0].set_ylabel("MPG")
    axes[H,0].scatter(X0[0][0],Y0,c='r',s=40,marker='*',label="æ–°æ•°æ®ç‚¹")
    axes[H,0].legend()
    
    axes[H,1].scatter(sample['weight'],modelLM.predict(X),s=15,marker='*',c='orange',label="çº¿æ€§å›å½’é¢„æµ‹")
    axes[H,1].scatter(sample['weight'],modelSVR.predict(X),s=15,marker='o',c='blue',label="SVRé¢„æµ‹")
    axes[H,1].set_title("MPGä¸è‡ªé‡(è®­ç»ƒé›†%d)"%(H+1))
    axes[H,1].set_xlabel("è‡ªé‡")
    axes[H,1].set_ylabel("MPG")
    axes[H,1].scatter(X0[0][0],modelLM.predict(X0),c='r',s=40,marker='&lt;',label="æ–°æ•°æ®ç‚¹çš„çº¿æ€§å›å½’é¢„æµ‹")
    axes[H,1].scatter(X0[0][0],modelSVR.predict(X0),c='r',s=40,marker='&gt;',label="æ–°æ•°æ®ç‚¹çš„SVRé¢„æµ‹")  
    axes[H,1].legend()
    H+=1     
plt.savefig("../4.png", dpi=500) </code></pre> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/ea/c8/vF5lUSWK_o.png" width="1200"></p> 
<h2 style="background-color:transparent;">æ€»ç»“</h2> 
<blockquote> 
 <p>æ€»çš„æ¥è¯´ï¼Œçº¿æ€§å›å½’é€‚ç”¨äºé¢„æµ‹è¿ç»­æ•°å€¼ï¼Œè€Œæ”¯æŒå‘é‡æœºé€‚ç”¨äºå¤„ç†åˆ†ç±»é—®é¢˜ï¼Œå¹¶ä¸”èƒ½å¤Ÿå¤„ç†éçº¿æ€§åˆ†ç±»ä»»åŠ¡ã€‚é€‰æ‹©é€‚å½“çš„ç®—æ³•å–å†³äºæ•°æ®ç±»å‹ã€ä»»åŠ¡éœ€æ±‚å’Œæ¨¡å‹å¤æ‚åº¦ã€‚</p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/96a5f4e6c9250cd97f2265e667c89dce/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">å¡”ç‘æ–¯ä¸–ç•Œ Mac ä¸‹è½½å®‰è£…è¯¦ç»†æ•™ç¨‹ï¼ˆé»‘å±æ‰“ä¸å¼€é—®é¢˜è§£å†³æŒ‡å—ï¼‰</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/caa522adbe363fc086ef70ec745380fb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">RabbitMQè¯¦è§£-06RabbitMQé«˜çº§</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§å’–.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>