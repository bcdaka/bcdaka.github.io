<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【爬虫】爬虫基础 - 编程大咖</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcdaka.github.io/posts/7498bf82b9a8ac79359b32e2a6a5c58d/">
  <meta property="og:site_name" content="编程大咖">
  <meta property="og:title" content="【爬虫】爬虫基础">
  <meta property="og:description" content="目录 一、Http响应与请求1、Http请求2、Http响应3、状态码 二、Requests库1、发起GET请求2、发起POST请求3、处理请求头 三、BeautifulSoup库1、解析HTML文档2、查找和提取数据Ⅰ、查找单个元素Ⅱ、查找所有元素Ⅲ、使用CSS选择器Ⅳ、获取元素属性 四、爬取豆瓣电影榜 一、Http响应与请求 HTTP是一种客户端-服务器协议，通信的双方分别是客户端和服务器。客户端发送HTTP请求，服务器接收并处理请求后返回HTTP响应。
1、Http请求 HTTP请求由请求行、请求头部、空行和请求数据（如POST请求时的表单数据）组成。
请求行包含请求方法、请求的URL和协议版本。常见的请求方法包括GET、POST、PUT、DELETE等。请求头部包含关于客户端和请求的其他信息，如User-Agent、Accept、Content-Type等。空行用于分隔请求头部和请求数据。请求数据通常用于POST请求，包含提交的数据。 请求示例：
POST /api/users HTTP/1.1 Host: www.example.com User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36 Accept: application/json Content-Type: application/json Content-Length: 27 { &#34;name&#34;: &#34;John&#34;, &#34;age&#34;: 30 } 请求行：POST /api/users HTTP/1.1
请求头：包含Host、User-Agent、Accept、Content-Type、Content-Length等
空行：请求头和请求体之间的空行
请求体：JSON数据
2、Http响应 HTTP响应由状态行、响应头部、空行和响应数据组成。
状态行包含协议版本、状态码和状态消息。状态码指示了请求的处理结果，如200表示成功，404表示未找到资源，500表示服务器内部错误等。响应头部包含服务器和响应的其他信息，如Server、Content-Type、Content-Length等。空行用于分隔响应头部和响应数据。响应数据包含服务器返回的数据，如HTML、JSON等。 假设服务器返回一个简单的HTML页面，响应可能如下：
HTTP/1.1 200 OK Date: Sun, 02 Jun 2024 10:20:30 GMT Server: Apache/2.4.41 (Ubuntu) Content-Type: text/html; charset=UTF-8 Content-Length: 137 Connection: keep-alive &lt;!">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-11T21:56:32+08:00">
    <meta property="article:modified_time" content="2024-07-11T21:56:32+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大咖" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大咖</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【爬虫】爬虫基础</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#Http_3" rel="nofollow">一、Http响应与请求</a></li><li><ul><li><a href="#1Http_7" rel="nofollow">1、Http请求</a></li><li><a href="#2Http_40" rel="nofollow">2、Http响应</a></li><li><a href="#3_79" rel="nofollow">3、状态码</a></li></ul> 
  </li><li><a href="#Requests_93" rel="nofollow">二、Requests库</a></li><li><ul><li><a href="#1GET_99" rel="nofollow">1、发起GET请求</a></li><li><a href="#2POST_115" rel="nofollow">2、发起POST请求</a></li><li><a href="#3_139" rel="nofollow">3、处理请求头</a></li></ul> 
  </li><li><a href="#BeautifulSoup_176" rel="nofollow">三、BeautifulSoup库</a></li><li><ul><li><a href="#1HTML_182" rel="nofollow">1、解析HTML文档</a></li><li><a href="#2_200" rel="nofollow">2、查找和提取数据</a></li><li><ul><li><a href="#_212" rel="nofollow">Ⅰ、查找单个元素</a></li><li><a href="#_221" rel="nofollow">Ⅱ、查找所有元素</a></li><li><a href="#CSS_231" rel="nofollow">Ⅲ、使用CSS选择器</a></li><li><a href="#_241" rel="nofollow">Ⅳ、获取元素属性</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_251" rel="nofollow">四、爬取豆瓣电影榜</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="Http_3"></a>一、Http响应与请求</h2> 
<p>HTTP是一种客户端-服务器协议，通信的双方分别是客户端和服务器。客户端发送HTTP请求，服务器接收并处理请求后返回HTTP响应。</p> 
<h3><a id="1Http_7"></a>1、Http请求</h3> 
<p>HTTP请求由请求行、请求头部、空行和请求数据（如POST请求时的表单数据）组成。</p> 
<ul><li>请求行包含请求方法、请求的URL和协议版本。常见的请求方法包括GET、POST、PUT、DELETE等。</li><li>请求头部包含关于客户端和请求的其他信息，如User-Agent、Accept、Content-Type等。</li><li>空行用于分隔请求头部和请求数据。</li><li>请求数据通常用于POST请求，包含提交的数据。</li></ul> 
<p>请求示例：</p> 
<pre><code>POST /api/users HTTP/1.1
Host: www.example.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36
Accept: application/json
Content-Type: application/json
Content-Length: 27

{
  "name": "John",
  "age": 30
}
</code></pre> 
<p><strong>请求行</strong>：POST /api/users HTTP/1.1</p> 
<p><strong>请求头</strong>：包含Host、User-Agent、Accept、Content-Type、Content-Length等</p> 
<p><strong>空行</strong>：请求头和请求体之间的空行</p> 
<p><strong>请求体</strong>：JSON数据</p> 
<h3><a id="2Http_40"></a>2、Http响应</h3> 
<p>HTTP响应由状态行、响应头部、空行和响应数据组成。</p> 
<ul><li>状态行包含协议版本、状态码和状态消息。状态码指示了请求的处理结果，如200表示成功，404表示未找到资源，500表示服务器内部错误等。</li><li>响应头部包含服务器和响应的其他信息，如Server、Content-Type、Content-Length等。</li><li>空行用于分隔响应头部和响应数据。</li><li>响应数据包含服务器返回的数据，如HTML、JSON等。</li></ul> 
<p>假设服务器返回一个简单的HTML页面，响应可能如下：</p> 
<pre><code>HTTP/1.1 200 OK
Date: Sun, 02 Jun 2024 10:20:30 GMT
Server: Apache/2.4.41 (Ubuntu)
Content-Type: text/html; charset=UTF-8
Content-Length: 137
Connection: keep-alive

&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Example Page&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Hello, World!&lt;/h1&gt;
    &lt;p&gt;This is a sample HTML page.&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre> 
<p><strong>状态行</strong>：HTTP/1.1 200 OK</p> 
<p><strong>响应头</strong>：包含Date、Server、Content-Type、Content-Length、Connection等</p> 
<p><strong>空行</strong>：响应头和响应体之间的空行</p> 
<p><strong>响应体</strong>：包含HTML代码</p> 
<h3><a id="3_79"></a>3、状态码</h3> 
<p>HTTP状态码指示了服务器对请求的处理结果。常见的状态码包括：</p> 
<ul><li><strong>1xx：信息响应</strong>，表示请求已接收，继续处理。</li><li><strong>2xx：成功</strong>，表示请求已成功被服务器接收、理解、并接受。</li><li><strong>3xx：重定向</strong>，表示需要进一步操作以完成请求。</li><li><strong>4xx：客户端错误</strong>，表示服务器无法处理请求。</li><li><strong>5xx：服务器错误</strong>，表示服务器在处理请求时发生了错误。</li></ul> 
<p><img src="https://images2.imgbox.com/3e/75/PzIvikzM_o.png" alt="状态码"></p> 
<h2><a id="Requests_93"></a>二、Requests库</h2> 
<p>Python的Requests库是一个非常强大且易于使用的HTTP库。</p> 
<p>在使用之前，需要先安装Requests库：<code>pip install requests</code></p> 
<h3><a id="1GET_99"></a>1、发起GET请求</h3> 
<p>GET请求用于从服务器请求数据。使用Requests库发起GET请求非常简单：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token comment"># 发起GET请求</span>
response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'https://news.baidu.com'</span><span class="token punctuation">)</span>
<span class="token comment"># 检查响应状态码</span>
<span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>
    <span class="token comment"># 打印响应内容</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"请求失败，状态码：</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>response<span class="token punctuation">.</span>status_code<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="2POST_115"></a>2、发起POST请求</h3> 
<p>POST请求用于向服务器提交数据。例如，需要登录的网站通常使用POST请求提交用户名和密码。使用Requests库发起POST请求的方法如下：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests

<span class="token comment"># 定义要发送的数据</span>
data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string">'123123123'</span><span class="token punctuation">,</span>
    <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'1231231312'</span>
<span class="token punctuation">}</span>

<span class="token comment"># 发起POST请求</span>
response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">'https://passport.bilibili.com/x/passport-login/web/login'</span><span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>

<span class="token comment"># 检查响应状态码</span>
<span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>
    <span class="token comment"># 打印响应内容</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"请求失败，状态码：</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>response<span class="token punctuation">.</span>status_code<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="3_139"></a>3、处理请求头</h3> 
<p>在有些网站（例如豆瓣），不让爬虫有反爬取机制，需要设置HTTP请求头和参数，来伪装成浏览器通过身份验证。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests

response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://movie.douban.com/top250"</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> response<span class="token punctuation">.</span>ok<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"请求失败:"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>status_code<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/41/8f/MobzBkYG_o.png" alt="请求失败"></p> 
<p>例如，上面的代码，没有设置请求头，豆瓣就拒绝让我们访问。</p> 
<p><img src="https://images2.imgbox.com/83/00/kEgCSQoi_o.png" alt="image-20240607014319894"></p> 
<p>我们可用随便进入网站，随便找个现成的User-Agent，放到我们的请求头里。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests

headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36 Edg/125.0.0.0"</span>
<span class="token punctuation">}</span>

response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://movie.douban.com/top250"</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/2f/5c/RVYd13LZ_o.png" alt="image-20240607014435738"></p> 
<p>这样，就能访问豆瓣，并且获取该网页的内容了。</p> 
<h2><a id="BeautifulSoup_176"></a>三、BeautifulSoup库</h2> 
<p>BeautifulSoup 是一个用于解析 HTML 和 XML 文档的 Python 库，尤其适用于从网页中提取数据。</p> 
<p>在使用之前，需要安装BeautifulSoup 库：<code>pip install beautifulsoup4</code></p> 
<h3><a id="1HTML_182"></a>1、解析HTML文档</h3> 
<p><code>html.parser</code>是Python内置的解析器，适用于大多数场景。以上面的豆瓣为例。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup

headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36 Edg/125.0.0.0"</span>
<span class="token punctuation">}</span>

response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://movie.douban.com/top250"</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
html <span class="token operator">=</span> response<span class="token punctuation">.</span>text
<span class="token comment"># 使用html.parser来解析HTML内容</span>
soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token string">"html.parser"</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="2_200"></a>2、查找和提取数据</h3> 
<p>BeautifulSoup提供了多种方法来查找和提取HTML文档中的数据。</p> 
<p><strong>BeautifulSoup常用方法：</strong></p> 
<ul><li><code>find(tag, attributes)</code>: 查找第一个符合条件的标签。</li><li><code>find_all(tag, attributes)</code>: 查找所有符合条件的标签。</li><li><code>select(css_selector)</code>: 使用CSS选择器查找符合条件的标签。</li><li><code>get_text()</code>: 获取标签内的文本内容。</li><li><code>attrs</code>: 获取标签的属性字典。</li></ul> 
<h4><a id="_212"></a>Ⅰ、查找单个元素</h4> 
<p><code>find</code>方法用于查找第一个符合条件的元素。例如，查找页面中的第一个标题：</p> 
<pre><code class="prism language-python">title <span class="token operator">=</span> soup<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"span"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"title"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>title<span class="token punctuation">.</span>string<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="_221"></a>Ⅱ、查找所有元素</h4> 
<p><code>findAll</code>方法用于查找所有符合条件的元素。例如，查找页面中的所有标题：</p> 
<pre><code class="prism language-python">all_titles <span class="token operator">=</span> soup<span class="token punctuation">.</span>findAll<span class="token punctuation">(</span><span class="token string">"span"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"title"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> title <span class="token keyword">in</span> all_titles<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>title<span class="token punctuation">.</span>string<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="CSS_231"></a>Ⅲ、使用CSS选择器</h4> 
<p><code>select</code>方法允许使用CSS选择器来查找元素。例如，查找所有标题：</p> 
<pre><code class="prism language-python">all_titles <span class="token operator">=</span> soup<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">"span.title"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> title <span class="token keyword">in</span> all_titles<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>title<span class="token punctuation">.</span>get_text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="_241"></a>Ⅳ、获取元素属性</h4> 
<p>可以使用<code>attrs</code>属性获取元素的属性字典。例如，获取所有图片的URL：</p> 
<pre><code class="prism language-python">all_images <span class="token operator">=</span> soup<span class="token punctuation">.</span>findAll<span class="token punctuation">(</span><span class="token string">"img"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> img <span class="token keyword">in</span> all_images<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>img<span class="token punctuation">[</span><span class="token string">'src'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<h2><a id="_251"></a>四、爬取豆瓣电影榜</h2> 
<p><img src="https://images2.imgbox.com/5d/36/PFar4Im1_o.png" alt="image-20240607021500369"></p> 
<p>电影标题：HTML的标签名是：span，指定元素的 class 属性是 title</p> 
<p><img src="https://images2.imgbox.com/e8/7a/5rTp8Ovi_o.png" alt="image-20240607021403243"></p> 
<p>评分：HTML标签是：span，指定元素的class属性是rating_num</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup

headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36 Edg/125.0.0.0"</span>
<span class="token punctuation">}</span>
    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"https://movie.douban.com/top250"</span></span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
    html <span class="token operator">=</span> response<span class="token punctuation">.</span>text
    soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token string">"html.parser"</span><span class="token punctuation">)</span>

    <span class="token comment"># 获取所有电影</span>
    all_movies <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"item"</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> movie <span class="token keyword">in</span> all_movies<span class="token punctuation">:</span>
        <span class="token comment"># 获取电影标题</span>
        titles <span class="token operator">=</span> movie<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">"span"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"title"</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> title <span class="token keyword">in</span> titles<span class="token punctuation">:</span>
            title_string <span class="token operator">=</span> title<span class="token punctuation">.</span>get_text<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token string">"/"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> title_string<span class="token punctuation">:</span>
                movie_title <span class="token operator">=</span> title_string

        <span class="token comment"># 获取电影评分</span>
        rating_num <span class="token operator">=</span> movie<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"span"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"rating_num"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_text<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment"># 输出电影标题和评分</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"电影: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>movie_title<span class="token punctuation">}</span></span><span class="token string">, 评分: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>rating_num<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/65/82/GfvXB3NM_o.png" alt="image-20240607021144542"></p> 
<p>爬取成功了，但是爬取的内容只有第一页，后面的内容没有爬取成功。分析上面的url连接，每个页面通过URL中的<code>start</code>参数进行分页。</p> 
<p><img src="https://images2.imgbox.com/04/f4/h8pHCDcw_o.png" alt="image-20240607020345475"></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup

headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36 Edg/125.0.0.0"</span>
<span class="token punctuation">}</span>

<span class="token keyword">for</span> start_num <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"https://movie.douban.com/top250?start=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>start_num<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>
    html <span class="token operator">=</span> response<span class="token punctuation">.</span>text
    soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token string">"html.parser"</span><span class="token punctuation">)</span>

    <span class="token comment"># 获取所有电影条目</span>
    all_movies <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"item"</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> movie <span class="token keyword">in</span> all_movies<span class="token punctuation">:</span>
        <span class="token comment"># 获取电影标题</span>
        titles <span class="token operator">=</span> movie<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">"span"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"title"</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> title <span class="token keyword">in</span> titles<span class="token punctuation">:</span>
            title_string <span class="token operator">=</span> title<span class="token punctuation">.</span>get_text<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token string">"/"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> title_string<span class="token punctuation">:</span>
                movie_title <span class="token operator">=</span> title_string

        <span class="token comment"># 获取电影评分</span>
        rating_num <span class="token operator">=</span> movie<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"span"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"rating_num"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_text<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment"># 输出电影标题和评分</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"电影: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>movie_title<span class="token punctuation">}</span></span><span class="token string">, 评分: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>rating_num<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/dfcc1df0b353b1396a733a20b4ffb67b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">阿里云GPU服务器安装ComfyUI</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9e45bb3097190634a12647173fd302e8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">jstat命令介绍</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大咖.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>